//tealium universal tag - utag.loader ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
var utag_condload=false;window.__tealium_twc_switch=false;try{(function(a,b,c){if(typeof utag_data=='undefined')utag_data={};a=location.pathname.split('/');b=(a.length>9)?9:a.length;for(c=1;c<b;c++){utag_data['_pathname'+c]=(typeof a[c]!='undefined')?a[c]:''}})();}catch(e){console.log(e);}
if(!utag_condload){try{try{if(window.performance&&typeof window.performance.mark==="function"){window.performance.mark("tealium_init_start");}}catch(e){}
window.WSI=window.WSI||{};window.WSI.tracking=window.WSI.tracking||{};window.WSI.tracking.errors=window.WSI.tracking.errors||[];window.utag_cfg_ovrd=window.utag_cfg_ovrd||{};window.utag_cfg_ovrd.noview=true;window.pmc={pageName:"",pathSplit:[],pageValue:"",isMobile:false,AdobeAnalytics_s_account:"wsidefaultdev",youTubeInitialized:false,skuData:{},privacyRequested:"1NNN",isErrorPageviewProcessingComplete:false,queryStringArray:[],dataLayerReadyCallbackRegistered:false,eventCallbacksRegistered:false,visitStart:0,linkInternalFilters:"javascript:,williams-sonoma.com,potterybarn.com,potterybarnkids.com,pbteen.com,potterybarnteen.com,westelm.com,markandgraham.com,rejuvenation.com,greenrow.com,cultivation.com,williams-sonoma.ca,potterybarn.ca,potterybarnkids.ca,westelm.ca,pbteen.ca,potterybarnteen.ca,ab.mgimgs.com,rk.mgimgs.com,ab.pbimgs.com,rk.pbimgs.com,ab.pkimgs.com,rk.pkimgs.com,ab.ptimgs.com,rk.ptimgs.com,ab.weimgs.com,rk.weimgs.com,ab.wsimgs.com,rk.wsimgs.com,williams-sonoma.cashstar.com,potterybarn.cashstar.com,potterybarnkids.cashstar.com,pbteen.cashstar.com,potterybarnteen.cashstar.com,westelm.cashstar.com,markandgraham.cashstar.com,recs.richrelevance.com,-m.cashstar.com,cashstar.com,west-elm-progressive.herokuapp.com,ws-preprd-rk1v,pkimgs.com,pbimgs.com,ptimgs.com,wsimgs.com,weimgs.com,mgimgs.com",getHashedEmail:function(eventIn){eventIn=eventIn||digitalData;if(utag_data.privacy_opt_out_LDU){return"";}
var potentialEmail=eventIn.email||pmc.getQueryStringValue("cm_em")||pmc.getNestedValue(eventIn,"data.profileEmail")||pmc.getNestedValue(eventIn,"x_user.profile.profileEmail")||pmc.getNestedValue(eventIn,"profile.profileEmail")||pmc.getNestedValue(eventIn,"user.profileEmail")||pmc.getNestedValue(eventIn,"page.attributes.emailAddress")||pmc.getNestedValue(eventIn,"user.profile.profileEmail")||pmc.getNestedValue(eventIn,"x_transaction.customer.email")||"";if(pmc.stringContains(potentialEmail,"@")||pmc.stringContains(potentialEmail,"%40")){var err=new Error("Plain text email");err.type="datalayer";pmc.logError(err);return"";}
potentialEmail=potentialEmail.replace("%25","%");return potentialEmail.replace("%3A",":");},environment:{adobeReportSuite:"wsidefaultdev",brandDomain:"williams-sonoma",primaryDomain:"com",tertiaryDomain:"www",brandCode:"ws",tealiumEnvironment:"qa",market:"us",countryCode:"us",appIdentifier:"",currency:"USD",_brandCodeMap:[{key:/\.williams-sonoma\./,value:"ws",},{key:/\.potterybarnkids\./,value:"pk",},{key:/\.potterybarnteen\./,value:"pt",},{key:/\.pbteen\./,value:"pt",},{key:/\.potterybarn\./,value:"pb",},{key:/\.westelm\./,value:"we",},{key:/\.markandgraham\./,value:"mg",},{key:/\.rejuvenation\./,value:"rj",},{key:/\.greenrow\./,value:"gr",},],_brandHostMap:[{key:"ws",value:"williams-sonoma",},{key:"pk",value:"potterybarnkids",},{key:"pt",value:"pbteen",},{key:"pb",value:"potterybarn",},{key:"we",value:"westelm",},{key:"mg",value:"markandgraham",},{key:"rj",value:"rejuvenation",},{key:"gr",value:"greenrow",},],_setTealiumEnvironment:function(subDomain){if(subDomain==="www"){return"prod";}else if(subDomain==="aktest-www"){return"staging";}else{return"qa";}},_setAdobeTrackingServer:function(){utag_data.s_trackingServerSecure_AdobeAnalytics="smetrics."+pmc.environment.brandDomain+"."+pmc.environment.primaryDomain;return utag_data.s_trackingServerSecure_AdobeAnalytics;},_dataLayerToReportSuiteMap:[{key:"usa",value:"us",},{key:"us",value:"us",},{key:"can",value:"ca",},],_domainToReportSuiteMap:[{key:"com",value:"us",},{key:"ca",value:"ca",},],_setMarket:function(environment,digitalData){var market=pmc.getNestedStringValue(digitalData,"x_state.market").toLowerCase();if(market){environment.market=environment.reportSuiteMarket=pmc.resolveMapLookup(environment._dataLayerToReportSuiteMap,market)||"";}else{environment.market=environment.reportSuiteMarket=pmc.resolveMapLookup(environment._domainToReportSuiteMap,environment.primaryDomain)||"";}},setVariablesFromBrowser:function(){try{var environment=pmc.environment;var docLocation=document.location;environment.hostname=(docLocation.hostname||"").toLowerCase();environment.pathname=(docLocation.pathname||"").toLowerCase();environment.queryString=(docLocation.search||"");environment.brandCode=pmc.resolveMapLookup(environment._brandCodeMap,environment.hostname);if(pmc.stringContains(environment.hostname,"-ecommerce-jukebox-release.services.")){environment.brandCode=environment.hostname.split("-ecommerce-jukebox-release.services.")[0];environment.brandDomain=pmc.resolveMapLookup(environment._brandHostMap,environment.brandCode);environment.hostname="jukebox."+environment.brandDomain+".com";}else{environment.brandDomain=pmc.resolveMapLookup(environment._brandHostMap,environment.brandCode);}
var hostArray;if(environment.brandDomain){hostArray=environment.hostname.split("."+environment.brandDomain+".");environment.tertiaryDomain=hostArray[0];environment.primaryDomain=hostArray[1]?hostArray[1]:"";environment.tealiumEnvironment=environment._setTealiumEnvironment(environment.tertiaryDomain);}}catch(e){e.data="Error in setVariablesFromBrowser within pmc.environment";pmc.logError(e);}},setVariablesFromDataLayer:function(){var environment=pmc.environment;var currencyCode=environment.currency=pmc.getNestedStringValue(digitalData,"x_state.currencyCode");var countryCode=pmc.getNestedStringValue(digitalData,"x_state.countryCode")
environment._setMarket(environment,window.digitalData);if(environment.market==="us"){currencyCode=currencyCode||"USD";countryCode=countryCode||"us";}else if(environment.market==="ca"){currencyCode=currencyCode||"CAD";countryCode=countryCode||"ca";}
utag_data.currency_code=environment.currency=currencyCode.toUpperCase();utag_data.country_code=environment.countryCode=countryCode.toLowerCase();utag_data.language="en";},},parseKeyValueString:function(inputString,delimiter,equals){if(!inputString||typeof inputString!=="string"){return[];}
var betweenPairs=delimiter||"&";var beforeValue=equals||"=";var pairsArray=inputString.split(betweenPairs);var outputObject={};var addPairToObject=function(pairString){var pairArray=pairString.split(beforeValue);if(pairArray.length===2&&pairArray[1]){outputObject[pairArray[0]]=outputObject[pairArray[0]]||pairArray[1];}}
for(var i=0,len=pairsArray.length;i<len;i++){addPairToObject(pairsArray[i]);}
return outputObject;},decodeQueryString:function(queryString){return queryString.replace(/%26/g,"&").replace(/%3D/g,"=").replace(/%2C/g,",");},formatQueryString:function(queryString){if(queryString[0]==="?"){queryString=queryString.substring(1);}
return pmc.decodeQueryString(queryString);},serializeQueryString:function(queryString){if(queryString===""){return[];}
if(typeof queryString!=="string"){queryString=document.location.search;}
queryString=pmc.formatQueryString(queryString);return pmc.parseKeyValueString(queryString);},getQueryStringValue:function(queryStringParameter,sourceArray){if(!pmc.isArray(sourceArray)){sourceArray=pmc.queryStringArray||[];}
if(typeof sourceArray[queryStringParameter]==="string"){return sourceArray[queryStringParameter];}
return"";},getPartsFromUrl:function(url){var out={};var remainder=url;var parts=[];if(!url){return{protocol:"",hostname:"",pathname:"",queryString:"",};}
if(pmc.stringContains(url,"//")){parts=remainder.split("//");out.protocol=parts[0];remainder=parts[1];}else{out.protocol=document.location.protocol;}
if(pmc.stringContains(url,"/")){parts=remainder.split("/");out.hostname=parts.shift();remainder=parts.join("/");}else{out.hostname="";}
if(pmc.stringContains(url,"?")){parts=remainder.split("?");out.pathname=parts[0];out.queryString=parts[1];}else{out.pathname=remainder;out.queryString="";}
return out;},getTrackingFromSession:function(){var wsiTracking;var wsiTrackingString=sessionStorage.getItem("wsi_tracking");if(wsiTrackingString){wsiTracking=JSON.parse(wsiTrackingString);}
return wsiTracking;},setCreditCardApprovalEvents:function(){var creditCardDecision=pmc.getQueryStringValue("instantIssuance");if(creditCardDecision==="true"){utag_data.pmc_event349="event349";}else if(creditCardDecision==="false"){utag_data.pmc_event350="event350";}},getBloomreachDomainKeyFromLocalStorage:function(brKey){var brConfig=JSON.parse(localStorage.getItem(brKey));for(var catId in brConfig){if(brConfig[catId].BR_CONFIG&&brConfig[catId].BR_CONFIG.domainKey){return pmc.getNestedValue(brConfig[catId],"BR_CONFIG.domainKey");}}},quantumMetrics:{eventQueue:[],isInitialized:false,sendEvent:function(eventNumber,payload){if(pmc.quantumMetrics.isInitialized){QuantumMetricAPI.sendEvent(eventNumber,0,payload);}else{pmc.quantumMetrics.eventQueue.push({eventNumber:eventNumber,payload:payload,});}},initialize:function(){let queue=pmc.quantumMetrics.eventQueue;for(let i=0,len=queue.length;i<len;i++){QuantumMetricAPI.sendEvent(queue[i].eventNumber,0,queue[i].payload);}
pmc.quantumMetrics.isInitialized=true;window.sessionStorage.setItem("qmSessionId",QuantumMetricAPI.getSessionID());},openHandler:function(){QuantumMetricAPI.addEventListener('start',pmc.quantumMetrics.initialize);},registerOpenHandler:function(){window.QuantumMetricOnload=pmc.quantumMetrics.openHandler;},},dispatchAnalyticsEvent:function(payload){var errorObj;if(pmc.checkNestedValue(window,"WSI.tracking.addEvent")){window.WSI.tracking.addEvent(payload);return;}
if(pmc.checkNestedValue(window,"WSI.dataLayer._addEvent")){window.WSI.dataLayer._addEvent({name:"elementInteraction",data:payload,});return;}
errorObj=new Error("No addEvent function found");pmc.logError(errorObj);},listenForCustomMessageEvents:function(){window.addEventListener("message",function(event){try{var sender=pmc.getNestedValue(event,"data.customMessageSender","");if(sender==="Qudini"){pmc.convertQudiniMessageEvents(event.data);}}catch(err){err.source="addEventListener | pmc.listenForCustomMessageEvents";pmc.logError(err);}});},convertQudiniMessageEvents:function(messageData){try{var allowedEvents=["Confirmation","RescheduleConfirmation","Cancellation","Contact Request"];var allowedTypes=["Appointment","Event"];if(pmc.arrayContains(allowedEvents,messageData.analyticsEvent)&&pmc.arrayContains(allowedTypes,messageData.schedulingType)){pmc.dispatchAnalyticsEvent({category:"qudini scheduling",item:messageData.schedulingType+" "+messageData.analyticsEvent,});}}catch(e){pmc.logError(e);}},handleUgc:function(eventData){const name=eventData.name||eventData.item;const action=eventData.userAction||eventData.item;const pageCategory=pmc.getNestedValue(digitalData,"page.pageCategory.primaryCategory");let dataOut={};let pipEventName="";if(name==="curalate library"){let curalateEvent="";utag_data.curalateLibraryLoaded=true;if(utag_data.page_type==="category"){curalateEvent="category";}else if(utag_data.page_type==="order"){curalateEvent="purchase";}
if(curalateEvent){dataOut={associatedTags:"curalate",curalate_event:curalateEvent,tealium_event:"curalate_library",};}}else if(name==="content impression"){dataOut={associatedTags:"curalate",curalate_event:"contentImpression",ugcExperienceId:eventData.experienceId,page_type:(utag_data.page_type==="pages")?"gallery":utag_data.page_type,tealium_event:"curalate_content_impression",};}else if(name==="item click"){pipEventName="cural8:UGC_item:"+eventData.position;dataOut={curalate_event:"itemClick",itemId:eventData.itemId,position:eventData.position,ugcExperienceId:eventData.experienceId,ugcProductStyleId:eventData.productStyleId,page_type:utag_data.page_type,tealium_event:"curalate_item_click",};}else if(name==="product click"){pipEventName="cural8:UGC_product:"+eventData.position;dataOut={curalate_event:"productClick",itemId:eventData.itemId,position:eventData.position,ugcExperienceId:eventData.experienceId,ugcProductStyleId:eventData.productStyleId,productId:eventData.productId,page_type:utag_data.page_type,tealium_event:"curalate_product_click",};}else if(action==="add own picture"){pipEventName="UGC Overlay Impressions";dataOut={associatedTags:"curalate,adobeAnalytics",tealium_event:"user_content_upload_impression",};}else if(eventData.item==="content submit"){pipEventName="UGC Overlay Uploads";dataOut={tealium_event:"user_content_upload_submit",pmc_eVar98:eventData.imageType,};if(eventData.optInChecked==="true"){dataOut.pmc_event324="event324";}}else if(eventData.item==="image click"){if(pageCategory==="products"){pipEventName="PIP:Shop The Look Interaction";}else if(pageCategory==="home"){pipEventName="HP:Shop The Look Interaction";}
dataOut={tealium_event:"user_content_image_click",pmc_eVar92:pipEventName,}}
if(!dataOut.tealium_event){return;}
if(pageCategory==="products"){dataOut.pmc_prop14=pipEventName;pmc.processPIPInteraction(dataOut);}else{pmc.fireLinkHit(dataOut);}},setVariablesFromQueryString:function(output){output.pmc_eVar14=output.cm_sp=pmc.getQueryStringValue("cm_sp");output.pmc_eVar15=output.cm_re=pmc.getQueryStringValue("cm_re");output.cm_ven=pmc.getQueryStringValue("cm_ven");output.tp_parameter=pmc.getQueryStringValue("tp");if(pmc.getQueryStringValue("cm_src")==="pip_ugc"){output.pmc_eVar92="PIP: Shop The Look Clickthru";}else if(pmc.getQueryStringValue("cm_src")==="hp_ugc"){output.pmc_eVar92="HP: Shop The Look Clickthru";}
return output;},processQueryStringArray:function(queryString,output=utag_data){pmc.queryStringArray=pmc.serializeQueryString(queryString);output=pmc.setVariablesFromQueryString(output);return output;},initializeVariablesFromBrowser:function(){try{pmc.environment.setVariablesFromBrowser();pmc.processQueryStringArray(pmc.environment.queryString);}catch(e){pmc.logError("Error in pmc.serializeQueryString(). "+e.message);pmc.queryStringArray=[];}
try{utag_data.random_order_id="";window.WSI.tracking.wsiTracking=window.pmc.getTrackingFromSession()||{};}catch(e){e.data="Error calling getTrackingFromSession";pmc.logError(e);}
try{pmc.referrer=pmc.getPartsFromUrl(document.referrer);pmc.referrerQueryArray=pmc.serializeQueryString(pmc.referrer.queryString);}catch(e){pmc.logError("Error in pmc.serializeQueryString() for referrer. "+e.message);pmc.referrerQueryArray=[];}
try{pmc.setCreditCardApprovalEvents();}catch(e){pmc.logError("Error in pmc.setCreditCardApprovalEvents(). "+e.message);}
try{pmc.cookieKeyValues=pmc.getAllCookies(document.cookie);pmc.environment.dataCenter=pmc.readCookie("WSIDC");}catch(e){pmc.logError("Error reading cookies. "+e.message);}
try{pmc.checkIdentityParameters();}catch(e){pmc.logError("Error in pmc.checkIdentityParameters(). "+e.message);}
try{utag_data.days_since_last_visit=pmc.getNumDaysSinceLastVisit();var omMid=pmc.getQueryStringValue("om_mid");utag_data.pmc_eVar52=omMid?omMid:"";utag_data.pmc_eVar64=pmc.getRecommendationStrategy();}catch(e){pmc.logError(e);}},parseJsonFromService:function(response){if(response.status===200){return response.json();}else if(response.ok){return;}else{throw new Error("Response is status "+response.status);}},setExternalHash:function(hashValue){if(!hashValue){return;}
if(utag_data.privacy_opt_out_LDU||pmc.environment.primaryDomain!=="com"){return;}
var endpoint="";var endpointDomain="www."+pmc.environment.brandDomain+"."+pmc.environment.primaryDomain;if(pmc.environment.tealiumEnvironment==="prod"){endpointDomain="//"+endpointDomain;}else if(pmc.environment.tealiumEnvironment==="staging"){endpointDomain="//aktest-"+endpointDomain;}else{return;}
hashValue=hashValue.replace("02:","").replace(/02%3a/i,"");endpoint=endpointDomain+"/svc/hash-lookup/v1/customer/"+hashValue;return fetch(endpoint,{method:"GET",})
.then(pmc.parseJsonFromService)
.then(function(data){if(data&&data.sha256){utag_data.customer_email=data.sha256;pmc.setLiveRampCookie(utag_data.customer_email);}})
.catch(function(error){error.type="service";error.data="Endpoint=/svc/hash-lookup/v1/customer/";error.data+=": Intialization Error: pmc.setExternalHash():";});},setLiveRampCookie:function(unsaltedHashedSha256Email){if(!pmc.readCookie("wsid_lrenv")&&unsaltedHashedSha256Email){var urlBase="https://api.rlcdn.com/api/identity/envelope?pid=13610&it=4";var fullUrl=urlBase+"&iv="+unsaltedHashedSha256Email;var options={method:"GET",headers:{Accept:"application/json",Origin:"https://williams-sonoma.com"}};fetch(fullUrl,options)
.then(function(response){if(response&&response.json){return response.json();}else{return;}})
.then(function(data){if(data&&data.envelope){utag_data.liveramp_ats_envelope=data.envelope;pmc.writeCookie("wsid_lrenv",data.envelope);}})
.catch(function(error){error.type="service";error.data="https://api.rlcdn.com/api/identity/envelope";pmc.logError(error);});}},getStorageValues:function(storageValues){var urlPath="/api/visitor/v1/storage?getValues=";if(pmc.stringContains(document.location.host,"wsgc.com")){urlPath="https://"+pmc.environment.tertiaryDomain+"."+pmc.environment.brandDomain+"."+pmc.environment.primaryDomain+urlPath;}
fetch(urlPath+storageValues,{method:"GET",})
.then(pmc.parseJsonFromService)
.then(function(jsonContent){var storageKeyValueObject=[];var acceptedParameterLength=pmc.acceptedParameterList.length;var acceptedStorageName="";var acceptedTealiumName="";var valueFromStorage="";if(jsonContent&&jsonContent.data){storageKeyValueObject=jsonContent.data;for(var j=0;j<acceptedParameterLength;j++){acceptedStorageName=pmc.acceptedParameterList[j].parameterName;acceptedTealiumName=pmc.acceptedParameterList[j].tealiumName;valueFromStorage=storageKeyValueObject[acceptedStorageName];if(valueFromStorage){utag_data[acceptedTealiumName]=valueFromStorage;}}}else{throw new Error("No information sent in response");}})
.catch(function(error){error.type="service";error.data="Endpoint=/api/visitor/v1/storage?";error.data+=": Intialization Error: pmc.getStorageValues():";pmc.logError(error);});},isInternal:function(referrer){if(pmc.linkInternalFilters){var filters=pmc.linkInternalFilters.split(",");var docRef=document.referrer.split("/");docRef=docRef[2];if(docRef){for(var f in filters){if(docRef.indexOf(filters[f])>-1){return true;}}}}
return false;},getPfmFromReferrer:function(referrer,isInternal,output){isInternal=isInternal||pmc.isInternal(referrer);if(isInternal){return output.pmc_eVar9||"";}
if(referrer){if(pmc.stringContains(referrer,"r.curalate.com")){return"";}else{return"external natural referral";}}},sendToStorage:function(storageArray){var storageQueryString="";var urlPath="/api/visitor/v1/storage?";if(pmc.stringContains(document.location.host,"wsgc.com")){urlPath="https://"+pmc.environment.tertiaryDomain+"."+pmc.environment.brandDomain+"."+pmc.environment.primaryDomain+urlPath;}
if(pmc.isArray(storageArray)&&storageArray.length>0){storageQueryString=storageArray.join("&");fetch(urlPath+storageQueryString,{method:"POST",headers:{"Content-Type":"application/json",},body:'{"action":"update"}',})
.then(pmc.parseJsonFromService)
.then(function(data){pmc.cookieKeyValues=pmc.getAllCookies(document.cookie);pmc.setClientIdValues([]);})
.catch(function(error){error.type="service";error.data="Endpoint=/api/visitor/v1/storage/";error.data+=": Intialization Error: pmc.sendToStorage():";pmc.logError(error);});}},acceptedParameterList:[{tealiumName:"wsid_gclid",parameterName:"gclid",},{tealiumName:"wsid_adlclid",parameterName:"adlclid",},{tealiumName:"wsid_kpid",parameterName:"kpid",},{tealiumName:"wsid_ir_clickid",parameterName:"clickid",},],acceptedClientIdList:[{name:"svi3",source:function(){return pmc.getAdobeVisitorId();},},{name:"lv_env3",source:function(){return""},},],setClientIdValues:function(processedCookieArray){var acceptedClientIdListLength=pmc.acceptedClientIdList.length;var parameterName="";var parameterValue="";var cookieName="";var idCookieSourceValue="";for(var j=0;j<acceptedClientIdListLength;j++){parameterName=pmc.acceptedClientIdList[j].name;cookieName="wsid_"+parameterName;parameterValue=pmc.readCookie(cookieName);if(parameterValue){utag_data[cookieName]=parameterValue;}else{if(!pmc.readCookie("wsiapp_meta")){idCookieSourceValue=pmc.acceptedClientIdList[j].source();if(idCookieSourceValue){idCookieSourceValue=parameterName+"="+idCookieSourceValue;processedCookieArray.push(idCookieSourceValue);}}}}
return processedCookieArray;},setStorageFromQueryString:function(sendToStorageArray){var acceptedParameterListLength=pmc.acceptedParameterList.length;var parameterKey="";var parameterValue="";var parameterCookie="";for(var i=0;i<acceptedParameterListLength;i++){parameterKey=pmc.acceptedParameterList[i].parameterName;parameterValue=pmc.getQueryStringValue(parameterKey);parameterCookie=pmc.acceptedParameterList[i].parameterName;if(parameterValue){sendToStorageArray.push(parameterCookie+"="+parameterValue);}}
return sendToStorageArray;},checkIdentityParameters:function(){var sendToStorageArray=pmc.setClientIdValues([]);if(pmc.queryStringArray){sendToStorageArray=pmc.setStorageFromQueryString(sendToStorageArray);}
if(sendToStorageArray.length>0){pmc.sendToStorage(sendToStorageArray);}},managePreviousPageData:function(pageName,pageType){try{var storedPageString=pmc.readCookie("wsi_tracking_page");var storedPageData=storedPageString?JSON.parse(storedPageString):{};var newPageDataString="";var newPageData={page_name:pageName||utag_data.pmc_pageName,page_type:pageType||utag_data.pmc_prop1,};if(storedPageData){if(storedPageData.page_name){utag_data.previous_page_name=storedPageData.page_name;}
if(storedPageData.page_type){utag_data.previous_page_type=storedPageData.page_type;}}
newPageDataString=JSON.stringify(newPageData);pmc.writeCookie("wsi_tracking_page",newPageDataString);return storedPageData;}catch(err){pmc.logError(err);}},pageValues:{_pageNameExceptionMap:[{exactPath:"/stores/",pageName:"stores:store-locator",},],getPageName:function(){var exception;var map=pmc.pageValues._pageNameExceptionMap;for(var i=0,len=map.length;i<len;i++){exception=map[i];if(exception.exactPath){if(exception.exactPath===pmc.environment.pathname){return exception.pageName;}}}
return"";},},sendEventToRelayServer:function(eventIn){if(pmc.environment.market.toLowerCase().indexOf("ca")>-1){return;}
var endpoint="https://"+window.location.hostname+"/itpm/event";var email=pmc.getHashedEmail(eventIn);var eventId=eventIn.eventId;endpoint+=(eventId)?"?event_id="+eventId:"";endpoint+=(email)?"&email="+email:"";endpoint+=eventIn.pageInitId?("&first_event=false&page_init_id="+eventIn.pageInitId):"";var name=eventIn.eventName;if(!(name==="pageView"||(name==="pageEvent"&&pmc.arrayContains(["cart_add","registry_add","registry_create","qudini_scheduling_appointment_confirmation","email_signup","search_results_event"],eventIn.eventType)))){return;}
var payload={name:name,type:eventIn.eventType,data:eventIn,email:email,market:eventIn.state&&eventIn.state.market,brand:eventIn.state&&eventIn.state.brandCode,}
fetch(endpoint,{method:"POST",mode:"cors",headers:{'Content-Type':'application/json'},body:JSON.stringify(payload),}).then(function(response){return response.json();}).then(function(data){if(data){console.log(JSON.stringify(data));}}).catch(function(error){error.type="service";error.data="Endpoint=https://edap-itpm-server-uat.services.west.nonprod.wsgc.com/itpm/event";error.data+=": Intialization Error: ITPM Relay Server Call:";});},wsiTrackingItems:function(itemsIn){try{var getItemGroupId=function(itemIn){let productId=itemIn.productId||itemIn.productID||itemIn;let ID={persistentGroupId:productId.persistentProdId||productId.persistentProdID||productId.persistentProductId||"",primaryGroupId:productId.primaryProdId||productId.primaryProdID||productId.primaryGroupId||"",groupId:productId.prodId||productId.prodID||productId.groupId||"",sku:productId.sku||"",};return ID;}
var getItemReadyToShip=function(itemIn){var readyToShip=pmc.getNestedValue(itemIn,"attributes.readyToShip")||pmc.getNestedValue(itemIn,"readyToShip")||{};return{aoddEnd:itemIn.aoddEnd||readyToShip.ecddEnd||readyToShip.aoddEnd||"",aoddStart:itemIn.aoddStart||readyToShip.ecddStart||readyToShip.aoddStart||"",backOrderDate:itemIn.backOrder||"",postalCode:readyToShip.postalCode||"",backOrderStatus:readyToShip.status||"",shipMode:readyToShip.shipMode||"",originalDeliveryEstimateStart:readyToShip.originalDeliveryEstimateStart||itemIn.originalDeliveryEstimateStart||"",originalDeliveryEstimateEnd:readyToShip.originalDeliveryEstimateEnd||itemIn.originalDeliveryEstimateEnd||"",};}
var getShipType=function(itemIn){if(pmc.getNestedValue(itemIn,"shipToStore.storeId")){return"bosts";}else if(itemIn.shipToStoreLocationCode||itemIn.pickupLocationCode){return"bopis";}}
var getUnitPrice=function(itemIn){itemIn.price=itemIn.price||{};let unitPrice=itemIn.price.unitPrice;if(!unitPrice){unitPrice=pmc.isNestedDataDefinedAndNonEmpty(itemIn,"price")?itemIn.price:0;}
return unitPrice;}
var updateItem=function(itemIn){let id=getItemGroupId(itemIn);let price=getUnitPrice(itemIn);let shipToStore=itemIn.shipToStore||{};return{giftWrapped:itemIn.giftWrapped||false,monogrammed:itemIn.monogrammed||false,porchInstallationService:itemIn.porchInstallationService||false,quantity:itemIn.quantity||0,unitPrice:price||"",cartSmartBundle:itemIn.cartSmartBundle?itemIn.cartSmartBundle.enabled:false,persistentGroupId:id.persistentGroupId,primaryGroupId:id.primaryGroupId,groupId:id.groupId,sku:id.sku||"",readyToShip:getItemReadyToShip(itemIn),itemType:itemIn.itemType||"",pickupLocationCode:itemIn.pickupLocationCode||"",superCategory:itemIn.superCategory||"",shipType:getShipType(itemIn)||"",storeId:shipToStore.storeId||itemIn.shipToStoreLocationCode||itemIn.pickupLocationCode||"",storeBrand:shipToStore.storeBrand||"",};}
var updateItems=function(itemsIn){let itemsOut=[];let itemOut={};itemsIn.forEach((itemIn)=>{itemOut=updateItem(itemIn);itemsOut.push(itemOut);});return itemsOut;}
if(itemsIn){return updateItems(itemsIn);}
return[];}
catch(err){pmc.logError(err);}},wsiTrackingEventInit:function(wsiTracking,eventData,sendObj){try{if(!wsiTracking||!eventData){return;}
wsiTracking.events=wsiTracking.events||[];var eventCategory=eventData.category||"";var eventItem=eventData.item||"";eventData=eventData.data||eventData||{};var now=new Date();var user=wsiTracking.user||{};var nowTimeStamp=now.getTime();var randomNumber=Math.floor(Math.random()*1000000000);var products=eventData.items?(eventData.items.item||eventData.items):[];var identity=wsiTracking.identity||{};var locale=wsiTracking.locale||wsiTracking.state||{};var page=wsiTracking.page||{};var wsiTrackingEvent={eventName:"pageEvent",eventType:eventData.tealium_event||sendObj.tealium_event,eventId:nowTimeStamp.toString()+randomNumber.toString(),browser:{userAgent:window.navigator.userAgent||window.Navigator.userAgent||"",viewWidth:window.innerWidth,viewHeight:window.innerHeight,screen:window.screen.width+"x"+window.screen.height,referrer:document.referrer,href:document.location.href,timeStamp:nowTimeStamp,timezoneOffsetMinutes:now.getTimezoneOffset(),},identity:{facebookClickId:identity.facebookClickId,facebookBrowserId:identity.facebookBrowserId,},cart:{items:[],},page:{concept:page.concept,categories:page.categories,siteSection:page.primaryCategory,pageType:page.pageType,pageName:page.pageName,adobePageName:page.adobePageName,adobePageType:page.adobePageType,wsiRetailStore:page.wsiRetailStore,},user:{profileEmail:user.profileEmail||eventData.email||(eventData.data?eventData.data.profileEmail:"")||"",userId:utag_data.sc_visitor_id,marketingOptOut:user.marketingOptOut||false,privacyRequestType:user.privacyRequestType||"",privacyRequested:pmc.privacy.isRequested||false,facebookClickId:identity.facebookClickId,facebookBrowserId:identity.facebookBrowserId,inboundParameters:{},},locale:{countryCode:locale.countryCode,currencyCode:locale.currencyCode,market:locale.market,brandCode:locale.brandCode,},};if(pmc.isNonEmptyArray(products)){wsiTrackingEvent.cart.items=pmc.wsiTrackingItems(products);}
var registryId=pmc.getNestedStringValue(eventData,"registry.registryId");if(registryId){wsiTrackingEvent.page.registry={registryId:registryId,}}
wsiTrackingEvent.state=wsiTrackingEvent.locale;wsiTracking.events.push(wsiTrackingEvent);pmc.sendEventToRelayServer(wsiTrackingEvent);return wsiTrackingEvent;}catch(err){pmc.logError(err);}},wsiTrackingInit:function(dd,eventType){dd=dd||window.digitalData;if(!dd){return;}
var initData=WSI.tracking.initData||{};var dd_pg=dd.page||{};var pageName=pmc.getNestedLowerCaseValue(dd_pg,"pageName");var dd_pg_atr=dd_pg.attributes||{};var dd_pr=dd.product||{};var refinements=dd_pg.refinements||{};var cat=dd_pg_atr.pageCategory||{};var pr_id=dd_pr?(dd_pr.productId||dd_pr.productID||{}):{};var productCategory=dd_pr.productCategory||{};var ship=(dd_pr&&dd_pr.attributes)?dd_pr.attributes.readyToShip||{}:{};var cart=dd.cart;if(!cart){if(dd.x_cart&&pmc.isNonEmptyArray(dd.x_cart.orders)&&(pageName!=="order confirmation")){cart=dd.x_cart;}else if(dd.x_transaction&&pmc.isNonEmptyArray(dd.x_transaction.orders)){cart=dd.x_transaction;}else{cart={};}}
var subOrder=pmc.isNonEmptyArray(cart.orders)?cart.orders[0]:{};cart.price=subOrder.price;var user=dd.x_user;var profile=(user&&user.profile)?user.profile||{}:{};var price=dd_pr.price||{};var price_selling=price.selling||{};var price_regular=price.regular||{};var ut_da=window.utag_data||{};var searchTerm=pmc.getQueryStringValue("words")||pmc.getQueryStringValue("term")||pmc.getNestedValue(dd_pg_atr,"searchTerm","");var now=new Date();var nowTimeStamp=Math.abs((new Date()).getTime()).toString();var isPurchase=(dd.x_transaction&&dd.x_transaction.orders&&dd.x_transaction.orders[0]&&dd.x_transaction.orders&&dd.x_transaction.orders[0].orderID)?true:false;var accessPoint=subOrder.accessPoint||{};var randomNumber=Math.floor(Math.random()*1000000000);var wsi_tracking={eventName:"pageView",eventType:eventType||utag_data.tealium_event||s.prop63,eventId:initData.eventId||nowTimeStamp.toString()+randomNumber.toString(),pageInitId:initData.pageInitId||"",browser:{userAgent:window.navigator.userAgent||window.Navigator.userAgent||"",viewWidth:window.innerWidth,viewHeight:window.innerHeight,screen:window.screen.width+"x"+window.screen.height,referrer:document.referrer,href:document.location.href,timeStamp:now.getTime(),timezoneOffsetMinutes:now.getTimezoneOffset(),},identity:initData.identity||{facebookClickId:"",facebookBrowserId:"",},page:{concept:dd_pg_atr.concept,strategy:dd_pg_atr.strategy,pipTemplate:dd_pg_atr.template,architecture:dd_pg_atr.architecture,technology:dd_pg_atr.technology,designTradeMemberTier:"",designTradeMemberType:"",expressCheckout:false,loyalty:false,marketing:false,notificationType:"",prescreenBannerDisplayed:"",pwa:false,transactional:false,refinements:{positions:refinements.positions,types:refinements.types,values:refinements.values,},registry:{userRole:"",registryId:"",privacyOptInType:"",items:[],},categories:cat.categories||productCategory.categories||utag_data.productCategory||utag_data.category_path||[],siteSection:cat.primaryCategory,pageType:dd_pg.pageType,pageName:pageName,adobePageName:ut_da.pmc_pageName,adobePageType:ut_da.pmc_prop1,wsiRetailStore:pmc.readCookie("WSIRetailStore"),},user:{authenticationStatus:profile.authenticationStatus||"",profileEmail:profile.profileEmail||(cart.customer?cart.customer.email:"")||"",userId:initData.userId||utag_data.sc_visitor_id,marketingOptOut:initData.marketingOptOut||false,privacyRequestType:utag_data.privacy_request_type||"",},locale:{countryCode:initData.countryCode||(dd.x_state?dd.x_state.countryCode:""),market:initData.countryCode||(dd.x_state?dd.x_state.market:""),currencyCode:dd.x_state?dd.x_state.currencyCode:"",brandCode:initData.countryCode||pmc.environment.brandCode,},previous:{pageName:"",pageType:"",percentViewed:"",searchTerm:"",productFinding:"",campaign:"",referrer:"",lastVisitEpochTime:"",originatingEpochTime:"",newRepeat:ut_da.new_or_repeat_visitor,adobeSessionStartTime:"",hitTime:"",},merchandising:{productFindingMethod:ut_da.pmc_eVar9,campaign:ut_da.pmc_campaign||ut_da.campaign,internalAd:ut_da.internal_ad,},search:{searchTerm:searchTerm,searchTermEntered:"",resultsCount:"",resultsType:"",isDuplicateSearch:false,},cart:{isPurchase:isPurchase,payment:subOrder.payment||{paymentType:"",newlyApproved:"",sccOperation:"",},price:cart.price||{giftWrapDiscountTotal:0,merchDiscount:0,merchTotal:price.merchTotal||0,orderTotal:price.orderTotal||0,personalizationDiscountTotal:0,shippingDiscountTotal:0,shippingTotal:price.shippingTotal||0,svcTotal:price.svcTotal||0,taxTotal:price.taxTotal||0,},delivery:{aoddEnd:"",aoddStart:"",postalCode:"",status:"",deliveryMethods:[],autoConsolidationEligibility:"",hasAutoDeliveryConsolidation:false,hasConveyableConsolidation:subOrder.hasConveyableConsolidation||false,hasInHomeConsolidation:subOrder.hasInHomeConsolidation||false,upsAccessPointEligibility:"",},customer:cart.customer||{address:{city:"",stateProvince:"",postalCode:"",country:""},email:"",},items:[{monogrammed:false,giftWrapped:false,porchInstallationService:false,quantity:0,sku:"",unitPrice:"",persistentGroupId:"",primaryGroupId:"",groupId:"",},],subOrder:{orderId:subOrder.orderID,orderType:subOrder.orderType||"",promoCode:subOrder.promoCode||"",checkoutType:dd_pg_atr.checkoutType,designTradeMemberTier:dd_pg_atr.designTradeMemberTier||"",designTradeMemberType:dd_pg_atr.designTradeMemberType||"",expressCheckout:dd_pg_atr.expressCheckout||false,loyalty:dd_pg_atr.loyalty||false,marketing:dd_pg_atr.marketing||false,notificationType:dd_pg_atr.notificationType||"",prescreenBannerDisplayed:dd_pg_atr.prescreenBannerDisplayed||"",chooseYourDate:subOrder.chooseYourDate||"false",hasConveyableConsolidation:subOrder.hasConveyableConsolidation||"false",hasInHomeConsolidation:subOrder.hasInHomeConsolidation||"false",itemTypes:subOrder.itemTypes||"",address:{},confirmedTenders:[{tenderTypeDetail:cart.confirmedTenders?cart.confirmedTenders.tenderTypeDetail:"",tenderAmount:cart.confirmedTenders?cart.confirmedTenders.tenderAmount:"",}],deliveryGroups:[{affectedSkus:[''],estimatedDeliveryDate:{start:'',end:'',},type:""},],eligibleServiceLevels:[],shipTos:cart.shiptos||[],accessPoint:{hasEditedPickUpPerson:accessPoint.hasEditedPickUpPerson||"false",isUpsAccessPointOrder:accessPoint.isUpsAccessPointOrder||"false",upsAccessPointEligibility:accessPoint.upsAccessPointEligibility||"Ineligible",},},},};if(!dd_pr){wsi_tracking.product={};}else{wsi_tracking.page.secondaryIds=(dd_pr&&dd_pr.attributes)?dd_pr.attributes.persistentIDs:[];wsi_tracking.product={giftWrapped:dd_pr.giftwrapped||false,monogrammed:dd_pr.monogrammed||false,porchInstallationService:dd_pr.porchInstallationService||false,quantity:dd_pr.quantity,superCategory:dd_pr.superCategory||"",unitPrice:price_selling.max||price_selling.min||price_regular.max||price_regular.min||0,productCategory:dd_pr.productCategory?dd_pr.productCategory:{},};wsi_tracking.product.Id={persistentGroupId:pr_id.persistentProductId||pr_id.persistentProductID||"",primaryGroupId:pr_id.primaryGroupId||pr_id.primaryProdID||"",groupId:pr_id.productId||pr_id.prodID||pr_id.prodId||"",sku:pr_id.sku||"",};}
var managePinterestIdentity=function(wsiTracking){var pinterestBrowserId=pmc.readCookie("_pin_unauth");var pinterestEpikId=pmc.getQueryStringValue("epik")||pmc.readCookie("_epik");if(pinterestEpikId){pmc.writeCookie("_epik",pinterestEpikId,90*24*60);wsi_tracking.identity.pinterestEpikId=pinterestEpikId;}
if(pinterestBrowserId){wsi_tracking.identity.pinterestBrowserId=pinterestBrowserId;}};var manageFacebookIdentity=function(wsiTracking){let facebookBrowserId=pmc.readCookie("_fbp");let querystringClickId=pmc.getQueryStringValue("fbclid");const facebookPrefix="fb.1."+nowTimeStamp+".";if(querystringClickId&&!pmc.stringStartsWith(querystringClickId,"fb.")){querystringClickId=facebookPrefix+querystringClickId;}
const facebookClickId=querystringClickId||pmc.readCookie("_fbc");if(facebookClickId){pmc.writeCookie("_fbc",facebookClickId,90*24*60);wsi_tracking.identity.facebookClickId=facebookClickId;}
if(!facebookBrowserId){facebookBrowserId=facebookPrefix+randomNumber;}
pmc.writeCookie("_fbp",facebookBrowserId,90*24*60);wsi_tracking.identity.facebookBrowserId=facebookBrowserId;};var updatePrevious=function(wsiTracking){wsiTracking.page=wsiTracking.page||{};wsiTracking.previous=wsiTracking.previous||{};wsiTracking.merchandising=wsiTracking.merchandising||{};wsiTracking.browser=wsiTracking.browser||{};wsiTracking.search=wsiTracking.search||{};var currentTime=wsi_tracking.browser.timeStamp;var previousHitTime=wsiTracking.browser.timeStamp;wsi_tracking.search.isDuplicateSearch=(wsi_tracking.search.searchTerm&&wsiTracking.previous.searchTerm&&wsi_tracking.search.searchTerm===wsiTracking.previous.searchTerm)?true:false;wsi_tracking.previous={orderIdRandom:wsiTracking.previous.orderIdRandom||Math.floor(Math.random()*1000000)+""+(new Date()).getTime(),pageName:wsiTracking.page.pageName||"",pageType:wsiTracking.page.pageType||"",adobePageName:wsiTracking.page.adobePageName||"",adobePageType:wsiTracking.page.adobePageType||"",percentViewed:wsiTracking.percentViewed||"",searchTerm:wsiTracking.search.searchTerm||"",productFinding:wsiTracking.previous.productFinding||"",campaign:wsiTracking.previous.campaign||wsiTracking.merchandising.campaign||"",referrer:wsiTracking.previous.referrer||wsiTracking.browser.referrer||document.referrer||"",originatingEpochTime:wsiTracking.previous.originatingEpochTime||currentTime,adobeSessionStartTime:(wsiTracking.previous.hitTime&&(currentTime-wsiTracking.previous.hitTime<1800000))?wsiTracking.previous.adobeSessionStartTime:currentTime,hitTime:previousHitTime||currentTime,newRepeat:wsiTracking.previous.newRepeat||ut_da.new_or_repeat_visitor,};return wsi_tracking;};wsi_tracking.events=[];manageFacebookIdentity();managePinterestIdentity();if(window.WSI.tracking.wsiTracking){wsi_tracking=updatePrevious(window.WSI.tracking.wsiTracking);}
if(wsi_tracking){if(cart&&(cart.orders||cart.items)){wsi_tracking.cart.items=pmc.wsiTrackingItems(cart.items||cart.orders[0].items);}
wsi_tracking.state=wsi_tracking.locale;pmc.sendEventToRelayServer(wsi_tracking);window.sessionStorage.setItem("wsi_tracking",JSON.stringify(wsi_tracking));return wsi_tracking;}},};window.utag_data=window.utag_data||{privacy_opt_out_LDU:false,};pmc.newSkuDataElement=function(){return{deliveryType:"unknown",start:"",end:"",groupId:""};};pmc.getNextValue=function(sourceString,startIndex){var returnString=sourceString.substring(startIndex);return returnString;};pmc.isArray=function(potentialArray){if(typeof(potentialArray)==="undefined"){return false;}
if(typeof(Array)!=="undefined"&&typeof(Array.isArray)!=="undefined"){return Array.isArray(potentialArray);}else{return(potentialArray instanceof Array);}};pmc.isNonEmptyArray=function(potentialArray){return(pmc.isArray(potentialArray)&&potentialArray.length>0);};pmc.returnNonTruthyArray=function(potentialArray){if(!potentialArray){return undefined;}
if(!pmc.isNonEmptyArray(potentialArray)){return potentialArray;}
for(var i=0;i<potentialArray.length;i++){if(potentialArray[i]){return potentialArray;}}
return undefined;}
pmc.lowercaseArray=function(arr){if(!pmc.isArray(arr)){return[];}
return arr.map(function(element){if(typeof element==="string"){return element.toLowerCase();}else{return element;}});};pmc.stringContains=function(str,match){if(typeof str!=="string"||typeof match!=="string"){return false;}
return str.indexOf(match)>-1;};pmc.arrayContains=function(array,match){if(pmc.isArray(array)){return array.indexOf(match)>-1;}
return false;};pmc.stringStartsWith=function(str,match){if(typeof str!=="string"||typeof match!=="string"){return false;}
return str.indexOf(match)===0;};pmc.convertToSnakeCase=function(str){if(typeof str!=="string"){return"";}
return str.split(" ").join("_").toLowerCase();};pmc.addToArrayUnique=function(arr,ele){if(!pmc.isArray(arr)){throw new Error("addToArrayUnique: 'arr' is not an Array");}
if(arr.indexOf(ele)>-1){return arr;}
return arr.push(ele);};pmc.roundValue=function(value,n){return Math.round(Math.pow(10,n)*value)/Math.pow(10,n);};pmc.getIntegerDifference=function(q1,q2){if(!isNaN(q1)&&!isNaN(q2)){return parseInt(q1-q2);}
return null;};pmc.getTotalFromUnitsAndPrice=function(units,pricePerUnit){var unitsNumber=parseInt(units);var priceNumber=parseFloat(pricePerUnit);if(!isNaN(unitsNumber)&&!isNaN(priceNumber)){return pmc.roundValue(unitsNumber*priceNumber,2);}
return 0;};pmc.writeCookie=function(name,value,expires){var expiryDate=new Date();if(name&&value){pmc.cookieKeyValues[name]=value;expires=expires||30;expiryDate.setTime(expiryDate.getTime()+(expires*60000));document.cookie=name+"="+value+"; path=/; domain=."+pmc.environment.brandDomain+"."+pmc.environment.primaryDomain+"; expires="+expiryDate.toUTCString();}};pmc.getAllCookies=function(cookieString){var cookieKeyValues={};var cookiesArray=[];var parts=[];var key="";var value="";try{if(cookieString){cookiesArray=cookieString.split(';');for(var i=0;i<cookiesArray.length;i++){parts=cookiesArray[i].split("=");if(parts&&parts.length===2){key=parts[0].trim()||"";value=parts[1].trim()||"";if(key&&value){cookieKeyValues[key]=value;}}}}}catch(e){pmc.logError(e);}
return cookieKeyValues;};pmc.readCookie=function(cookieKey){return pmc.cookieKeyValues[cookieKey]||"";};pmc.KeyValue=function(str,pairDelimiter,keyValueDelimiter){this.keyValueAssociativeArray=[];this.getValue=function(key){return this.keyValueAssociativeArray[key]||"";};str=str||"";pairDelimiter=pairDelimiter||"&";keyValueDelimiter=keyValueDelimiter||"=";var pairArray,keyValArray;if(str){pairArray=str.split(pairDelimiter);if(pairArray){for(var i=0;i<pairArray.length;i++){keyValArray=pairArray[i].split(keyValueDelimiter);if(keyValArray.length===2){this.keyValueAssociativeArray[keyValArray[0]]=keyValArray[1];}else{this.keyValueAssociativeArray["base"+i]=keyValArray[0];}}}}};pmc.getNumDaysSinceLastVisit=function(){try{var daysSinceLastVisit=-1;var millisecondsSince1970=pmc.readCookie("s_lv");var time={};time.SECONDS=1000;time.MINUTES=time.SECONDS*60;time.HOURS=time.MINUTES*60;time.DAYS=time.HOURS*24;if(typeof(millisecondsSince1970)!=="undefined"&&millisecondsSince1970.length>0&&!isNaN(millisecondsSince1970)&&millisecondsSince1970>0){var rightNow=new Date();daysSinceLastVisit=Math.round((rightNow.valueOf()-millisecondsSince1970*1)/time.DAYS,0);if(typeof(pmc.getQueryStringValue)!=="undefined"){if(pmc.getQueryStringValue("TestTimeUnit")==="seconds"){daysSinceLastVisit=Math.round((rightNow.valueOf()-millisecondsSince1970*1)/time.SECONDS,0);}else if(pmc.getQueryStringValue("TestTimeUnit")==="minutes"){daysSinceLastVisit=Math.round((rightNow.valueOf()-millisecondsSince1970*1)/time.MINUTES,0);}}}
return daysSinceLastVisit;}catch(e){pmc.logError("Error in getNumDaysSinceLastVisit(). "+e.message);return-1;}};pmc.resolveMapLookup=function(map,input,outkey){try{var isMatch=false;var thisKey;var thisVal;var useVal;var useKey;useVal=input||"";useKey=outkey||"value";if(!pmc.isArray(map)){return;}
for(var ii=0,len=map.length;ii<len;ii++){thisKey=map[ii].key;thisVal=map[ii][useKey];if(typeof map[ii].useVal==='undefined'){map[ii].input=useVal;}
if(typeof thisKey==="string"&&thisKey===useVal){isMatch=true;}else if(typeof thisKey==="object"&&typeof thisKey.test==="function"&&thisKey.test(useVal)){isMatch=true;}else if(typeof thisKey==="function"&&thisKey(map[ii])){isMatch=true;}
if(isMatch){if(typeof thisVal==="string"||typeof thisVal==="object"){return thisVal;}else if(typeof thisVal==="function"){return thisVal(map[ii]);}}}}catch(e){pmc.logError(e);}};pmc.getPageValuesFromURL=function(path){var data={pageValue:[],pathSplit:[],pageId:"",isMobile:false};var spl=(typeof(path)!=="undefined"&&path.length>0)?path:document.location.pathname;if(spl.indexOf("/")===0){spl=spl.replace("/","");}
if(spl.lastIndexOf("/")===(spl.length-1)){spl=spl.substring(0,spl.length-1);}
spl=spl.split("/");var jnd=0;for(var ind=0;ind<spl.length;ind++){if(typeof(spl[ind])!=="undefined"&&spl[ind].length>0){if(ind===0&&spl[ind]==="m"){data.isMobile=true;}else{data.pathSplit[jnd]=spl[ind];jnd++;}}}
if(data.pathSplit.length>0){var latestValue=data.pathSplit.pop();data.pageId=latestValue.replace(".html","");data.pageValue=data.pageId.replace(/-/g," ");}else{data.pageId="home";data.pageValue="home page";data.pathSplit.push(data.pageValue);}
return data;};pmc.releaseThread=function(callback,duration){if(pmc.isVariableDefinedAndNonEmpty(callback)){if(!pmc.isVariableDefinedAndNonEmpty(duration)){duration=0;}
window.setTimeout(callback,duration);}};pmc.getAdobeVisitorId=function(){var visitorId="";var amcvCookie="";var strippedValue="";try{visitorId=pmc.readCookie("wsid_svi3");if(!visitorId){if(window.visitor&&typeof window.visitor.getMarketingCloudVisitorID==="function"){visitorId=window.visitor.getMarketingCloudVisitorID();}else{amcvCookie=pmc.readCookie("AMCV");if(amcvCookie){strippedValue=amcvCookie.toLowerCase().indexOf('mcmid').split('|');if(strippedValue.length>1){visitorId=strippedValue[1];}}}}}catch(e){utag.DB(e);}
return visitorId;};pmc.setAdobeSvi3Id=function(svi3){if(window.Visitor&&window.visitor&&typeof window.visitor.setCustomerIDs==="function"){Visitor.AuthState=Visitor.AuthState||{UNKNOWN:0,AUTHENTICATED:1,LOGGED_OUT:2,};window.visitor.setCustomerIDs({"svi3ID":{"id":svi3,"authState":Visitor.AuthState.AUTHENTICATED,},});}};pmc.privacy={isRequested:false,setPrivacyCookie:function(privacyRequested){var iabCompliantValue="1NNN";if(privacyRequested){iabCompliantValue="1NYN";pmc.writeCookie("usprivacy",iabCompliantValue,7*24*60);}},setStatus:function(isPrivacyRequested,isCookieSet){if(isPrivacyRequested){utag_data.privacy_opt_out_LDU=true;window.google_restricted_data_processing=true;pmc.privacy.isRequested=true;}
if(!isCookieSet){pmc.privacy.setPrivacyCookie(isPrivacyRequested);}},matchEmailAndAdobeIds:function(emailId,adobeId,endpointUrl){var matchIdXhr=new XMLHttpRequest();var matchObj={"randomCookieId":adobeId,"hashedConsumerId":emailId,};matchIdXhr.open('POST',endpointUrl,true);matchIdXhr.setRequestHeader("Accept","application/json");matchIdXhr.setRequestHeader("Content-type","application/json");matchIdXhr.send(JSON.stringify(matchObj));},getGpcStatus:function(environment,adobeVisitorId,customerEmail){var gpcRequested=navigator.globalPrivacyControl;if(gpcRequested){pmc.privacy.setStatus(true,false);utag_data.privacy_request_type="GPC";return true;}
return false;},initializeTruyoEndpoint:function(environment,adobeVisitorId,customerEmail){var orgId="95AM7WRK5AJ50";var endpointBase="qa-wsi";if(environment==="prod"||pmc.getQueryStringValue("fakeProd")){orgId="JJ2PHKG484N5P";endpointBase="wsi";}
var baseUrl="https://"+endpointBase+".truyo.com/api/v1/consent/public/"+orgId+"/consumercookies/opt-out-urls?";var completeUrl=baseUrl+"idType=rcid&id="+adobeVisitorId;if(customerEmail){var matchUrl="https://"+endpointBase+".truyo.com/api/v1/consent/public/"+orgId+"/consumercookie/relations";pmc.privacy.matchEmailAndAdobeIds(customerEmail,adobeVisitorId,matchUrl);}
return completeUrl;},getLduStatus:function(response){var optedOutUrls=[];if(response&&response.optOutUrls){optedOutUrls=response.optOutUrls;for(var i=0;i<optedOutUrls.length;i++){if(optedOutUrls[i].optOutUrl==="LDU"){return true;}}}
return false;},getCookieStatus:function(){var privacyRequested=pmc.readCookie("usprivacy");if(privacyRequested.charAt(2)==='Y'){return true;}
return false;},callTruyo:function(environment,adobeVisitorId,customerEmail){try{if(!environment||!adobeVisitorId){return;}
utag_data.privacy_opt_out_LDU=false;var xhr=new XMLHttpRequest();var responseObject;xhr.onreadystatechange=function(){if(xhr.readyState!==4)return;if(xhr.status>=200&&xhr.status<300){responseObject=JSON.parse(xhr.responseText);if(pmc.privacy.getLduStatus(responseObject)){pmc.privacy.setStatus(true,false);}}};xhr.open('GET',pmc.privacy.initializeTruyoEndpoint(environment,adobeVisitorId,customerEmail));xhr.setRequestHeader("Accept","application/json");xhr.setRequestHeader("Content-type","application/json");xhr.send();}catch(e){pmc.logError(e);}},initialize:function(environment,adobeVisitorId,customerEmail){var privacyRequested=false;window.utag_data=utag_data||{privacy_opt_out_LDU:false,};if(pmc.privacy.getCookieStatus()){pmc.privacy.setStatus(true,true);privacyRequested=true;}else{privacyRequested=pmc.privacy.getGpcStatus(environment,adobeVisitorId,customerEmail);}
if(!privacyRequested){pmc.privacy.callTruyo(environment,adobeVisitorId,customerEmail);}}};pmc.setDigitalDataPageObject=function(){var pathDataValues={};if(typeof(window.digitalData)!=="undefined"){if(typeof(window.digitalData.page)==="undefined"){try{pathDataValues=pmc.getPageValuesFromURL(document.location.pathname);}catch(e){e.data="Error calling pmc.getPageValuesFromURL from pmc.setDigitalDataPageObject";pmc.logError(e);return;}
pmc.isMobile=pathDataValues.isMobile;var categoryValue="";var pageValue=pathDataValues.pageValue.toUpperCase();var pageNameValue=pageValue;var pageTypeValue="UNKNOWN";var primaryCategoryValue="UNKNOWN";if(pathDataValues.pathSplit.length>0){pageTypeValue=primaryCategoryValue=pathDataValues.pathSplit[0];categoryValue="E:"+pageTypeValue.toUpperCase();pageNameValue=pathDataValues.pathSplit.join(":").toUpperCase()+":"+pageValue;}
if(pageNameValue.indexOf("THEKEY")>-1){pageTypeValue="CUSTOMER SERVICE";categoryValue="E:"+pageTypeValue;if(pmc.isMobile){categoryValue="M:"+categoryValue;pageValue="MOBILE "+pageNameValue;}
if(pathDataValues.pathSplit.length>2&&pathDataValues.pathSplit[pathDataValues.pathSplit.length-2].indexOf("hlc")>-1){pageValue+=" HLC";}
utag_data["page_type"]=utag_data["pmc_pageType"]=utag_data["pmc_channel"]=utag_data["pmc_prop1"]=utag_data["pmc_prop2"]=utag_data["pmc_prop3"]=utag_data["pmc_prop4"]=utag_data["pmc_prop5"]=pmc.pmc_pageType=pmc.pmc_prop1=pmc.pmc_prop2=pmc.pmc_prop3=pmc.pmc_prop4=pmc.pmc_prop5=primaryCategoryValue="thekey";utag_data["page_name"]=utag_data["pmc_pageName"]=pmc.pmc_pageName=pageNameValue;}
window.digitalData.page={attributes:{cmCategoryId:categoryValue,cmPageId:pageValue,mobile:pmc.isMobile},pageCategory:{categories:pathDataValues.pathSplit,primaryCategory:primaryCategoryValue,},pageName:pageNameValue,pageType:pageTypeValue};}}};pmc.removeHTML=function(str){try{var cleanStr;var errorObj;var div=document.createElement("div");div.innerHTML=str;cleanStr=div.textContent||div.innerText||"";if(str!==cleanStr){errorObj=new Error("HTML in data layer");errorObj.data="str="+str;errorObj.type="datalayer";pmc.logError(errorObj);}
return cleanStr;}catch(e){pmc.logError(e);return"";}};pmc.stripSpecialSymbols=function(string){if(typeof string!=="string"){return"";}
return string.replace(/[]/g,"");};pmc.removeStringsFromArray=function(source,target){var destination=[];if(typeof target==="string"){target=[target];}
for(var i=0;i<source.length;i++){if(pmc.isArray(target)){if(pmc.arrayContains(target,source[i])){continue;}else{destination.push(source[i]);}}}
return destination;};pmc.getMillisecondsBetweenEvents=function(t1,t2){return Math.abs(t1-t2);};pmc.getDaysBetweenDateAndToday=function(d1){return pmc.getDaysBetweenEvents(d1,new Date());};pmc.getDaysBetweenEvents=function(d1,d2){try{if(typeof d1==="string"){d1=new Date(d1);}
if(typeof d2==="string"){d2=new Date(d2);}
if(!d1||!d2||isNaN(d1)||isNaN(d2)){return 0;}
var timeDiff=pmc.getMillisecondsBetweenEvents(d1.getTime(),d2.getTime());var days=Math.ceil(timeDiff/(1000*3600*24));return days;}catch(e){e.data="d1="+d1+",d1="+d2;pmc.logError(e);}};pmc.normalizeProductIdString=function(parent){if(typeof parent!=="object"){return"";}
return parent.productId||parent.productID||"";};pmc.normalizeProductIdObject=function(parent){if(typeof parent!=="object"){return{};}
return parent.productId||parent.productID||{};};pmc.getBaseSku=function(longSku){if(typeof longSku==="string"){return longSku.split("-")[0];}};pmc.normalizeProdId=function(parent){if(typeof parent!=="object"){return"";}
return parent.prodId||parent.prodID||"";};pmc.getNormalProdId=function(parent){return pmc.normalizeProdId(pmc.normalizeProductIdObject(parent));};pmc.getNormalDesignTradeTier=function(inString){let output=pmc.lowerCaseString(inString);if(output&&output!=="non-member"){output="member";}
return output;};pmc.items=(function(){var _buildAdobeStringFromList=function(list,delimiter,isPurchase){var stringList=[];if(!pmc.isArray(list)||list.length===0){return"";}
for(var i=0,l=list.length;i<l;i++){stringList.push(list[i].adobeString(isPurchase));}
return stringList.join(delimiter);};var _setValueForKey=function(list,name,val){for(var i=0,l=list.length;i<l;i++){if(list[i].name===name){if(val===""){list.splice(i,1);}else{list[i].value=val;}
return;}}
if(val!==""){list.push(new ProductVariable(name,val));}};var _getVarFromList=function(list,name,val){for(var i=0,l=list.length;i<l;i++){if(list[i].name===name){return list[i].value;}}};var _stripDelimeters=function(string){if(typeof string!=="string"){return"";}
return string.replace(/[,|;]/g,"");};var _validEventName=function(name){return(typeof name==="string")?_stripDelimeters(name):"";};var _validEventValue=function(val){if(typeof val==="number"){return val;}
if(typeof val==="string"){return _stripDelimeters(val);}
return 1;};var _validEvarName=function(name){return(typeof name==="string")?_stripDelimeters(name):"";};var _validEvarValue=function(val){if(typeof val==="string"){return _stripDelimeters(val)||"";}
if(typeof val==="number"){return val||0;}
return"";};var ProductVariable=function(name,val){this.name=name;this.value=val;this.adobeString=function(){return this.name+"="+this.value;};};var ProductItem=function(){this.adobeEventList=[];this.adobeEvarList=[];this.groupId="";this.sku="";this.units="";this.unitPrice="";this.productName="";this.availability="";this.swatch=false;this.discount=0;this.discountedPrice=0;this.category="";this.setGroupId=function(groupId){if(typeof groupId==="string"){this.groupId=pmc.removeHTML(groupId);}};this.setSku=function(newSku){this.setEvar("eVar33",pmc.getBaseSku(newSku));};this.setUnits=function(units){this.units=parseInt(units)||0;};this.setProductName=function(productName){this.productName=productName||"";};this.setUnitPrice=function(unitPrice){var price=parseFloat(unitPrice)||0;this.unitPrice=pmc.roundValue(price,2);};this.setAsSwatch=function(){this.swatch=true;};this.isSwatch=function(){return this.swatch;};this.setDiscount=function(discount){if(!isNaN(discount)){this.discount=discount;}};this.setCategory=function(category){this.category=category;};this.setEvent=function(name,val,output,utag_name){_setValueForKey(this.adobeEventList,_validEventName(name),_validEventValue(val));if(output){output[utag_name||"pmc_"+name]=name;return output;}};this.setEventsFromString=function(eventString){var eventObj=pmc.parseKeyValueString(eventString,"|");var keyList=Object.keys(eventObj);var thisKey;for(var i=0,len=keyList.length;i<len;i++){thisKey=keyList[i];this.setEvent(thisKey,eventObj[thisKey]);}};this.getEvent=function(name){return _getVarFromList(this.adobeEventList,name);};this.setEvar=function(name,val){var validVal=_validEvarValue(val);_setValueForKey(this.adobeEvarList,_validEvarName(name),validVal);if(name==="eVar33"){this.sku=pmc.getBaseSku(parseInt(validVal))||"";}
if(name==="eVar45"){this.availability=validVal;}};this.setEvarsFromString=function(evarString){var evarObj=pmc.parseKeyValueString(evarString,"|");var keyList=Object.keys(evarObj);var thisKey;for(var i=0,len=keyList.length;i<len;i++){thisKey=keyList[i];this.setEvar(thisKey,evarObj[thisKey]);}};this.getEvar=function(name){return _getVarFromList(this.adobeEvarList,name);};this.getTotalPrice=function(){return pmc.getTotalFromUnitsAndPrice(this.units,this.unitPrice);};this.setBackOrderFromDate=function(backOrderDate,output){var diffDays=0;if(backOrderDate&&backOrderDate!=="0"){diffDays=pmc.getDaysBetweenDateAndToday(backOrderDate);}
this.setEvent("event56",1,output);if(diffDays){output=this.setEvent("event74",diffDays,output);this.setEvar("eVar46",diffDays);}
return output;};this.setBackOrderFromComponent=function(output){var componentArray=digitalData.component;if(!componentArray||componentArray.length===0){return output;}
for(var j=0,len=componentArray.length;j<len;j++){if(pmc.checkNestedValue(componentArray[j],"componentID.componentID")&&pmc.checkNestedValue(componentArray[j],"attributes.groupId")){if(this.groupId===componentArray[j].attributes.groupId&&(componentArray[j].componentID.componentID.match(/backorder/i)!=null||componentArray[j].componentID.componentID.match(/availability/i)!=null)){output.pmc_event56="event56";this.setEvent("event56");var diffDays=pmc.getDaysBetweenDateAndToday(componentArray[j].attributes.backorder);if(diffDays>0){this.setEvar("eVar46",diffDays);this.setEvent("event74",diffDays);output.pmc_event74="event74";}}}}
return output;};this.adobeString=function(isPurchase){if(isPurchase&&!this.swatch){return";"+this.groupId+";"+this.units+";"+this.getTotalPrice()+";"+_buildAdobeStringFromList(this.adobeEventList,"|")+";"+_buildAdobeStringFromList(this.adobeEvarList,"|");}else{return";"+this.groupId+";;;"+_buildAdobeStringFromList(this.adobeEventList,"|")+";"+_buildAdobeStringFromList(this.adobeEvarList,"|");}};};var ProductList=function(productArray){this.items=[];this._findItem=function(groupId,sku){for(var i=0,l=this.items.length;i<l;i++){if(this.items[i].groupId===groupId&&pmc.getBaseSku(this.items[i].sku)===pmc.getBaseSku(sku)){return this.items[i];}}};this._buildPropertyArray=function(property){var propArray=[];for(var i=0,l=this.items.length;i<l;i++){propArray.push(this.items[i][property]);}
return propArray;};this.addItem=function(groupId,sku){var possibleDuplicate=this._findItem(groupId,sku);if(possibleDuplicate){return possibleDuplicate;}
var newItem=createItem(groupId,pmc.getBaseSku(sku));if(newItem){this.items.push(newItem);}
return newItem;};this.addItemFromObject=function(product){if(typeof product!=="object"){return;}
var possibleDuplicate=this._findItem(product.groupId,product.sku);if(possibleDuplicate){return possibleDuplicate;}
var newItem=createItemFromObject(product);this.items.push(newItem);return newItem;};this.addItemFromProductString=function(productString){if(typeof productString!=="string"){return;}
var partsArray=productString.split(";");var newItem=this.addItem(partsArray[1]);if(newItem){newItem.setUnits(partsArray[2]);newItem.setUnitPrice(partsArray[3]);newItem.setEventsFromString(partsArray[4]);newItem.setEvarsFromString(partsArray[5]);}};this.hasFreeSwatches=function(){for(var i=0,len=this.items.length;i<len;i++){if(this.items[i].isSwatch()&&!this.items[i].unitPrice){return true;}}
return false;};this.hasPaidSwatches=function(){for(var i=0,len=this.items.length;i<len;i++){if(this.items[i].isSwatch()&&this.items[i].unitPrice>0){return true;}}
return false;};this.hasNonSwatches=function(){for(var i=0,len=this.items.length;i<len;i++){if(!this.items[i].isSwatch()){return true;}}
return false;};this.getGroupIdArray=function(){return this._buildPropertyArray("groupId");};this.getUnitsArray=function(){return this._buildPropertyArray("units");};this.getSkuArray=function(){return this._buildPropertyArray("sku");};this.getUnitPriceArray=function(){return this._buildPropertyArray("unitPrice");};this.getProductNameArray=function(){return this._buildPropertyArray("productName");};this.getAvailabilityArray=function(){return this._buildPropertyArray("availability");};this.getDiscountArray=function(){return this._buildPropertyArray("discount");};this.getDiscountedPriceArray=function(){return this._buildPropertyArray("discountedPrice");};this.getCategoryArray=function(){return this._buildPropertyArray("category");};this.getSubtotalPrice=function(){var subtotal=0;for(var i=0,len=this.items.length;i<len;i++){subtotal+=this.items[i].getTotalPrice();}
return subtotal;};this.getVariableValues=function(name){var item;var list=[];var value;for(var i=0,len=this.items.length;i<len;i++){item=this.items[i]
value=item.getEvent(name)||item.getEvar(name);list.push(value);}
return list;};this.getEventSum=function(name){var sum=0;var eventValue;for(var i=0,len=this.items.length;i<len;i++){eventValue=this.items[i].getEvent(name);if(!isNaN(eventValue)){sum+=(eventValue*1);}}
return sum;};this.length=function(){return this.items.length;};this.adobeString=function(isPurchase){return _buildAdobeStringFromList(this.items,",",isPurchase);};if(pmc.isArray(productArray)){for(const item of productArray){this.addItemFromObject(item);}}};var createItemList=function(productArray){return new ProductList(productArray);};var createItemListFromProductString=function(productString){if(typeof productString!=="string"){return;}
var productsArray=productString.split(",");var newItemList=createItemList();for(var i=0,len=productString.length;i<len;i++){newItemList.addItemFromProductString(productsArray[i]);}
return newItemList;};var createItem=function(groupId,sku){if(groupId||sku){var newItem=new ProductItem();newItem.setGroupId(groupId);newItem.setSku(pmc.getBaseSku(sku));return newItem;}};var createItemFromObject=function(product){if(product.groupId||product.sku){return createItem(product.groupId,product.sku);}};var getSimpleProductString=function(groupId,sku){var item=createItem(groupId,sku);if(item){return item.adobeString();}else{return"";}};var getProductString=function(itemObject){if(typeof itemObject!=="object"){return"";}
var item=createItem(itemObject.groupId,itemObject.sku);if(item){return item.adobeString();}
return"";};return{createItemList:createItemList,createItem:createItem,createItemFromObject:createItemFromObject,getSimpleProductString:getSimpleProductString,getProductString:getProductString,createItemListFromProductString:createItemListFromProductString,};})();pmc.getProductStringLegacy=function(pArray){var completeString="",currentProd={},paLen=pArray.length,i=0;var j=0;var incrementor=[];for(;i<paLen;i++){currentProd=pArray[i];currentProd.category="";completeString+=currentProd.category+";";completeString+=currentProd.description+";";var quantity=currentProd.quantity*1;var price=currentProd.price;if(!isNaN(quantity)&&!isNaN(price)){price=pmc.roundValue((price),2);}else{if(isNaN(quantity)){quantity='';}
if(isNaN(price)){price='';}}
if(quantity==0||quantity=="0"){quantity="";completeString+=quantity+";";}else{completeString+=quantity+";";}
if(price==0||price=="0"){price="";completeString+=""+";";}else{completeString+=pmc.roundValue((quantity*price),2)+";";}
if(currentProd.purchaseIncrementorEvents.length>0){incrementor=[];for(j=0;j<currentProd.purchaseIncrementorEvents.length;j++){incrementor.push(currentProd.purchaseIncrementorEvents[j].eventName+"="+currentProd.purchaseIncrementorEvents[j].value);}
completeString+=incrementor.join("|");if(currentProd.purchaseMerchandisingEvars.length>0){completeString+=";";}}
if(currentProd.purchaseMerchandisingEvars.length>0){if(currentProd.purchaseIncrementorEvents.length==0){completeString+=";";}
incrementor=[];for(j=0;j<currentProd.purchaseMerchandisingEvars.length;j++){incrementor.push(currentProd.purchaseMerchandisingEvars[j].evarName+"="+currentProd.purchaseMerchandisingEvars[j].value);}
completeString+=incrementor.join("|");}
if(i<paLen-1){completeString+=",";}}
return completeString;};pmc.setECommerceExtensionFromAdobeVariables=function(utagEvent){if(!utagEvent||!utagEvent.pmc_products){return utagEvent;}
var itemList=pmc.items.createItemListFromProductString(utagEvent.pmc_products);var categoryArray=[];var totalsBySkuArray=[];var units=0;var skuTotalFloat=0;utagEvent._cprod=pmc.returnNonTruthyArray(utagEvent.product_id)||itemList.getGroupIdArray()||[];utagEvent._cprodname=utagEvent._cprod;totalsBySkuArray=pmc.returnNonTruthyArray(utagEvent.product_unit_price)||pmc.returnNonTruthyArray(itemList.getUnitPriceArray())||itemList.getVariableValues("event70")||[];utagEvent._cquan=pmc.returnNonTruthyArray(utagEvent.product_quantity)||pmc.returnNonTruthyArray(itemList.getUnitsArray())||itemList.getVariableValues("event69")||[];utagEvent._cprice=totalsBySkuArray.map(function(skuTotal,index){units=parseInt(utagEvent._cquan[index]);skuTotalFloat=parseFloat(skuTotal);return skuTotalFloat/units;});utagEvent._csku=pmc.returnNonTruthyArray(utagEvent.product_sku)||itemList.getSkuArray()||[];if(utagEvent.pmc_pageName.indexOf("shop:")===0){categoryArray=utagEvent.pmc_pageName.split(":");categoryArray.shift();if(categoryArray.length===2){categoryArray[2]=categoryArray[1];}}
utagEvent.product_id=utagEvent._cprod;utagEvent._cprod=utagEvent._cprodname;utagEvent.product_unit_price=utagEvent._cprice;utagEvent.product_quantity=utagEvent._cquan;utagEvent.product_sku=utagEvent._csku;if(utagEvent.tealium_event==="product_view"){utagEvent.PIPGroupID=utagEvent._cprod;}
utagEvent._ccurrency=utagEvent.currency_code=utagEvent.currency||"";utagEvent._ccustid=utagEvent.customer_id=utagEvent.pmc_eVar50;utagEvent._czip=utagEvent.customer_postal_code?utagEvent.customer_postal_code:'';utagEvent._ccat=utagEvent.product_category=categoryArray||[];return utagEvent;};pmc.setRefinements=function(eventData,output){var refinements=pmc.getNestedValue(eventData,"refinements");var latestRefinement=pmc.getNestedStringValue(eventData,"latestRefinement").toLowerCase();var refinementPositions=pmc.getNestedValue(refinements,"positions",[]);eventData=eventData||{};if(refinements){var valuesArray=[];var refinementPositionAndType=[];output.pmc_eVar1=output.pmc_eVar1||utag_data.pmc_eVar1;output.pmc_eVar2=output.pmc_eVar2||utag_data.pmc_eVar2;output.pmc_eVar3=output.pmc_eVar3||utag_data.pmc_eVar3;output.pmc_eVar9=eventData.productFindingMethod||output.pmc_eVar9||utag_data.pmc_eVar9;output.pmc_eVar27=output.pmc_eVar27||utag_data.pmc_eVar27;output.pmc_eVar28=output.pmc_eVar28||utag_data.pmc_eVar28;output.pmc_eVar29=output.pmc_eVar29||utag_data.pmc_eVar29;output.pmc_eVar51=output.pmc_eVar51||utag_data.pmc_eVar51;output.pmc_eVar93=output.pmc_eVar93||utag_data.pmc_eVar93;if(pmc.isNonEmptyArray(refinements.types)&&pmc.isNonEmptyArray(refinements.values)){for(var i=0,l=refinements.types.length;i<l;i++){valuesArray.push(refinements.types[i]+":"+refinements.values[i]);if(refinementPositions[i]){refinementPositionAndType.push(refinementPositions[i]+":"+refinements.types[i])}}
output.pmc_eVar39=refinements.types.join("|").toLowerCase();output.pmc_eVar40=valuesArray.join("|").toLowerCase();output.pmc_eVar139=refinementPositions.join("|")||"no refinement";output.pmc_eVar140=refinementPositionAndType.join("|").toLowerCase()||"no refinement";}else{if(eventData.userAction==="clear all"){output.pmc_eVar9=eventData.productFindingMethod||pmc.getPfmFromURL()||output.pmc_eVar9||utag_data.pmc_eVar9||"";}
output.pmc_eVar39="no refinement";output.pmc_eVar40="no refinement";output.pmc_eVar139="no refinement";output.pmc_eVar140="no refinement";}
output.pmc_prop16="D=v39";output.pmc_prop17="D=v40";if(latestRefinement==="bopis"){output.pmc_event221="event221";if(pmc.arrayContains(refinements.values,"BOPIS")){output.pmc_eVar96="BOPIS Filter Enabled";}else{output.pmc_eVar96="BOPIS Filter Disabled";}}
if(eventData.clickLocation){output.pmc_eVar14=eventData.clickLocation;}
if(refinements.productCount&&pmc.checkNestedValue(digitalData,"page.pageCategory.primaryCategory","shop")){output.pmc_event403=parseInt(refinements.productCount)||0;if(output.pmc_event403>0){output.pmc_event404="event404";}}else if(refinements.productCount===0){output.pmc_event405="event405";}
output.facet_action=eventData.userAction;}
return output;};pmc.processCategoryRefinements=function(eventData){if(pmc.checkNestedValue(eventData,"refinements")){var sendObj={tealium_event:"facet_selection",};sendObj=pmc.setRefinements(eventData,sendObj);pmc.addPageHierarchyToEvent(sendObj);pmc.fireLinkHit(sendObj);}};pmc.processFacetActions=function(eventData){var eventItem=pmc.getNestedLowerCaseValue(eventData,"item");var sendObj={};if(eventItem==="refinement"){pmc.processCategoryRefinements(eventData);return;}
if(eventItem==="remove facets"){sendObj.tealium_event="facet_clear";eventData.userAction="clear all";eventData.refinements={positions:[],types:[],values:[],};pmc.setRefinements(eventData,sendObj);}
if(eventItem==="show facets"){sendObj={tealium_event:"facet_show",link_text:"Facet Show Button",}}
if(eventItem==="hide facets"){sendObj={tealium_event:"facet_hide",link_text:"Facet Hide Button",}}
if(sendObj.tealium_event){pmc.fireLinkHit(sendObj);}};pmc.isVariableDefinedAndNonEmpty=function(obj){if(typeof(obj)==="undefined"){return false;}
if(typeof(obj)=="number"){return true;}else if(typeof(obj)=="string"){if(obj.length>0){return true;}else{return false;}}else if(typeof(obj)=="boolean"){return obj;}else if(pmc.isArray(obj)&&obj.length>0){return true;}else if(typeof(obj)==="object"){for(var a in obj){if(obj.hasOwnProperty(a)){return true;}}}else if(typeof(obj)==="function"){return true;}
return false;};pmc.checkDataDefinedAndNonEmpty=function(obj,key){try{if(typeof(key)==="undefined"){return pmc.isVariableDefinedAndNonEmpty(obj);}else if(typeof(obj[key])!=="undefined"){return pmc.isVariableDefinedAndNonEmpty(obj[key]);}
return false;}catch(e){return false;}};pmc.isNestedDataDefinedAndNonEmpty=function(obj,str){var objArray=str.split(".");var baseObject=obj;for(var i=0;i<objArray.length;i++){if(!pmc.checkDataDefinedAndNonEmpty(baseObject,objArray[i])){return false;}else{baseObject=baseObject[objArray[i]];}}
return true;};pmc.getLeafNode=function(obj,keys){var keyArray=keys.split(".");var objNode=obj;var i=0;var len=0;if(typeof obj==="undefined"){return undefined;}
for(i=0,len=keyArray.length-1;i<len;i++){if(typeof objNode[keyArray[i]]!=="object"&&typeof objNode[keyArray[i]]!=="function"){return undefined;}
objNode=objNode[keyArray[i]];}
return objNode[keyArray[i]];};pmc.checkNestedValue=function(obj,keys,value){var objNode=pmc.getLeafNode(obj,keys);if(typeof objNode==="undefined"){return false;}
if(typeof value==="undefined"){if(typeof objNode==="object"){if(pmc.isArray(objNode)){if(objNode.length>0){return true;}else{return false;}}
for(var p in objNode){if(objNode.hasOwnProperty(p)){return true;}}
return false;}else{return!!objNode;}}
return objNode===value;};pmc.getNestedValue=function(obj,keys,defaultValue){var objNode=pmc.getLeafNode(obj,keys);if(typeof objNode==="undefined"){return defaultValue;}else{return objNode;}};pmc.isNonEmptyString=function(str){return(typeof str==="string"&&str!=="");};pmc.checkNestedString=function(obj,keys){return pmc.isNonEmptyString(pmc.getNestedValue(obj,keys));};pmc.getNestedStringValue=function(obj,keys){var out=pmc.getNestedValue(obj,keys,"");if(typeof out==="object"){out="";}
return out+"";};pmc.getNestedLowerCaseValue=function(obj,keys){return pmc.getNestedStringValue(obj,keys).toLowerCase();};pmc.lowerCaseString=function(str){if(typeof str==="string"){return str.toLowerCase();}
return"";};pmc.convertArrayNumbersToStrings=function(array){return array.map(function(number){return number.toString();})};pmc.orderValidKeys=function(object,properOrdering){var type="";var reconciledList=[];for(var i=0,len=properOrdering.length;i<len;i++){type=properOrdering[i];if(object[type]){reconciledList.push(type);}}
return reconciledList;};pmc.orderArrayElements=function(array,properOrdering){var type="";var reconciledList=[];for(var i=0,len=properOrdering.length;i<len;i++){type=properOrdering[i];if(array.indexOf(type)>-1){reconciledList.push(type);}}
return reconciledList;};pmc.getSubBrand=function(secondaryDomain,subList){var item={};var concept="";var conceptsList=[];var topPageCategory="";var topProductCategory="";var pageType="";var landing="";var pattern="";var defaultValue="";for(var i=0;i<subList.length;i++){item=subList[i];if(item.brand===secondaryDomain){if(window.digitalData){concept=pmc.getNestedStringValue(digitalData,"page.attributes.concept").toLowerCase();topPageCategory=pmc.getNestedValue(digitalData,"page.pageCategory.categories",[])[0];topProductCategory=pmc.getNestedValue(digitalData,"product.productCategory.categories",[])[0];pageType=pmc.getNestedValue(digitalData,"page.pageCategory.primaryCategory","");landing=item.landing;pattern=item.pattern;if(landing.length&&pmc.stringContains(pmc.environment.pathname,landing)){return item.subBrandName;}else if(pattern.length&&pageType==="shop"&&topPageCategory&&topPageCategory!=="homekeeping"&&pmc.stringStartsWith(topPageCategory,pattern)){return item.subBrandName;}else if(pattern.length&&topProductCategory&&topProductCategory!=="homekeeping"&&pmc.stringStartsWith(topProductCategory,pattern)){return item.subBrandName;}else if(concept){conceptsList=item.concepts;for(var j=0,len=conceptsList.length;j<len;j++){if(concept===conceptsList[j].conceptValue){return conceptsList[j].subBrand;}}}}
defaultValue=item.default;}}
return defaultValue;};pmc.setSubBrand=function(){try{pmc.subBrandPatternList=[{brand:"potterybarn",landing:"/pages/apartment/",pattern:"apartment",subBrandName:"pb-apartment",concepts:[{conceptValue:"pottery barn",subBrand:"pb"},{conceptValue:"pottery barn apartment",subBrand:"pb-apartment"},],default:"pb",},{brand:"williams-sonoma",landing:"/pages/williams-sonoma-home/",pattern:"home",subBrandName:"ws-home",concepts:[{conceptValue:"williams sonoma home",subBrand:"ws-home"},{conceptValue:"williams sonoma kitchen",subBrand:"ws-kitchen"},{conceptValue:"williams sonoma",subBrand:"ws-kitchen"},],default:"ws-kitchen",},{brand:"westelm",landing:"/shop/baby/",pattern:"kids-",subBrandName:"we-kids",concepts:[{conceptValue:"west elm",subBrand:"we"},{conceptValue:"west elm kids",subBrand:"we-kids"},{conceptValue:"west elm b2b",subBrand:"we-b2b"},],default:"we",},{brand:"westelm",landing:"/shop/kids-baby/",pattern:"kids-",subBrandName:"we-kids",concepts:[{conceptValue:"west elm",subBrand:"we"},{conceptValue:"west elm kids",subBrand:"we-kids"},],default:"we",},{brand:"westelm",landing:"/shop/west-elm-collection/",pattern:"west-elm-collection",subBrandName:"we-collection",concepts:[{conceptValue:"west elm",subBrand:"we"},{conceptValue:"west elm kids",subBrand:"we-kids"},],default:"we",},{brand:"pbteen",landing:"/pages/pbdorm/",pattern:"dorm",subBrandName:"pt-dorm",concepts:[{conceptValue:"pottery barn teen",subBrand:"pt"},{conceptValue:"pottery barn dorm",subBrand:"pt-dorm"},],default:"pt",},{brand:"potterybarnteen",landing:"/pages/pbdorm/",pattern:"dorm",subBrandName:"pt-dorm",concepts:[{conceptValue:"pottery barn teen",subBrand:"pt"},{conceptValue:"pottery barn dorm",subBrand:"pt-dorm"},],default:"pt",},{brand:"potterybarnkids",landing:"/pages/baby.html",pattern:"baby",subBrandName:"pk-baby",concepts:[{conceptValue:"pottery barn kids",subBrand:"pk"},{conceptValue:"modern | baby + kids",subBrand:"pk-modern-baby"},],default:"pk",},{brand:"potterybarnkids",landing:"/pages/modern-baby/",pattern:"modern-",subBrandName:"pk-modern-baby",concepts:[{conceptValue:"pottery barn kids",subBrand:"pk"},{conceptValue:"modern | baby + kids",subBrand:"pk-modern-baby"},],default:"pk",},{brand:"markandgraham",landing:"",pattern:"",subBrandName:"",concepts:[{conceptValue:"mark and graham",subBrand:"mg"},],default:"mg",},{brand:"rejuvenation",landing:"",pattern:"",subBrandName:"",concepts:[{conceptValue:"rejuvenation",subBrand:"rj"},],default:"rj",},{brand:"greenrow",landing:"",pattern:"",subBrandName:"",concepts:[{conceptValue:"greenrow",subBrand:"gr"},],default:"gr",}];pmc.subBrand=pmc.getSubBrand(pmc.environment.brandDomain,pmc.subBrandPatternList);}catch(e){pmc.logError("Error trying to set subBrand: "+e);}};pmc.getAdobeSubBrand=function(subBrand){var conceptMap=[{key:"pb",value:"potterybarn",},{key:"pb-apartment",value:"pb apartment",},{key:"ws-kitchen",value:"ws",},{key:"ws-home",value:"wsh",},{key:"we",value:"west elm",},{key:"we-collection",value:"west elm",},{key:"we-kids",value:"WE Kids",},{key:"we-b2b",value:"West Elm B2B",},{key:"pt",value:"pbteen",},{key:"pt-dorm",value:"pb dorm",},{key:"pk",value:"potterybarnkids",},{key:"pk-baby",value:"potterybarnkids",},{key:"pk-modern-baby",value:"PK Modern Baby",},{key:"mg",value:"mark and graham",},{key:"rj",value:"rejuvenation",},{key:"gr",value:"greenrow",},];return pmc.resolveMapLookup(conceptMap,subBrand)||"";};pmc.getSKUInOrdersFromID=function(itemID,orders){for(var i=0;i<orders.length;i++){var products=orders[i].items;for(var j=0;j<products.length;j++){if(pmc.getNormalProdId(products[j])===itemID){return pmc.normalizeProductIdObject(products[j]).sku;}}}
return"";};pmc.altImageClick=function(eventData){try{eventData=eventData.data||eventData;var groupID=eventData.productId||utag_data.PIPGroupID;var position=eventData.item||eventData.name||"";var sendObject={};var errorObj;if(groupID){sendObject.pmc_products=pmc.items.getSimpleProductString(groupID);}else{errorObj=new Error("Group ID missing");errorObj.type="datalayer";pmc.logError(errorObj);}
if(pmc.checkNestedValue(eventData,"item","alt image swipe")){sendObject.tealium_event="alt_image_swipe";pmc.fireLinkHit(sendObject);return;}
if(pmc.suppressDoubleFire("altImageClickFired")){return true;}
if(position){sendObject={pmc_prop14:pmc.removeHTML(eventData.category+":"+position).toLowerCase(),link_text:"element interaction",tealium_event:"pip_alt_image_click",pmc_eVar31:position.toLowerCase(),pmc_event39:"event39",};if(position.includes("shop-by-room")){sendObject.pmc_event273="event273";}
window.setTimeout(function(){pmc.processPIPInteraction(sendObject);},400);}}catch(e){e.data="eventData.item == "+eventData.item;pmc.logError(e);}};pmc.handleGroupGifting=function(eventData){var eventItem=pmc.getNestedLowerCaseValue(eventData,"item");var sendObj={link_text:"group gifting:"+eventData.item,tealium_event:"group_gifting_select",};if(eventItem==="contribute opt-in"){sendObj.pmc_event142="event142";}else if(eventItem==="contribute opt-out"){sendObj.pmc_event143="event143";}else{return;}
pmc.fireLinkHit(sendObj);};pmc.getSourceFromStack=function(err){if(typeof err.stack==="string"&&err.stack.indexOf("at ")>-1){return err.stack.split('at ')[1].match(/(\S+)/)[1];}
return"(unknown)";};pmc.setErrorData=function(err,output){var errorText;try{err.source=err.source||pmc.getSourceFromStack(err);err.type=err.type||"general";err.type=err.type.toLowerCase();err.data=err.data||"";errorText=err.type+" error in "+err.source+":"+err.message;output.link_text=output.link_text||errorText;if(output.pmc_eVar100){output.pmc_eVar100+="||"+errorText+" : "+err.data;}else{output.pmc_eVar100=errorText+" : "+err.data;}
if(err.type==="general"){output.pmc_event100="event100";}else if(err.type==="datalayer"){output.pmc_event240="event240";}else if(err.type==="service"){output.pmc_event440="event440";}
return output;}catch(e){try{utag.link({tealium_event:"err_event_fallback",pmc_event100:"event100",pmc_eVar100:"Error in setErrorData: "+e.message,});}catch(e){}}};pmc.fireErrorHit=function(err){try{var hitData={tealium_event:"error_event",pmc_pageName:utag_data.pmc_pageName,};hitData=pmc.setErrorData(err,hitData);if(hitData){utag.link(hitData);err.reported=true;}}catch(e){try{utag.link({tealium_event:"err_event_fallback",pmc_event100:"event100",pmc_eVar100:"Error in fireErrorHit: "+e.message,});}catch(e){}}};pmc.isErrorInLog=function(err){var errorLog=pmc.getNestedValue(window,"WSI.tracking.errors");if(errorLog.length){for(var i=0,len=errorLog.length;i<len;i++){if(errorLog[i].source===err.source&&errorLog[i].message===err.message){return true;}}}
return false;};pmc.logError=function(err){try{var errorLog=window.WSI.tracking.errors;if(typeof err==="string"){err=new Error(err);}else if(err.reported||pmc.isErrorInLog(err)){return;}
errorLog.push(err);if(pmc.isErrorPageviewProcessingComplete){window.setTimeout(function(){if(!err.reported){pmc.fireErrorHit(err);err.reported=true;}},600);}}catch(e){try{window.setTimeout(function(){utag.link({tealium_event:"err_event_fallback",pmc_event100:"event100",pmc_eVar100:"Error in logError: "+e.message,});},500);}catch(e){}}};pmc.addErrorLogToHit=function(output){var errorLog=window.WSI.tracking.errors;for(var i=0,len=errorLog.length;i<len;i++){if(!errorLog[i].reported){pmc.setErrorData(errorLog[i],output);errorLog[i].reported=true;}}}
pmc.fireLinkHit=function(hitData,addDelay){try{var delayMilliseconds=addDelay?750:0;hitData.pmc_pageName=hitData.pmc_pageName||pmc.originalPageName||utag_data.pmc_pageName;hitData.link_text=hitData.link_text||"D=c63";hitData.pmc_eVar18=hitData.pmc_prop18=utag_data.pmc_prop18;hitData.pmc_prop8=hitData.pmc_prop8||utag_data.pmc_prop8;hitData.pmc_eVar10=hitData.pmc_pageName||utag_data.pmc_pageName;hitData.tealium_event=hitData.tealium_event||"generic_event";hitData.brand=utag_data.brand;hitData.subBrand=pmc.subBrand;hitData.pmc_prop36=utag_data.pmc_prop36;hitData.pmc_eVar110=utag_data.pmc_eVar110;hitData.market=utag_data.market;hitData.currency_code=pmc.environment.currency;hitData.country_code=pmc.environment.countryCode;hitData.brand_with_market=utag_data.brand_with_market;hitData.sc_visitor_id=utag_data.sc_visitor_id;pmc.addErrorLogToHit(hitData);pmc.isErrorPageviewProcessingComplete=true;var page=pmc.managePreviousPageData(hitData.pmc_pageName,pmc.originalPageType);hitData.previous_page_name=page.page_name||utag_data.previous_page_name;hitData.previous_page_type=page.page_type||utag_data.previous_page_type;if(delayMilliseconds){window.setTimeout(function(){utag.link(hitData);},delayMilliseconds);}else{utag.link(hitData);}}catch(e){e.data="tealium_event="+hitData.tealium_event;pmc.logError(e);}};pmc.processPIPInteraction=function(hitData,delayLinkCall){delayLinkCall=delayLinkCall||false;try{hitData.pmc_event47=hitData.pmc_event47||"event47";hitData.pmc_prop14=hitData.pmc_prop14||"Not Set";hitData.pmc_eVar21="D=c14";hitData.link_text=hitData.link_text||"PIP Interaction: "+hitData.pmc_prop14;hitData.pmc_products=hitData.pmc_products||pmc.items.getSimpleProductString(utag_data.PIPGroupID);hitData.tealium_event=hitData.tealium_event||"generic_pip_interaction";hitData.associatedTags=hitData.associatedTags||"adobeAnalytics";pmc.fireLinkHit(hitData,delayLinkCall);}catch(e){e.data="tealium_event="+hitData.tealium_event;pmc.logError(e);}};pmc.fireViewHit=function(hitData){hitData.hit_type="virtual_page_view";hitData.brand=utag_data.brand;hitData.subBrand=pmc.subBrand;hitData.market=utag_data.market;hitData.currency_code=pmc.environment.currency;hitData.country_code=pmc.environment.countryCode;hitData.brand_with_market=utag_data.brand_with_market;hitData.sc_visitor_id=utag_data.sc_visitor_id;hitData.pmc_eVar41=hitData.pmc_eVar41||utag_data.pmc_eVar41;hitData.pmc_eVar42=hitData.pmc_eVar42||utag_data.pmc_eVar42;pmc.addErrorLogToHit(hitData);utag.view(hitData);};pmc.addPageHierarchyToEvent=function(output){output.pmc_prop1=utag_data.pmc_prop1;output.pmc_prop2=utag_data.pmc_prop2;output.pmc_prop3=utag_data.pmc_prop3;output.pmc_prop4=utag_data.pmc_prop4;output.pmc_prop5=utag_data.pmc_prop5;};pmc.handleFabricView=function(eventData){var eventItem=pmc.getNestedLowerCaseValue(eventData,"item");if(eventItem==="shipping view"){pmc.processPIPInteraction({tealium_event:"pip_fabric_toggle_shipping",pmc_prop14:"Fabric Toggle",});return;}
if(eventItem==="fabric view"){pmc.processPIPInteraction({tealium_event:"pip_fabric_toggle_fabric",pmc_prop14:"Fabric Toggle",});return;}};pmc.handleSwatchSelection=function(eventData){var eventItem=pmc.getNestedLowerCaseValue(eventData,"item");if(eventItem==="recently viewed"){pmc.processPIPInteraction({tealium_event:"pip_swatch_recent",pmc_prop14:"Recently Viewed Swatch",});return;}};pmc.handleSwatchPreview=function(eventData){try{var interactionType=pmc.getNestedValue(eventData,"item","");var productId=pmc.getNestedValue(eventData,"productId","");var productList=pmc.items.createItemList();if(interactionType&&productId){productList.addItem(productId);pmc.fireLinkHit({tealium_event:"swatch_preview_"+interactionType,pmc_products:productList.adobeString(),});}}catch(e){pmc.logError(e);}};pmc.handleFabricFilterInteraction=function(eventData){try{if(pmc.checkNestedValue(eventData,"item","Open")){pmc.processPIPInteraction({tealium_event:"fabric_filter_interaction",pmc_prop14:"Fabric Filter Open",});}}catch(e){pmc.logError(e);}};pmc.handleShipToStore=function(eventData){try{var storeId=pmc.getNestedValue(eventData,"storeId");var storeBrand=pmc.getNestedStringValue(eventData,"storeBrand").toLowerCase();var sendObj={tealium_event:"bosts_select_store",};var newItem=pmc.items.createItem(utag_data.PIPGroupID,eventData.sku);if(storeId){newItem.setEvar("eVar95",storeId);sendObj.storeSelected=storeId;newItem.setEvar("eVar103",storeBrand);newItem.setEvar("eVar97","bosts");sendObj=newItem.setEvent("event302",1,sendObj);sendObj.pmc_products=newItem.adobeString();pmc.fireLinkHit(sendObj);}}catch(e){pmc.logError(e);}};pmc.handleFavoritesClick=function(eventData){var itemList=pmc.items.createItemList();var actionObject={group_id:eventData.item,tealium_event:"favorites_pip_click",};if(pmc.isArray(eventData.sku)&&eventData.sku.length>0){for(var i=0,l=eventData.sku.length;i<l;i++){itemList.addItem(eventData.item,eventData.sku[i]);}}else{itemList.addItem(eventData.item);}
actionObject.pmc_products=itemList.adobeString();pmc.fireLinkHit(actionObject);};pmc.handleFavoritesRemove=function(eventData){var itemList=pmc.items.createItemList();var actionObject={group_id:eventData.item,tealium_event:"favorites_remove",};if(pmc.isArray(eventData.sku)&&eventData.sku.length>0){for(var i=0,l=eventData.sku.length;i<l;i++){itemList.addItem(eventData.item,eventData.sku[i]);}}else{itemList.addItem(eventData.item);}
actionObject.pmc_products=itemList.adobeString();pmc.fireLinkHit(actionObject);};pmc.handleFavoritesAdd=function(eventData){var itemList=pmc.items.createItemList();var actionObject={group_id:eventData.item,tealium_event:"favorites_add",encoded_path_name:utag_data.encoded_path_name,};if(pmc.isArray(eventData.sku)&&eventData.sku.length>0){actionObject.pmc_event307="event307";for(var i=0,l=eventData.sku.length;i<l;i++){itemList.addItem(eventData.item,eventData.sku[i]);}}else{itemList.addItem(eventData.item);}
actionObject.pmc_products=itemList.adobeString();if(pmc.checkNestedValue(eventData,"newFavoritesList")||pmc.checkNestedValue(eventData,"newFavoriteList")){actionObject.pmc_event87="event87";}
pmc.fireLinkHit(actionObject);};pmc.handleRecentlyViewedCarousel=function(eventData){var type=eventData.item;if(type==="open"){pmc.fireLinkHit({tealium_event:"sitewide_carousel_impression",});}else if(type==="scroll"){pmc.fireLinkHit({tealium_event:"sitewide_carousel_scroll",});}else if(type==="see-more"){var item=pmc.items.createItem(eventData.groupId);item.setEvent("event319");pmc.fireLinkHit({tealium_event:"sitewide_carousel_click",pmc_products:item.adobeString(),});}};pmc.handlePznCarousel=function(eventData){try{var sendObject={};var eventType=eventData.item||"";var tealiumEvent="";var itemList=pmc.items.createItemList();var tealiumEventMap=[{key:"display",value:"pzn_carousel_impression",},{key:"scroll",value:"pzn_carousel_scroll",},{key:"see more",value:"pzn_carousel_see_more",},];tealiumEvent=pmc.resolveMapLookup(tealiumEventMap,eventType);if(tealiumEvent){sendObject.tealium_event=tealiumEvent;if(eventData.groupId){var item=itemList.addItem(eventData.groupId);if(tealiumEvent==="pzn_carousel_see_more"){item.setEvent("event337");sendObject.pmc_products=itemList.adobeString();}}
pmc.fireLinkHit(sendObject);}}catch(e){pmc.logError(e);}};pmc.handleSmartBundleCartClose=function(eventData){var cartItem=eventData.item;if(pmc.checkNestedValue(cartItem,"productId")&&pmc.checkNestedValue(cartItem,"sku")){var primaryProduct=pmc.items.createItem(cartItem.productId,cartItem.sku);primaryProduct.setEvent("event209");pmc.fireLinkHit({tealium_event:"smart_bundle_cart_close",pmc_products:primaryProduct.adobeString(),});}};pmc.handleAbTestLink=function(eventData){var testName=pmc.getNestedValue(eventData,"item");pmc.fireLinkHit({tealium_event:"ab_test_link",link_text:"ABTestInteraction:"+testName,},true);};pmc.handleStoreChangeBopis=function(eventData,output){var errObj;var newItem=pmc.items.createItem(eventData.groupId||utag_data.PIPGroupID,eventData.sku);var storeId;output.tealium_event="pickup_delivery_store_change";if(newItem){newItem.setEvar("eVar103","non-BOSTS");storeId=eventData.storeId||pmc.getNestedValue(eventData,"attributes.storeId");newItem.setEvar("eVar95",storeId);output.storeSelected=storeId;newItem.setEvar("eVar97","bopis");output=newItem.setEvent("event113",1,output);output.pmc_products=newItem.adobeString();}else{errObj=new Error("No product info for BOPIS store change");errObj.type="datalayer";pmc.logError(errObj);}
return output;};pmc.handleStoreChangeBosts=function(eventData,output){var errObj;var newItem=pmc.items.createItem(eventData.groupId||utag_data.PIPGroupID,eventData.sku);var storeBrand=pmc.getNestedStringValue(eventData,"storeBrand").toLowerCase();output.tealium_event="bosts_select_store";if(newItem){newItem.setEvar("eVar95",eventData.storeId);output.storeSelected=eventData.storeId;newItem.setEvar("eVar103",storeBrand);newItem.setEvar("eVar97","bosts");output=newItem.setEvent("event302",1,output);output.pmc_products=newItem.adobeString();}else{errObj=new Error("No product info for BOSTS store change");errObj.type="datalayer";pmc.logError(errObj);}
return output;};pmc.handleBopisToggle=function(eventData,output){var toggle=eventData.type;if(typeof(toggle)==="undefined"){output.tealium_event="pickup_delivery_bopis";}else if(toggle==="toggle"){output.tealium_event="pickup_delivery_toggle";if(eventData.enabled){output.pmc_eVar96="BOPIS Filter Enabled";}else{output.pmc_eVar96="BOPIS Filter Disabled";}}
return output;};pmc.handleChangeDelivery=function(eventData,output){var newItem=pmc.items.createItem(eventData.groupId,eventData.sku);var storeBrand=pmc.getNestedStringValue(eventData,"storeBrand").toLowerCase();output.tealium_event="pickup_delivery_change_method";if(newItem){if(eventData.item==="select bopis"){newItem.setEvar("eVar95",eventData.storeId);newItem.setEvar("eVar97","bopis");newItem.setEvar("eVar103","non-BOSTS");output=newItem.setEvent("event375",1,output);}else if(eventData.item==="select bosts"){newItem.setEvar("eVar95",eventData.storeId);newItem.setEvar("eVar97","bosts");newItem.setEvar("eVar103",storeBrand);output=newItem.setEvent("event376",1,output);}else if(eventData.item==="select ship to home"){newItem.setEvar("eVar95","non-store");newItem.setEvar("eVar97","ship");newItem.setEvar("eVar103","non-BOSTS");output=newItem.setEvent("event374",1,output);}
output.pmc_products=newItem.adobeString();}
return output;};pmc.handlePickupAndDelivery=function(eventData){try{var sendObj={};var selectionType=pmc.getNestedStringValue(eventData,"item").toLowerCase();if(!selectionType){return;}
if(selectionType==="ships to home"||selectionType==="ship to home"){sendObj.tealium_event="pickup_delivery_ships_to_home";}else if(selectionType==="store change"){sendObj=pmc.handleStoreChangeBopis(eventData,sendObj);}else if(selectionType==="bosts store change"){sendObj=pmc.handleStoreChangeBosts(eventData,sendObj);}else if(selectionType==="select bopis"||selectionType==="select bosts"||selectionType==="select ship to home"){sendObj=pmc.handleChangeDelivery(eventData,sendObj);}else if(selectionType==="zip change"){sendObj.tealium_event="pickup_delivery_zip_change";}else if(selectionType==="bopis"){sendObj=pmc.handleBopisToggle(eventData,sendObj);}
if(sendObj.tealium_event){pmc.fireLinkHit(sendObj);}}catch(e){pmc.logError(e);}};pmc.handleMyAccount=function(eventData){var sendObj={tealium_event:"generic_account_interaction",};if(eventData.item){sendObj.tealium_event="account_"+pmc.convertToSnakeCase(eventData.item);}
pmc.fireLinkHit(sendObj);};pmc.creditCardInteraction=function(eventData){var attr=eventData.type;if(!attr){return;}
if(pmc.checkNestedValue(eventData,"location")){attr=eventData.location+"|"+attr;}
pmc.fireLinkHit({tealium_event:"credit_card_interaction",pmc_event85:"event85",});};pmc.promoCodeInteraction=function(eventData){var sendObj={pmc_eVar6:eventData.promoCode,pmc_eVar62:eventData.promoType,tealium_event:"promo_code_event",};var event=eventData.event;if(event==="success"){sendObj.tealium_event="promo_code_apply";sendObj.pmc_event177="event177";}else if(event==="remove"){sendObj.tealium_event="promo_code_remove";sendObj.pmc_event179="event179";sendObj.pmc_eVar61="promo code removal";sendObj.pmc_event79="event79";}else if(event==="error"){if(eventData.errorCode){sendObj.pmc_prop23="promo code:"+eventData.errorCode;}else{sendObj.pmc_prop23="promo code error";}
sendObj.pmc_prop24=sendObj.pmc_prop23;sendObj.pmc_event178="event178";sendObj.tealium_event="promo_code_error";}
pmc.fireLinkHit(sendObj);};pmc.searchSubmission=function(eventData){if(pmc.suppressDoubleFire("searchSubmissionFired")){return true;}
if(!eventData.searchTerm){return;}
pmc.fireLinkHit({tealium_event:"search_submission",pmc_searchTerm:eventData.searchTerm,searchTermEntered:eventData.searchEntry,associatedTags:"bloomreach",},false);return;};pmc.filterOverlayOpen=function(eventData){pmc.fireLinkHit({tealium_event:"facet_overlay_open",pmc_event210:"event210",});};pmc.reviewClick=function(eventData){pmc.fireLinkHit({tealium_event:"review_link_click",});};pmc.handleReviews=function(eventData){if(eventData.item==="link clicked"){pmc.fireLinkHit({tealium_event:"review_link_click",});}};pmc.pickThisStore=function(eventData){var storeId="";var newItem={};var prodId=pmc.getNormalProdId(digitalData.product);try{storeId=eventData.storeId||eventData.pickupLocationCode;newItem=pmc.items.createItem(prodId);newItem.setEvent("event113");newItem.setEvar("eVar103","non-BOSTS");newItem.setEvar("eVar95",storeId);newItem.setEvar("eVar97","bopis");}catch(e){return;}
pmc.fireLinkHit({tealium_event:"pick_this_store",pmc_event113:"event113",storeSelected:storeId,pmc_products:newItem.adobeString(),});};pmc.toggleButton=function(eventData){if(eventData.item){pmc.fireLinkHit({tealium_event:"toggle_event",link_text:"toggle: "+eventData.item.toLowerCase(),});}};pmc.changeShippingMethod=function(eventData){var shipMethod=eventData.item;var productString=pmc.legacyCheckoutProductString();if(!shipMethod){return;}
pmc.fireLinkHit({tealium_event:"change_shipping_method",pmc_eVar8:shipMethod,pmc_event176:"event176",pmc_products:productString,});};pmc.handlePorchInstall=function(eventData){var eventCategory=pmc.getNestedLowerCaseValue(eventData,"category");var porchItem=pmc.items.createItem(eventData.item);var sendObj={pmc_prop14:eventCategory,};if(!porchItem){return;}
if(eventCategory==="add porch installation"){sendObj.tealium_event="porch_add_install";sendObj=porchItem.setEvent("event98",1,sendObj);}else if(eventCategory==="remove porch installation"){sendObj.tealium_event="porch_remove_install";sendObj=porchItem.setEvent("event94",1,sendObj);}else{return;}
if(pmc.checkNestedValue(digitalData,"page.pageCategory.primaryCategory","products")){sendObj.tealium_event="pip_"+sendObj.tealium_event;sendObj.pmc_products=porchItem.adobeString();pmc.processPIPInteraction(sendObj);}else{var SKU=pmc.getSKUInOrdersFromID(eventData.item,digitalData.x_cart.orders);if(SKU.length>0){porchItem.setSku(SKU);sendObj.pmc_products=porchItem.adobeString();pmc.fireLinkHit(sendObj);}}};pmc.changeZip=function(eventData){var action=pmc.getNestedValue(eventData,"userAction")||pmc.getNestedValue(eventData,"item")||"";action=action.toLowerCase();var category=pmc.getNestedValue(eventData,"category");var actionObject={tealium_event:"zip_event",pmc_zip:eventData.zipCode,};if(category==="cart"){return;}
if(pmc.checkNestedValue(eventData,"sku")){var item=pmc.items.createItem(utag_data.PIPGroupID,eventData.sku);actionObject.pmc_products=item.adobeString();}
actionObject.link_text=category+":"+action;if(action==="zipentryinit"||action==="overlay initiation"||action==="zipentryedit"){actionObject.tealium_event="zip_event_start";}else if(action==="zipinitsubmit"||action==="zipentryinitsubmit"||action==="zip entry submit"||action==="zipentryeditsubmit"){actionObject.tealium_event="zip_event_submit";}
if(pmc.checkNestedValue(digitalData,"page.pageCategory.primaryCategory","products")){actionObject.pmc_prop14="Delivery ZIP change";pmc.processPIPInteraction(actionObject);}else{pmc.fireLinkHit(actionObject);}};pmc.notificationsPanelOpen=function(eventData){var eventItem=pmc.getNestedLowerCaseValue(eventData,"item");if(eventItem==="notifications panel open"){pmc.fireLinkHit({tealium_event:"registry_banner_open",});return;}
if(eventItem==="sort by"){pmc.sortBy("registry",eventData.option);return;}};pmc.registryCompletionOptIn=function(eventData){if(eventData.registryId){pmc.fireLinkHit({tealium_event:"registry_discount_opt_in",registry_id:eventData.registryId,});return;}};pmc.favoritesClickThru=function(eventData){pmc.fireLinkHit({tealium_event:"favorites_gallery_click",pmc_event145:"event145",});};pmc.odisImpression=function(eventData){pmc.fireLinkHit({tealium_event:"on_display_impression",pmc_event125:"event125",link_text:"ODIS Component displayed",pmc_products:pmc.items.getSimpleProductString(pmc.getNormalProdId(digitalData.product)),});};pmc.handleOdis=function(eventData){var prodId;var sendObj={tealium_event:"on_display",};if(eventData.item==="ODIS component impression"){sendObj={tealium_event:"on_display_impression",pmc_prop14:"See This In Store Impression",}}else if(eventData.item==="ODIS component display opened"){sendObj={tealium_event:"on_display_open",pmc_prop14:"See This In Store Open",}}else if(eventData.item==="change location"||eventData.userAction==="changeLocationFilter"){sendObj={tealium_event:"on_display_change_location",pmc_prop14:"See This In Store Change Location",}}else if(eventData.item==="store details"||eventData.userAction==="storeExpandLink"){sendObj={tealium_event:"on_display_store_info",pmc_prop14:"See This In Store Show Store Details",pmc_prop35:eventData.storeID,}}
if(eventData.numberOfStoresWithDisplays===0){sendObj.pmc_event127="event127";}
prodId=pmc.getNormalProdId(digitalData.product);if(prodId){sendObj.pmc_products=pmc.items.getSimpleProductString(prodId);}
pmc.processPIPInteraction(sendObj);};pmc.checkoutInteraction=function(eventData){var item=eventData.item.toLowerCase();if(item==="gift cards"||item==="promo code"){pmc.fireLinkHit({tealium_event:"checkout_interaction",pmc_eVar61:eventData.item,});}};pmc.affirmOverlayOpen=function(eventData){var eventItem=pmc.getNestedLowerCaseValue(eventData,"item");if(eventItem==="overlay initiation"){pmc.fireLinkHit({tealium_event:"affirm_overlay_open",pmc_prop1:utag_data.pmc_prop1,});return;}};pmc.heroClick=function(eventData){pmc.processPIPInteraction({tealium_event:"pip_hero_interaction",pmc_prop14:"hero:"+(pmc.getNestedStringValue(eventData,"item")).toLowerCase(),});};pmc.handleTabbedContent=function(eventData){pmc.processPIPInteraction({tealium_event:"pip_tabbed_content_interaction",pmc_prop14:"tabbed content:"+(pmc.getNestedStringValue(eventData,"item")).toLowerCase(),});};pmc.clickAssemblyInstruction=function(){pmc.processPIPInteraction({tealium_event:"pip_view_assembly_instructions",pmc_prop14:"view assembly instructions",});};pmc.facebookPromo=function(eventData){var sendObject={tealium_event:"facebook_promo_demo",link_text:eventData.item+":"+eventData.category,};pmc.fireLinkHit(sendObject);};pmc.startDesignChat=function(eventData){var sendObject={tealium_event:"design_chat_start",link_text:eventData.item,};if(pmc.checkDataDefinedAndNonEmpty(eventData,"category")){sendObject.link_text+=":"+eventData.category;}
pmc.fireLinkHit(sendObject);};pmc.hideDesignChat=function(eventData){var sendObject={tealium_event:"design_chat_hide",link_text:eventData.item,};if(pmc.checkDataDefinedAndNonEmpty(eventData,"category")){sendObject.link_text+=":"+eventData.category;}
pmc.fireLinkHit(sendObject);};pmc.sortBy=function(category,sortValue){if(!pmc.suppressDoubleFire("sort_by")){var pageType=pmc.getNestedStringValue(utag_data,"page_type").toLowerCase();var eventType="";if(category==="registry event"){pageType="RegList";eventType="registry";}else if(pageType==="search"){eventType=pageType="Search";}else if(pageType==="category"){eventType=pageType="Shop";}
if(eventType){pmc.fireLinkHit({tealium_event:eventType.toLowerCase()+"_sort_by",pmc_eVar81:pageType+":"+sortValue,});}}};pmc.handleRegistryEvents=function(eventData){var item=pmc.getNestedStringValue(eventData,"item").toLowerCase();if(item==="sort by"){pmc.fireLinkHit({tealium_event:"registry_sort_by",pmc_eVar81:"RegList:"+eventData.option,});return;}
if(item==="completion opt-in"){pmc.fireLinkHit({tealium_event:"registry_discount_opt_in",registry_id:pmc.getNestedValue(digitalData,"page.registry.attributes.registryId"),});return;}
if(item==="notification open"){pmc.fireLinkHit({tealium_event:"registry_banner_open",});return;}
if(item==="view shipping details"){pmc.fireLinkHit({tealium_event:"registry_shipping_details",pmc_eVar92:"gift tracker:view shipping details",pmc_products:pmc.items.getSimpleProductString(eventData.groupId,eventData.sku),});return;}
if(item==="registry app click"){pmc.fireLinkHit({tealium_event:"registry_app_click",pmc_eVar92:"registry:registry app link click",});return;}
if(item==="search results"){pmc.fireLinkHit({tealium_event:"registry_search",});}};pmc.trackingOptOut=function(eventData){var eventItem=pmc.getNestedLowerCaseValue(eventData,"item");if(eventItem==="personal information opt-out"){pmc.fireLinkHit({tealium_event:"personal_data_opt_out",link_text:"navigationbarlink: personal information opt-out",pmc_pageName:utag_data.pmc_pageName,pmc_event182:"event182",});return;}};pmc.truyoClickThru=function(eventData){var eventItem=pmc.getNestedLowerCaseValue(eventData,"item");if(eventItem==="external link: truyo"){pmc.fireLinkHit({tealium_event:"truyo_link_click",link_text:"bodylink: external link: truyo",pmc_pageName:utag_data['pmc_pageName'],pmc_event183:"event183",});return;}};pmc.orderSwatch=function(eventData){var eventObj={pmc_pageName:utag_data["pmc_pageName"],pmc_products:pmc.items.getSimpleProductString(utag_data.product_id[0]),};var eventItem=pmc.lowerCaseString(eventData.item);if(eventItem==="open"){eventObj.tealium_event="swatch_order_open";}
if(eventItem==="submit"){eventObj.tealium_event="swatch_order_submit";eventObj.swatchesOrdered=eventData.swatchesOrdered;}
if(pmc.checkNestedValue(digitalData,"page.pageCategory.primaryCategory","products")){eventObj.pmc_prop14="Swatch Ordering Open";pmc.processPIPInteraction(eventObj);}else{pmc.fireLinkHit(eventObj);}};pmc.handlePersonalizedContent=function(eventData){var campaignStatus=[],programStatus="";if(typeof eventData.campaignStatus!="undefined"){if(eventData.campaignStatus.length>0){campaignStatus.push(eventData.campaignStatus);}else{campaignStatus.push("");}}else{campaignStatus.push("");}
if(typeof eventData.campaign!="undefined"){if(eventData.campaign.length>0){campaignStatus.push(eventData.campaign);}else{campaignStatus.push("");}}else{campaignStatus.push("");}
var placement="";if(typeof eventData.placement!="undefined"){placement=eventData.placement;}
if(typeof eventData.programStatus!="undefined"){programStatus=eventData.programStatus;if(programStatus.toUpperCase()==="INELIGIBLE"){return;}}
if(typeof eventData.productId!="undefined"&&eventData.productId!=""){if(placement.toUpperCase().indexOf("EMAIL")>=0||(campaignStatus.length>1&&campaignStatus[1].toUpperCase().indexOf("EMAIL")>=0)){return;}
pmc.fireLinkHit({tealium_event:"content_personalization_click",pmc_prop72:eventData.campaign+"|"+placement,link_text:"content personalization - element interaction",pmc_eVar18:utag_data["pmc_eVar18"],pmc_prop18:utag_data["pmc_prop18"],pmc_eVar71:eventData.programStatus,pmc_event72:"event72",pmc_eVar72:campaignStatus.join("|"),pmc_eVar73:eventData.placement,pmc_prop73:eventData.productId,pmc_eVar74:eventData.productId,pmc_eVar75:eventData.treatment,});}else{if(eventData.item==="EMAIL SIGNUP : EMAIL FORM"){eventData.includesSms=(eventData.emailNotificationType==="sms_text");pmc.handleEmailOverlay(eventData);return;}else{if(placement.toUpperCase().indexOf("EMAIL")>=0||(campaignStatus.length>1&&campaignStatus[1].toUpperCase().indexOf("EMAIL")>=0)){return;}
pmc.fireLinkHit({tealium_event:"content_personalization_click",pmc_prop72:eventData.campaign+"|"+placement,link_text:"content personalization - element interaction",pmc_eVar18:utag_data["pmc_eVar18"],pmc_prop18:utag_data["pmc_prop18"],pmc_eVar71:eventData.programStatus,pmc_event72:"event72",pmc_eVar72:campaignStatus.join("|"),pmc_eVar73:eventData.placement,pmc_eVar75:eventData.treatment,});}}};pmc.handleReturnInitiation=function(eventData){if(pmc.checkNestedValue(eventData,"item","initiated")){pmc.fireLinkHit({tealium_event:"return_initiated",});}};pmc.handleStoreLocator=function(eventData){if(pmc.checkNestedValue(eventData,"item","store locator search results")){pmc.fireLinkHit({tealium_event:"store_locator_search",});}};pmc.creditCardApplicationClick=function(eventData){var sendObject={tealium_event:pmc.convertToSnakeCase(eventData.item),link_text:eventData.item,pmc_eVar14:eventData.clickLocation,};pmc.fireLinkHit(sendObject);};pmc.handleUserAuthentication=function(eventData){var item=eventData.item;var sendObject={tealium_event:pmc.convertToSnakeCase(item),link_text:item,pmc_eVar90:eventData.designTradeMemberId,};if(item==="initiate"){sendObject.tealium_event="initiate_smart_login";}else{sendObject=pmc.processAuthentication(eventData.user,sendObject);}
if(eventData.designTradeMergeComplete){sendObject.pmc_event434="event434";}
pmc.fireLinkHit(sendObject);};pmc.handleCustomerService=function(eventData){try{var eventItem=pmc.lowerCaseString(eventData.item);if(eventItem==="initiate payment update"){pmc.fireLinkHit({tealium_event:"initiate_payment_update",});}}catch(e){pmc.logError(e);}};pmc.handleCrossBrandSearch=function(eventData){try{var brand=pmc.getNestedValue(eventData,"brand","")||pmc.getNestedValue(eventData,"brands","");var tealiumEvent=pmc.convertToSnakeCase(eventData.category+"_"+eventData.item);var sendObj={tealium_event:tealiumEvent,pmc_eVar89:brand,pmc_prop9:pmc.getQueryStringValue("words"),};pmc.fireLinkHit(sendObj);}catch(e){pmc.logError(e);}};pmc.genericLinkTracking=function(eventData){var item=pmc.getNestedStringValue(eventData,"item").toLowerCase();if(item){pmc.fireLinkHit({tealium_event:"generic_tracking",link_text:"Generic Link:"+item,pmc_eVar92:item,});}};pmc.handleMyDesignProjects=function(eventData){try{var item=pmc.getNestedStringValue(eventData,"item").toLowerCase();if(item){pmc.fireLinkHit({pmc_eVar92:"my design projects:"+item,tealium_event:"my_design_projects_"+pmc.convertToSnakeCase(eventData.item),});}}catch(e){pmc.logError(e);}};pmc.handleSeeMoreLikeThis=function(eventData){var sendObj={};var item;if(eventData.item==="carousel open"){sendObj={tealium_event:"see_more_like_this_open",pmc_prop1:utag_data.pmc_prop1,}
item=pmc.items.createItem(eventData.groupId);sendObj=item.setEvent("event372",1,sendObj);sendObj.pmc_products=item.adobeString();pmc.fireLinkHit(sendObj);return;}};pmc.handleDelayedEvent=function(eventData){var category=pmc.getNestedStringValue(eventData,"category").toLowerCase();if(pmc.checkNestedValue(eventData,"item","sortBy")){pmc.sortBy(category,eventData.option||eventData.item);return;}
if(category==="search event"){pmc.search.handleResults(eventData);return;}
if(category==="minipip"){pmc.handleMiniPip(eventData);return;}
if(category==="quick look"){pmc.quickLook(window.digitalData,eventData);return;}
if(category==="quick buy"){pmc.quickBuy(window.digitalData,eventData);return;}
if(category==="checkout error"){if(!pmc.suppressDoubleFire("handleCheckoutPromoErrorFired")){pmc.handleCheckoutError(eventData);}
return;}
if(category==="avs error"){pmc.handleAvsError(eventData);return;}
if(eventData.name==="Reset"&&category){pmc.handleResetClick(eventData);return;}
if(category==="shop-by-room"){pmc.handleShopByRoom(eventData);return;}
if(pmc.checkNestedValue(eventData,"type","video")&&eventData.title){pmc.videoImpression(eventData);return;}
if(category==="see more like this"){pmc.handleSeeMoreLikeThis(eventData);return;}
if(pmc.checkNestedValue(eventData,"data")){var dataCategory=pmc.getNestedLowerCaseValue(eventData,"data.category");if(dataCategory==="pip error"&&pmc.checkNestedValue(eventData,"name")&&(pmc.checkNestedValue(eventData,"data.prodId")||pmc.getNormalProdId(eventData.product))&&pmc.checkNestedValue(eventData.data,"type")){pmc.handlePipError(eventData);return;}
if(eventData.name==="shipmentTracking"&&pmc.checkNestedValue(eventData,"data")){pmc.trackWismo(eventData.data);return;}
if(eventData.name==="alerts"&&pmc.checkNestedValue(eventData,"data")){pmc.trackWismoAlert(eventData.data);return;}
if(category==="applepay"&&eventData.item==="Impression"){pmc.trackApplepayImpressions(eventData.data);return;}
if(pmc.isNestedDataDefinedAndNonEmpty(eventData,"data._recommendedProducts")){pmc.handleProductRecs(eventData);return;}
if(pmc.isNestedDataDefinedAndNonEmpty(eventData,"data.isOnDisplay.isAvailable")||pmc.isNestedDataDefinedAndNonEmpty(eventData,"isOnDisplay.isAvailable")){pmc.odisImpression(eventData);return;}
}};pmc.handleRegistryEdit=function(eventData){var sendObj;var item=pmc.getNestedStringValue(eventData,"item").toLowerCase();if(item==="open"){sendObj={tealium_event:"registry_edit_open",};pmc.fireLinkHit(sendObj);return;}
if(item==="complete"){sendObj={tealium_event:"registry_edit_complete",};sendObj=pmc.setRegistryVariables(eventData.registry,sendObj);pmc.fireLinkHit(sendObj);}};pmc.handleKeyRewards=function(eventData){var item=pmc.getNestedStringValue(eventData,"item").toLowerCase();var sendObj={};if(item==="notification impression"){sendObj.tealium_event="key_rewards_impression";pmc.setKeyRewardsNotifications(eventData.keyRewardsNotification,sendObj);pmc.fireLinkHit(sendObj);return;}};pmc.handleCartShare=function(eventData){var item=pmc.getNestedStringValue(eventData,"item").toLowerCase();var sendObj={};if(item==="initiate"){sendObj.tealium_event="cart_share_initiation";pmc.fireLinkHit(sendObj);return;}
if(item==="complete"){sendObj.tealium_event="cart_share_completion";sendObj.pmc_eVar92="share cart submit:"+eventData.method;pmc.fireLinkHit(sendObj);return;}};pmc.handleApiErrors=function(eventData){var sendObj={tealium_event:"api_error",pmc_event440:"event440",};var endpoint=pmc.getNestedStringValue(eventData,"item").toLowerCase();var message=pmc.getNestedStringValue(eventData,"message").toLowerCase();sendObj.pmc_eVar100=endpoint+":"+message;sendObj.pmc_products=pmc.items.getProductString(eventData.product);pmc.fireLinkHit(sendObj);};pmc.handleInlineMonogram=function(eventData){var item=pmc.getNestedLowerCaseValue(eventData,"item");var sendObj={};if(item==="initiated"){sendObj.tealium_event="inline_monogram_initiation";sendObj.pmc_products=pmc.items.getProductString(eventData.product);pmc.fireLinkHit(sendObj);return;}};pmc.handleInstockToggle=function(eventData){var item=pmc.getNestedLowerCaseValue(eventData,"item");var toggleStatus=pmc.getNestedLowerCaseValue(eventData,"newState");var product=pmc.items.createItem(utag_data.PIPGroupID);var sendObj={tealium_event:"pip_instock_toggle_"+item,pmc_eVar115:toggleStatus,associatedTags:"adobeAnalytics",};if(toggleStatus==="filter on"&&pmc.checkNestedValue(digitalData,"page.attributes.seeSimilarFeature")){sendObj=product.setEvent("event427",1,sendObj);sendObj.pmc_eVar117="in-stock toggle enabled";sendObj.pmc_products=product.adobeString();}
if(item==="impression"){sendObj.pmc_event421="event421";pmc.fireLinkHit(sendObj,true);}else if(item==="interaction"){sendObj.pmc_prop14="pip instock toggle interaction";pmc.processPIPInteraction(sendObj,true);}};pmc.handleProductModification=function(eventData){try{var productList=pmc.items.createItemList();var eventProducts=eventData.products;var eventItem=pmc.getNestedStringValue(eventData,"item").toLowerCase();var sendObject={};if(eventItem==="add allstate protection"){for(var i=0;i<eventProducts.length;i++){var currentProduct=eventProducts[i];var product=productList.addItemFromObject(currentProduct);var productQuantity=currentProduct.quantity;if(productQuantity){sendObject=product.setEvent("event416",productQuantity,sendObject);sendObject.tealium_event="add_all_state_product_modification";}}
sendObject.pmc_products=productList.adobeString();pmc.fireLinkHit(sendObject);return;}}catch(e){pmc.logError(e);}};pmc.handleSeeSimilar=function(eventData){var eventItem=pmc.getNestedLowerCaseValue(eventData,"item");var seeSimilarReason=pmc.getNestedLowerCaseValue(eventData,"seeSimilarReason");var product=pmc.items.createItemFromObject(eventData.product);var sendObj={pmc_eVar117:seeSimilarReason,};if(eventItem==="impression"){sendObj.tealium_event="see_similar_impression";sendObj=product.setEvent("event427",1,sendObj);sendObj.pmc_products=product.adobeString();pmc.fireLinkHit(sendObj);return;}
if(eventItem==="open flyout"){sendObj.tealium_event="see_similar_flyout_open";sendObj.pmc_prop14="view similar in-stock items";sendObj=product.setEvent("event372",1,sendObj);sendObj.pmc_products=product.adobeString();pmc.processPIPInteraction(sendObj);return;}};pmc.handleDesignTrade=function(eventData){var eventItem=pmc.getNestedLowerCaseValue(eventData,"item");var sendObj={pmc_eVar102:pmc.getNormalDesignTradeTier(eventData.designTradeMemberTier),pmc_eVar90:eventData.designTradeMemberId,};if(eventItem==="merge accounts"){sendObj.tealium_event="design_trade_account_merge";sendObj.pmc_event434="event434";pmc.fireLinkHit(sendObj);return;}};pmc.handleChecklist=function(eventData){const eventItem=pmc.getNestedLowerCaseValue(eventData,"item");const sendObj={};if(eventItem==="interaction"){sendObj.tealium_event="dorm_checklist_interaction";pmc.fireLinkHit(sendObj);}};pmc.handleRacImpression=function(eventData){const eventItem=pmc.getNestedLowerCaseValue(eventData,"item");const sendObj={};if(eventItem==="dorm checklist impression"){sendObj.tealium_event="dorm_checklist_rac_impression";pmc.fireLinkHit(sendObj);}};pmc.handleProductRecsEvents=function(eventData){const eventItem=pmc.getNestedLowerCaseValue(eventData,"item");const sendObj={};if(eventItem==="expand thumbnail"){sendObj.tealium_event="product_recs_attribute_selection_impression";sendObj.pmc_prop30=utag_data.pmc_prop30;sendObj.pmc_prop19=utag_data.pmc_prop19;sendObj.pmc_products=pmc.items.getProductString(eventData.product);pmc.fireLinkHit(sendObj);}};pmc.getPipTealiumEvent=function(item){if(item==="bi-directional pip:unavailable attribute"){return"bi_directional_unavailable_attribute";}else if(item==="bi-directional pip:clear all attributes"){return"bi_directional_clear_all_attributes";}
return"";}
pmc.handlePipSimpleTracking=function(eventData){var eventItem=pmc.getNestedLowerCaseValue(eventData,"item");var sendObj={tealium_event:pmc.getPipTealiumEvent(eventItem)||"pip_simple_tracking",pmc_eVar92:eventItem,pmc_prop14:eventItem,};pmc.processPIPInteraction(sendObj);};pmc.handleWebArEvents=function(eventData){var eventItem=pmc.lowerCaseString(eventData.item);var cta=pmc.lowerCaseString(eventData.cta);var sendObj={pmc_products:pmc.items.getProductString(eventData.product),};if(eventItem==="view in ar"){sendObj.tealium_event="pip_ar_open_view";sendObj.pmc_prop14="view in ar: "+cta+" cta";sendObj.pmc_eVar107="view in ar open";pmc.processPIPInteraction(sendObj);return;}};pmc.handleShareFavorites=function(eventData){const eventItem=pmc.lowerCaseString(eventData.item);if(eventItem==="start"){pmc.fireLinkHit({tealium_event:"share_favorites_start",pmc_eVar92:"share favorites:initiate",});return;}
if(eventItem==="finish"){pmc.fireLinkHit({tealium_event:"share_favorites_finish",pmc_eVar92:"share favorites:submit "+eventData.method,});return;}};pmc.handlePipOverlay=function(eventData){const eventItem=pmc.lowerCaseString(eventData.item);const itemList=pmc.items.createItemList(eventData.products);if(eventItem==="double dare confirmation"){pmc.fireLinkHit({tealium_event:"overlay_double_dare",pmc_products:itemList.adobeString(),});return;}};pmc.handleScrollableHero=function(eventData){const eventItem=pmc.lowerCaseString(eventData.item);if(eventItem==="scroll to end"){pmc.fireLinkHit({tealium_event:"scrollable_hero_end",pmc_products:pmc.items.getSimpleProductString(utag_data.PIPGroupID),});return;}};pmc.handleEmailOverlay=function(eventData){const sendObj={};if(eventData.email){sendObj.tealium_event="email_signup";sendObj.customer_email_public=pmc.getHashedEmail(eventData);sendObj.pmc_eVar38="Personalized Content Widget";sendObj.pmc_event32="event32";sendObj.pmc_event53="event53";}
if(eventData.includesSms){sendObj.tealium_event=sendObj.tealium_event||"sms_signup";sendObj.pmc_event268="event268";}
if(eventData.campaign||eventData.placement){sendObj.pmc_prop72=eventData.campaign+"|"+eventData.placement;}
if(sendObj.tealium_event){pmc.wsiTrackingEvent=pmc.wsiTrackingEventInit(window.WSI.tracking.wsiTracking,eventData,sendObj);pmc.fireLinkHit(sendObj);}};pmc.handleSmartAddOns=function(eventData){const eventItem=pmc.lowerCaseString(eventData.item);const product=pmc.items.createItemFromObject(eventData.product);let sendObj={};if(eventItem==="impression"){sendObj.tealium_event="smart_addon_impression";sendObj=product.setEvent("event439",1,sendObj);sendObj.pmc_products=product.adobeString();pmc.fireLinkHit(sendObj);return;}};pmc.handleImmediateEvent=function(eventData){var category=pmc.getNestedLowerCaseValue(eventData,"category");if(typeof eventData!=="object"){return;}
var handlerMap=[{key:"registry edit drawer",value:"handleRegistryEdit",},{key:"registry",value:"handleRegistryEvents",},{key:"key rewards",value:"handleKeyRewards",},{key:"cart share",value:"handleCartShare",},{key:"api error",value:"handleApiErrors",},{key:"inline monogram",value:"handleInlineMonogram",},{key:"null search",value:"handleCrossBrandSearch",},{key:"xbrand search",value:"handleCrossBrandSearch",},{key:"checkout user flow",value:"handleSparcModule",},{key:"prescreened credit card",value:"handlePrescreenedCreditCard",},{key:"availability status",value:"handleAvailability",},{key:"customer service",value:"handleCustomerService",},{key:"product modification",value:"handleProductModification",},{key:"alt image interaction",value:"altImageClick",},{key:"scrolled content",value:"handleScrollSet",},{key:"swatch ordering",value:"orderSwatch",},{key:"urgency impression",value:"handleUrgencyImpression",},{key:"filter button clicked",value:"filterOverlayOpen",},{key:"review link click",value:"reviewClick",},{key:"reviews",value:"handleReviews",},{key:"pick this store",value:"pickThisStore",},{key:"checkout initiation",value:"handleThirdPartyCheckoutInitiation",},{key:"swatch selection",value:"handleSwatchSelection",},{key:"swatch preview",value:"handleSwatchPreview",},{key:"fabric view toggle",value:"handleFabricView",},{key:"fabric-filter",value:"handleFabricFilterInteraction",},{key:"ship to store",value:"handleShipToStore",},{key:"facet tracking",value:"processFacetActions",},{key:"promoevent",value:"promoCodeInteraction",},{key:"promotion interaction",value:"handleSparcPromo",},{key:"gift card / reward interaction",value:"handleSparcGiftRewards",},{key:"checkout error",value:"handleSparcCheckoutError",},{key:"ups access point",value:"handleUpsAccessPointEvents",},{key:"recently-viewed",value:"handleRecentlyViewedCarousel",},{key:"pzn triggered carousel",value:"handlePznCarousel",},{key:"smart bundling cart module close",value:"handleSmartBundleCartClose",},{key:"abtestinteraction",value:"handleAbTestLink",},{key:"ugc",value:"handleUgc",},{key:"qudini scheduling",value:"handleQudiniScheduling",},{key:"zip edit",value:"changeZip",},{key:"add to favorites",value:"handleFavoritesAdd",},{key:"pip clickthrough",value:"handleFavoritesClick",},{key:"remove from favorites",value:"handleFavoritesRemove",},{key:"favoritespopupclickthru",value:"favoritesClickThru",},{key:"hero",value:"heroClick",},{key:"tabbed content",value:"handleTabbedContent",},{key:"pip error",value:"handlePipError",},{key:"user error",value:"handleUserError",},{key:"product return",value:"handleReturnInitiation",},{key:"store locator",value:"handleStoreLocator",},{key:"credit card application",value:"creditCardApplicationClick",},{key:"account",value:"handleMyAccount",},{key:"my account",value:"handleMyAccount",},{key:"user authentication",value:"handleUserAuthentication",},{key:"link tracking",value:"genericLinkTracking",},{key:"my design projects",value:"handleMyDesignProjects",},{key:"optimized registry creation",value:"handleOptimizedRegistryCreation",},{key:"pickup and delivery filter",value:"handlePickupAndDelivery",},{key:"cart",value:"handleCartEvents",},{key:"bodylink",value:"truyoClickThru",},{key:"navigationbarlink",value:"trackingOptOut",},{key:"searchsubmission",value:"searchSubmission",},{key:"creditcard",value:"creditCardInteraction",},{key:"change shipping method",value:"changeShippingMethod",},{key:"add porch installation",value:"handlePorchInstall",},{key:"remove porch installation",value:"handlePorchInstall",},{key:"toggle",value:"toggleButton",},{key:"registry event",value:"notificationsPanelOpen",},{key:"registry completion optin",value:"registryCompletionOptIn",},{key:"group gifting",value:"handleGroupGifting",},{key:"odis",value:"handleOdis",},{key:"checkout payment",value:"checkoutInteraction",},{key:"affirm",value:"affirmOverlayOpen",},{key:"product scarcity",value:"handleProductScarcityImpression",},{key:"in-stock toggle",value:"handleInstockToggle",},{key:"stylitics mood board",value:"handleStyliticsMoodBoard",},{key:"grid toggle",value:"handleGridSizeToggleInteraction",},{key:"see similar",value:"handleSeeSimilar",},{key:"design trade",value:"handleDesignTrade",},{key:"pip simple tracking",value:"handlePipSimpleTracking",},{key:"web ar",value:"handleWebArEvents",},{key:"share favorites",value:"handleShareFavorites",},{key:"pip overlay",value:"handlePipOverlay",},{key:"scrollable hero",value:"handleScrollableHero",},{key:"email overlay",value:"handleEmailOverlay",},{key:"smart add ons",value:"handleSmartAddOns",},{key:"checklist",value:"handleChecklist",},{key:"rac overlay",value:"handleRacImpression",},{key:"product recs",value:"handleProductRecsEvents",},];var handler=pmc.resolveMapLookup(handlerMap,category);if(handler){pmc[handler](eventData);return;}
if(eventData.item==="Design Chat Impression"){return;}
if(eventData.item==="Start Design Chat"){pmc.startDesignChat(eventData);return;}
if(eventData.item==="Hide Design Chat"){pmc.hideDesignChat(eventData);return;}
if(eventData.item==="refinement"){var errorObj=new Error("Refinement event with wrong category");errorObj.data="category=''"+eventData.category+"''";errorObj.type="datalayer";pmc.logError(errorObj);pmc.processCategoryRefinements(eventData);return;}
if(eventData.name==="Reset"&&category){pmc.handleResetClick(eventData);return;}
if(eventData.userAction==="userAction"&&pmc.stringStartsWith(eventData.userAction,"zip")){pmc.changeZip(eventData);return;}
if(eventData.target==="On Display In Store"){pmc.handleOdis(eventData);return;}
if(eventData.item==="view assembly instructions"){pmc.clickAssemblyInstruction(eventData);return;}
if(eventData.item==="Facebook Promo Demo"&&category){pmc.facebookPromo(eventData);return;}
if(eventData.type==="personalizedContent"){pmc.handlePersonalizedContent(eventData);return;}
window.setTimeout(function(){pmc.handleDelayedEvent(eventData);},500);return true;};pmc.handleElementInteraction=function(eventData){try{if(pmc.checkNestedValue(eventData,"data.data")){eventData.data=eventData.data.data;}
pmc.handleImmediateEvent(eventData.data);}catch(e){e.data="data.category="+eventData.data.category+", data.item="+eventData.data.item+", data.type="+eventData.data.type;pmc.logError(e);}};pmc.handleScrollSet=function(eventData){var item=pmc.removeHTML(eventData.item);if(!isNaN(item[item.length-1])){pmc.altImageClick(eventData);}else if(pmc.environment.brandCode!=="mg"){var pipInteractionObj={tealium_event:"pip_scroll_content",link_text:"scrolled content",pmc_prop14:pmc.removeHTML("scrolled content:"+item).toLowerCase(),};pmc.processPIPInteraction(pipInteractionObj);return;}};pmc.checkoutProductString=function(item,ignorePotential){var orderItem=pmc.newOrderItem();var idObject={};if(pmc.checkDataDefinedAndNonEmpty(item,"productID")){idObject=item.productID;orderItem.description=idObject.persistentProdID||idObject.primaryProdID||idObject.prodID;}
if(pmc.isNestedDataDefinedAndNonEmpty(item,"attributes.readyToShip")){var shipmentInfo=item.attributes.readyToShip;pmc.getLegacyCheckOutShipmentDates(orderItem,item);if(pmc.isVariableDefinedAndNonEmpty(shipmentInfo.postalCode)){utag_data["pmc_zip"]=shipmentInfo.postalCode;}}
if(typeof(item.productID.sku)!=="undefined"&&item.productID.sku.length>0){orderItem.addPurchaseMerchandisingEvar("eVar33",item.productID.sku);}
if(typeof(item.quantity)!=="undefined"&&!ignorePotential&&pmc.pageName.toUpperCase()==="SHOPPING CART"){utag_data["pmc_event69"]="event69";orderItem.addPurchaseIncrementorEvent("event69",item.quantity);}
orderItem.itemTotal=(parseInt(item.quantity)*pmc.roundValue(item.price.unitPrice,2));if(orderItem.itemTotal&&!ignorePotential&&pmc.pageName.toUpperCase()==="SHOPPING CART"){utag_data["pmc_event70"]="event70";orderItem.addPurchaseIncrementorEvent("event70",pmc.roundValue(orderItem.itemTotal,2));}
return orderItem;};pmc.legacyCheckoutProductString=function(ignorePotential){var orderItem={};try{if(!pmc.isVariableDefinedAndNonEmpty(ignorePotential)){ignorePotential=false;}
if(pmc.stringContains(utag_data.pmc_pageName,"error")||pmc.stringContains(utag_data.pmc_pageName,"serverdown")||pmc.stringContains(utag_data.pmc_pageName,"lockout")||pmc.stringContains(utag_data.pmc_pageName,"issue")){utag_data.pmc_prop1=utag_data.pmc_prop2=utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5="checkout";utag_data.pmc_pageName="checkout:issue:ordererror";utag_data.pmc_prop23="D=v41";utag_data.pmc_prop6="D=v41";utag_data.pmc_prop7="D=v42";utag_data.pmc_eVar41=pmc.getNestedStringValue(digitalData,"page.attributes.cmCategoryId");utag_data.pmc_eVar42=pmc.getNestedStringValue(digitalData,"page.attributes.cmPageId");}
pmc.order=pmc.newOrder();if(pmc.isNestedDataDefinedAndNonEmpty(digitalData,"x_cart.orders")){var pageIndex=0;var pageParam=pmc.getQueryStringValue("page");if(pageParam){pageIndex=parseInt(pageParam)-1;}
var registryIncrementor;var orderArray=digitalData.x_cart.orders;for(var i=0;i<orderArray.length;i++){if(orderArray[i].orderType==="registry"&&typeof registryIncrementor==="undefined"){registryIncrementor=i===0?0:orderArray[i-1].shiptos.length-1;}
if(typeof(orderArray[i].items)!=="undefined"){var itemArray=orderArray[i].items;for(var h=0;h<itemArray.length;h++){var item=itemArray[h];if((orderArray[i].orderType==="normal"&&item.shiptoIndex===pageIndex)||(orderArray[i].orderType==="registry"&&pageIndex===registryIncrementor)){orderItem=pmc.checkoutProductString(item,ignorePotential);orderItem=pmc.addBackorderedItemToProductArray(orderItem);pmc.order.orderItems.push(orderItem);}}}
if(orderArray[i].orderType==="registry"){registryIncrementor++;}}}
if(pmc.order.orderItems.length>0){return pmc.getProductStringLegacy(pmc.order.orderItems);}else{return"";}}catch(e){pmc.logError(e);}};pmc.addBackorderEventsToProductArray=function(orderItem,backorderDate){var diffDays=0;if(backorderDate&&backorderDate!=="0"){diffDays=pmc.getDaysBetweenDateAndToday(backorderDate);}
if(diffDays){orderItem.purchaseIncrementorEvents.push({"eventName":"event74","value":diffDays});orderItem.purchaseMerchandisingEvars.push({"evarName":"eVar46","value":diffDays});}
orderItem.purchaseIncrementorEvents.push({"eventName":"event56","value":1});return diffDays;};pmc.addBackorderedItemToProductArray=function(orderItem){if(typeof(orderItem)==="undefined"){return{};}
try{if(typeof(digitalData.component)!=="undefined"){var componentArray=digitalData.component;var componentLength=componentArray.length;for(var j=0;j<componentLength;j++){if(pmc.isNestedDataDefinedAndNonEmpty(componentArray[j],"componentID.componentID")&&pmc.isNestedDataDefinedAndNonEmpty(componentArray[j],"attributes.groupId")){if(orderItem.description==componentArray[j].attributes.groupId&&(componentArray[j].componentID.componentID.match(/backorder/i)!=null||componentArray[j].componentID.componentID.match(/availability/i)!=null)){utag_data["pmc_event56"]="event56";var diffDays=pmc.addBackorderEventsToProductArray(orderItem,componentArray[j].attributes.backorder);if(diffDays>0){utag_data["pmc_event74"]="event74";}}}}}}catch(e){pmc.logError(e);}
return orderItem;};pmc.getBackorderedProductString=function(){try{if(typeof(utag_data["pmc_products"])!=="undefined"&&utag_data["pmc_products"].length>0){return utag_data["pmc_products"];}
var order=pmc.newOrder();if(typeof(digitalData.component)!=="undefined"){var componentArray=digitalData.component;var componentLength=componentArray.length;var component={},componentID="";for(var j=0;j<componentLength;j++){component=componentArray[j];if(pmc.isNestedDataDefinedAndNonEmpty(component,"componentID.componentID")){if(pmc.isNestedDataDefinedAndNonEmpty(component,"attributes.groupId")){componentID=component.componentID.componentID;if(componentID.match(/backorder/i)!=null||componentID.match(/availability/i)!=null){var item=component.attributes;var orderItem=pmc.newOrderItem();orderItem.description=item.groupId;orderItem.purchaseMerchandisingEvars.push({"evarName":"eVar33","value":item.sku});utag_data["pmc_event56"]="event56";if(typeof(item.backorder)!=='undefined'){var diffDays=pmc.addBackorderEventsToProductArray(orderItem,item.backorder);if(diffDays>0){utag_data["pmc_event74"]="event74";}}
order.orderItems.push(orderItem);}}}}}
if(order.orderItems.length>0){return pmc.getProductStringLegacy(order.orderItems);}else{return"";}}catch(e){pmc.logError(e);}};pmc.setUpsAccessPointOrderPage=function(order){try{if(pmc.checkDataDefinedAndNonEmpty(order,"accessPoint")){var sourceObj=order.accessPoint;utag_data["pmc_eVar91"]=sourceObj.upsAccessPointEligibility?sourceObj.upsAccessPointEligibility:"";utag_data["pmc_event294"]=sourceObj.isUpsAccessPointOrder&&sourceObj.isUpsAccessPointOrder!=="false"?"event294":"";utag_data["pmc_event291"]=sourceObj.hasEditedPickUpPerson&&sourceObj.hasEditedPickUpPerson!=="false"?"event291":"";}}catch(e){pmc.logError(e);}};pmc.trackSmsOptInFeatures=function(){try{if(pmc.isNestedDataDefinedAndNonEmpty(digitalData,"page.attributes")){var pageAttributes=digitalData.page.attributes;utag_data.pmc_event268=pageAttributes.marketing?"event268":"";utag_data.pmc_event267=pageAttributes.loyalty?"event267":"";if(pageAttributes.transactional){utag_data.pmc_event141="event141";}}}catch(e){pmc.logError(e);}};pmc.getRegularCheckoutType=function(){var status=pmc.getNestedLowerCaseValue(digitalData,"x_user.profile.authenticationStatus");if(status){if(status==="anonymous"){return"guest regular";}else{return"authenticated regular";}}else{return"guest regular";}};pmc.getCheckoutType=function(itemList,newType){try{var errorObj;var checkout=pmc.lowerCaseString(newType||pmc.getNestedValue(digitalData,"page.attributes.checkoutType"));var chkmodeParam=pmc.getQueryStringValue("chkmode");if(!checkout){errorObj=new Error("Data layer missing checkoutType");errorObj.type="datalayer";pmc.logError(errorObj);return"";}
if(chkmodeParam==="freeswatch"){return"free swatches checkout";}
if(chkmodeParam==="paidswatch"){return"paid swatches checkout";}
if(itemList&&!itemList.hasNonSwatches()){if(itemList.hasPaidSwatches()){return"paid swatches checkout";}
return"free swatches checkout";}
if(checkout==="regular"){return pmc.getRegularCheckoutType();}
if(typeof checkout==="string"){return checkout;}}catch(e){pmc.logError(e);}};pmc.tenderTypes=function(){var tenderKey,tenderCat,tenderEvent,tenderStr="",tenderVals=[],keysUsed=[],tenderTypeMap=[{key:"visa",bucket:"cc",event:"revenueCreditCard"},{key:"visa/ws",bucket:"cc",event:"revenueCreditCard"},{key:"williams-sonoma",bucket:"cc",event:"revenueCreditCard"},{key:"williams-sonoma visa",bucket:"cc",event:"revenueCreditCard"},{key:"williams sonoma visa",bucket:"cc",event:"revenueCreditCard"},{key:"mastercard",bucket:"cc",event:"revenueCreditCard"},{key:"master card",bucket:"cc",event:"revenueCreditCard"},{key:"amex",bucket:"cc",event:"revenueCreditCard"},{key:"american express",bucket:"cc",event:"revenueCreditCard"},{key:"discover",bucket:"cc",event:"revenueCreditCard"},{key:"discover card",bucket:"cc",event:"revenueCreditCard"},{key:"discover network",bucket:"cc",event:"revenueCreditCard"},{key:/^plcc\//,bucket:"cc",event:"revenueCreditCard"},{key:/^my saved/,bucket:"cc",event:"revenueCreditCard"},{key:/key rewards visa/,bucket:"cc",event:"revenueCreditCard"},{key:/key rewards card/,bucket:"cc",event:"revenueCreditCard"},{key:"williams-sonoma plcc",bucket:"cc",event:"revenueCreditCard"},{key:"pottery barn",bucket:"cc",event:"revenueCreditCard"},{key:"pottery barn kids",bucket:"cc",event:"revenueCreditCard"},{key:"pottery barn/pottery barn kids",bucket:"cc",event:"revenueCreditCard"},{key:"west elm card",bucket:"cc",event:"revenueCreditCard"},{key:"svc",bucket:"sv",event:"revenueSVC"},{key:"gift card",bucket:"sv",event:"revenueSVC"},{key:"key reward",bucket:"kr",event:"revenueKeyRewards"},{key:"credit reward",bucket:"cr",event:"revenueCCReward"},{key:"paypal",bucket:"dp",event:"revenuePayPal"},{key:"credit.paypal",bucket:"dp",event:"revenuePayPal"},{key:"venmo",bucket:"dp",event:"revenueVenmo"},{key:"credit.venmo",bucket:"dp",event:"revenueVenmo"},{key:"applepay",bucket:"dp",event:"revenueApplePay"},{key:"apple_pay",bucket:"dp",event:"revenueApplePay"},{key:"affirm",bucket:"dp",event:"revenueAffirm"},{key:/.*/,bucket:"xx",event:"other"}];if(digitalData.x_transaction.confirmedTenders&&digitalData.x_transaction.confirmedTenders.length>0){for(var i=0,len=digitalData.x_transaction.confirmedTenders.length;i<len;i++){tenderKey=digitalData.x_transaction.confirmedTenders[i].tenderTypeDetail.toLowerCase();tenderCat=pmc.resolveMapLookup(tenderTypeMap,tenderKey,"bucket");if(!keysUsed[tenderKey]){if(i>0)tenderStr+="|";tenderStr+=tenderCat+":"+tenderKey;keysUsed[tenderKey]=1;}else{keysUsed[tenderKey]+=1;}
tenderEvent=pmc.resolveMapLookup(tenderTypeMap,tenderKey,"event");tenderVals[tenderEvent]=parseFloat(tenderVals[tenderEvent])||0;tenderVals[tenderEvent]+=parseFloat(digitalData.x_transaction.confirmedTenders[i].tenderAmount);utag_data[tenderEvent]=tenderVals[tenderEvent];}}
utag_data.pmc_eVar7=tenderStr;};pmc.getPriorityPriceOnPip=function(){var priceSelling=pmc.getNestedValue(digitalData,"product.price.selling",{});var priceRegular=pmc.getNestedValue(digitalData,"product.price.regular",{});return priceSelling.max||priceSelling.min||priceRegular.max||priceRegular.min||"";};pmc.getOrderItemRevenue=function(item){try{var unitPrice=pmc.getNestedValue(item,"price.unitPrice");if(pmc.checkNestedValue(item,"price.merchDiscount")){return pmc.roundValue((item.price.unitPrice-item.price.merchDiscount),2);}else if(unitPrice||unitPrice===0){return unitPrice;}}catch(e){e.data="pmc.getOrderItemRevenue: Invalid item price";e.type="datalayer";pmc.logError(e);return 0;}};pmc.shipmentConsolidation={getStatus:function(items,keys){var status={};for(var i=0,len=items.length;i<len;i++){if(pmc.checkNestedValue(items[i],keys)){var itemType=pmc.getNestedValue(items[i],keys,"");if(itemType){status[itemType]=true;}}}
return status;},getTypes:function(cartItems,nestedKeys){var status=pmc.shipmentConsolidation.getStatus(cartItems,nestedKeys);var consolidationTypes=pmc.orderValidKeys(status,["CMO","FN","SS"]);return consolidationTypes.join("|");},getSkuListOnDgo:function(cart){var inHomeSkus=[];var deliveryGroups=cart.subOrders[0].deliveryGroups;for(var i=0,len=deliveryGroups.length;i<len;i++){if(deliveryGroups[i].type==="IN_HOME_DELIVERY"&&deliveryGroups[i].affectedSkus&&deliveryGroups[i].affectedSkus.length){inHomeSkus=inHomeSkus.concat(deliveryGroups[i].affectedSkus);}}
return inHomeSkus;},getSkuDataOnDgo:function(cart){var skuList=[];var items=[];if(cart.subOrders&&cart.subOrders.length&&cart.subOrders[0].deliveryGroups&&cart.subOrders[0].deliveryGroups.length){skuList=pmc.shipmentConsolidation.getSkuListOnDgo(cart);}else{var e=new Error("pmc.shipmentConsolidation: skuList not populated");e.type="datalayer";pmc.logError(e);return[];}
var cartItems=cart.items
for(var i=0;i<cartItems.length;i++){var item=cartItems[i];if(skuList.indexOf(item.sku)>-1){items.push({sku:item.sku,price:item.unitPrice,quantity:item.quantity,deliveryEstimateStart:pmc.isNestedDataDefinedAndNonEmpty(item,"readyToShip.originalDeliveryEstimateStart")?item.readyToShip.originalDeliveryEstimateStart:"",});}}
return items;},getSkuDataOnOrder:function(order){var items=[];for(var i=0,len=order.items.length;i<len;i++){var item=order.items[i];if(pmc.checkNestedValue(item,"readyToShip.shipMode","FN")){items.push({sku:pmc.normalizeProductIdObject(item).sku,price:pmc.getOrderItemRevenue(item),quantity:item.quantity,});}}
return items;},calculateFnRevenue:function(items){var total=0;for(var i=0,len=items.length;i<len;i++){total+=pmc.getTotalFromUnitsAndPrice(items[i].quantity,items[i].price);}
return total;},getMagnitude:function(items){if(!items.length||!items[0].deliveryEstimateStart){return 0;}
var initialDateString=items[0].deliveryEstimateStart;var earliest=new Date(initialDateString);var latest=new Date(initialDateString);for(var i=1,len=items.length;i<len;i++){if(items[i].deliveryEstimateStart){var itemDate=new Date(items[i].deliveryEstimateStart);if(itemDate<earliest){earliest=itemDate;}
if(itemDate>latest){latest=itemDate;}}else{var errObj=new Error("No deliveryEstimateStart found");errObj.data="GroupID="+pmc.getNormalProdId(items[i]);errObj.type="datalayer";pmc.logError(errObj);}}
return pmc.getDaysBetweenEvents(earliest,latest);},convertSkuData:function(items){return{numberOfLines:items.length,revenue:pmc.shipmentConsolidation.calculateFnRevenue(items),magnitude:pmc.shipmentConsolidation.getMagnitude(items),};},setDgoVariables:function(eventData,isAutoConsolidation,sendObject){var cart=eventData.attributes.cart;var itemsArray=pmc.shipmentConsolidation.getSkuDataOnDgo(cart);var analyticsData=pmc.shipmentConsolidation.convertSkuData(itemsArray);sendObject.multilineDgoCount=analyticsData.numberOfLines;sendObject.multilineDgoRevenue=analyticsData.revenue;sendObject.consolidationMagnitude=analyticsData.magnitude;if(isAutoConsolidation){sendObject.pmc_event295="event295";}
return sendObject;},setOrderVariables:function(order){utag_data.shippingConsolidationSelected=pmc.shipmentConsolidation.getTypes(order.items,"readyToShip.shipMode");var itemsArray=pmc.shipmentConsolidation.getSkuDataOnOrder(order);if(itemsArray.length){var analyticsData=pmc.shipmentConsolidation.convertSkuData(itemsArray);utag_data.pmc_event296="event296";utag_data.multilineOrderCount=analyticsData.numberOfLines;utag_data.multilineOrderRevenue=analyticsData.revenue;}},};pmc.purchase=function(){try{var err;var dataLayerOrderArray;var dataLayerOrder;var itemList;var item;var groupId;var dataLayerItemsArray;var dataLayerItem;var shipType;var productIdObject;utag_data.pmc_pageName="checkout:order confirmation";utag_data.pmc_channel=utag_data.pmc_prop1=utag_data.pmc_prop2=utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5="checkout";dataLayerOrderArray=pmc.getNestedValue(digitalData,"x_transaction.orders");if(!pmc.isArray(dataLayerOrderArray)||dataLayerOrderArray.length===0){err=new Error("No x_transaction.orders in data layer");err.type="datalayer";pmc.logError(err);return;}
dataLayerOrder=dataLayerOrderArray[0];dataLayerItemsArray=pmc.getNestedValue(dataLayerOrder,"items");if(!pmc.isArray(dataLayerItemsArray)){err=new Error("No items array in data layer");err.type="datalayer";pmc.logError(err);return;}
try{pmc.getStorageValues("gclid,adlclid,kpid,clickid");}catch(error){error.type="service";error.data="Location: pmc.purchase";error.data+=": Storage Lookup Error: ";pmc.logError(error);}
utag_data.pmc_eVar5=dataLayerOrder.orderID;utag_data.pmc_state=pmc.getNestedValue(digitalData,"x_transaction.customer.address.stateProvince");utag_data.pmc_zip=pmc.getNestedValue(digitalData,"x_transaction.customer.address.postalCode");utag_data.pmc_eVar6=dataLayerOrder.promoCode||dataLayerOrder.promos;utag_data.customer_email_public=pmc.getHashedEmail(digitalData);if(utag_data.customer_email_public){utag_data.pmc_event53="event53";}
utag_data.pmc_event7=pmc.getNestedValue(dataLayerOrder,"price.orderTotal")||0;utag_data.pmc_event8=pmc.getNestedValue(dataLayerOrder,"price.shippingTotal")||0;utag_data.pmc_event9=pmc.getNestedValue(dataLayerOrder,"price.surchargeTotal")||0;utag_data.pmc_event10=pmc.getNestedValue(dataLayerOrder,"price.taxTotal")||0;utag_data.pmc_event15=pmc.getNestedValue(dataLayerOrder,"price.shippingDiscountTotal")||0;utag_data.pmc_event38=pmc.getNestedValue(dataLayerOrder,"price.giftWrapTotal")||0;utag_data.event86=pmc.checkNestedValue(dataLayerOrder,"payment.newlyApproved")?"event86":"";utag_data.pmc_event298=pmc.checkNestedValue(dataLayerOrder,"chooseYourDate","true")?"event298":"";if(dataLayerOrder.deliverWithFurnitureSelected==="together"){utag_data.pmc_event385="event385";}else if(dataLayerOrder.deliverWithFurnitureSelected==="separate"){utag_data.pmc_event386="event386";}
utag_data.pmc_event413=dataLayerOrder.hasGiftRecipientEmail?"event413":"";}catch(e){e.data="Location: pmc.purchase basic order data";pmc.logError(e);}
try{var personalizationDiscount=pmc.getNestedValue(dataLayerOrder,"price.personalizationDiscountTotal",0);var merchantDiscount=pmc.getNestedValue(dataLayerOrder,"price.merchDiscount",0);var nonPersonalizedDiscount=merchantDiscount-personalizationDiscount;if(personalizationDiscount>0){utag_data.pmc_event14=personalizationDiscount;}
if(nonPersonalizedDiscount>0){utag_data.pmc_event13=nonPersonalizedDiscount;}}catch(e){e.data="Location: pmc.purchase discount data";pmc.logError(e);}
try{itemList=pmc.items.createItemList();for(var i=0,il=dataLayerItemsArray.length;i<il;i++){shipType="";dataLayerItem=dataLayerItemsArray[i];productIdObject=pmc.getNestedValue(dataLayerItem,"productID");if(productIdObject){groupId=productIdObject.persistentProdID||productIdObject.primaryProdID||productIdObject.prodID;item=itemList.addItem(groupId,productIdObject.sku);}
item.setUnits(dataLayerItem.quantity);item.setUnitPrice(pmc.getOrderItemRevenue(dataLayerItem));utag_data.registry_id=utag_data.registry_id||pmc.getNestedValue(dataLayerItem,"attributes.registryStoreId");if(pmc.checkNestedValue(dataLayerItem,"allstateProtectionPlan",true)){var allStatePrice=pmc.getNestedValue(dataLayerItem,"price.allstateProtection");if((item.unitPrice>0)&&allStatePrice){utag_data=item.setEvent("event417",dataLayerItem.quantity,utag_data);utag_data=item.setEvent("event418",allStatePrice,utag_data);}}
if(pmc.checkNestedValue(dataLayerItem,"attributes.itemType","swatch")){item.setAsSwatch();if(item.unitPrice>0){utag_data=item.setEvent("event364",1,utag_data);utag_data=item.setEvent("event365",item.units,utag_data);utag_data=item.setEvent("event366",item.getTotalPrice(),utag_data);}else{utag_data=item.setEvent("event363",item.units,utag_data);}
utag_data.pmc_event362="event362";}
if(dataLayerItem.isGift){utag_data=item.setEvent("event414",1,utag_data);}
if(dataLayerItem.giftWrapped){utag_data=item.setEvent("event36",1,utag_data);}
if(dataLayerItem.porchInstallationService){utag_data=item.setEvent("event97",1,utag_data);}
if(pmc.checkNestedValue(dataLayerItem,"shipToStore.storeId")){shipType="bosts";utag_data.pmc_event303="event303";item.setEvar("eVar95",pmc.getNestedValue(dataLayerItem,"shipToStore.storeId"));item.setEvar("eVar103",pmc.getNestedStringValue(dataLayerItem,"shipToStore.storeBrand").toLowerCase());utag_data=item.setEvent("event304",1,utag_data);utag_data=item.setEvent("event305",item.units,utag_data);utag_data=item.setEvent("event306",item.getTotalPrice(),utag_data);utag_data.order_has_nonBopis="true";}else if(pmc.checkNestedValue(dataLayerItem,"pickupLocationCode")){shipType="bopis";utag_data=item.setEvent("event112",1,utag_data);item.setEvar("eVar95",pmc.getNestedValue(dataLayerItem,"pickupLocationCode"));item.setEvar("eVar103","non-BOSTS");utag_data=item.setEvent("event117",item.getTotalPrice(),utag_data);utag_data.pmc_event116=(utag_data.pmc_event116||0)+item.units;utag_data.order_has_bopis="true";utag_data.pmc_event115="event115";}else{item.setEvar("eVar95","non-store");item.setEvar("eVar103","non-BOSTS");utag_data.order_has_nonBopis="true";}
item.setEvar("eVar97",shipType||"ship");}
if(itemList.hasNonSwatches()){utag_data.order_id=utag_data.pmc_eVar5;}else{utag_data.order_id_swatches_only=utag_data.pmc_eVar5;}
utag_data.pmc_eVar4=pmc.getCheckoutType(itemList);utag_data.pmc_products=itemList.adobeString(true);}catch(e){e.data="Location: pmc.purchase process items";pmc.logError(e);}
try{var dataLayerShiptos=dataLayerOrder.shiptos;var deliveryMethods;var deliveryConsolidation=[];var serviceLevels=[];if(!pmc.isArray(dataLayerShiptos)){err=new Error("No shiptos array in data layer");err.type="datalayer";pmc.logError(err);return;}
for(var j=0,jl=dataLayerShiptos.length;j<jl;j++){deliveryMethods=dataLayerShiptos[j].deliveryMethods;if(pmc.isArray(deliveryMethods)){for(var k=0,kl=deliveryMethods.length;k<kl;k++){pmc.addToArrayUnique(deliveryConsolidation,pmc.getNestedStringValue(deliveryMethods[k],"consolidationSelection").toLowerCase());}}
serviceLevels=serviceLevels.concat(pmc.lowercaseArray(dataLayerShiptos[j].serviceLevels));}
if(pmc.arrayContains(serviceLevels,"doorstep")){utag_data.pmc_event326="event326";}else if(pmc.arrayContains(serviceLevels,"white_glove")){utag_data.pmc_event327="event327";}
utag_data.pmc_eVar8=utag_data.pmc_prop58=pmc.orderArrayElements(serviceLevels,["standard","rush","white_glove","doorstep","pickup_regular","pickup_internal"]).join("|")||dataLayerShiptos[0].shipMethod;var inDeliveryConsolidation=function(value,eventName){return pmc.arrayContains(deliveryConsolidation,value)?eventName:"";}
if(deliveryConsolidation.length>0){utag_data.pmc_event262=inDeliveryConsolidation("ship_together","event262");utag_data.pmc_event263=inDeliveryConsolidation("ship_separate","event263");utag_data.pmc_event264=inDeliveryConsolidation("deliver_together","event264");utag_data.pmc_event265=inDeliveryConsolidation("deliver_separate","event265");utag_data.pmc_event266=inDeliveryConsolidation("no_consolidation","event266");}
utag_data.pmc_eVar102=pmc.getNormalDesignTradeTier(pmc.getNestedValue(digitalData,"page.attributes.designTradeMemberTier"));if(utag_data.pmc_eVar102){utag_data.pmc_event382="event382";}}catch(e){e.data="Location: pmc.purchase process shiptos";pmc.logError(e);}
try{pmc.shipmentConsolidation.setOrderVariables(dataLayerOrder);}catch(e){e.data="Location: pmc.purchase shipment consolidation";pmc.logError(e);}
try{if(pmc.checkNestedValue(dataLayerOrder,"payment.keyRewardsAutoEnroll")){utag_data.pmc_event207="event207";}
pmc.tenderTypes();}catch(e){e.data="Location: pmc.purchase payment data";pmc.logError(e);}
try{pmc.setUpsAccessPointOrderPage(dataLayerOrder);}catch(e){e.data="Location: pmc.purchase setUpsAccessPointOrderPage";pmc.logError(e);}
try{pmc.trackSmsOptInFeatures();}catch(e){e.data="Location: pmc.purchase trackSmsOptInFeatures";pmc.logError(e);}
var randomOrderId=pmc.getNestedValue(window.WSI,"tracking.wsiTracking.previous.orderIdRandom");if(!randomOrderId){window.WSI.tracking=window.WSI.tracking||{};window.WSI.tracking.wsiTracking=window.WSI.tracking.wsiTracking||{previous:{},};window.WSI.tracking.wsiTracking.previous.orderIdRandom=randomOrderId=Math.floor(Math.random()*1000000)+""+(new Date()).getTime();};utag_data.random_order_id=randomOrderId;};pmc.setSearchResultType=function(searchResultType){if(!searchResultType){if(pmc.isNestedDataDefinedAndNonEmpty(digitalData,"page.attributes.searchResultsType")){searchResultType=digitalData.page.attributes.searchResultsType.toLowerCase()}}
if(pmc.isVariableDefinedAndNonEmpty(searchResultType)){if(searchResultType==="partialmatch"){return"partial-match";}else if(searchResultType==="spellcorrected"){return"spell-corrected";}else if(searchResultType==="typeahead"){return"type-ahead";}else if(searchResultType==="didyoumean"){return"did-you-mean";}else{return searchResultType;}}else{return"unknown";}};pmc.handleSearchTypeAhead=function(){utag_data['pmc_event33']=(digitalData.page.attributes.searchTypeahead==true)?"pmc_event33":"";};pmc.getMobileReviewsRatings=function(dataObject){try{var outerElement=document.getElementsByClassName("rating-reviews-summary")[0];if(outerElement){var reviewContainer=outerElement.getElementsByClassName("number-of-reviews")[0];if(reviewContainer&&reviewContainer.innerText){var reviewNumber=parseInt(reviewContainer.innerText.replace(/\D/g,''));if(reviewNumber){dataObject.reviews=reviewNumber;}}else{if(document.querySelectorAll("#BVRRContainer").length&&!document.querySelectorAll("#first-to-write").length){var errObj=new Error("Found reviews container but no reviews content");errObj.type="datalayer";pmc.logError(errObj);}
return dataObject;}
var ratingContainer=document.getElementsByClassName("bv-secondary-rating-summary-rating")[0];if(ratingContainer&&ratingContainer.innerText){var ratingNumber=parseFloat(ratingContainer.innerText);if(ratingNumber){dataObject.ratings=ratingNumber;}}}
return dataObject;}catch(e){pmc.logError(e);}};pmc.getDesktopReviewsRatings=function(dataObject){try{var reviewContainer=document.querySelectorAll(".bv-stars-container span[itemprop=\"reviewCount\"]")[0];if(reviewContainer&&reviewContainer.innerText){var reviewNumber=parseInt(reviewContainer.innerText);if(reviewNumber){dataObject.reviews=reviewNumber;}}else{if(document.querySelectorAll('#goToQA .bv-rr').length&&!document.querySelectorAll("#first-to-write").length){var errObj=new Error("Found reviews container but no reviews content");errObj.type="datalayer";pmc.logError(errObj);}
return dataObject;}
var ratingContainer=document.querySelectorAll(".bv-secondary-rating-summary-rating")[0];if(ratingContainer){var ratingNumber=parseFloat(ratingContainer.innerText);if(ratingNumber){dataObject.ratings=ratingNumber;}}
return dataObject;}catch(e){pmc.logError(e);}};pmc.getRatingsReviews=function(){try{var ratingsAndReviews={ratings:0,reviews:0};return pmc.isMobile?pmc.getMobileReviewsRatings(ratingsAndReviews):pmc.getDesktopReviewsRatings(ratingsAndReviews);}catch(e){pmc.logError(e);}};pmc.setPfmProductStringVariables=function(pfm){var dictionary=[{key:"WSIRecs:RVI-Carousel",value:"event320",},{key:"WSIRecs:RVI-MoreLikeThis-Seed",value:"event321",},{key:"WSIRecs:RVI-MoreLikeThis-Companion",value:"event321",},{key:"WSIRecs:PZN-Carousel",value:"event338",},{key:"WSIRecs:PZN-MoreLikeThis-Seed",value:"event339",},{key:"WSIRecs:PZN-MoreLikeThis-Companion",value:"event339",},];return pmc.resolveMapLookup(dictionary,pfm)||"";};pmc.pageViewProductDetailsPage=function(){try{var errorObj;var _productId=utag_data.pmc_eVar63=utag_data.PIPGroupID=pmc.getNormalProdId(digitalData.product);var productEvent="";var pickupLocation=pmc.getQueryStringValue("pickuplocation");var skuFromUrl=pmc.getQueryStringValue("sku");var cqsSearchTerm=pmc.getQueryStringValue("words");var availabilityStatus=pmc.getNestedValue(digitalData,"product.productId.availabilityStatus");var productList=pmc.items.createItemList();var swatchType="";var dataLayerPageName=pmc.getNestedValue(digitalData,"page.pageName");var categoryNameArray=pmc.getNestedValue(digitalData,"product.productCategory.categoryNames");var categoryArray=pmc.getNestedValue(digitalData,"product.productCategory.categories");var pageAttributes=digitalData.page.attributes||{};var pageTemplate=pageAttributes.template;var inStockToggleState;var persistentIds;if(utag_data.pmc_eVar42==="M:PIP INTERSTITIAL"){return;}
if(!_productId){errorObj=new Error("No product ID on PIP");errorObj.type="datalayer";pmc.logError(errorObj);return;}
var productItem=productList.addItem(_productId);utag_data.pmc_prop35=pickupLocation.split(":")[1]||"";utag_data.pmc_event181=utag_data.pmc_prop35?"event181":"";utag_data.product_highest_price=pmc.getPriorityPriceOnPip();utag_data.pmc_prop1=utag_data.pmc_prop2=utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5="product detail";utag_data.pmc_pageName=pmc.originalPageName="product detail:"+_productId;utag_data.pmc_prop1=pmc.originalPageType="product detail:"+pageTemplate;if(pageAttributes.inlineMonogram){utag_data.pmc_event381="event381";}
if(pageAttributes.shopByRoom){utag_data.pmc_event273="event273";}
if(pageAttributes.scrollableHeroImages){utag_data=productItem.setEvent("event437",1,utag_data);}
if(pageAttributes.smartAddOns){productItem.setSku(productItem.smartAddOns);utag_data=productItem.setEvent("event439",1,utag_data);}
if(pageAttributes.splitExperience==="basic"){utag_data.splitPip="Split";}else{utag_data.splitPip="Regular";}
if(pageAttributes.bidirectionalAttributes){utag_data.pmc_event444="event444";}
if(cqsSearchTerm){utag_data.pmc_eVar9="search:cqs search";utag_data.pmc_prop9=utag_data.pmc_eVar27=cqsSearchTerm;utag_data.pmc_prop10="1";utag_data.pmc_prop11=utag_data.pmc_prop22=utag_data.pmc_eVar29=utag_data.pmc_eVar51="cqs";utag_data.pmc_event33="event33";utag_data.pmc_event35="event35";}
inStockToggleState=pmc.getNestedValue(digitalData,"page.attributes.inStockToggle")
if(inStockToggleState){utag_data.pmc_eVar115=inStockToggleState;utag_data.pmc_event421="event421";if(inStockToggleState==="filter on"&&pmc.checkNestedValue(digitalData,"page.attributes.seeSimilarFeature")){utag_data=productItem.setEvent("event427",1,utag_data);utag_data.pmc_eVar117="in-stock toggle enabled";}}
if(pmc.stringContains(pageTemplate,"swatch")){utag_data=productItem.setEvent("event397",1,utag_data);if(pmc.stringContains(dataLayerPageName,"fabric")){swatchType="fabric";}else if(pmc.stringContains(dataLayerPageName,"leather")){swatchType="leather";}else if(pmc.stringContains(dataLayerPageName,"outdoor")){swatchType="outdoor";}else if(pmc.stringContains(dataLayerPageName,"swatches")){swatchType="fabric";}
utag_data.pmc_pageName=dataLayerPageName;}else{utag_data=productItem.setEvent("event18",1,utag_data);utag_data.pmc_prodView="prodView";if(!pmc.stringContains(utag_data.pmc_prop1,"pip")){utag_data.pmc_prop1+=" pip";pmc.originalPageType=utag_data.pmc_prop1;}
if(pageAttributes.templateVariant==="dream"||pageAttributes.strategy==="dream"){utag_data.pmc_prop1=pmc.originalPageType=utag_data.pmc_prop1+"|dream";}
persistentIds=pmc.getNestedValue(digitalData,"product.attributes.persistentIDs");if(pmc.isArray(persistentIds)){utag_data.pmc_event19="event19";for(var i=0;i<persistentIds.length;i++){var productItemSecondary=productList.addItem(persistentIds[i]);productItemSecondary.setEvent("event19");}}}
if(utag_data.pmc_eVar9){productEvent=pmc.setPfmProductStringVariables(utag_data.pmc_eVar9);if(productEvent){utag_data=productItem.setEvent(productEvent,1,utag_data);}}
if(pmc.checkNestedValue(digitalData,"page.attributes.allstateProtectionOffer")){utag_data=productItem.setEvent("event415",1,utag_data);}
if(pmc.checkNestedValue(digitalData,"page.attributes.webAr",true)){utag_data.pmc_event399="event399";}
if(pmc.normalizeProductIdObject(digitalData.product).porchInstallationOption){utag_data=productItem.setEvent("event101",1,utag_data);}
if(pmc.stringContains(_productId,"gift-card")){utag_data.pmc_prop1="product detail:gift card";productItem.setEvar("eVar58","primary");}
if(pickupLocation&&utag_data.pmc_prop35){utag_data=productItem.setEvent("event181",1,utag_data);productItem.setEvar("eVar33",skuFromUrl);}
try{var nlaNodes=document.querySelectorAll(".nla, .nla-subset").length;if(nlaNodes>0){utag_data=productItem.setEvent("event155",1,utag_data);}}catch(e){e.data="nla querySelectorAll";pmc.logError(e);}
if(availabilityStatus==="nla"){utag_data=productItem.setEvent("event155",1,utag_data);}else if(availabilityStatus==="partial nla"){utag_data=productItem.setEvent("event455",1,utag_data);}
if(pmc.environment.brandCode==="ws"&&!pmc.checkNestedValue(digitalData,"page.attributes.template","reduced")){var ratingsReviews=pmc.getRatingsReviews();var ratings=ratingsReviews.ratings;var reviews=ratingsReviews.reviews;productItem.setEvar("eVar83",ratings||"no reviews");productItem.setEvar("eVar84",reviews||"no reviews");if(ratings&&reviews){utag_data=productItem.setEvent("event271",ratings,utag_data);utag_data=productItem.setEvent("event272",reviews,utag_data);}}
if(productList.length()===1){if(productItem.getEvar("eVar45")==="mixed availability"){productItem.setEvar("eVar45","backordered");}}
if(pmc.isArray(categoryNameArray)){utag_data.product_category=[categoryNameArray[categoryNameArray.length-1]];}
if(pmc.isArray(categoryArray)){utag_data.category_path=categoryArray;utag_data.page_section1=categoryArray[0];utag_data.page_sectionEnd=categoryArray[categoryArray.length-1];}
utag_data.pmc_products=productList.adobeString();}catch(e){pmc.logError(e);}};pmc.newOrderItem=function(){var pmc_orderItem=function(){this.description="";this.itemNumber="";this.shippingOptions="";this.quantity="";this.price="";this.itemTotal="";this.monogram="";this.giftWrapped=false;this.purchaseIncrementorEvents=[];this.purchaseMerchandisingEvars=[];this.addPurchaseIncrementorEvent=function(eventName,eventValue){if(pmc.isVariableDefinedAndNonEmpty(eventName)&&pmc.isVariableDefinedAndNonEmpty(eventValue)){this.purchaseIncrementorEvents.push({"eventName":eventName,"value":eventValue})}};this.addPurchaseMerchandisingEvar=function(eVarName,eVarValue){if(pmc.isVariableDefinedAndNonEmpty(eVarName)&&pmc.isVariableDefinedAndNonEmpty(eVarValue)){this.purchaseMerchandisingEvars.push({"evarName":eVarName,"value":eVarValue})}};};return new pmc_orderItem();};pmc.newOrder=function(){return{number:"",orderItems:[],state:"",zip:"",eVar7:"",shipMethod:"",eVar5:"",eVar6:"",eVar34:"",eVar43:"",event7:"",event8:"",event9:"",event10:"",event14:"",event15:"",event38:"",event86:"",event112:"",productString:"",};};pmc.setDebugMode=function(){this.debug=false;try{if(window.location.href.indexOf("debug=")>-1){if(window.location.href.split("debug=")[1].split("&")[0]==="true"){this.debug=true;}}}catch(error){}};pmc.debugStatus=function(msg){if(this.debug==true){if(msg){console.log("pmc.debugStatus: "+msg);}
console.log(this);}};pmc.suppressDoubleFire=function(variableName,duration){if(typeof(variableName)==="undefined"){variableName="hasSingleFired";}
duration=duration||200;setTimeout(function(){pmc[variableName]=null;},duration);if(pmc.isVariableDefinedAndNonEmpty(pmc[variableName])){return true;}
pmc[variableName]=true;return false;};pmc.registryAddLegacy=function(eventObject){var sendObj={tealium_event:"registry_add"};var registryAddObject=pmc.decorateRegistryAddObject(eventObject,sendObj);pmc.fireLinkHit(registryAddObject);if(pmc.isNewMfe()){pmc.fakePageViewRegistryConfirm();}};pmc.decorateRegistryAddObject=function(eventObject,output){try{var eventData=eventObject.data;var registryAddObject=output||{};if(eventData.items&&eventData.items.item){var itemList=pmc.items.createItemList();registryAddObject.pmc_event16="event16";registryAddObject.registry_id=pmc.getNestedValue(eventData,"registry.registryId");registryAddObject.pmc_pageName="add item:add to registry";registryAddObject.pmc_prop1="add to registry";registryAddObject.pmc_prop5=registryAddObject.pmc_prop4=registryAddObject.pmc_prop3=registryAddObject.pmc_prop2="add item";registryAddObject.encoded_path_name=utag_data.encoded_path_name;for(var i=0,l=eventData.items.item.length;i<l;i++){var dataLayerItem=eventData.items.item[i];var item=itemList.addItem(dataLayerItem.groupId,dataLayerItem.sku);var itemQuantity=dataLayerItem.quantity;if(itemQuantity){registryAddObject.pmc_event211="event211";item.setEvent("event211",itemQuantity);var itemItemTotal=pmc.getTotalFromUnitsAndPrice(itemQuantity,dataLayerItem.price);if(itemItemTotal){registryAddObject.pmc_event212="event212";item.setEvent("event212",itemItemTotal);}}
if(dataLayerItem.merchBundle){item.setEvar("eVar133",dataLayerItem.merchBundle);}}
registryAddObject.pmc_products=itemList.adobeString();registryAddObject.product_id=itemList.getGroupIdArray();registryAddObject.product_unit_price=itemList.getVariableValues("event212");registryAddObject.product_quantity=itemList.getVariableValues("event211");registryAddObject.product_name=itemList.getProductNameArray();registryAddObject.product_sku=itemList.getSkuArray();}
eventData.tealium_event=registryAddObject.tealium_event;pmc.wsiTrackingEvent=pmc.wsiTrackingEventInit(window.WSI.tracking.wsiTracking,eventObject);return registryAddObject;}catch(e){pmc.logError(e);}};pmc.pageViewInternationalCheckout=function(){if(pmc.checkNestedValue(digitalData,"page.pageName","INTERNATIONAL ORDER CONFIRMATION")){utag_data.pmc_event58="event58";pmc.purchase();}else{utag_data.pmc_eVar4="international";}};pmc.setPageValuesFromDataLayer=function(){try{if(!window.digitalData){return"No Page Name";}
var urlPageData=pmc.getPageValuesFromURL(window.location);var primaryCategory=pmc.isNestedDataDefinedAndNonEmpty(digitalData,"page.pageCategory.primaryCategory")?digitalData.page.pageCategory.primaryCategory:"NoPrimaryCategory";var digitalDataPageName=pmc.isNestedDataDefinedAndNonEmpty(digitalData,"page.pageName")?digitalData.page.pageName.toLowerCase():"NoDigitalDataPageName";var fixAuditPageName=digitalDataPageName;if(digitalDataPageName.indexOf(primaryCategory)===0){fixAuditPageName=digitalDataPageName.replace(primaryCategory+":","").trim();}
fixAuditPageName=primaryCategory+":"+fixAuditPageName;var pageValues={setHierarchyVariables:function(pageData,urlPageData){var categories=[];urlPageData.sectionLevel2="shop";urlPageData.sectionLevel1="supercategory";if(pmc.checkNestedValue(pageData,"pageCategory.categories")){categories=pageData.pageCategory.categories;}else{categories=["none"];var err=new Error("Categories array missing");err.type="datalayer";pmc.logError(err);}
var isMobile=pmc.checkDataDefinedAndNonEmpty(digitalData.page.attributes,"mobile");utag_data._pathname1=isMobile?"m":"shop";utag_data._pathname2=isMobile?"shop":categories[0];utag_data._pathname3=isMobile?categories[0]:"";utag_data._pathname4=utag_data._pathname5=utag_data._pathname6="";urlPageData.merchandising1=urlPageData.merchandising2=urlPageData.merchandising3=categories[0];urlPageData.sectionLevel3=urlPageData.sectionLevel4=urlPageData.sectionLevel5="shop:"+categories[0];if(categories.length>1){urlPageData.sectionLevel1="category";utag_data._pathname3=isMobile?categories[0]:categories[1];utag_data._pathname4=isMobile?categories[1]:"";urlPageData.merchandising2=urlPageData.merchandising3=categories[0]+":"+categories[1];urlPageData.sectionLevel4=urlPageData.sectionLevel5="shop:"+urlPageData.merchandising2;}
if(categories.length>2){urlPageData.sectionLevel1="subcategory";utag_data._pathname4=isMobile?categories[1]:categories[2];utag_data._pathname5=isMobile?categories[2]:"";urlPageData.merchandising3=categories[0]+":"+categories[1]+":"+categories[2];urlPageData.sectionLevel5="shop:"+urlPageData.merchandising3;}
return urlPageData;},handleCollections:function(pageData){pageData.sectionLevel1+=":collections";return pageData;},setAdobeHierarchy:function(pageData,urlPageData){urlPageData=pageValues.setHierarchyVariables(pageData,urlPageData);if(pmc.checkNestedValue(digitalData,"page.attributes.template","collections")){urlPageData=pageValues.handleCollections(urlPageData);}
utag_data.pmc_eVar1=urlPageData.merchandising1;utag_data.pmc_eVar2=urlPageData.merchandising2;utag_data.pmc_eVar3=urlPageData.merchandising3;utag_data.pmc_prop1=urlPageData.sectionLevel1;utag_data.pmc_prop2=urlPageData.sectionLevel2;utag_data.pmc_prop3=urlPageData.sectionLevel3;utag_data.pmc_prop4=urlPageData.sectionLevel4;utag_data.pmc_pageName=utag_data.pmc_prop5=urlPageData.sectionLevel5;return utag_data.pmc_pageName;},filterOnPageName:function(){var pageName="";if(fixAuditPageName){var pageNameMap={"sign in":"account:login","checkout sign in":"signin","order confirmation":"order confirmation","manage registry: create":"create-registry-confirmation"};pageName=pageNameMap[fixAuditPageName];}
return pageName;},pageObjectMap:[{triggerType:"function",getRootValue:function(){if(window.location.pathname==="/"||window.location.pathname==="/m/"){return"home page"}
return false;}},{triggerType:"dd",pageType:primaryCategory,expectedValue:"shop",getRootValue:function(){return pageValues.setAdobeHierarchy(digitalData.page,urlPageData);}},{triggerType:"dd",pageType:primaryCategory,expectedValue:"shoppingcart",getRootValue:function(){return"shopping cart";}},{triggerType:"dd",pageType:primaryCategory,expectedValue:"products",getRootValue:function(){return"product detail:"+(pmc.getNormalProdId(digitalData.product));}},{triggerType:"dd",pageType:primaryCategory,expectedValue:"checkout",getRootValue:function(){return pmc.getNestedStringValue(digitalData,"page.pageName").toLowerCase();}},{triggerType:"dd",pageType:primaryCategory,expectedValue:"favorites",getRootValue:function(){return pmc.getNestedStringValue(digitalData,"page.pageName").toLowerCase();}},{triggerType:"function",getRootValue:function(){return pageValues.filterOnPageName();}}]}
var digitalDataDerivedPageName="";var objectMap=pageValues.pageObjectMap;for(var i=0;i<objectMap.length;i++){var thisObject=objectMap[i];if(thisObject.triggerType==="function"||(thisObject.triggerType==="dd"&&thisObject.pageType===thisObject.expectedValue)){digitalDataDerivedPageName=thisObject.getRootValue();}
if(digitalDataDerivedPageName){break;}}
utag_data.fixAuditPageName=digitalDataDerivedPageName||fixAuditPageName;utag_data.digitalDataPageName=digitalDataPageName;return digitalDataDerivedPageName;}catch(e){pmc.logError(e);}};pmc.getPageName=function(){try{var _pname=[];var _ptype="";var _siteSection="";var _superCategory="";var _category="";var _subCategory="";var _eVar1="";var _eVar2="";var _eVar3="";var registryIDFromUrl="";var i=0;var pathName="";var pageCategory=pmc.getNestedValue(digitalData,"page.pageCategory",{});var primaryCategory=pmc.getNestedStringValue(pageCategory,"primaryCategory").toLowerCase();pmc.pageName=pmc.getNestedStringValue(digitalData,"page.pageName");if(primaryCategory==="registry"){if(window.location.pathname.match(/\/shoppingcart/)!=null){registryIDFromUrl=window.location.pathname.match(/\/shoppingcart\/[A-Za-z0-9]+\//).toString().replace(/\/shoppingcart\//g,"").replace(/\//g,"");}else if(window.location.pathname.match(/\/registry\/[A-Za-z0-9]+\//)!=null){registryIDFromUrl=window.location.pathname.match(/\/registry\/[A-Za-z0-9]+\//).toString().replace(/\/registry\//g,"").replace(/\//g,"");}}
utag_data.registry_id=pmc.getNestedValue(digitalData,"page.attributes.registryStoreId");for(i=1;typeof utag_data["_pathname"+i.toString()]!="undefined";i++){if(utag_data["_pathname"+i.toString()].toLowerCase()!="m"&&utag_data["_pathname"+i.toString()]!=""&&utag_data["_pathname"+i.toString()]!=registryIDFromUrl){pathName=utag_data["_pathname"+i.toString()];_pname.push(pathName.split(".")[0]);}}
if(typeof _pname[1]!=="undefined"){_ptype="supercategory";_siteSection=_pname[0];_superCategory=_category=_subCategory=_pname[0]+":"+_pname[1];_eVar1=_eVar2=_eVar3=_pname[1];}else{if(primaryCategory){_ptype=primaryCategory.toLowerCase();}
if(_pname.length===0){_pname.push("");}
_siteSection=_superCategory=_category=_subCategory=_pname[0];}
if(_pname.length>=3){_ptype="category";_siteSection=_pname[0];_superCategory=_pname[0]+":"+_pname[1];_category=_subCategory=_pname[0]+":"+_pname[1]+":"+_pname[2];_eVar2=_eVar3=_pname[1]+":"+_pname[2];}
if(_pname.length>=4){_ptype="subcategory";_siteSection=_pname[0];_superCategory=_pname[0]+":"+_pname[1];_category=_pname[0]+":"+_pname[1]+":"+_pname[2];_subCategory=_pname[0]+":"+_pname[1]+":"+_pname[2]+":"+_pname[3];_eVar2=_pname[1]+":"+_pname[2];_eVar3=_pname[1]+":"+_pname[2]+":"+_pname[3];}
if(primaryCategory==="shop"){utag_data.pmc_prop1=pmc.removeHTML(_ptype).toLowerCase();}else{utag_data.pmc_prop1=primaryCategory||_siteSection;}
utag_data.pmc_prop2=pmc.removeHTML(_siteSection).toLowerCase();utag_data.pmc_prop3=pmc.removeHTML(_superCategory).toLowerCase();utag_data.pmc_prop4=pmc.removeHTML(_category).toLowerCase();utag_data.pmc_prop5=pmc.removeHTML(_subCategory).toLowerCase();if(pmc.arrayContains(["shop","room","gift","the-key","tips-and-ideas"],primaryCategory)){utag_data.pmc_eVar1=pmc.removeHTML(_eVar1).toLowerCase();utag_data.pmc_eVar2=pmc.removeHTML(_eVar2).toLowerCase();utag_data.pmc_eVar3=pmc.removeHTML(_eVar3).toLowerCase();if(primaryCategory==="room"){utag_data.pmc_eVar2="room:"+utag_data.pmc_eVar2;utag_data.pmc_eVar3="room:"+utag_data.pmc_eVar3;}}else{utag_data.pmc_eVar1="";utag_data.pmc_eVar2="";utag_data.pmc_eVar3="";}
_pname=[];for(i=1;typeof utag_data["_pathname"+i.toString()]!=="undefined";i++){if(utag_data["_pathname"+i.toString()].toLowerCase()!="m"&&utag_data["_pathname"+i.toString()]!=""&&utag_data["_pathname"+i.toString()]!=registryIDFromUrl){pathName=utag_data["_pathname"+i.toString()];_pname.push(pathName.split(".")[0]);}}
if((primaryCategory==="recipe")&&(utag_data.pmc_prop1==="pages"||utag_data.pmc_prop2=="pages")){utag_data.pmc_prop1=utag_data.pmc_prop2=utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5="recipe";}
if(primaryCategory==="recipe"&&((pmc.isArray(pageCategory.categories)&&pageCategory.categories[0]==="search")||typeof pageCategory.categories==="undefined")){utag_data.pmc_eVar9="recipe";if(pmc.checkNestedValue(digitalData,"page.attributes.recipeViewEvent",true)){utag_data.pmc_event57="event57";utag_data.pmc_prop1=utag_data.pmc_prop2=utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5="recipe detail";}}
if(primaryCategory==="registry"&&pmc.removeHTML(_pname.join(":")).toLowerCase()==="shoppingcart:confirmation"){utag_data.pmc_prop1="add to cart";utag_data.pmc_prop2=utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5="add item";return("add item:add to cart");}
if(_pname[0]&&_pname[0].toLowerCase()==="netstorage"){utag_data.pmc_prop1=utag_data.pmc_prop2="error page";utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5=utag_data.pmc_pageName=pmc.pageName="error page:"+_pname[1].toLowerCase();return utag_data.pmc_pageName;}
if(pmc.stringContains(pmc.pageName.toLowerCase(),"favorites")){utag_data.pmc_pageName=pmc.pageName=utag_data.pmc_prop4=utag_data.pmc_prop5=pmc.getNestedValue(digitalData,"page.pageName");return pmc.pageName;}
var returnName=pmc.removeHTML(_pname.join(":")).toLowerCase();if(pmc.stringContains(returnName,"sitemap")){utag_data.pmc_prop1="sitemap";}
if(pmc.checkNestedValue(digitalData,"page.pageName","account:forgotpassword:thankyou")){returnName=digitalData.page.pageName;}
if(utag_data.page_name==="registry:search-registry-results"){returnName="registry:search-registry-link-account";}
if(utag_data.page_name==="registry:find-registry"){returnName="registry:find-registry-results";}
return returnName;}catch(e){pmc.logError(e);return"Page Name Error: "+e.message;}};pmc.getItemsArrayFromXCart=function(){var orders=pmc.getNestedValue(digitalData,"x_cart.orders");if(orders&&orders.length>0){return orders[0].items;}else{return[];}};pmc.cartAddFromService=function(){var _parseItem=function(itemString){var errObj;var item={};var parts=itemString.split("x");if(parts.length===1){item.quantity=1;item.sku=parts[0];}else if(parts.length===2){item.quantity=parseInt(parts[0]);item.sku=parts[1];}else{errObj=new Error("Invalid cart share item string");errObj.type="datalayer";errObj.data="item="+itemString;pmc.logError(errObj);return;}
if(pmc.stringContains(item.sku,"-")){item.sku=item.sku.split("-")[1];}
if(item.quantity>0&&item.sku.length>0){return item;}};var _getItemsFromQueryString=function(){var outputList=[];var item;var itemStrings=pmc.getQueryStringValue("items").split(",");for(var i=0,len=itemStrings.length;i<len;i++){item=_parseItem(itemStrings[i]);if(item&&item.sku&&item.quantity){outputList.push(item);}}
return outputList;};var _getItemIfInCart=function(item,itemsFromDataLayer){for(var i=0,len=itemsFromDataLayer.length;i<len;i++){if(item.sku===pmc.normalizeProductIdObject(itemsFromDataLayer[i]).sku){return itemsFromDataLayer[i];}}};var _getCartShareItems=function(itemsFromQueryString){var itemList=pmc.items.createItemList();var itemsFromDataLayer=pmc.getItemsArrayFromXCart();var dataLayerItem;var newItem;var quantity;var unitPrice;var itemTotal;for(var i=0,len=itemsFromQueryString.length;i<len;i++){dataLayerItem=_getItemIfInCart(itemsFromQueryString[i],itemsFromDataLayer);if(dataLayerItem){newItem=itemList.addItem(pmc.getNormalProdId(dataLayerItem),pmc.normalizeProductIdObject(dataLayerItem).sku);newItem=pmc.setShipmentDates(newItem,dataLayerItem,utag_data);if(dataLayerItem.attributes.itemType==="swatch"){newItem.setAsSwatch();if(dataLayerItem.price.unitPrice){utag_data=newItem.setEvent("event368",1,utag_data);}else{utag_data=newItem.setEvent("event367",1,utag_data);}}else{utag_data.pmc_scAdd="scAdd";quantity=itemsFromQueryString[i].quantity;unitPrice=pmc.getNestedValue(dataLayerItem,"price.unitPrice");newItem.setUnitPrice(unitPrice);utag_data=newItem.setEvent("event11",quantity,utag_data);utag_data=newItem.setEvent("event69",quantity,utag_data);itemTotal=pmc.getTotalFromUnitsAndPrice(quantity,unitPrice);utag_data=newItem.setEvent("event12",itemTotal,utag_data);utag_data=newItem.setEvent("event70",itemTotal,utag_data);if(pmc.getNestedValue(dataLayerItem,"attributes.readyToShip.aoddStart")&&pmc.checkNestedValue(dataLayerItem,"attributes.readyToShip.status","BackOrdered")){dataLayerItem=newItem.setBackOrderFromDate(dataLayerItem.attributes.readyToShip.aoddStart,utag_data);utag_data=newItem.setEvent("event167",1,utag_data);}else{utag_data=newItem.setBackOrderFromComponent(utag_data);}}}}
return itemList;};try{var itemsFromQueryString=_getItemsFromQueryString();if(itemsFromQueryString.length===0||!pmc.checkNestedValue(digitalData,"x_cart.attributes.itemCount")){return;}
var itemList=_getCartShareItems(itemsFromQueryString);if(itemList.length()===0){return;}
if(pmc.getQueryStringValue("cm_src").toLowerCase()==="cartshare"||pmc.getQueryStringValue("cartshare").toLowerCase()==="true"){utag_data.pmc_event104="event104";}else if(pmc.getQueryStringValue("cm_src").toLowerCase()==="productlist"){utag_data.pmc_event105="event105";}else if(pmc.getQueryStringValue("cm_src").toLowerCase()==="atcct"){utag_data.pmc_event103="event103";}else if(pmc.getQueryStringValue("showroom").toLowerCase()==="true"){utag_data.pmc_event106="event106";}
utag_data.pmc_eVar58="";utag_data.pmc_event50="";utag_data.pmc_event99="";if(pmc.isMobile&&!pmc.checkNestedValue(utag_data,"pmc_eVar18")&&!pmc.checkNestedValue(utag_data,"pmc_prop18")){utag_data.pmc_eVar18="mobile site";utag_data.pmc_prop18="mobile site";}
utag_data=pmc.setEcommerceFromProductList(itemList,utag_data);}catch(e){e.data="items="+pmc.getQueryStringValue("items");pmc.logError(e);}};pmc.setShipmentDates=function(trackingItem,dataLayerItem,output){var startDate="";var endDate="";var startDays=0;var endDays=0;var readyToShip=pmc.getNestedValue(dataLayerItem,"attributes.readyToShip");var aoddDateLogic=pmc.getNestedValue(dataLayerItem,"attributes.aoddDateLogic");if(readyToShip){if(readyToShip.noEstimateMsg&&readyToShip.noEstimateErrorMsg){output.pmc_prop23=readyToShip.noEstimateMsg;output=trackingItem.setEvent("event168",1,output);}
if(readyToShip.aoddStart){output=trackingItem.setEvent("event160",1,output);startDate=readyToShip.aoddStart;endDate=readyToShip.aoddEnd;}else if(readyToShip.ecddStart){output=trackingItem.setEvent("event161",1,output);startDate=readyToShip.ecddStart;endDate=readyToShip.ecddEnd;}
if(startDate&&endDate){startDays=pmc.getDaysBetweenDateAndToday(startDate);endDays=pmc.getDaysBetweenDateAndToday(endDate);output=trackingItem.setEvent("event163",startDays,output);output=trackingItem.setEvent("event164",endDays,output);trackingItem.setEvar("eVar66",startDays);trackingItem.setEvar("eVar67",endDays);trackingItem.setEvar("eVar69",""+startDate);trackingItem.setEvar("eVar70",""+endDate);}
trackingItem.setEvar("eVar45",readyToShip.status||"");}
if(aoddDateLogic){trackingItem.setEvar("eVar101",aoddDateLogic.algorithm);if(aoddDateLogic.algorithm==="ECA Date Used"){output=trackingItem.setEvent("event369",aoddDateLogic.daysDifference,output);output=trackingItem.setEvent("event370",0,output);}else if(aoddDateLogic.algorithm==="TD Date Used"){output=trackingItem.setEvent("event369",0,output);output=trackingItem.setEvent("event370",aoddDateLogic.daysDifference,output);}else{output=trackingItem.setEvent("event369",0,output);output=trackingItem.setEvent("event370",0,output);}}
return trackingItem;};pmc.getLegacyCheckOutShipmentDates=function(trackingItem,dataLayerItem){var shipmentInfo={startDate:new Date(),endDate:new Date(),startDays:0,endDays:0,noEstimateMsg:"",noEstimateErrorMsg:""}
if(pmc.isNestedDataDefinedAndNonEmpty(dataLayerItem,"attributes.readyToShip")){var readyToShip=dataLayerItem.attributes.readyToShip;}else{return false;}
if(pmc.checkDataDefinedAndNonEmpty(readyToShip,"noEstimateMsg")&&pmc.checkDataDefinedAndNonEmpty(readyToShip,"noEstimateErrorMsg")){shipmentInfo.noEstimateMsg=readyToShip.noEstimateMsg;shipmentInfo.noEstimateErrorMsg=readyToShip.noEstimateErrorMsg;utag_data.pmc_prop23=shipmentInfo.noEstimateMsg;utag_data.pmc_event168="event168";trackingItem.addPurchaseIncrementorEvent("event168",1);}
if(pmc.checkDataDefinedAndNonEmpty(readyToShip,"aoddStart")){trackingItem.pmc_event160=utag_data.pmc_event160="event160";trackingItem.addPurchaseIncrementorEvent("event160",1);shipmentInfo.startDate=readyToShip.aoddStart;}else if(pmc.checkDataDefinedAndNonEmpty(readyToShip,"ecddStart")){trackingItem.pmc_event161=utag_data.pmc_event161="event161";trackingItem.addPurchaseIncrementorEvent("event161",1);shipmentInfo.startDate=readyToShip.ecddStart;}else{return false;}
if(pmc.checkDataDefinedAndNonEmpty(readyToShip,"aoddEnd")){shipmentInfo.endDate=readyToShip.aoddEnd;}else if(pmc.checkDataDefinedAndNonEmpty(readyToShip,"ecddEnd")){shipmentInfo.endDate=readyToShip.ecddEnd;}else{return false;}
shipmentInfo.startDate=new Date(shipmentInfo.startDate);shipmentInfo.endDate=new Date(shipmentInfo.endDate);var now=new Date();shipmentInfo.startDays=pmc.getDaysBetweenEvents(shipmentInfo.startDate,now);shipmentInfo.endDays=pmc.getDaysBetweenEvents(shipmentInfo.endDate,now);if(!shipmentInfo.startDays||!shipmentInfo.endDays){var errObj=new Error("shipmentInfo missing data");errObj.type="datalayer";pmc.logError(errObj);}
trackingItem.pmc_event163=utag_data.pmc_event163="event163";trackingItem.addPurchaseIncrementorEvent("event163",shipmentInfo.startDays);trackingItem.pmc_event164=utag_data.pmc_event164="event164";trackingItem.addPurchaseIncrementorEvent("event164",shipmentInfo.endDays);if(pmc.isVariableDefinedAndNonEmpty(readyToShip.status)){trackingItem.addPurchaseMerchandisingEvar("eVar45",readyToShip.status);}
trackingItem.addPurchaseMerchandisingEvar("eVar66",shipmentInfo.startDays);trackingItem.addPurchaseMerchandisingEvar("eVar67",shipmentInfo.endDays);return true;};pmc.cartPageView=function(xcart,output){try{output=output||utag_data;output.pmc_prop1=pmc.originalPageType=output.pmc_prop2=output.pmc_prop3=output.pmc_prop4=output.pmc_prop5="shopping cart";output.pmc_pageName=pmc.originalPageName="shopping cart";var itemList=pmc.items.createItemList();var order;if(pmc.checkNestedValue(xcart,"orders")&&pmc.isArray(xcart.orders)){order=xcart.orders[0];}else{return output;}
if(!pmc.isArray(order.items)){return output;}
var groupId;var dataLayerItem;var newItem;var sku;var isSwatchItem;var isSwatchOnlyOrder=true;for(var i=0,l=order.items.length;i<l;i++){dataLayerItem=order.items[i];if(!pmc.checkNestedValue(dataLayerItem,"productID")){var e=new Error("No productID in data layer item");e.type="datalayer";pmc.logError(e);continue;}
groupId=dataLayerItem.productID.persistentProdID||dataLayerItem.productID.primaryProdID||dataLayerItem.productID.prodID;sku=pmc.getNestedValue(dataLayerItem,"productID.sku");newItem=itemList.addItem(groupId,sku);if(pmc.checkNestedValue(dataLayerItem,"attributes.readyToShip")){newItem=pmc.setShipmentDates(newItem,dataLayerItem,output);output.pmc_zip=pmc.getNestedValue(dataLayerItem,"attributes.readyToShip.postalCode");}
isSwatchItem=pmc.checkNestedValue(dataLayerItem,"attributes.itemType","swatch");if(!isSwatchItem){isSwatchOnlyOrder=false;}
if(!isSwatchItem&&dataLayerItem.quantity&&pmc.checkNestedValue(dataLayerItem,"price.unitPrice")){output=newItem.setEvent("event69",dataLayerItem.quantity,output);output=newItem.setEvent("event70",pmc.getTotalFromUnitsAndPrice(dataLayerItem.quantity,dataLayerItem.price.unitPrice),output);newItem.setUnitPrice(dataLayerItem.price.unitPrice);newItem.setDiscount(dataLayerItem.price.merchDiscount);}
if(pmc.checkNestedValue(dataLayerItem,"cartSmartBundle.enabled")){output=newItem.setEvent("event208",1,output);}
if(pmc.getNestedValue(dataLayerItem,"attributes.readyToShip.aoddStart")&&pmc.checkNestedValue(dataLayerItem,"attributes.readyToShip.status","BackOrdered")){output=newItem.setBackOrderFromDate(dataLayerItem.attributes.readyToShip.aoddStart,output);}else{output=newItem.setBackOrderFromComponent(output);}
newItem.setEvar("eVar114",dataLayerItem.clearanceType);if(dataLayerItem.clearanceType&&dataLayerItem.clearanceType!=="non-clearance sku"){output=newItem.setEvent("event420",1,output);}}
output=pmc.setEcommerceFromProductList(itemList,output);if(!isSwatchOnlyOrder){output.pmc_scView="scView";output.pmc_event78=pmc.getMerchTotal();}
return output;}catch(err){err.data="groupId="+groupId;pmc.logError(err);}};pmc.getReportSuite=function(environment){try{if(!environment){return"wsidefaultdev";}
var account="wsi";var brand=environment.brandCode.toLowerCase();var reportSuiteMarket=pmc.getNestedStringValue(environment,"reportSuiteMarket").toLowerCase();var appIdentifier=environment.appIdentifier.toLowerCase();var nonUsMarket="";var adobeEnvironment=(environment.tealiumEnvironment==="prod")?"production":"dev";if(reportSuiteMarket&&reportSuiteMarket!=="us"){nonUsMarket=reportSuiteMarket;}
if(appIdentifier==="shoppingapp"&&adobeEnvironment==="production"){appIdentifier="";}
return account+brand+nonUsMarket+appIdentifier+adobeEnvironment;}catch(e){pmc.logError(e);}};pmc.addFabricFilterVariables=function(item,eventData,cartAddObj){var conversion={};var swatchFilters=eventData.swatchFilters;var featuresCount=parseInt(swatchFilters.featuresSelected);var colorsCount=parseInt(swatchFilters.colorsSelected);var fabricsCount=parseInt(swatchFilters.fabricsSelected);if(!featuresCount&&!colorsCount&&!fabricsCount){return;}
if(featuresCount){cartAddObj.fabricFeatures=featuresCount;conversion["Fabric Features"]=featuresCount;}
if(colorsCount){cartAddObj.fabricColors=colorsCount;conversion["Color"]=colorsCount;}
if(fabricsCount){cartAddObj.fabrics=fabricsCount;conversion["Fabric"]=fabricsCount;}
cartAddObj.pmc_event309="event309";var eVar86Value=pmc.orderValidKeys(conversion,["Fabric Features","Color","Fabric"]).join("_");item.setEvar("eVar86",eVar86Value);};pmc.handlePrescreenedCreditCard=function(eventData){var sendObject={};var bannerType=pmc.getNestedValue(eventData,"prescreenedCreditCardBanner");var item=pmc.getNestedValue(eventData,"item","");if(item==="banner click"){sendObject.tealium_event="credit_card_banner_click";sendObject.pmc_eVar106="prescreen credit banner "+bannerType;pmc.fireLinkHit(sendObject);return;}};pmc.handleAvailability=function(eventData){var sendObject={};var dataLayerProduct=eventData.product;var productList=pmc.items.createItemList();var productItem=productList.addItemFromObject(dataLayerProduct);var item=pmc.getNestedLowerCaseValue(eventData,"item");productItem=pmc.setShipmentDates(productItem,dataLayerProduct,sendObject);if(item==="backorder notice"){sendObject.tealium_event="availability_backorder";sendObject=productItem.setEvent("event166",1,sendObject);if(pmc.getNestedValue(dataLayerProduct,"attributes.readyToShip.aoddStart")){sendObject=productItem.setBackOrderFromDate(dataLayerProduct.attributes.readyToShip.aoddStart,sendObject);}}else if(item==="nla notice"){sendObject.tealium_event="availability_nla";sendObject=productItem.setEvent("event165",1,sendObject);}else if(item==="in-stock notice"){sendObject.tealium_event="availability_instock";sendObject=productItem.setEvent("event162",1,sendObject);}else{return;}
sendObject.pmc_products=productItem.adobeString();sendObject.product_id=productList.getGroupIdArray();sendObject.product_availability=productList.getAvailabilityArray();pmc.fireLinkHit(sendObject);};pmc.handleCartEvents=function(eventData){try{var eventItem=pmc.getNestedLowerCaseValue(eventData,"item");if(eventItem==="remove"){var productList=pmc.items.createItemList();var eventProducts=eventData.products;var eventProductsLen=eventProducts.length;var item;var sendObject={};var groupId="";var sku="";for(var i=0;i<eventProductsLen;i++){var currentItem=eventProducts[i];sku=pmc.getNestedValue(currentItem,"sku","");groupId=pmc.getNestedValue(currentItem,"groupId","")
item=productList.addItem(groupId,sku);if(currentItem.itemType==="swatch"){item.setAsSwatch();sendObject=item.setEvent("event398",1,sendObject);}else{sendObject=item.setEvent("event169",currentItem.quantity,sendObject);sendObject=item.setEvent("event170",currentItem.price,sendObject);}}
if(!productList.hasNonSwatches()){sendObject.tealium_event="cart_remove_swatch_only";}else{sendObject.tealium_event="cart_remove";sendObject.pmc_scRemove="scRemove";}
sendObject.pmc_products=productList.adobeString();pmc.fireLinkHit(sendObject);return;}
if(eventItem==="share shopping cart"){pmc.fireLinkHit({tealium_event:"cart_share",link_text:"cart: share shopping cart",});return;}}catch(e){pmc.logError(e);}};pmc.setEcommerceFromProductList=function(itemList,output){output.pmc_products=itemList.adobeString();output.product_id=itemList.getGroupIdArray();output.product_unit_price=itemList.getUnitPriceArray();output.product_quantity=itemList.getUnitsArray();output.product_name=itemList.getProductNameArray();output.product_sku=itemList.getSkuArray();output.product_discount=itemList.getDiscountArray();output.product_discounted_price=itemList.getDiscountedPriceArray();output.product_category=itemList.getCategoryArray();output.subtotal_price=itemList.getSubtotalPrice();return output;};pmc.cartAdd=function(a,b,c){var categoryArray=pmc.getNestedValue(digitalData,"product.productCategory.categories");try{if(pmc.suppressDoubleFire("addToCartFired")){return true;}
if(b.data.items&&b.data.items.item){if(typeof(window.__attentive)!=="undefined"&&typeof(window.__attentive.handleAddToCart)==="function"){window.__attentive.handleAddToCart(b);}
var itemList=pmc.items.createItemList();var cartAddObj={pmc_pageName:"add item:add to cart",pmc_event111:"",pmc_prop23:"",pmc_event168:"",encoded_path_name:utag_data.encoded_path_name,has_non_swatches:false,};utag_data.pmc_prop23="";cartAddObj.sc_visitor_id=utag_data.sc_visitor_id;cartAddObj.pmc_eVar9=b.data.productFindingMethod||b.data.ProductSuggestionPFM||"";if(pmc.checkNestedValue(b.data,"ProductSuggestionImpression","SmartBundle:RAC")){cartAddObj.pmc_event216="event216";}
if(pmc.checkNestedValue(b.data,"ProductSuggestionPFM","SmartBundleSubsequentCartAdd:RAC")){cartAddObj.pmc_event316="event316";cartAddObj.pmc_eVar9="SmartBundle:RAC";}
if(pmc.checkNestedValue(b.data,"inStockFilterSelected")){cartAddObj.pmc_event383="event383";}
if(cartAddObj.pmc_eVar9==="Smart Bundle:CART"){cartAddObj.pmc_eVar9="SmartBundle:CART";}
if(cartAddObj.pmc_eVar9==="SmartBundle:CART"&&pmc.stringContains(document.referrer,"shoppingcart")){cartAddObj.pmc_event316="event316";}
if(pmc.checkNestedValue(b.data,"sourceLocation","product recs configurable thumbnail")){cartAddObj.pmc_event443="event443";}
var eventItems=b.data.items.item;var eventItemsLen=eventItems.length;for(var i=0;i<eventItemsLen;i++){var currentItem=eventItems[i];var groupId=currentItem.persistentProductId||currentItem.groupId||currentItem.primaryProductId;var primaryGroupId=currentItem.primaryProductId||currentItem.groupId;var newItem=itemList.addItem(groupId,currentItem.sku);var shipToStore={};var storeBrand="";if(cartAddObj.pmc_eVar9==="SmartBundle:RAC"){newItem.setEvar("eVar58","persistent");}else if(currentItem.persistentProductId){newItem.setEvar("eVar58","persistent");}else if(pmc.arrayContains(pmc.getNestedValue(digitalData,"product.attributes.persistentIDs"),currentItem.groupId)){newItem.setEvar("eVar58","persistent");}else{newItem.setEvar("eVar58","primary");}
if(pmc.getNestedStringValue(currentItem,"attributes.itemType")==="swatch"){newItem.setEvar("eVar58","swatch");cartAddObj.tealium_event="cart_add_swatch_only";if(currentItem.price){cartAddObj=newItem.setEvent("event368",1,cartAddObj);}else{cartAddObj=newItem.setEvent("event367",1,cartAddObj);}}else{cartAddObj.has_non_swatches=true;cartAddObj.pmc_scAdd="scAdd";cartAddObj.tealium_event="cart_add";newItem.setUnitPrice(currentItem.price);cartAddObj=newItem.setEvent("event11",currentItem.quantity,cartAddObj);cartAddObj=newItem.setEvent("event69",currentItem.quantity,cartAddObj);var itemTotal=pmc.getTotalFromUnitsAndPrice(currentItem.quantity,currentItem.price);cartAddObj=newItem.setEvent("event12",itemTotal,cartAddObj);cartAddObj=newItem.setEvent("event70",itemTotal,cartAddObj);}
newItem.setProductName(currentItem.productName);cartAddObj.pmc_eVar63=utag_data.pmc_eVar63||cartAddObj.pmc_eVar63||primaryGroupId;newItem=pmc.setShipmentDates(newItem,currentItem,cartAddObj);if(currentItem.backOrder){cartAddObj=newItem.setBackOrderFromDate(currentItem.backOrder,cartAddObj);cartAddObj=newItem.setEvent("event167",1,cartAddObj);}
if(pmc.checkNestedValue(currentItem,"porchInstallationService")){if(currentItem.porchInstallationService!=="false"){cartAddObj=newItem.setEvent("event99",1,cartAddObj);}}
if(pmc.isNonEmptyString(pmc.pageName)){if(pmc.stringContains(pmc.pageName.toLowerCase(),"registry")){cartAddObj.pmc_event173="event173";}}
if(pmc.checkNestedValue(b.data,"swatchFilters")){pmc.addFabricFilterVariables(newItem,b.data,cartAddObj);}
if(currentItem.pickupLocationCode){cartAddObj.pmc_event111="event111";newItem.setEvent("event111");newItem.setEvar("eVar95",currentItem.pickupLocationCode);newItem.setEvar("eVar97","bopis");newItem.setEvar("eVar103","non-BOSTS");}else if(pmc.checkNestedValue(currentItem,"shipToStoreLocationCode")){cartAddObj.pmc_event301="event301";newItem.setEvent("event301");newItem.setEvar("eVar95",currentItem.shipToStoreLocationCode);newItem.setEvar("eVar97","bosts");}else if(pmc.checkNestedValue(currentItem,"shipToStore")){shipToStore=pmc.getNestedValue(currentItem,"shipToStore",{});storeBrand=pmc.getNestedLowerCaseValue(shipToStore,"storeBrand");newItem.setEvar("eVar103",storeBrand);newItem.setEvar("eVar95",shipToStore.storeId);newItem.setEvent("event301");cartAddObj.pmc_event301="event301";newItem.setEvar("eVar97","bosts");}else{newItem.setEvar("eVar95","non-store");newItem.setEvar("eVar103","non-BOSTS");newItem.setEvar("eVar97","ship");}
if(currentItem.merchBundle){newItem.setEvar("eVar133",currentItem.merchBundle);}
if(pmc.checkNestedValue(currentItem,"attributes.splitPip")){newItem.setEvar("eVar87",currentItem.attributes.splitPip);var productType=newItem.getEvar("eVar58");if(productType&&productType==="persistent"){newItem.setEvar("eVar87","non-featured");}}
newItem.setEvar("eVar150","no personalization applied");if(pmc.checkNestedValue(currentItem,"monogram.monogramSeq")){for(var j=0,l=currentItem.monogram.monogramSeq.length;j<l;j++){if(currentItem.monogram.monogramSeq[j].monogramDetails!=="No"){cartAddObj.pmc_event50="event50";newItem.setEvar("eVar150","personalization applied");break;}}}
if(pmc.checkNestedValue(currentItem,"allstateProtectionPlan",true)){cartAddObj=newItem.setEvent("event416",currentItem.quantity,cartAddObj);}
if(pmc.checkNestedValue(currentItem,"attributes.smartAddOns")){newItem.setEvar("eVar122","pip add-on");}else{newItem.setEvar("eVar122","non add-on");}
newItem.setEvar("eVar114",currentItem.clearanceType);if(currentItem.clearanceType&&currentItem.clearanceType!=="non-clearance sku"){cartAddObj=newItem.setEvent("event420",1,cartAddObj);}}
cartAddObj=pmc.setEcommerceFromProductList(itemList,cartAddObj);cartAddObj.pmc_event160=cartAddObj.pmc_event160||utag_data.pmc_event160||"";cartAddObj.pmc_event161=cartAddObj.pmc_event161||utag_data.pmc_event161||"";cartAddObj.pmc_event163=cartAddObj.pmc_event163||utag_data.pmc_event163||"";cartAddObj.pmc_event164=cartAddObj.pmc_event164||utag_data.pmc_event164||"";cartAddObj.pmc_event168=cartAddObj.pmc_event168||utag_data.pmc_event168||"";var itemCountBeforeCartAdd;var potentialItemsInMfe=parseInt(pmc.getNestedValue(b.data,"itemsBeforeCartAdd"));if(!isNaN(potentialItemsInMfe)){itemCountBeforeCartAdd=potentialItemsInMfe;}else{itemCountBeforeCartAdd=pmc.getNestedValue(digitalData,"x_cart.attributes.itemCount");}
if((itemCountBeforeCartAdd===0||b.data.items.item.length==itemCountBeforeCartAdd)&&cartAddObj.has_non_swatches){cartAddObj.pmc_scOpen="scOpen";}
cartAddObj.link_text=pmc.getNestedValue(window.WSI,"adobeTnt.cartAddVariant");pmc.releaseThread(function(){pmc.fireLinkHit(cartAddObj);utag_data.pmc_event160="";utag_data.pmc_event161="";utag_data.pmc_event163="";utag_data.pmc_event164="";if(pmc.isNewMfe()){pmc.fakePageViewAddToCart();}},5);if(pmc.isArray(categoryArray)){b.category_path=categoryArray;b.page_section1=categoryArray[0];b.page_sectionEnd=categoryArray[categoryArray.length-1];}
b.data.tealium_event="cart_add";pmc.wsiTrackingEvent=pmc.wsiTrackingEventInit(window.WSI.tracking.wsiTracking,b.data);}}catch(e){pmc.logError(e);}};pmc.cartEvent=function(cartEventData){try{if(pmc.checkNestedValue(cartEventData,"item")&&pmc.checkNestedValue(cartEventData,"groupId")){var sendObject={};var groupId=cartEventData.persistentProductId||cartEventData.primaryProductId||cartEventData.groupId;var sku=cartEventData.SKU;var item=pmc.items.createItem(groupId,sku);var unitPrice;var units;var totalRevenue;if(cartEventData.item==="updateCartAmount"){unitPrice=parseFloat(cartEventData.unitPrice)+parseFloat(cartEventData.unitSurcharge);units=pmc.getIntegerDifference(cartEventData.updatedQuantity,cartEventData.quantity);totalRevenue=Math.abs(pmc.getTotalFromUnitsAndPrice(units,unitPrice));if(units>0){if(pmc.checkNestedValue(cartEventData,"attributes.itemType","swatch")){sendObject.tealium_event="cart_add_swatch_only";if(totalRevenue>0){sendObject=item.setEvent("event368",1,sendObject);}}else{sendObject.tealium_event="cart_add";sendObject.pmc_scAdd="scAdd";sendObject=item.setEvent("event11",units,sendObject);sendObject=item.setEvent("event12",totalRevenue,sendObject);sendObject=item.setEvent("event69",units,sendObject);sendObject=item.setEvent("event70",totalRevenue,sendObject);}}else if(units<0){if(pmc.checkNestedValue(cartEventData,"attributes.itemType","swatch")){sendObject.tealium_event="cart_remove_swatch_only";sendObject=item.setEvent("event398",1,sendObject);}else{units=Math.abs(units);sendObject.tealium_event="cart_remove";sendObject.pmc_scRemove="scRemove";sendObject=item.setEvent("event169",units,sendObject);sendObject=item.setEvent("event170",totalRevenue,sendObject);}}else if(units===null){var e=new Error("Invalid cart update quantity");e.data="quantity="+cartEventData.quantity+"|updatedQuantity="+cartEventData.updatedQuantity;e.type="datalayer";pmc.logError(e);}}else if(cartEventData.item==="addFromSaveForLater"){sendObject.tealium_event="cart_add_from_saved";}else if(cartEventData.item==="moveToSaveForLater"){sendObject.tealium_event="cart_move_to_saved";}else if(cartEventData.item==="removeFromSaveForLater"||cartEventData.item==="removeFromCart"){if(pmc.checkNestedValue(cartEventData,"attributes.itemType","swatch")){sendObject.tealium_event="cart_remove_swatch_only";sendObject=item.setEvent("event398",1,sendObject);}else{unitPrice=parseFloat(cartEventData.unitPrice)+parseFloat(cartEventData.unitSurcharge);units=cartEventData.quantity;totalRevenue=pmc.getTotalFromUnitsAndPrice(units,unitPrice);sendObject.tealium_event="cart_remove";sendObject.pmc_scRemove="scRemove";sendObject=item.setEvent("event169",cartEventData.quantity,sendObject);sendObject=item.setEvent("event170",totalRevenue,sendObject);}}
if(sendObject.tealium_event){sendObject.pmc_products=item.adobeString();sendObject.product_sku=[sku];sendObject.product_id=[groupId];sendObject.product_unit_price=[unitPrice];sendObject.product_quantity=[units];sendObject.encoded_path_name=utag_data.encoded_path_name;pmc.fireLinkHit(sendObject);}}}catch(err){pmc.logError(err);}};pmc.getMerchTotal=function(){var count=digitalData.x_cart.orders[0].items.length,orderAmt,quantity,totalPrice=0,unitPrice;for(var i=0;i<count;i++){quantity=digitalData.x_cart.orders[0].items[i].quantity;unitPrice=digitalData.x_cart.orders[0].items[i].price.unitPrice;orderAmt=unitPrice*quantity;totalPrice+=orderAmt;}
return totalPrice.toFixed(2);};pmc.scheduledDeliveryPageView=function(){var pageId=pmc.getNestedStringValue(digitalData,"page.pageName").toLowerCase();if(!pageId){pageId=pmc.getNestedStringValue(digitalData,"page.attributes.cmPageId").toLowerCase();}
if((pageId==="delivery-schedule"||pageId==="delivery-reschedule")&&pmc.checkNestedValue(digitalData.page.attributes,"appointment")){var appointment=digitalData.page.attributes.appointment;var hubCode=appointment.hubCode,workOrderNumber=appointment.workOrderNumber,keyCode=appointment.key
utag_data["pmc_prop40"]=keyCode+"|"+workOrderNumber;utag_data["pmc_eVar121"]=utag_data["pmc_prop40"]+"|"+hubCode;utag_data["pmc_prop43"]=hubCode;utag_data["pmc_prop2"]="self-service";utag_data["pmc_prop3"]="self-service";utag_data["pmc_prop4"]="delivery";utag_data["pmc_prop5"]=pageId;if(appointment.status==="ACCEPTED_APPOINTMENT"){if(pageId==="delivery-schedule"){utag_data["pmc_pageName"]=utag_data["page_name"]="Delivery Schedule Make An Appointment";utag_data["pmc_event122"]="event122";}else if(pageId==="delivery-reschedule"){utag_data["pmc_pageName"]=utag_data["page_name"]="Delivery Reschedule An Appointment";utag_data["pmc_event123"]="event123";}
utag_data["pmc_prop42"]=appointment.appointmentDate;utag_data["pmc_pageName"]=utag_data["page_name"]="Delivery Schedule Appointment Made";}else if(appointment.status==="SERVICE_UNAVAILABLE"){utag_data["pmc_event119"]="event119";utag_data["pmc_eVar121"]="";utag_data["pmc_prop43"]="";}else if(appointment.status==="WORK_ORDER_NOT_FOUND"){utag_data["pmc_event120"]="event120";utag_data["pmc_eVar121"]="";utag_data["pmc_prop43"]="";}else{utag_data["pmc_event121"]="event121";if(pmc.checkDataDefinedAndNonEmpty(appointment,"numberOfAvailableDays")&&pmc.checkDataDefinedAndNonEmpty(appointment,"status")&&appointment.numberOfAvailableDays*1>0){utag_data["pmc_event121"]="";if(pmc.checkDataDefinedAndNonEmpty(appointment,"firstAvailableDate")){utag_data["pmc_prop41"]=appointment.firstAvailableDate;}}}}};pmc.pageViewTrackOrder=function(){var shipmentTracking=pmc.getNestedValue(digitalData,"page.attributes.shipmentTracking");var updatePaymentSuccess=pmc.getNestedValue(digitalData,"page.attributes.updatePaymentSuccess");if(shipmentTracking){utag_data.pmc_eVar5=shipmentTracking.orderNumber;utag_data.pmc_event134="event134";if(shipmentTracking.isBopis){utag_data.pmc_event137="event137";}
if(shipmentTracking.isHome){utag_data.pmc_event136="event136";}
if(shipmentTracking.isOther){utag_data.pmc_event138="event138";}
if(shipmentTracking.isParcel){utag_data.pmc_event135="event135";}
if(updatePaymentSuccess){utag_data.pmc_event410="event410";utag_data.pmc_event411=pmc.getNestedValue(digitalData,"page.attributes.orderTotal");}}};pmc.pageViewAccountCreated=function(){if(pmc.checkNestedValue(digitalData.page,"attributes.accountCreated")&&!pmc.checkNestedValue(digitalData.page,"attributes.accountCreated","false")){utag_data.pmc_event52="event52";utag_data.pmc_eVar48="authenticated";if(pmc.checkNestedValue(digitalData.x_user,"profile")){if(digitalData.x_user.profile.profileEmail){utag_data.customer_email_public=pmc.getHashedEmail(digitalData);utag_data.pmc_event53="event53";}
if(pmc.checkNestedValue(digitalData.x_user,"profile.attributes.socialSignIn")){utag_data.pmc_event31="event31";}
utag_data.pmc_eVar38="D=c2";}}};pmc.pageViewSearch=function(){try{var searchErrorFromUrl=pmc.getQueryStringValue("searcherrortype");if(searchErrorFromUrl){utag_data.pmc_prop23=searchErrorFromUrl;}else{pmc.pageViewSearchResults();}}catch(e){pmc.logError(e);}};pmc.setMerchEvarNonValues=function(output){var evar;var variableName;var merchEvarList=[{number:"1",nonValue:"non-shop"},{number:"2",nonValue:"D=v1"},{number:"3",nonValue:"D=v1"},{number:"15",nonValue:"non-internal ad cm_re"},{number:"25",nonValue:"non-homepage link"},{number:"27",nonValue:"non-search"},{number:"28",nonValue:"non-spell-corrected search"},{number:"29",nonValue:"non-search"},{number:"39",nonValue:"no refinement"},{number:"40",nonValue:"no refinement"},{number:"51",nonValue:"non-search"},{number:"64",nonValue:"non-WSIRecs"},{number:"93",nonValue:"non-shop"},{number:"139",nonValue:"no refinement"},{number:"140",nonValue:"no refinement"},{number:"118",nonValue:"non ranking override"},{number:"119",nonValue:"non dynamic assortment"},{number:"120",nonValue:"non-mobiletabnav"},];for(var i=merchEvarList.length-1;i>=0;i--){evar=merchEvarList[i];if(typeof AppMeasurement!=="undefined"&&output instanceof AppMeasurement){variableName="eVar"+evar.number;}else{variableName="pmc_eVar"+evar.number;}
output[variableName]=output[variableName]||evar.nonValue;}
return output;};pmc.pageViewSearchResults=function(){try{if(utag_data.search_algorithm!=="bloomreach"||!pmc.checkNestedValue(digitalData,"page.pageCategory.primaryCategory")){return;}
utag_data.pmc_prop1=utag_data.pmc_prop2=utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5='search';utag_data.pmc_pageName=utag_data.pmc_pageName||"search:results";utag_data.pmc_event60="event60";utag_data.pmc_eVar27="";utag_data.pmc_prop9="";utag_data.pmc_prop10="";utag_data.pmc_prop11=utag_data.pmc_eVar29="";utag_data.pmc_prop22="D=v51";utag_data.pmc_prop31=utag_data.search_algorithm||pmc.getNestedValue(digitalData,"page.attributes.searchAlgo");utag_data.pmc_event33="";}catch(e){pmc.logError(e)}};pmc.search={_setSearchType:function(eventData,output){output.pmc_prop11="D=v29";var pageId=eventData.pageType||pmc.getNestedValue(digitalData,"page.attributes.cmPageId","");pageId=pageId.toUpperCase();if(eventData.activeTab==="recipes"){output.pmc_prop10=eventData.searchResultsCount;output.pmc_eVar29="recipe";output.pmc_eVar42="RECIPESEARCH";}else if(eventData.activeTab==="products"){output.pmc_prop10=eventData.searchResultsCount;output.pmc_eVar29="product";output.pmc_eVar42="PRODUCTSEARCH";}else if(pmc.stringContains(pageId,"PRODUCT")){output.pmc_prop10=pmc.getNestedValue(eventData,"searchResults.product");output.pmc_eVar29="product";output.pmc_eVar42="PRODUCTSEARCH";}else if(pmc.stringContains(pageId,"ARTICLE")){output.pmc_prop10=pmc.getNestedValue(eventData,"searchResults.article");output.pmc_eVar29="article";output.pmc_eVar42="ARTICLESEARCH";}else if(pmc.stringContains(pageId,"VIDEO")){output.pmc_prop10=pmc.getNestedValue(eventData,"searchResults.video");output.pmc_eVar29="video";output.pmc_eVar42="VIDEOSEARCH";}else if(pmc.stringContains(pageId,"RECIPE")){output.pmc_prop10=pmc.getNestedValue(eventData,"searchResults.recipe");output.pmc_eVar29="recipe";output.pmc_eVar42="RECIPESEARCH";}else{output.pmc_prop10=pmc.getNestedValue(eventData,"searchResults.product");output.pmc_eVar29="product";output.pmc_eVar42="PRODUCTSEARCH";}
return output;},_setSearchSuggestion:function(eventData,output){if(pmc.checkNestedValue(eventData,"searchType")){var pfmMap=[{key:"Search:TA-Recent",value:"search: type ahead recent search",},{key:"Search:TA-CategoryFilter",value:"search: type ahead category filter",},{key:"Search:TA-Suggestion",value:"search: type ahead search suggestion",},{key:"search: search results search suggestion",value:"search: search results search suggestion",},];output.pmc_eVar9=pmc.resolveMapLookup(pfmMap,eventData.searchType)||output.pmc_eVar9;}
var searchEntry=eventData.searchTermEntered||eventData.searchEntry||"";if((searchEntry!==""&&searchEntry!==eventData.searchTerm)||pmc.checkNestedValue(eventData,"searchType","Search:TA-Recent")){output.pmc_event37="event37";output.pmc_eVar28=pmc.stripSpecialSymbols(searchEntry);output.pmc_prop12="D=v28";}
return output;},_setSearchPfm:function(eventData,output){if(pmc.stringContains(utag_data.pmc_eVar9,"xbr")){output.pmc_eVar9=utag_data.pmc_eVar9;}else if(!eventData.searchPfm||eventData.searchPfm==="search:search results"){output.pmc_eVar9=utag_data.external_pfm||"search:search results";}else{output.pmc_eVar9=eventData.searchPfm;}
return output},_setCqsRedirect:function(eventData,output){if(pmc.stringContains(eventData.searchResultsType,"cqsnull")||pmc.getNestedStringValue(digitalData,"page.attributes.cmPageId").toUpperCase()==="CQS RESULTS NULL"){output.pmc_prop10="1";output.pmc_eVar29="no results";output.pmc_prop11="D=v29";}else if(pmc.stringContains(eventData.searchResultsType,"cqs")){output.pmc_eVar9="search:cqs search";output.pmc_eVar29="cqs";output.pmc_prop11="D=v29";}
return output;},_getPaginationPage:function(eventData){if(pmc.checkNestedValue(eventData,"viewAll",true)||pmc.checkNestedValue(digitalData,"page.attributes.viewAll",true)){return"view all";}else if(pmc.checkNestedValue(eventData,"pageNumber")){return eventData.pageNumber;}else if(pmc.checkNestedValue(digitalData,"page.attributes","pageNumber")){return digitalData.page.attributes.pageNumber;}else if(pmc.checkNestedValue(eventData,"searchResultsCurrentPage")){return eventData.searchResultsCurrentPage;}else if(pmc.checkNestedValue(digitalData,"page.attributes","searchResultsCurrentPage")){return digitalData.page.attributes.searchResultsCurrentPage;}
return"";},_initializeSearchResultsObject:function(eventData,resultObj){var searchTerm=pmc.getNestedLowerCaseValue(eventData,"searchTerm")||pmc.getQueryStringValue("words")||pmc.getQueryStringValue("term")||pmc.getNestedValue(digitalData,"page.attributes.searchTerm","");resultObj=resultObj||{};resultObj=pmc.setMerchEvarNonValues(resultObj);resultObj.pmc_prop12="D=v28";resultObj.pmc_prop16="D=v39";resultObj.pmc_prop17="D=v40";resultObj.pmc_event33="event33";resultObj.pmc_pageName=utag_data.pmc_pageName||"search:results";resultObj=this._setSearchPfm(eventData,resultObj);resultObj.pmc_eVar27=utag_data.pmc_eVar27=pmc.stripSpecialSymbols(searchTerm);if(pmc.getQueryStringValue("words").length===0){resultObj.pmc_eVar27="empty search";}
resultObj.pmc_prop9="D=v27";resultObj.pmc_prop6="";resultObj.pmc_prop7="";resultObj.pmc_eVar10="";resultObj.pmc_prop22="D=v51";resultObj.pmc_prop10=eventData.searchResultsCount.toString();resultObj.pmc_prop31=eventData.searchAlgo||utag_data.search_algorithm;if(utag_data.pmc_eVar51!=="search suggestion"){resultObj.pmc_eVar51=pmc.getNestedLowerCaseValue(eventData,"searchResultsType");}
resultObj.pmc_event60="event60";resultObj.tealium_event="search_results_event";return resultObj;},handleResults:function(eventData,searchResultObj){try{if(pmc.suppressDoubleFire("searchResults")){return true;}
if(eventData.name==="addChild"){if(utag_data.search_algorithm!=="bloomreach"||!pmc.checkNestedValue(eventData,"data")){return;}
eventData=eventData.data;}
if(pmc.checkNestedValue(eventData,"redirect","true")){return;}
searchResultObj=pmc.search._initializeSearchResultsObject(eventData,searchResultObj);if(!pmc.checkNestedValue(searchResultObj,"pmc_prop10")||searchResultObj.pmc_prop10==="0"){searchResultObj.pmc_event34="event34";}else{searchResultObj.pmc_prop20=this._getPaginationPage(eventData);}
searchResultObj=pmc.search._setSearchType(eventData,searchResultObj);searchResultObj=pmc.search._setCqsRedirect(eventData,searchResultObj);searchResultObj=pmc.setRefinements(eventData,searchResultObj);searchResultObj=pmc.search._setSearchSuggestion(eventData,searchResultObj);pmc.fireLinkHit(searchResultObj);}catch(e){e.data="query string is "+document.location.search;pmc.logError(e);}},};pmc.pageViewSearchRedirect=function(){try{var searchTerm=pmc.getQueryStringValue("term")||pmc.getQueryStringValue("words")||pmc.getNestedValue(digitalData,"page.attributes.searchTerm","");if(searchTerm){searchTerm=searchTerm.replace(/\+/g," ").toLowerCase();utag_data.pmc_eVar27=pmc.stripSpecialSymbols(searchTerm);utag_data.pmc_prop9="D=27";}
if(pmc.checkNestedValue(digitalData.page.pageCategory,"primaryCategory","products")){utag_data.pmc_prop11=utag_data.pmc_eVar29=utag_data.pmc_eVar51="cqs";utag_data.pmc_prop22="D=v51";utag_data.pmc_prop10="1";utag_data.pmc_eVar9="search:cqs search";}else{utag_data.pmc_prop11=utag_data.pmc_eVar29=utag_data.pmc_eVar51="redirect";utag_data.pmc_prop22="D=v51";utag_data.pmc_prop10="redirect";utag_data.pmc_eVar9="search:search redirect";}
utag_data.pmc_event33="event33";utag_data.pmc_event35="event35";}catch(e){pmc.logError(e);}};pmc.setTypeAheadSearchRecommendation=function(){try{utag_data.pmc_eVar27=pmc.stripSpecialSymbols(pmc.getQueryStringValue("_br_psugg_q").replace(/\+/g," ").toLowerCase());utag_data.pmc_prop9="D=27";utag_data.pmc_event33="event33";utag_data.pmc_eVar29=utag_data.pmc_prop11="typeahead";utag_data.pmc_eVar51=utag_data.pmc_prop22="typeahead";utag_data.pmc_eVar9="search: type ahead product recommendation";utag_data.search_type_ahead_event="recommendation_clicked";}catch(e){pmc.logError(e);}};pmc.processAuthenticationStatus=function(userProfile,output){var authenticationStatus=pmc.lowerCaseString(userProfile.authenticationStatus);if(authenticationStatus){output.pmc_eVar48=authenticationStatus;}
return output;};pmc.processAuthenticationAction=function(userProfile,output){const authenticationAction=pmc.lowerCaseString(userProfile.authenticationAction);let designTradeTier=pmc.getNormalDesignTradeTier(userProfile.designTradeMemberTier);if(typeof userProfile.designTradeMemberTier==="boolean"){designTradeTier=userProfile.designTradeMemberTier?"member":"non-member";}
output.pmc_eVar102=designTradeTier;output.authentication_action=authenticationAction;if(authenticationAction.includes("login")){output.pmc_event51="event51";if(userProfile.accountCreated){output.pmc_event52="event52";if(pmc.isSparc()){output.pmc_event352="event352";}}
if(designTradeTier==="member"){output.pmc_event433="event433";}}
return output;};pmc.processAuthentication=function(user,output){try{var userObject=user||{};var userProfile=userObject.profile;if(!userProfile){var err=new Error("Expected user.profile");err.type="datalayer";pmc.logError(err);return output;}
output.customer_email_public=pmc.getHashedEmail(user);if(output.customer_email_public){output.pmc_eVar38=output.pmc_eVar38||"D=c2";output.pmc_event53="event53";}
output=pmc.processAuthenticationStatus(userProfile,output);output=pmc.processAuthenticationAction(userProfile,output);return output;}catch(e){pmc.logError(e);}};pmc.getRecommendationStrategy=function(){return pmc.getQueryStringValue("recstrat").replace("%7C","|").replace("%7c","|");};pmc.setShopCategoryVariables=function(){var categoryArray=pmc.getNestedValue(digitalData,"page.pageCategory.categories")||pmc.getNestedValue(digitalData,"product.productCategory.categories");var pageType=pmc.getNestedValue(digitalData,"page.pageType");utag_data.pmc_eVar118=pmc.getNestedValue(digitalData,"page.attributes.productRankingAlgo");utag_data.pmc_eVar119=pmc.getNestedValue(digitalData,"page.attributes.dynamicAssortment");utag_data.pmc_eVar120=pmc.getQueryStringValue("tabnav");if(!pmc.isArray(categoryArray)||!pageType){return false;}
var categoryLength=categoryArray.length;if(pageType==="supercategory"){utag_data.top_category=categoryArray[0];utag_data.category=categoryArray[0];utag_data.category_id=categoryArray[0];utag_data.supercategory=categoryArray[0];}else if(pageType==="category"){utag_data.top_category=categoryArray[0];utag_data.category=categoryArray[categoryLength-1];utag_data.category_id=categoryArray[categoryLength-1];utag_data.supercategory=categoryArray[0];}else if(pageType==="subcategory"){utag_data.top_category=categoryArray[0];utag_data.category=categoryArray[categoryLength-2];utag_data.category_id=categoryArray[categoryLength-1];utag_data.supercategory=categoryArray[0];utag_data.subcategory=categoryArray[categoryLength-1];}else if(digitalData.product){utag_data.top_category=categoryArray[0];utag_data.category_id=categoryArray[categoryArray.length-1];}};pmc.initializeVariablesFromDataLayer=function(){var tempPageName="";pmc.isMobile=(pmc.isNestedDataDefinedAndNonEmpty(digitalData,"page.attributes.mobile"))?digitalData.page.attributes.mobile:false;utag_data.search_algorithm=pmc.getNestedValue(digitalData,"page.attributes.searchAlgo");utag_data.strategy=pmc.getNestedValue(digitalData,"page.attributes.strategy","");utag_data.encoded_path_name=pmc.environment.pathname.replace(/\//g,"%2F");pmc.environment.setVariablesFromDataLayer();utag_data.brand=pmc.environment.brandCode;utag_data.market=pmc.environment.market;utag_data.brand_with_market=pmc.environment.brandCode+"-"+pmc.environment.market;pmc.setSubBrand();utag_data.pmc_prop8=pmc.getAdobeSubBrand(pmc.subBrand);if(!pmc.readCookie("wsiapp_meta")){utag_data.sc_visitor_id=pmc.getAdobeVisitorId();pmc.setAdobeSvi3Id(utag_data.sc_visitor_id);}
var hashedEmail=pmc.getHashedEmail(digitalData);if(hashedEmail){utag_data.customer_email_public=hashedEmail;utag_data.pmc_event53="event53";if(pmc.getQueryStringValue("cm_em")){utag_data.pmc_eVar38="email";}}
pmc.privacy.initialize(pmc.environment.tealiumEnvironment,utag_data.sc_visitor_id,hashedEmail);if(!utag_data.privacy_opt_out_LDU){pmc.setExternalHash(hashedEmail);}
if(pmc.isSparc()){pmc.reinitializePathnameHierarchy();}
if(pmc.checkNestedValue(digitalData,"page.attributes.prodRecCarousel",true)){utag_data.pmc_event441="event441";}
if(!pmc.checkNestedValue(utag_data,"pmc_pageName")){try{utag_data.pmc_eVar10=utag_data.pmc_pageName=pmc.originalPageName=pmc.pageValues.getPageName()||pmc.getPageName();tempPageName=pmc.setPageValuesFromDataLayer();if(!utag_data.pmc_pageName){utag_data.pmc_pageName=tempPageName;}
if(utag_data.pmc_pageName==="stores:store-locator"){utag_data.pageName="stores:store-locator";}}catch(e){utag_data.pmc_pageName="unknown";e.type="datalayer";e.data="URL="+pmc.environment.pathname;pmc.logError(e);}}
pmc.originalPageType=utag_data.pmc_prop1;utag_data.pmc_eVar41=pmc.getNestedValue(digitalData,"page.attributes.cmPageId")||pmc.getNestedValue(digitalData,"page.pageName");utag_data.pmc_eVar42=pmc.getNestedValue(digitalData,"page.attributes.cmCategoryId")||pmc.getNestedValue(digitalData,"page.pageCategory.primaryCategory");utag_data.pmc_prop6="D=v41";utag_data.pmc_prop7="D=v42";pmc.setShopCategoryVariables();pmc.visitStart=pmc.readCookie("inVisit")?0:1;pmc.writeCookie("inVisit","1",30);};pmc.pfmPatterns=[{pageType:"products",pfm:"ecatalog",qsFilters:[{qp:"catalogId",qv:"",},{qp:"ci_sku",qv:"",},{qp:"ci_src",qv:"",}],},{pageType:"products",pfm:"shop",referrer:"curalate",cookie:{key:"s_ppv",value:"features",},},{pageType:"products",pfm:"shop",referrer:"curalate",cookie:{key:"s_ppv",value:"lookbook",},},{pageType:"products",pfm:"autorecs:rar",qsFilters:[{qp:"cm_src",qv:"AutoRARRel",}],},{pageType:"products",pfm:"autorecs:rac",qsFilters:[{qp:"cm_src",qv:"AutoRACRel",}],},{pageType:"products",pfm:"autorecs:csl_pip",qsFilters:[{qp:"cm_src",qv:"autocslpip",}],},{pageType:"products",pfm:"autorecs:cart",qsFilters:[{qp:"cm_src",qv:"AUTOCARTREL",}],},{pageType:"products",pfm:"autorecs:category",qsFilters:[{qp:"cm_src",qv:"AUTOCATREL",}],},{pageType:"products",pfm:"autorecs:orderconfirm",qsFilters:[{qp:"cm_src",qv:"AUTOORDCONFREL",}],},{pageType:"products",pfm:"autorecs:add to registry confirmation",qsFilters:[{qp:"cm_src",qv:"AUTOREGLISTCONFREL",}],},{pageType:"products",pfm:"autorecs:pip2",qsFilters:[{qp:"cm_src",qv:"AUTOREL2",}],},{pageType:"products",pfm:"autorecs:pip1",qsFilters:[{qp:"cm_src",qv:"AUTOREL",}],},{pageType:"products",pfm:"autorecs:nullsearch",qsFilters:[{qp:"cm_src",qv:"AUTOSCHNULLREL",}],},{pageType:"products",pfm:"autorecs:searchresults",qsFilters:[{qp:"cm_src",qv:"AUTOSCHREL",}],},{pageType:"products",pfm:"autorecs:subcategory",qsFilters:[{qp:"cm_src",qv:"AUTOSUBCATREL",}],},{pageType:"products",pfm:"autorecs:myrecs",qsFilters:[{qp:"cm_src",qv:"MYRECS",}],},{pageType:"products",pfm:"autorecs:pip recently viewed",qsFilters:[{qp:"cm_src",qv:"PIPRECENTVIEW",}],},{pageType:"products",pfm:"related items",qsFilters:[{qp:"cm_src",qv:"REL",}],},{pageType:"products",pfm:"upsells",qsFilters:[{qp:"cm_src",qv:"SPIF",}],},{pageType:"products",pfm:"upsells",qsFilters:[{qp:"cm_src",qv:"SPIFS",}],},{pageType:"products",pfm:"registry: registry list gift giver",qsFilters:[{qp:"cm_src",qv:"REGGG",}],},{pageType:"products",pfm:"registry: registry list registrant",qsFilters:[{qp:"cm_src",qv:"REGCR",}],},{pageType:"products",pfm:"registry: completion program registrant",qsFilters:[{qp:"cm_src",qv:"REGCMP",}],},{pageType:"products",pfm:"registry: registry list",qsFilters:[{qp:"cm_src",qv:"RGL",}],},{pfm:"registry:checklist",qsFilters:[{qp:"cm_src",qv:"registrychecklist",}],},{pageType:"products",pfm:"search:cqs",qsFilters:[{qp:"cm_src",qv:"CQS",}],},{pageType:"products",pfm:"bloomreach",qsFilters:[{qp:"cm_src",qv:"bloomreach",}],},{pageType:"products",pfm:"recipe",qsFilters:[{qp:"cm_src",qv:"recipe",}],},{pageType:"products",pfm:"autorecs:homepage",qsFilters:[{qp:"cm_src",qv:"autohprel",}],},{pageType:"products",pfm:"autorecs:hp most popular",qsFilters:[{qp:"cm_src",qv:"autohppop",}],},{pageType:"products",pfm:"autorecs:homepageRVI",qsFilters:[{qp:"cm_src",qv:"autorecsHPRVI",}],},{pageType:"products",pfm:"autorecs:supercategory",qsFilters:[{qp:"cm_src",qv:"autorecsSupercat",}],},{pageType:"products",pfm:"content personalization",qsFilters:[{qp:"cm_src",qv:"conpers",}],},{pageType:"products",pfm:"Smart Inspiration",qsFilters:[{qp:"cm_src",qv:"smartinspiration",}],},{pageType:"products",pfm:"WsiRecs:Homepage",qsFilters:[{qp:"cm_src",qv:"WsiHomepage1",}],},{pageType:"products",pfm:"WsiRecs:Homepage2",qsFilters:[{qp:"cm_src",qv:"WsiHomepage2",}],},{pageType:"products",pfm:"WsiRecs:Pip1",qsFilters:[{qp:"cm_src",qv:"WsiPip1",}],},{pageType:"products",pfm:"WsiRecs:Pip2",qsFilters:[{qp:"cm_src",qv:"WsiPip2",}],},{pageType:"products",pfm:"WsiRecs:Pip Recently Viewed",qsFilters:[{qp:"cm_src",qv:"WsiPipRvi",}],},{pageType:"products",pfm:"WsiRecs:SuperCategory1",qsFilters:[{qp:"cm_src",qv:"WsiSuperCategory1",}],},{pageType:"products",pfm:"WsiRecs:SuperCategory2",qsFilters:[{qp:"cm_src",qv:"WsiSuperCategory2",}],},{pageType:"products",pfm:"WsiRecs:Category1",qsFilters:[{qp:"cm_src",qv:"WsiCategory1",}],},{pageType:"products",pfm:"WsiRecs:Category2",qsFilters:[{qp:"cm_src",qv:"WsiCategory2",}],},{pageType:"products",pfm:"WsiRecs:SubCategory1",qsFilters:[{qp:"cm_src",qv:"WsiSubCategory1",}],},{pageType:"products",pfm:"WsiRecs:SubCategory2",qsFilters:[{qp:"cm_src",qv:"WsiSubCategory2",}],},{pageType:"products",pfm:"WsiRecs:AddToCart",qsFilters:[{qp:"cm_src",qv:"WsiRac",}],},{pageType:"products",pfm:"WsiRecs:Cart",qsFilters:[{qp:"cm_src",qv:"WsiCart",}],},{pageType:"products",pfm:"WsiRecs:SearchResults",qsFilters:[{qp:"cm_src",qv:"WsiSearch",}],},{pageType:"products",pfm:"WsiRecs:NullSearch",qsFilters:[{qp:"cm_src",qv:"WsiNullSearch",}],},{pageType:"products",pfm:"WsiRecs:AddToRegistry",qsFilters:[{qp:"cm_src",qv:"WsiRar",}],},{pageType:"products",pfm:"WsiRecs:OrderConfirm",qsFilters:[{qp:"cm_src",qv:"WsiOrderConfirm",}],},{pageType:"products",pfm:"WsiRecs:Pla",qsFilters:[{qp:"cm_src",qv:"WsiCsl_Pip",}],},{pageType:"products",pfm:"WsiRecs:Favorites1",qsFilters:[{qp:"cm_src",qv:"WsiFavorites1",}],},{pageType:"products",pfm:"WsiRecs:Favorites2",qsFilters:[{qp:"cm_src",qv:"WsiFavorites2",}],},{pageType:"products",pfm:"WSIRecs:AccountRVI",qsFilters:[{qp:"cm_src",qv:"WSIAccountRVI",}],},{pageType:"products",pfm:"WSIRecs:EmptyCart",qsFilters:[{qp:"cm_src",qv:"WsiECart",}],},{pageType:"products",pfm:"WSIRecs:EmptyCartRVI",qsFilters:[{qp:"cm_src",qv:"WSIECartRvi",}],},{pageType:"products",pfm:"WSIRecs:EmptyCartRVI",qsFilters:[{qp:"cm_src",qv:"WsiECartRvi",}],},{pageType:"products",pfm:"WsiRecs:FavoritesRVI",qsFilters:[{qp:"cm_src",qv:"WsiFavoritesRvi",}],},{pageType:"products",pfm:"WsiRecs:DesignServices",qsFilters:[{qp:"cm_src",qv:"WsiRecsDesignServices",}],},{pageType:"products",pfm:"WsiRecs:PIPFlyout-AITC",qsFilters:[{qp:"cm_src",qv:"WsiPipFlyoutAITC",}],},{pageType:"products",pfm:"WsiRecs:PIPFlyout-RVI",qsFilters:[{qp:"cm_src",qv:"WsiPipFlyoutRVI",}],},{pageType:"products",pfm:"WsiRecs:PIPFlyout-PIP1",qsFilters:[{qp:"cm_src",qv:"WsiPipFlyoutPIP1",}],},{pageType:"products",pfm:"WsiRecs:PIPFlyout-PIP2",qsFilters:[{qp:"cm_src",qv:"WsiPipFlyoutPIP2",}],},{pageType:"products",pfm:"DesignServices:Favorites",qsFilters:[{qp:"cm_src",qv:"FavoritesDesignServices",}],},{pageType:"products",pfm:"WSIRecs:DesignServicesRVI",qsFilters:[{qp:"cm_src",qv:"WSIRecsDesignServicesRVI",}],},{pageType:"products",pfm:"design services:room planner",qsFilters:[{qp:"cm_src",qv:"DesignServicesRP",}],},{pageType:"products",pfm:"Reduced PIP Clickthru",qsFilters:[{qp:"cm_src",qv:"reducedClick",}],},{pageType:"products",pfm:"Shop By Room",qsFilters:[{qp:"cm_src",qv:"shopByRoom",}],},{pageType:"products",pfm:"Shop By Room:Gallery",qsFilters:[{qp:"cm_src",qv:"shopByRoomGallery",}],},{pageType:"products",pfm:"WSI:shop by room clickthru",qsFilters:[{qp:"cm_src",qv:"shopByRoomClick",}],},{pageType:"products",pfm:"Shop By Room:Lookbook",qsFilters:[{qp:"cm_src",qv:"shopByRoomLookbook",}],},{pfm:"Salesfloor",qsFilters:[{qp:"cm_ven",qv:"Salesfloor",}],},{pageType:"products",pfm:"WSIRecs:RVI-Carousel",qsFilters:[{qp:"cm_src",qv:"RVI-Carousel",}],},{pageType:"products",pfm:"WSIRecs:RVI-MoreLikeThis-Seed",qsFilters:[{qp:"cm_src",qv:"RVI-MoreLikeThis-Seed",}],},{pageType:"products",pfm:"WSIRecs:RVI-MoreLikeThis-Companion",qsFilters:[{qp:"cm_src",qv:"RVI-MoreLikeThis-Companion",}],},{pageType:"products",pfm:"WSIRecs:PZN-Carousel",qsFilters:[{qp:"cm_src",qv:"PZN-Carousel",}],},{pageType:"products",pfm:"WSIRecs:PZN-MoreLikeThis-Seed",qsFilters:[{qp:"cm_src",qv:"PZN-MoreLikeThis-Seed",}],},{pageType:"products",pfm:"WSIRecs:PZN-MoreLikeThis-Companion",qsFilters:[{qp:"cm_src",qv:"PZN-MoreLikeThis-Companion",}],},{pageType:"products",pfm:"WSIRecs:Shop-MoreLikeThis",qsFilters:[{qp:"cm_src",qv:"Shop-MoreLikeThis",}],},{pageType:"products",pfm:"WSIRecs:Search-MoreLikeThis",qsFilters:[{qp:"cm_src",qv:"Search-MoreLikeThis",}],},{pageType:"products",pfm:"WSIRecs:HP-MoreLikeThis",qsFilters:[{qp:"cm_src",qv:"HP-MoreLikeThis",}],},{pageType:"products",pfm:"WSIRecs:PIP-MoreLikeThis",qsFilters:[{qp:"cm_src",qv:"WSI-PIP-ebsmlt",}],},{pageType:"products",pfm:"WsiRecs:account recently viewed",qsFilters:[{qp:"cm_src",qv:"Account-RVI-Carousel",}],},{pageType:"products",pfm:"SmartBundle:RAC",qsFilters:[{qp:"cm_src",qv:"smartbundlerac",}],},{pfm:"WsiRecs:AlsoInThisCollection",qsFilters:[{qp:"cm_src",qv:"WsiAitc",}],},{pageType:"products",pfm:"SmartBundle:CART",qsFilters:[{qp:"cm_src",qv:"smartbundlecart",}],},{pfm:"search results:null search xbr",qsFilters:[{qp:"cm_pla",qv:"NullSearchXBR",}],},{pfm:"search results:search results xbr",qsFilters:[{qp:"cm_pla",qv:"XBRSearchResults",}],},{pageType:"search",pfm:"search:search results",},{pageType:"products",pfm:"stylitics moodboard clickthrough",qsFilters:[{qp:"cm_src",qv:"moodboard",}],},{pageType:"products",pfm:"you may also need",qsFilters:[{qp:"cm_src",qv:"YMAN",}],},{pageType:"products",pfm:"search featured products",qsFilters:[{qp:"cm_src",qv:"SEARCH_TOPPRODUCT",}],},{pageType:"shoppingcart",pfm:"cartshare",qsFilters:[{qp:"cm_src",qv:"cartshare",}],},{pageType:"shoppingcart",pfm:"cartshare",qsFilters:[{qp:"cartshare",qv:"true",}],},{pageType:"shoppingcart",pfm:"productlist",qsFilters:[{qp:"cm_src",qv:"productlist",}],},{pageType:"shoppingcart",pfm:"abandon",qsFilters:[{qp:"cm_src",qv:"atcct",}],},{pageType:"products",pfm:"My Design Projects",qsFilters:[{qp:"cm_src",qv:"MyDesignProjects",}],},{pageType:"shop",pfm:"visual navigation",qsFilters:[{qp:"cm_src",qv:"visnav",}],},{pageType:"products",pfm:"WSIRecs:ShopRVI",qsFilters:[{qp:"cm_src",qv:"WSIShopRVI",}],},{pageType:"products",pfm:"WSIRecs:SearchRVI",qsFilters:[{qp:"cm_src",qv:"WSISearchRVI",}],},{pageType:"products",pfm:"WSIRecs:CartRVI",qsFilters:[{qp:"cm_src",qv:"WSICartRVI",}],},{pageType:"products",pfm:"WSIRecs:MyRecs",qsFilters:[{qp:"cm_src",qv:"WsiMyRecs",}],},{pageType:"products",pfm:"WSIRecs:MyRecsRVI",qsFilters:[{qp:"cm_src",qv:"WsiMyRecsRvi",}],},{pageType:"products",pfm:"PZN:HP Shop By Room Tile",qsFilters:[{qp:"cm_src",qv:"pznhpsxrtile",}],},{pageType:"products",pfm:"PZN:HP Shop By Room Carousel",qsFilters:[{qp:"cm_src",qv:"pznhpsxrcarousel",}],},{pageType:"products",pfm:"WSIRecs:RegistryList1",qsFilters:[{qp:"cm_src",qv:"WsiRegistryList1",}],},{pageType:"products",pfm:"shop:collections",qsFilters:[{qp:"cm_src",qv:"shop-collections",}],},{template:"collections",pfm:"shop:collections",},{pageType:"products",pfm:"HP Shop The Look",qsFilters:[{qp:"cm_src",qv:"HPShopTheLook",}],},{pageType:"products",pfm:"HP Shop The Look",qsFilters:[{qp:"cm_src",qv:"hp_ugc",}],},{pageType:"products",pfm:"PIP Shop The Look",qsFilters:[{qp:"cm_src",qv:"PIPShopTheLook",}],},{pageType:"products",pfm:"PIP Shop The Look",qsFilters:[{qp:"cm_src",qv:"pip_ugc",}],},{pageType:"products",pfm:"WSIRecs:style quiz",qsFilters:[{qp:"cm_src",qv:"wsistylequiz",}],},{pageType:"products",pfm:"buy it again",qsFilters:[{qp:"cm_src",qv:"buyitagain",}],},{pageType:"products",pfm:"WsiRecs:DynamicSearchResults",qsFilters:[{qp:"cm_src",qv:"WsiDynamicSearch",}],},{pageType:"products",pfm:"WsiRecs:Store Locator1",qsFilters:[{qp:"cm_src",qv:"WsiStoreLocatorCarousel1",}],},{pageType:"products",pfm:"WsiRecs:Store Locator2",qsFilters:[{qp:"cm_src",qv:"WsiStoreLocatorCarousel2",}],},{pageType:"products",pfm:"WsiRecs:Store Locator RVI",qsFilters:[{qp:"cm_src",qv:"WsiStoreLocatorRVI",}],},{pageType:"products",pfm:"WsiRecs:Store Details1",qsFilters:[{qp:"cm_src",qv:"WsiStoreDetailsCarousels1",}],},{pageType:"products",pfm:"WsiRecs:Store Details2",qsFilters:[{qp:"cm_src",qv:"WsiStoreDetailsCarousels2",}],},{pageType:"products",pfm:"WsiRecs:Store Details RVI",qsFilters:[{qp:"cm_src",qv:"WsiStoreDetailsRVI",}],},{pageType:"products",pfm:"WsiRecs:RegistryList2",qsFilters:[{qp:"cm_src",qv:"WsiRegistryList2",}],},{pfm:"shop:quicklinks",qsFilters:[{qp:"cm_src",qv:"shopquicklinks",}],},{pfm:"dorm checklist",qsFilters:[{qp:"cm_src",qv:"dormchecklist",}],},{pageType:"wishlist",pfm:"wishlist:gift giver",pageName:"wishlist: giver view",},{pageType:"wishlist",pfm:"wishlist:creator",pageName:"wishlist: creator view",},{pathName:"/customer-service/gift-services/gift-card-landing",pfm:"shop",},{pfm:"internal ad",qsFilters:[{qp:"cm_re",qv:"",}],},{pageType:"shop",pfm:"shop",},{pageType:"room",pfm:"shop",},{pageType:"gift",pfm:"shop",},{pageType:"the-key",pfm:"shop",},{pageType:"tips-and-ideas",pfm:"shop",},{pathName:"design-lab",pfm:"shop",},];pmc.isPfmMatch=function(rule){var filter;var paramValue;if(rule.pageType&&!pmc.checkNestedValue(digitalData,"page.pageCategory.primaryCategory",rule.pageType)){return false;}
if(rule.pathName&&!pmc.stringContains(pmc.environment.pathname,rule.pathName.toLowerCase())){return false;}
if(rule.template&&!pmc.checkNestedValue(digitalData,"page.attributes.template",rule.template)){return false;}
if(rule.cookie&&!pmc.stringContains(pmc.readCookie(rule.cookie.key),rule.cookie.value)){return false;}
if(rule.referrer&&(!pmc.referrer||!pmc.stringContains(pmc.referrer.hostname,rule.referrer))){return false;}
if(rule.pageName&&!pmc.checkNestedValue(digitalData,"page.pageName",rule.pageName)){return false;}
if(rule.qsFilters){for(var i=0,len=rule.qsFilters.length;i<len;i++){filter=rule.qsFilters[i];paramValue=pmc.getQueryStringValue(filter.qp).toLowerCase();if(!paramValue){return false;}
if(filter.qv&&paramValue!==filter.qv.toLowerCase()){return false;}}}
return true;};pmc.checklistPage=function(input,output){const page=input.page;const primaryCategory=page.pageCategory.primaryCategory;output.pmc_pageName=page.pageName;output.pmc_prop1=page.pageType;output.pmc_prop2=primaryCategory;output.pmc_prop3=output.pmc_prop4=output.pmc_prop5="D=pageName";output.tealium_event="checklist page load";if(page.attributes.previous==="rac checklist cta clickthrough"){output.pmc_event462="event462";}
return output;}
pmc.getPfmFromURL=function(){var pfmPattern;for(var i=0;i<pmc.pfmPatterns.length;i++){pfmPattern=pmc.pfmPatterns[i];if(pmc.isPfmMatch(pfmPattern)){return pfmPattern.pfm;}}};pmc.getPfmFromNativeAppPayload=function(cmSrc){if(typeof cmSrc!=="string"){return"";}
var pfmPatterns=pmc.pfmPatterns;for(var i=0;i<pfmPatterns.length;i++){var pfmPattern=pfmPatterns[i];var filters=pfmPattern.qsFilters;if(pmc.isArray(filters)){for(var j=0;j<filters.length;j++){var filter=filters[j]||{};var isValid=false;if(filter.qp&&cmSrc&&(filter.qv&&cmSrc.toUpperCase()===filter.qv.toUpperCase())){isValid=true}else{isValid=false;break;}}
if(isValid){return pfmPattern.pfm;}}}};pmc.handleAppQSParameters=function(){if(pmc.environment.hostname.indexOf('.cashstar.com')==-1){var appType=pmc.getQueryStringValue("apptype",pmc.queryArray);var scan=pmc.getQueryStringValue("scan",pmc.queryArray);if(typeof(appType)!=="undefined"&&appType.toLowerCase()==="reg"){var appString="RegistryApp";if(scan===true||scan==="true"){appString+="^scan";}
utag_data["pmc_eVar18"]=utag_data["pmc_prop18"]=utag_data["pmc_eVar9"]=appString;}else if(typeof(appType)!=="undefined"&&appType.toLowerCase()==="shop"){}}}
pmc.registryPrivacy=function(registryPrivacy,output){try{var registryPartners;var genPrivacy;if(!registryPrivacy){return;}
output=output||{};if(registryPrivacy.partners){registryPartners=registryPrivacy.partners;if(registryPartners.length>0&&pmc.checkNestedValue(registryPartners[0],"name","TheKnotOptIn")&&registryPartners[0].isUpdated){if(registryPartners[0].isOptedIn){output.pmc_event149=utag_data.pmc_event149="event149";output.pmc_prop49=utag_data.pmc_prop49="TheKnot";}else{output.pmc_event150=utag_data.pmc_event150="event150";}}}
if(pmc.checkNestedValue(registryPrivacy,"setting.isUpdated")){genPrivacy=pmc.getNestedStringValue(registryPrivacy,"setting.optInType").toLowerCase();if(genPrivacy==="public"){output.pmc_event201=utag_data.pmc_event201="event201";}else if(genPrivacy==="private"){output.pmc_event202=utag_data.pmc_event202="event202";}else if(genPrivacy==="passwordprotected"||genPrivacy==="protected"){output.pmc_event203=utag_data.pmc_event203="event203"}}
return output;}catch(e){pmc.logError(e);}};pmc.setRegistryListData=function(registryItems,output){var item;var itemQuantity=0;var itemPrice=0;var itemTotal=0;var itemList=pmc.items.createItemList();var newItem;var productId;var productSku;var errorObj;if(!pmc.isArray(registryItems)){errorObj=new Error("Registry items not an array");errorObj.type="datalayer";pmc.logError(errorObj);return output;}
for(var j=0;j<registryItems.length;j++){item=registryItems[j];if(pmc.checkNestedValue(item,"attributes.requestedQuantity")){item.quantity=item.attributes.requestedQuantity;}else{continue;}
productId=pmc.getNormalProdId(item);productSku=pmc.normalizeProductIdObject(item).sku;newItem=itemList.addItem(productId,productSku);itemQuantity=parseInt(item.quantity);itemPrice=parseFloat(item.price.unitPrice);itemTotal=pmc.getTotalFromUnitsAndPrice(itemQuantity,itemPrice);if(itemQuantity){output=newItem.setEvent("event151",itemQuantity,output);if(itemPrice>100.00){output=newItem.setEvent("event152",itemQuantity,output);}}
if(pmc.checkNestedValue(item,"attributes.stillNeedsQuantity")){output=newItem.setEvent("event148",item.attributes.stillNeedsQuantity,output);}
if(pmc.checkNestedValue(item,"attributes.backorder")){output=newItem.setBackOrderFromDate(item.attributes.backorder,output);}
if(pmc.checkNestedValue(item,"attributes.NLA")&&item.attributes.NLA){output=newItem.setEvent("event155",1,output);}}
output.pmc_products=itemList.adobeString();return output;};pmc.setRegistryVariables=function(registry,output){var registryList;var notifications;var errorObj;if(!registry){errorObj=new Error("No registry object");errorObj.type="datalayer";pmc.logError(errorObj);return output;}
if(pmc.checkNestedValue(registry,"attributes.dataAvailability","after page load")){return output;}
registryList=registry.items;if(registryList){output=pmc.setRegistryListData(registryList,output);}
if(registry.privacy){output=pmc.registryPrivacy(registry.privacy,output);}
notifications=parseInt(pmc.getNestedValue(registry,"attributes.notifications"));if(notifications>0){output.pmc_event197="event197";output.numberOfNotifications=notifications;}
output.registry_id=pmc.getNestedValue(registry,"attributes.registryId");output.pmc_eVar36=pmc.getNestedValue(registry,"attributes.eventType");return output;};pmc.registryListPfmLegacy=function(){if(pmc.checkNestedValue(digitalData,"x_state.giftGiver",true)){return"registry:registry list gift giver";}
if(pmc.checkNestedValue(digitalData,"x_state.registrant",true)){return"registry:registry list registrant";}
if(pmc.checkNestedValue(digitalData,"x_state.completionUser",true)){return"registry:completion program registrant";}
return"registry";};pmc.registryListPfm=function(){var userRole=pmc.getNestedValue(digitalData,"page.registry.attributes.userRole");if(userRole){if(userRole==="registrant"){return"registry:registry list registrant";}
if(userRole==="gift giver"){return"registry:registry list gift giver";}
return"registry";}else{return pmc.registryListPfmLegacy();}};pmc.pageViewRegistry=function(){var registryObject;try{if(pmc.stringContains(pmc.environment.pathname,"registry-list")){utag_data.pmc_prop1="registry list";utag_data.pmc_event45="event45";utag_data.pmc_eVar9=pmc.registryListPfm();if(pmc.checkNestedValue(digitalData.page.attributes,"isAllowGroupGifting",true)){utag_data.pmc_event144="event144";}}
registryObject=pmc.getNestedValue(digitalData,"page.registry")||pmc.getNestedValue(digitalData,"x_registry.registry");if(pmc.isArray(registryObject)){registryObject=registryObject[0];}
if(registryObject){if(!registryObject.attributes&&pmc.checkNestedValue(digitalData,"x_registry.attributes")){registryObject.attributes=digitalData.x_registry.attributes;}
if(!registryObject.privacy&&pmc.checkNestedValue(digitalData,"x_registry.privacy")){registryObject.privacy=digitalData.x_registry.privacy;}
utag_data=pmc.setRegistryVariables(registryObject,utag_data);}}catch(e){pmc.logError(e);}};pmc.registryListEvent=function(registry){var pageName=pmc.getNestedValue(window.digitalData,"page.pageName","");var analyticsVariables={tealium_event:"registry_list_event",registry_id:"",};if(pmc.checkNestedValue(registry,"attributes.registryId")){utag_data.registry_id=registry.attributes.registryId;if(pageName==="registry: create"||pageName==="manage registry: create"||pmc.stringContains(window.location.pathname,"create-registry-confirmation")||(pmc.stringContains(window.location.pathname,"registry-list")&&pmc.stringContains(window.location.search,"congrats"))){try{pmc.getStorageValues("clickid");}catch(error){error.type="service";error.data="Location: pmc.registryListEvent";error.data+=": Storage Lookup Error: ";pmc.logError(error);}
analyticsVariables.tealium_event="registry_create";}}
analyticsVariables=pmc.setRegistryVariables(registry,analyticsVariables);pmc.fireLinkHit(analyticsVariables);};pmc.handleOptimizedRegistryCreation=function(eventData){var sendObj={};var privacy={};var step=pmc.getNestedValue(eventData,"item","");if(step==="event type"){sendObj.tealium_event="optimized_registry_create_event_type"}else if(step==="address"){sendObj.tealium_event="optimized_registry_create_address"}else if(step==="confirmation"){privacy=pmc.getNestedValue(eventData,"data.privacy");sendObj.tealium_event="registry_create"
sendObj.pmc_eVar36=pmc.getNestedValue(eventData,"data.registry.eventType","");sendObj.registry_id=pmc.getNestedValue(eventData,"data.registry.registryId","");sendObj=pmc.registryPrivacy(privacy,sendObj);sendObj=pmc.decorateRegistryAddObject(eventData,sendObj);}else{return;}
pmc.fireLinkHit(sendObj);};pmc.pageViewErrorPage=function(){if(digitalData.page.pageName.toUpperCase()==="CHECKOUT ERROR"){var messageNode=document.querySelector("h1")
if(messageNode!==null&&messageNode.innerText.toLowerCase().indexOf("no longer available")>0){utag_data["pmc_event155"]="event155";}}};pmc.legacySwatchOrdering=function(){var groupIdFromURL=document.location.pathname.match(/products\/([^\/]+)\//)[1];if(document.getElementById("swatchRequestForm")){utag_data.pmc_products=pmc.items.getSimpleProductString(groupIdFromURL);utag_data.tealium_event="swatch_legacy_open";}
var content=document.getElementById('content');if(content&&content.innerHTML&&pmc.stringContains(content.innerHTML,"Thank You")){utag_data.pmc_event246="event246";utag_data.pmc_products=pmc.items.getSimpleProductString(groupIdFromURL);utag_data.tealium_event="swatch_legacy_submit";}};pmc.pageViewGiftCards=function(){utag_data.pmc_prop1=utag_data.pmc_prop2=utag_data.pmc_eVar1="customer-service";utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5=utag_data.pmc_eVar2=utag_data.pmc_eVar3="customer-service:gift-services";};pmc.checkoutSignPageView=function(output){output.pmc_eVar4=pmc.getCheckoutType()||"guest regular";output.pmc_pageName="checkout:signin";output=pmc.addSwatchOnlyInitiationEvents(output);return output;};pmc.checkoutSignInError=function(){var errors=[];var error="";var pageName=pmc.getNestedStringValue(digitalData,"page.pageName").toLowerCase();if(pmc.stringContains(pageName,"checkout sign in")){errors=pmc.getNestedValue(digitalData,"page.attributes.errors");if(pmc.isArray(errors)){error=pmc.resolveMapLookup(errors,"checkout login");utag_data.pmc_prop24=utag_data.pmc_prop23=error||"";}}};pmc.handleReturnPageView=function(){var categoriesArray=pmc.getNestedValue(digitalData,"page.pageCategory.categories",[]);if(categoriesArray[0]==="return"){utag_data.pmc_pageName=pmc.getNestedValue(digitalData,"page.pageName","");if(utag_data.pmc_pageName==="customer-service:return:return-label"){utag_data.pmc_event345="event345";}}};pmc.handleWsReserveStatus=function(){utag_data.pmc_eVar77=pmc.checkNestedValue(digitalData,"x_user.profile.reserveStatus")?"WS Reserve Member":"";};pmc.pageViewMonogram=function(){var groupId=pmc.getNestedValue(digitalData,"page.attributes.groupId","");utag_data.pmc_pageName="monogram options";utag_data.pmc_event49="event49";utag_data.pmc_products=groupId?";"+groupId:"";utag_data.pmc_prop1='popup';utag_data.pmc_prop2='monogram-options';utag_data.pmc_prop3='monogram-options';utag_data.pmc_prop4='monogram-options';utag_data.pmc_prop5='monogram-options';};pmc.addEventsFromPfm=function(output){var pfm=output.pmc_eVar9;if(pfm==="WSIRecs:Shop-MoreLikeThis"||pfm==="WSIRecs:Search-MoreLikeThis"||pfm==="WSIRecs:HP-MoreLikeThis"||pfm==="WSIRecs:PIP-MoreLikeThis"){output.pmc_event373="event373";}
return output;};pmc.setKeyRewardsNotifications=function(notifications,output){var rewardAmount;if(typeof notifications!=="object"){return output;}
rewardAmount=notifications.context.replace("rewards","");output.pmc_eVar104=notifications.placement;output.pmc_eVar105=rewardAmount;output.pmc_event390=parseInt(rewardAmount)||0;output.pmc_event391="event391";return output;};pmc.parsePromotions=function(){var promotion=pmc.getQueryStringValue("cm_sp");var promoArray;var pageArea;var context;var placement;if(!promotion){return;}
promoArray=promotion.split("-_-");pageArea=promoArray[0];context=promoArray[1];placement=promoArray[2];if(pageArea==="navigation"&&pmc.stringContains(context,"rewards")){utag_data.pmc_eVar104=placement;utag_data.pmc_eVar105=context.replace("rewards","");utag_data.pmc_event392="event392";}};pmc.pageViewDesignServices=function(){if(pmc.checkNestedValue(digitalData,"page.attributes.appointmentsWidgetPresent")){utag_data.pmc_event412="event412";}};pmc.setGridSizeToggleImpression=function(output){var gridSize=pmc.getNestedLowerCaseValue(digitalData,"page.attributes.gridSize");output.pmc_eVar116=gridSize||"no grid toggle available";output.pmc_event424=gridSize?"event424":"";return output;};pmc.pageViewStyleQuiz=function(){let pageName=pmc.getNestedLowerCaseValue(digitalData,"page.pageName");if(pageName==="style quiz"){if(pmc.checkNestedValue(digitalData,"page.attributes.firstQuiz")){utag_data.pmc_event428="event428";}else{utag_data.pmc_event431="event431";}}else if(pageName==="style quiz results"){if(pmc.checkNestedValue(digitalData,"page.attributes.newQuiz")){if(pmc.checkNestedValue(digitalData,"page.attributes.firstQuiz")){utag_data.pmc_event429="event429";}else{utag_data.pmc_event432="event432";}}else if(pmc.checkNestedValue(digitalData,'page.attributes.savingQuiz')){utag_data.pmc_event430="event430";}}};pmc.pageView=function(){const pathname=pmc.environment.pathname;let errObj;try{pmc.setDebugMode();pmc.debugStatus("BEGIN pageView()");utag_data.tag_priority=utag_data.tag_priority||'1';utag_data["referrer_path"]=document.referrer.pathname;utag_data.pmc_eVar94=pmc.environment.dataCenter;utag_data.liveramp_ats_envelope=pmc.readCookie("wsid_lrenv");if(!window.digitalData){errObj=new Error("No digitalData object on page");errObj.type="datalayer";errObj.source="pmc.pageView";pmc.logError(errObj);return;}
pmc.initializeVariablesFromDataLayer(window.digitalData);utag_data.pmc_eVar9=utag_data.pmc_eVar9||pmc.getPfmFromURL();utag_data=pmc.addEventsFromPfm(utag_data);utag_data=pmc.processAuthentication(digitalData.x_user,utag_data);if(!digitalData.version&&digitalData.page.attributes.architecture&&digitalData.page.attributes.technology){let siteArchitecture=pmc.getNestedLowerCaseValue(digitalData,"page.attributes.architecture");let siteTechnology=pmc.getNestedLowerCaseValue(digitalData,"page.attributes.technology");utag_data.pmc_prop36=siteArchitecture+":"+siteTechnology;utag_data.pmc_eVar110=siteArchitecture==="dp"?"non-mfe page":siteArchitecture+":"+siteTechnology;}
if(pmc.checkNestedValue(digitalData,"page.attributes.mobile",true)&&!utag_data.pmc_eVar18&&!utag_data.pmc_prop18){utag_data.pmc_prop18=utag_data.pmc_eVar18="mobile site";}
if(pmc.checkNestedValue(digitalData,"page.attributes","productRankingAlgo")){utag_data.pmc_eVar65=pmc.getNestedLowerCaseValue(digitalData,"page.attributes.productRankingAlgo");}
if(pathname.includes("/checkout/thanks.html")&&pmc.getNestedLowerCaseValue(digitalData,"page.pageName").includes("order confirmation")){pmc.purchase();pmc.originalPageName=utag_data.pmc_pageName;return;}
if(pmc.getNestedLowerCaseValue(digitalData,"page.pageName")==="my favorites"){utag_data.pmc_pageName=utag_data.pmc_prop1=utag_data.pmc_prop2=utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5="my favorites";utag_data.pmc_eVar9="favorites";if(utag_data.pmc_event51==="event51"){utag_data.pmc_eVar38="my favorites";}}
var cmValue=pmc.getQueryStringValue("cm_src");if(cmValue==="shopByRoom"||cmValue==="shopByRoomGallery"||cmValue==="shopByRoomClick"||cmValue==="shopByRoomLookbook"){utag_data.pmc_event275="event275";}
if(pathname.includes("/customer-service/order-shipment-tracking/results.html")||pathname.includes("/customer-service/charge-details/results.html")){pmc.pageViewTrackOrder();}
try{var primaryCategory=pmc.getNestedLowerCaseValue(digitalData,"page.pageCategory.primaryCategory");if(primaryCategory==="search"){pmc.pageViewSearch();}else if(primaryCategory==="products"){pmc.pageViewProductDetailsPage();}else if(primaryCategory==="home"){utag_data.pmc_pageName=utag_data.pmc_prop1="home page";utag_data.pmc_prop2=utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5="D=c1";}else if(primaryCategory==="checkout"){if(pmc.isSparc()){pmc.handleSparcPageView();}else{utag_data.pmc_products=pmc.legacyCheckoutProductString();}}else if(primaryCategory==="shop"){utag_data=pmc.setRefinements(pmc.getNestedValue(digitalData,"page.attributes"),utag_data);utag_data.pmc_eVar93=pmc.getQueryStringValue("originsc")||"D=v1";utag_data=pmc.setGridSizeToggleImpression(utag_data);}else if(primaryCategory==="registry"){pmc.pageViewRegistry();}else if(primaryCategory==="gift card options"){utag_data.pmc_pageName="gift card options";utag_data.pmc_prop1=utag_data.pmc_prop2=utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5=utag_data.pmc_pageName;}else if(primaryCategory==="monogram-options"){pmc.pageViewMonogram();}else if(primaryCategory==="shoppingcart"){utag_data=pmc.cartPageView(digitalData.x_cart,utag_data);}else if(primaryCategory==="design-services"){pmc.pageViewDesignServices();}else if(primaryCategory==="internationalcheckout"){pmc.pageViewInternationalCheckout();}else if(primaryCategory==="style quiz"){pmc.pageViewStyleQuiz();}}catch(e){e.data="Problem setting category and type";pmc.logError(e);}
var incomingPageName=pmc.getNestedLowerCaseValue(digitalData,"page.pageName");if(incomingPageName==="error: session expired"){utag_data.pmc_pageName="checkout:issue:ordererror";utag_data.pmc_prop1=utag_data.pmc_prop2=utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5="checkout";if(pmc.isMobile){utag_data.pmc_prop23="MOBILE ERROR: SESSION EXPIRED";}else{utag_data.pmc_prop23="ERROR: SESSION EXPIRED";}}
var pageType=pmc.getNestedLowerCaseValue(digitalData,"page.pageType");if(pageType==="checklist"){utag_data=pmc.checklistPage(digitalData,utag_data);}
if(pmc.getQueryStringValue("searchredir")==="true"){pmc.pageViewSearchRedirect();}
if(pmc.getQueryStringValue("_br_psugg_q")){pmc.setTypeAheadSearchRecommendation();}
if(pathname.includes("/request-swatches.html")){pmc.legacySwatchOrdering();}else if(pathname.includes("/customer-service/gift-services/gift-card-landing")){pmc.pageViewGiftCards();}
if(pmc.checkNestedValue(digitalData,"page.attributes.template","shop-by-room-gallery")){utag_data.pmc_event273="event273";}
if(pmc.checkNestedValue(digitalData,"page.attributes.keyRewardsNotification")){utag_data=pmc.setKeyRewardsNotifications(digitalData.page.attributes.keyRewardsNotification,utag_data);}
if(utag_data.pmc_pageName==="customer-service:catalog-request:thanks-for-request"){utag_data.pmc_event30="event30";}
pmc.checkoutSignInError();var pageName=pmc.getNestedLowerCaseValue(digitalData,"page.pageName");if(pageName.includes("checkout sign in")||pageName.includes("checkout:signin")){utag_data=pmc.checkoutSignPageView(utag_data);}
pmc.pageViewAccountCreated();pmc.cartAddFromService();pmc.scheduledDeliveryPageView();pmc.handleAppQSParameters();pmc.handleReturnPageView();pmc.handleWsReserveStatus();pmc.parsePromotions();}catch(e){pmc.logError(e);}};pmc.quickLook=function(dataLayer,eventData){var groupId=pmc.normalizeProductIdString(eventData);pmc.fireViewHit({tealium_event:"quicklook",associatedTags:"adobeAnalytics",pmc_event41:"event41",pmc_prodView:"prodView",pmc_products:pmc.items.getSimpleProductString(groupId),pmc_pageName:"product detail:"+groupId,pmc_prop1:"product detail: quick look",pmc_prop2:"product detail",pmc_prop3:"product detail",pmc_prop4:"product detail",pmc_prop5:"product detail",pmc_eVar9:"",pmc_prop7:"D=v42",pmc_eVar42:"E:QUICKSHOP",pmc_prop6:"D=v41",pmc_eVar41:"QuickLook_Overlay",pmc_eVar18:utag_data.pmc_eVar18,pmc_prop18:utag_data.pmc_prop18,pmc_eVar63:groupId,page_type:"product",product_sku:[groupId],tag_priority:"9",});};pmc.quickBuy=function(dataLayer,eventData){var groupId=pmc.normalizeProductIdString(eventData)||pmc.getNormalProdId(dataLayer.product);pmc.fireViewHit({tealium_event:"quickbuy",associatedTags:"adobeAnalytics",pmc_event42:"event42",pmc_prodView:"prodView",pmc_products:pmc.items.getSimpleProductString(groupId),pmc_pageName:"product detail:"+groupId,pmc_prop1:"product detail: quick buy",pmc_prop2:"product detail",pmc_prop3:"product detail",pmc_prop4:"product detail",pmc_prop5:"product detail",pmc_eVar9:"",pmc_prop7:"D=v42",pmc_eVar42:"E:QUICKSHOP",pmc_prop6:"D=v41",pmc_eVar41:"QuickBuy_Overlay",pmc_eVar18:utag_data.pmc_eVar18,pmc_prop18:utag_data.pmc_prop18,pmc_eVar63:groupId,page_type:"product",product_sku:[groupId],tag_priority:"9",});};pmc.personalizationStartCallback=function(dataLayer,eventData){var groupID=pmc.getNormalProdId(dataLayer.product);pmc.fireViewHit({tealium_event:"personalization_start",associatedTags:"adobeAnalytics",pmc_event49:"event49",pmc_products:pmc.items.getSimpleProductString(groupID),pmc_prop1:"product: monogram options",pmc_prop2:"product",pmc_prop3:"product",pmc_prop4:"product",pmc_prop5:"product",pmc_pageName:"product: monogram preview overlay",pmc_eVar18:utag_data.pmc_eVar18,pmc_prop18:utag_data.pmc_prop18,tag_priority:"9",});};pmc.overlayPageView=function(a,b,digitalData,overlayName,prop1){var pageCategory=pmc.getNestedValue(digitalData,"page.pageCategory",{});if(typeof prop1!="undefined"){pmc.fireViewHit({tealium_event:"overlay_view",associatedTags:"adobeAnalytics",pmc_pageName:overlayName,pmc_prop1:prop1,pmc_prop2:pageCategory.primaryCategory,pmc_prop3:pageCategory.primaryCategory,pmc_prop4:pageCategory.primaryCategory,pmc_prop5:pageCategory.primaryCategory,pmc_event50:"",pmc_event47:"",pmc_prop14:"",pmc_eVar21:"",pmc_products:"",pmc_event42:null,pmc_event41:null,pmc_eVar18:utag_data["pmc_eVar18"],pmc_prop18:utag_data["pmc_prop18"],tag_priority:"9",});}else{pmc.fireViewHit({tealium_event:"overlay_view",associatedTags:"adobeAnalytics",pmc_pageName:overlayName,pmc_prop1:pageCategory.primaryCategory,pmc_prop2:pageCategory.primaryCategory,pmc_prop3:pageCategory.primaryCategory,pmc_prop4:pageCategory.primaryCategory,pmc_prop5:pageCategory.primaryCategory,pmc_event50:"",pmc_event47:"",pmc_prop14:"",pmc_eVar21:"",pmc_products:"",pmc_event42:null,pmc_event41:null,pmc_eVar18:utag_data["pmc_eVar18"],pmc_prop18:utag_data["pmc_prop18"],tag_priority:"9",});}};pmc.handlePipError=function(eventData){if(eventData.data){eventData.category=eventData.data.category;eventData.prodId=eventData.data.prodId;eventData.item=eventData.data.type;eventData.name=eventData.name;}
if(!eventData.item||!pmc.isArray(eventData.name)){return;}
if(pmc.suppressDoubleFire("handlePipErrorFired")){return true;}
var errorMessage=eventData.name.join(",");var description="PIP Error:"+errorMessage;var sendObj={tealium_event:"pip_error",pip_error_list:errorMessage,pmc_prop23:description,link_text:description,};if(eventData.product){sendObj.pmc_products=pmc.items.getProductString(eventData.product);}else{sendObj.pmc_products=pmc.items.getSimpleProductString(eventData.prodId||utag_data.PIPGroupID);}
if(errorMessage==="insufficient quantity available"){sendObj.pmc_event133="event133";}
pmc.fireLinkHit(sendObj);};pmc.handleUserError=function(eventData){var errorString=eventData.item+":"+eventData.errorCodes.join("|");pmc.fireLinkHit({tealium_event:"user_error",pmc_prop23:errorString,pmc_prop24:errorString,});};pmc.handleResetClick=function(data){var actionObject={tealium_event:"pip_reset_click",link_text:data.name+":"+data.category,};pmc.processPIPInteraction(actionObject);};pmc.trackWismo=function(data){try{var orderNumber=pmc.getNestedValue(digitalData,"page.attributes.shipmentTracking.orderNumber");var sendObj={tealium_event:"wismo_event",pmc_eVar5:orderNumber,};if(data.isBopis){sendObj.pmc_event137="event137";}
if(data.isHome){sendObj.pmc_event136="event136";}
if(data.isOther){sendObj.pmc_event138="event138";}
if(data.isParcel){sendObj.pmc_event135="event135";}
window.setTimeout(function(){pmc.fireLinkHit(sendObj);},500);}catch(e){pmc.logError(e);}};pmc.trackWismoAlert=function(data){if(!pmc.isVariableDefinedAndNonEmpty(data.alerts)){return;}
for(var i=0;i<data.alerts.length;i++){var sendObj={tealium_event:"wismo_alert",};var alertObj=data.alerts[i];if(pmc.isVariableDefinedAndNonEmpty(alertObj.alertPresent)&&alertObj.alertPresent==="true"){sendObj.pmc_event146="event146";}
if(pmc.isVariableDefinedAndNonEmpty(alertObj.alertMessage)){sendObj.pmc_prop23=alertObj.alertMessage;}
pmc.fireLinkHit(sendObj);}};pmc.handleCheckoutError=function(data){var sendObj={pmc_prop23:"",pmc_prop24:"",tealium_event:"checkout_error",};if(data.data&&pmc.isArray(data.data)){if(data.data[0]==="PROMO CODE"){data.data.shift();}
if(data.data.length>0){sendObj.pmc_prop24=sendObj.pmc_prop23=data.data.join("|");pmc.fireLinkHit(sendObj);}}};pmc.handleAvsError=function(data){var pageName=digitalData.page.pageName,errorString="";var sendObj={pmc_prop23:"",pmc_prop24:"",tealium_event:"avs_error",};if(typeof pageName==="string"&&pageName){pageName=pageName.toLowerCase();if(pmc.stringContains(pageName,"shipping")){errorString="AVS Shipping Failure";}else if(pmc.stringContains(pageName,"billing")){errorString="AVS Billing Failure";}
sendObj.pmc_prop23=sendObj.pmc_prop24=errorString;pmc.fireLinkHit(sendObj);}};pmc.handleProductRecs=function(data){try{if(!pmc.isArray(data.data._recommendedProducts)){return;}
var recs=data.data._recommendedProducts,sendObj={associatedTags:"revjet-prod-recs,amobee-prod-recs",tealium_event:"product_recommendation_impression",productRecName:data.name,productRecProdString:"",};for(var i=0,len=recs.length;i<len;i++){if(i>0){sendObj.productRecProdString+=",";}
sendObj.productRecProdString+=recs[i].productId;}
pmc.fireLinkHit(sendObj);}catch(e){pmc.logError(e);}};pmc.trackApplepayImpressions=function(eventData){try{var sendObj={tealium_event:"applepay_impression",associatedTags:"adobeAnalytics",};if(eventData.location==="SPARC"){sendObj.pmc_event258="event258";}else if(eventData.location==="Cart"){sendObj.pmc_event257="event257";}
pmc.fireLinkHit(sendObj);}catch(e){pmc.logError(e);}};pmc.handleThirdPartyCheckoutInitiation=function(eventData){try{if(pmc.checkDataDefinedAndNonEmpty(eventData,"item")){pmc.fireLinkHit({tealium_event:"third_party_checkout_initiation",pmc_eVar4:pmc.getCheckoutType(undefined,eventData.item.toLowerCase()),pmc_scCheckout:"checkout",});}}catch(e){e.data="tealium_event=third_party_checkout_initiation";pmc.logError(e);}}
pmc.handleShopByRoom=function(data){var sendObj={};var dataItem=pmc.getNestedLowerCaseValue(data,"item");var clickInteractionValue="shop-by-room:"+dataItem;if(dataItem==="impression"){sendObj={tealium_event:"shopbyroom_impression",pmc_event273:"event273",pmc_eVar123:data.variant||"curalate",associatedTags:"adobeAnalytics",pmc_products:pmc.items.getSimpleProductString(utag_data.PIPGroupID),};pmc.fireLinkHit(sendObj,true);return;}
sendObj={tealium_event:"shopbyroom_engagement",pmc_eVar92:clickInteractionValue,pmc_eVar123:data.variant||"curalate",};if(data.item==="show products"){sendObj.tealium_event="shopbyroom_interaction";}
if(utag_data.page_type==="product"){sendObj.pmc_prop14="D=v92";pmc.processPIPInteraction(sendObj,true);}else{pmc.fireLinkHit(sendObj,true);}};pmc.initializeCuralateUGC=function(){try{var ugcObject={imageType:"upload",optInChecked:false,};window.addEventListener("message",function(event){try{var errorObject={};var eventObject={};var buttonText="";var displayNameNodeList="";var emailAddressNodeList="";var termsAndConditionsNodeList="";var optInCheckedNodeList="";var nestedDataValue=pmc.getNestedStringValue(event,"data.pcmPixelPostMessageEvent.cd");if(nestedDataValue){eventObject=JSON.parse(nestedDataValue);if(eventObject.buttonText&&eventObject.buttonFeatures&&!pmc.stringContains(eventObject.buttonFeatures.toLowerCase(),"email")){buttonText=eventObject.buttonText.toLowerCase();if(buttonText==="facebook"||buttonText==="instagram"||buttonText==="upload"){ugcObject.imageType=buttonText;}else if(buttonText==="submit"){displayNameNodeList=document.querySelectorAll("[id^='crl8-custom-uploader'] input[name='displayName']");emailAddressNodeList=document.querySelectorAll("[id^='crl8-custom-uploader'] input[name='emailAddress']");termsAndConditionsNodeList=document.querySelectorAll("[id^='crl8-custom-uploader'] input[name='termsAndConditions']");optInCheckedNodeList=document.querySelectorAll("[id^='crl8-custom-uploader'] input[name='emailOptIn']");if(!displayNameNodeList.length&&!emailAddressNodeList.length&&!termsAndConditionsNodeList.length&&!optInCheckedNodeList.length){return;}else if(!displayNameNodeList.length||!emailAddressNodeList.length||!termsAndConditionsNodeList.length||!optInCheckedNodeList.length){errorObject=new Error("Curalate dom node not found");errorObject.type="datalayer";pmc.logError(errorObject);}else{if(displayNameNodeList[0].value&&emailAddressNodeList[0].value&&termsAndConditionsNodeList[0].value==="true"){ugcObject.optInChecked=optInCheckedNodeList.length>0?optInCheckedNodeList[0].value:"false";ugcObject.item="content submit";pmc.handleUgc(ugcObject);}}}}}}catch(err){err.source="addEventListener | pmc.initializeCuralateUGC";pmc.logError(err);}});}catch(e){pmc.logError(e);}};pmc.handleUrgencyImpression=function(data){try{var eventTypeMap=[{key:"pip urgency",value:"event328",},{key:"cart urgency",value:"event347",},];var urgencyType=pmc.getNestedStringValue(data,"item").toLowerCase();var eventNumber=pmc.resolveMapLookup(eventTypeMap,urgencyType);if(!eventNumber){return;}
var eventItems=data.impressionAssociations;var productList=pmc.items.createItemList();var productId="";var count=0;var item;for(var i=0;i<eventItems.length;i++){productId=eventItems[i].productId;count=eventItems[i].count;if(productId&&count){item=productList.addItem(productId);item.setEvar("eVar88",count);item.setEvent(eventNumber);}}
window.setTimeout(function(){pmc.fireLinkHit({pmc_products:productList.adobeString(),tealium_event:pmc.convertToSnakeCase(urgencyType)+"_impression",})},1000);}catch(e){pmc.logError(e);}};pmc.handleProductScarcityImpression=function(eventData){const eventItem=pmc.lowerCaseString(eventData.item);const prodList=pmc.items.createItemList(eventData.products);let sendObject={};if(prodList&&eventItem==="impression"){sendObject.tealium_event="product_scarcity_impression";prodList.items.forEach((product)=>{sendObject=product.setEvent("event423",1,sendObject);});sendObject.pmc_products=prodList.adobeString();pmc.fireLinkHit(sendObject);}};pmc.handleStyliticsMoodBoard=function(eventData){try{let sendObject={};let clickInteractionValue="stylitics "+pmc.getNestedLowerCaseValue(eventData,"action");if(pmc.checkNestedValue(eventData,"item","impression")){let productGroupId=utag_data.PIPGroupID;if(productGroupId){let item=pmc.items.createItem(productGroupId);sendObject=item.setEvent("event426",1,sendObject);sendObject.tealium_event="stylitics_mood_board_impression";sendObject.pmc_products=item.adobeString();pmc.fireLinkHit(sendObject,true);return;}}
sendObject.tealium_event="stylitics_mood_board_interaction";if(utag_data.page_type==="product"){sendObject.pmc_prop14=clickInteractionValue;sendObject.pmc_eVar92="D=c14";pmc.processPIPInteraction(sendObject,true);}else{pmc.fireLinkHit(sendObject,true);}}catch(e){pmc.logError(e);}};pmc.handleGridSizeToggleInteraction=function(eventData){try{var gridSize=pmc.getNestedLowerCaseValue(eventData,"gridSize");pmc.fireLinkHit({tealium_event:"grid_size_toggle_interaction",pmc_eVar116:gridSize,});}catch(e){pmc.logError(e);}};pmc.handleQudiniScheduling=function(eventData){try{var eventType="";var analyticsEvent="";var sendObj={};var eventMapping=[{key:"Appointment Open",value:"appointment_open",},{key:"Event Open",value:"event_open",},{key:"Event Scroll Interaction",value:"event_scroll",},{key:"Appointment Confirmation",value:"appointment_confirmation",},{key:"Appointment RescheduleConfirmation",value:"appointment_reschedule",},{key:"Appointment Cancellation",value:"appointment_cancellation",},{key:"Event Confirmation",value:"event_confirmation",},{key:"Appointment Choice In Person",value:"choice_in_person",},{key:"Appointment Choice Virtual",value:"choice_virtual",},{key:"Appointment Choice In Home",value:"choice_in_home",},{key:"Appointment Choice Contact Request",value:"choice_contact_requested",},];eventType=eventData.item||"";analyticsEvent=pmc.resolveMapLookup(eventMapping,eventType);if(analyticsEvent){sendObj={qudini_scheduling:analyticsEvent,tealium_event:"qudini_scheduling_"+analyticsEvent,};pmc.wsiTrackingEvent=pmc.wsiTrackingEventInit(window.WSI.tracking.wsiTracking,eventData,sendObj);if(utag_data.page_type==="product"){sendObj.pmc_prop14="Make a Free Design Appointment CTA"
pmc.processPIPInteraction(sendObj);}else{pmc.fireLinkHit(sendObj);}}}catch(e){pmc.logError(e);}};pmc.handleAddComponent=function(eventData){try{if(!pmc.checkNestedValue(eventData,"data")){return;}
pmc.handleDelayedEvent(eventData.data);}catch(e){e.data="data.category="+eventData.data.category+", data.item="+eventData.data.item+", data.name="+eventData.data.name;pmc.logError(e);}};pmc.fakePageViewAddToCart=function(){var page=pmc.managePreviousPageData("add item:add to cart","add to cart");pmc.fireViewHit({tealium_event:"fpv_add_to_cart",associatedTags:"adobeAnalytics",pmc_pageName:"add item:add to cart",pmc_prop1:"add to cart",pmc_prop2:"add item",pmc_prop3:"add item",pmc_prop4:"add item",pmc_prop5:"add item",pmc_prop19:page.previous_page_name,pmc_prop30:page.previous_page_type,tag_priority:"9",});};pmc.fakePageViewRegistryConfirm=function(){if(pmc.suppressDoubleFire("registryConfirmationRichFired")){return;}
var page=pmc.managePreviousPageData("add item:add to registry","add to registry");pmc.fireViewHit({associatedTags:"adobeAnalytics",tealium_event:"fpv_add_to_registry",pmc_pageName:"add item:add to registry",pmc_prop1:"add to registry",pmc_prop2:"add item",pmc_prop3:"add item",pmc_prop4:"add item",pmc_prop5:"add item",pmc_prop19:page.previous_page_name,pmc_prop30:page.previous_page_type,product_id:utag_data.product_id,product_unit_price:utag_data.product_unit_price,product_quantity:utag_data.product_quantity,tag_priority:"9",});};pmc.handleMiniPip=function(eventData){pmc.fireViewHit({tealium_event:"fpv_minipip_overlay",associatedTags:"adobeAnalytics",pmc_pageName:utag_data.pmc_pageName,pmc_prop1:"product detail:secondary product overlay",pmc_prop2:"product detail",pmc_prop3:"product detail",pmc_prop4:"product detail",pmc_prop5:"product detail",tag_priority:"9",});};pmc.addChildEvent=function(b){if(b.name!=="addChild"){return true;}
var addChildObject={};var suppressionName="addChildEventFired";suppressionName+=(b.target)?b.target.replace(/\W/g,"_"):"";if(pmc.suppressDoubleFire(suppressionName)){return true;}
var pageCategory=pmc.getNestedValue(window.digitalData,"page.pageCategory",{});if(pmc.checkNestedValue(b,"target","QuickLook_Overlay")){pmc.quickLook(digitalData,b.data);return;}
if(pmc.checkNestedValue(b,"target","QuickBuy_Overlay")){pmc.quickBuy(digitalData,b.data);return;}
if(b.target==="Monogram Preview Overlay"){pmc.personalizationStartCallback(digitalData,b);return;}
if(b.target==="ECOMMERCE CONFIRMATION-RICH"&&pmc.pageName.toUpperCase().indexOf("REGISTRY")===-1){pmc.fakePageViewAddToCart();return;}
if(b.target==="Search Results Main"||b.target==="Search Results Overlay"){pmc.search.handleResults(b,addChildObject);return;}
if(b.target==="Category Main"&&pmc.checkNestedValue(b,"data.refinements")){pmc.processCategoryRefinements(b.data);return;}
if(b.target==="REGISTRY CONFIRMATION-RICH"){pmc.fakePageViewRegistryConfirm();return;}
if(b.target==="On Display In Store"){addChildObject.tealium_event="on_display_open";addChildObject.pmc_prop14="See This In Store";if(b.data.numberOfStoresWithDisplays==="0"){addChildObject.pmc_event127="event127";}
addChildObject.pmc_products=pmc.items.getSimpleProductString(pmc.getNestedValue(digitalData,"product.productID.prodID"));pmc.processPIPInteraction(addChildObject);return;}
if(b.target==="POPUP: SHIPPING OPTIONS"){addChildObject.tealium_event="shipping_popup";addChildObject.associatedTags="adobeAnalytics";addChildObject.pmc_pageName="shipping options overlay";addChildObject.pmc_prop1=addChildObject.pmc_prop2=addChildObject.pmc_prop3=addChildObject.pmc_prop4=addChildObject.pmc_prop5=pageCategory.primaryCategory;pmc.fireLinkHit(addChildObject);return;}
if(b.target==="POPUP: RETURN POLICY"){addChildObject.tealium_event="return_policy_popup";addChildObject.associatedTags="adobeAnalytics";addChildObject.pmc_pageName="return policy overlay";addChildObject.pmc_prop1=addChildObject.pmc_prop2=addChildObject.pmc_prop3=addChildObject.pmc_prop4=addChildObject.pmc_prop5=pageCategory.primaryCategory;pmc.fireLinkHit(addChildObject);return;}
if(b.target==="POPUP: CHECK SVC BALANCE"){addChildObject.tealium_event="check_svc_balance_popup";addChildObject.associatedTags="adobeAnalytics";addChildObject.pmc_pageName="svc balance overlay";addChildObject.pmc_prop1=addChildObject.pmc_prop2=addChildObject.pmc_prop3=addChildObject.pmc_prop4=addChildObject.pmc_prop5=pageCategory.primaryCategory;pmc.fireLinkHit(addChildObject);return;}
if(b.target==="POPUP: GIFT WRAP"){addChildObject.tealium_event="gift_wrap_popup";addChildObject.associatedTags="adobeAnalytics";addChildObject.pmc_pageName="gift wrap overlay";addChildObject.pmc_prop1=addChildObject.pmc_prop2=addChildObject.pmc_prop3=addChildObject.pmc_prop4=addChildObject.pmc_prop5=pageCategory.primaryCategory;pmc.fireLinkHit(addChildObject);return;}
if(b.target==="ACCOUNT: ADDRESS BOOK ADD"){addChildObject.tealium_event="address_book_add";addChildObject.associatedTags="adobeAnalytics";addChildObject.pmc_pageName="account:address book add";addChildObject.pmc_prop1=addChildObject.pmc_prop2=addChildObject.pmc_prop3=addChildObject.pmc_prop4=addChildObject.pmc_prop5="overlay";pmc.fireLinkHit(addChildObject);return;}
if(b.target==="ACCOUNT: ADDRESS BOOK EDIT"){addChildObject.tealium_event="address_book_edit";addChildObject.associatedTags="adobeAnalytics";addChildObject.pmc_pageName="account:address book edit";addChildObject.pmc_prop1=addChildObject.pmc_prop2=addChildObject.pmc_prop3=addChildObject.pmc_prop4=addChildObject.pmc_prop5="overlay";pmc.fireLinkHit(addChildObject);return;}
if(b.target==="ACCOUNT: ADDRESS BOOK REMOVE"){addChildObject.tealium_event="address_book_remove";addChildObject.associatedTags="adobeAnalytics";addChildObject.pmc_pageName="account:address book remove";addChildObject.pmc_prop1=addChildObject.pmc_prop2=addChildObject.pmc_prop3=addChildObject.pmc_prop4=addChildObject.pmc_prop5="overlay";pmc.fireLinkHit(addChildObject);return;}
if(b.target==="ACCOUNT: RESEND EMAIL"){addChildObject.tealium_event="account_resend_email";addChildObject.associatedTags="adobeAnalytics";addChildObject.pmc_pageName="account:resent email";addChildObject.pmc_prop1=addChildObject.pmc_prop2=addChildObject.pmc_prop3=addChildObject.pmc_prop4=addChildObject.pmc_prop5="overlay";pmc.fireLinkHit(addChildObject);return;}
if(b.target==="PASSWORD GUIDELINES"){addChildObject.tealium_event="password_guidelines";addChildObject.associatedTags="adobeAnalytics";addChildObject.pmc_pageName="account:password guidelines";addChildObject.pmc_prop1=addChildObject.pmc_prop2=addChildObject.pmc_prop3=addChildObject.pmc_prop4=addChildObject.pmc_prop5="overlay";pmc.fireLinkHit(addChildObject);return;}
if(b.target==="monogram guide"){addChildObject.tealium_event="monogram_guide";addChildObject.associatedTags="adobeAnalytics";addChildObject.pmc_pageName=b.target;addChildObject.pmc_prop1="popup";addChildObject.pmc_prop2=addChildObject.pmc_prop3=addChildObject.pmc_prop4=addChildObject.pmc_prop5="monogram-options";addChildObject.pmc_eVar41="MONOGRAM GUIDE";addChildObject.pmc_eVar42="OVERLAY";pmc.fireLinkHit(addChildObject);return;}
if(b.target==="international shipping to"){addChildObject.tealium_event="international_shipping";addChildObject.associatedTags="adobeAnalytics";addChildObject.pmc_pageName=b.target;addChildObject.pmc_prop1="overlay";addChildObject.pmc_prop2=addChildObject.pmc_prop3=addChildObject.pmc_prop4=addChildObject.pmc_prop5="international";addChildObject.pmc_eVar41="INTERNATIONAL: SHIPPING TO";addChildObject.pmc_eVar42="INTERNATIONAL";pmc.fireLinkHit(addChildObject);return;}
if(b.target==="international product eligibility"){addChildObject.tealium_event="international_eligibility";addChildObject.associatedTags="adobeAnalytics";addChildObject.pmc_pageName=b.target;addChildObject.pmc_prop1="overlay";addChildObject.pmc_prop2=addChildObject.pmc_prop3=addChildObject.pmc_prop4=addChildObject.pmc_prop5="customer-service";addChildObject.pmc_eVar41="INTL: PRODUCT ELIGIBILITY OVERLAY";addChildObject.pmc_eVar42="INTL";pmc.fireLinkHit(addChildObject);return;}
if(b.target==="Registry List Main"&&pmc.checkNestedValue(b,"data.registry")){pmc.registryListEvent(b.data.registry);return;}
if(pmc.checkNestedValue(b,"target","opened3Dfabric")){var openedProduct=pmc.items.createItem(pmc.getNestedValue(digitalData,"product.productID.prodID"),pmc.getNestedValue(b,"data.skuId"));pmc.fireLinkHit({tealium_event:"3d_fabric_open",pmc_products:openedProduct.adobeString(),link_text:"3Dfabric:"+b.data.fabricId,});}else if(pmc.checkNestedValue(b,"target","applied3Dfabric")){var appliedProduct=pmc.items.createItem(pmc.getNestedValue(digitalData,"product.productID.prodID"),pmc.getNestedValue(b,"data.skuId"));pmc.fireLinkHit({tealium_event:"3d_fabric_apply",pmc_products:appliedProduct.adobeString(),link_text:"3Dfabric:"+b.data.fabricId,});}
return;}
pmc.clearVariables=function(){for(var instance in utag_data){if(instance.indexOf("pmc")===0){utag_data[instance]="";}}};pmc.handleVirtualPageView=function(a,b,c){try{for(var h=1;h<9;h++){if(utag_data.hasOwnProperty('_pathname'+h)){utag_data['_pathname'+h]='';}}
a=document.location.pathname.split('/');b=(a.length>9)?9:a.length;for(c=1;c<b;c++){utag_data['_pathname'+c]=(typeof a[c]!='undefined')?a[c]:'';}
b=function(obj,filter){var key,keys=[];for(key in obj){if(obj.hasOwnProperty(key)&&filter.test(key)){keys.push(key);}}
return keys;};a=b(utag_data,/pmc_/);for(c in a){if(a.hasOwnProperty(c)){utag_data[a[c]]='';}}
a=b(utag_data,/qp\./);for(c in a){if(a.hasOwnProperty(c)){utag_data[a[c]]='';}}
utag_data["pmc_eVar27"]="";utag_data["pmc_eVar9"]="";utag_data["pmc_prop9"]="";if(window.s){window.s.__fo=null;window.s.internalFlag=false;window.s.timingPerformanceTracked=false;if(typeof(window.s.clearVars)==="function"){window.s.clearVars();}}
window.s.pageURL=document.location.href;try{pmc.initializeVariablesFromBrowser();}catch(e){pmc.logError("Error in pmc.initializeVariablesFromBrowser() on MFE page. "+e.message);}}catch(e){pmc.logError(e);}};pmc.initializeSparcDeliveryDates=function(cart){try{if(!cart){cart=digitalData.cart;}
if(!pmc.checkDataDefinedAndNonEmpty(cart,"subOrders")||!pmc.isArray(cart.subOrders)){return"";}
var subOrders=cart.subOrders;for(var i=0,iLen=subOrders.length;i<iLen;i++){var deliveryGroups=subOrders[i].deliveryGroups;if(!deliveryGroups){break;}
for(var j=0,jLen=deliveryGroups.length;j<jLen;j++){var currentDeliveryGroup=deliveryGroups[j];if(currentDeliveryGroup){var skus=currentDeliveryGroup.affectedSkus;if(!skus){break;}
for(var k=0,kLen=skus.length;k<kLen;k++){var sku=skus[k];var estimatedStart=currentDeliveryGroup.estimatedDeliveryDate.start;var estimatedEnd=currentDeliveryGroup.estimatedDeliveryDate.end;if(estimatedStart&&estimatedEnd){var skuElement=pmc.skuData[sku]||pmc.newSkuDataElement();skuElement.deliveryType=currentDeliveryGroup.type;skuElement.start=estimatedStart;skuElement.end=estimatedEnd;pmc.skuData[sku]=skuElement;}}}}}}catch(e){pmc.logError(e);}};pmc.parseSubOrders=function(subOrders){const deliveryDetailsBySku={};if(!pmc.isArray(subOrders)){return{};}
var _processSkus=function(skus,deliveryDetails){if(!pmc.isArray(skus)){return;}
for(let i=0,il=skus.length;i<il;i++){deliveryDetailsBySku[skus[i]]=deliveryDetails;}};var _parseDeliveryGroups=function(deliveryGroups){if(!pmc.isArray(deliveryGroups)){return;}
for(let i=0,il=deliveryGroups.length;i<il;i++){let deliveryDetails={startDate:pmc.getNestedValue(deliveryGroups[i],"estimatedDeliveryDate.start"),endDate:pmc.getNestedValue(deliveryGroups[i],"estimatedDeliveryDate.end"),type:pmc.getNestedValue(deliveryGroups[i],"type"),};if(deliveryDetails.startDate&&deliveryDetails.endDate){deliveryDetails.startDays=pmc.getDaysBetweenDateAndToday(deliveryDetails.startDate);deliveryDetails.endDays=pmc.getDaysBetweenDateAndToday(deliveryDetails.endDate);_processSkus(deliveryGroups[i].affectedSkus,deliveryDetails);}}};for(var i=0,il=subOrders.length;i<il;i++){_parseDeliveryGroups(subOrders[i].deliveryGroups);}
return deliveryDetailsBySku;};pmc.setDeliveryData=function(currentItem,deliveryDetails,sendObj){if(typeof currentItem!=="object"||typeof deliveryDetails!=="object"){return;}
currentItem.setEvent("event161",1,sendObj);sendObj=currentItem.setEvent("event163",deliveryDetails.startDays,sendObj);sendObj=currentItem.setEvent("event164",deliveryDetails.endDays,sendObj);currentItem.setEvar("eVar66",deliveryDetails.startDays);currentItem.setEvar("eVar67",deliveryDetails.endDays);currentItem.setEvar("eVar69",deliveryDetails.startDate);currentItem.setEvar("eVar70",deliveryDetails.endDate);return sendObj;};pmc.getSparcProductList=function(cart,output){try{const itemList=pmc.items.createItemList();let deliveryDetailsBySku;if(typeof cart!=="object"||!pmc.isArray(cart.items)){let errorObj=new Error("Invalid or missing cart in data layer");errorObj.type="datalayer";pmc.logError(errorObj);return itemList;}
deliveryDetailsBySku=pmc.parseSubOrders(cart.subOrders);for(let i=0,len=cart.items.length;i<len;i++){let dataLayerItem=cart.items[i]||{};let groupId=dataLayerItem.persistentProductId||dataLayerItem.primaryGroupId;if(groupId){let item=itemList.addItem(groupId,dataLayerItem.sku);if(pmc.checkNestedValue(dataLayerItem,"attributes.itemType","swatch")){item.setAsSwatch();item.setUnitPrice(dataLayerItem.unitPrice);}
pmc.setDeliveryData(item,deliveryDetailsBySku[dataLayerItem.sku],output);}else{pmc.logError("groupId is required for all items in the dataLayer.");}}
return itemList;}catch(e){pmc.logError(e);}};pmc.reinitializePathnameHierarchy=function(){try{utag_data["pmc_pageName"]=undefined;var a=document.location.pathname.split('/');var b=(a.length>9)?9:a.length;for(var c=1;c<b;c++){utag_data['_pathname'+c]=(typeof a[c]!='undefined')?a[c]:''}
utag_data["pathNameHasBeenReset"]=true;}catch(e){pmc.logError(e);}}
pmc.getUpsAccessPointEligibility=function(cart){if(pmc.isNestedDataDefinedAndNonEmpty(cart,"attributes.upsAccessPointEligibility")){return cart.attributes.upsAccessPointEligibility;}
return"";};pmc.setUpsAccessPointImpression=function(cart){var eligibility=pmc.getUpsAccessPointEligibility(cart);if(eligibility){utag_data["pmc_eVar91"]=eligibility;if(eligibility!=="Ineligible"){utag_data["pmc_event290"]="event290";}}};pmc.addSwatchOnlyInitiationEvents=function(output){var checkoutType=pmc.getQueryStringValue("chkmode");if(!checkoutType){output.pmc_scCheckout="checkout";if(output.pmc_pageName==="checkout:signin"){output.pmc_event1="event1";}}else if(checkoutType==="freeswatch"){output.pmc_event360="event360";}else if(checkoutType==="paidswatch"){output.pmc_event361="event361";}
return output;};pmc.handleSparcPageView=function(){var itemList;try{utag_data.pmc_pageName=utag_data.pmc_pageName.replace("app","module");utag_data.pmc_prop3=utag_data.pmc_prop4=utag_data.pmc_prop5=utag_data.pmc_pageName;itemList=pmc.getSparcProductList(digitalData.cart,utag_data);if(itemList.hasNonSwatches()){utag_data.pmc_scCheckout="checkout";}else{utag_data=pmc.addSwatchOnlyInitiationEvents(utag_data);}
utag_data.pmc_eVar4=pmc.getCheckoutType(itemList);utag_data.pmc_products=itemList.adobeString();pmc.setUpsAccessPointImpression(digitalData.cart);}catch(e){pmc.logError(e);}};pmc.handleUpsAccessPointEvents=function(data){try{var eligibility=pmc.getUpsAccessPointEligibility(digitalData.cart);var eventType=data.item;if(!eligibility||!eventType){return;}
var sendObject={pmc_eVar91:eligibility,tealium_event:"ups_access_point",};if(eventType==="Search Button Click"){sendObject["pmc_event292"]="event292";}else if(eventType==="Location Selected"){sendObject["pmc_event293"]="event293";}
pmc.fireLinkHit(sendObject);}catch(e){e.data="tealium_event=ups_access_point";pmc.logError(e);}};pmc.isSparc=function(){try{var path=window.document.location.pathname;return pmc.stringContains(path,"/checkout/app/")||pmc.stringContains(path,"/update-payment/app/");}catch(e){pmc.logError(e);}};pmc.isMFE=function(){try{return!digitalData.version&&(pmc.checkNestedValue(window.digitalData,"page.attributes.architecture","mfe")||pmc.checkNestedValue(window.WSI,"dataLayer.registerCallback.version","mfe"));}catch(e){pmc.logError(e);}};pmc.isNewMfe=function(){try{return pmc.isMFE()&&!pmc.checkNestedValue(window,"WSI.dataLayer.updateObject");}catch(e){pmc.logError(e);}};pmc.getTealiumEvent=function(){var pageName="";var pageType="";if(utag_data.page_name){pageName=utag_data.page_name.toLowerCase();if(pageName==="ws credit card landing"){return"credit_card_view";}
if(pageName==="account: sign in"){return"account_signin_view";}
if(pageName==="account: my account"){return"account_myaccount_view";}
if(pageName==="account: signed out"){return"account_signout_view";}
if(pageName==="thekey:enroll:thankyou"||pageName==="thekey:enroll:confirmed"){return"key_confirmation";}
if(pageName==="registry:create-registry-confirmation"||(pmc.stringContains(window.location.pathname,"registry-list")&&pmc.stringContains(window.location.search,"congrats"))){if(pmc.checkNestedValue(digitalData,"x_registry.attributes.dataAvailability","after page load")){return"registry_create_partial";}
return"registry_create";}
if(pageName==="registry:registry-list"){return"registry_list_view";}
if(pageName==="stores:store-locator"){return"store_locator_view";}
if(pageName==="customer service:international email confirmation"){return"email_confirm_view";}
if(pageName==="ws chef: sign up confirm"){return"pro_chef_confirm_view";}
if(pageName==="thekey:enroll:unconfirmed"){return"thekey_confirm_view";}
if(pageName==="swatch request confirm"){return"swatch_order_submit";}}
if(pmc.stringContains(pmc.environment.pathname,"/create-registry-confirmation")){return"registry_create";}
if(utag_data.page_type){pageType=utag_data.page_type.toLowerCase();if(pageType==="home"){return"homepage_view";}
if(pageType==="category"){return"category_view";}
if(pageType==="product"){return"product_view";}
if(pageType==="cart"){return"cart_view";}
if(pageType==="checkout"){return"checkout";}
if(pageType==="search"){return"search_results";}
if(pageType==="registry"){return"registry_view";}
if(pageType==="style quiz"){return"style_quiz_view";}}
if(utag_data.pmc_prop1==="contest"){return"contest_view";}
if(pmc.stringContains(pmc.environment.pathname,"sweepstakes/thank")){return"sweepstakes_thanks";}
if(pmc.stringContains(pmc.environment.pathname,"/customer-service/credit-card")){return"credit_card_legacy_view";}
if(pmc.stringContains(pmc.environment.pathname,"/pages/credit-card/")){return"credit_card_apply_now_view";}
if(pmc.stringContains(pmc.environment.pathname,"/pages/the-key-rewards/")){return"the_key_rewards_view";}
if(utag_data.pmc_scView==="scView"){return"cart_view";}
if(utag_data.order_id){return"purchase";}else if(utag_data.order_id_swatches_only){return"purchase_swatches_only";}
if(utag_data.pmc_scAdd==="scAdd"){return"cart_add";}
return"generic_pageview";};pmc.setEcommerceVariables=function(){utag_data.product_id=utag_data.product_id||[];utag_data.product_sku=utag_data.product_sku||[];utag_data.product_name=utag_data.product_name||[];utag_data.product_unit_price=utag_data.product_unit_price||[];utag_data.product_discounted_price=utag_data.product_discounted_price||[];utag_data.product_quantity=utag_data.product_quantity||[];utag_data.product_discount=utag_data.product_discount||[];if(digitalData.product){utag_data.product_id.push(pmc.getNormalProdId(digitalData.product));utag_data.product_name.push(pmc.normalizeProductIdObject(digitalData.product).productName);utag_data.product_unit_price.push(pmc.getNestedValue(digitalData.product,"price.selling.min"));}};pmc.handleDataLayerReady=function(eventData){try{utag_data.page_name=utag_data.page_name||pmc.getNestedStringValue(digitalData,"page.pageName")||pmc.getNestedStringValue(digitalData,"page.attributes.cmPageId")||"NoPageName";if(pmc.isFirstPageViewComplete){pmc.handleVirtualPageView();}else{pmc.isFirstPageViewComplete=true;}
pmc.setEcommerceVariables();if(window.utag&&utag.pagevars){utag.pagevars();}
try{window.com.tealium.convert_to_udo(digitalData);}catch(e){e.data="Error calling com.tealium.convert_to_udo";pmc.logError(e);}
pmc.pageView();var previousPage=pmc.managePreviousPageData();utag_data.quantum_session_id=window.sessionStorage.getItem("qmSessionId");utag_data.tealium_event=pmc.getTealiumEvent();if(utag_data.tealium_event==="registry_create"){try{pmc.getStorageValues("clickid");}catch(error){error.type="service";error.data="Location: pmc.handleDataLayerReady: registry_create";error.data+=": Storage Lookup Error: ";pmc.logError(error);}}
var appMeasurementLookupInternational={ca:["823","855"],};var appMeasurementLookupUs={pt:["5078","4566"],mg:["5584","4964"],pb:["6255","5459"],pk:["5618","4875"],we:["5687","5241"],ws:["6491","5917"],rj:["5985","6014"],gr:["481","375"],};var brandUID=appMeasurementLookupInternational[pmc.environment.market]||appMeasurementLookupUs[pmc.environment.brandCode];pmc.addErrorLogToHit(utag_data);pmc.isErrorPageviewProcessingComplete=true;if(!pmc.readCookie("WSIRetailStore")){utag.view(utag_data,null,brandUID);}
window.setTimeout(function(){utag_data.tag_priority="2";utag_data.tealium_event=pmc.getTealiumEvent();utag.view(utag_data);utag_data.tag_priority="9";},750);}catch(e){pmc.logError(e);}};pmc.initializeAdobeAnalytics=function(){return pmc.getReportSuite(pmc.environment);};pmc.buildSparcErrorProductString=function(eventData,output){var itemList;var dataLayerItem;var product;var error;var errorsArray=pmc.getNestedValue(eventData,"errors");if(!pmc.isArray(errorsArray)){return"";}
itemList=pmc.items.createItemList();for(var i=0,len=errorsArray.length;i<len;i++){error=errorsArray[i];dataLayerItem=error.attributes;if(dataLayerItem&&dataLayerItem.productId){product=itemList.addItem(dataLayerItem.productId,dataLayerItem.sku);if(error.errorCode==="backorder"){product.setEvar("eVar45","Backordered");product.setBackOrderFromDate(dataLayerItem.backOrderDate,output);}else if(error.errorCode==="no longer available"){product.setEvar("eVar45","NLA");}}}
return itemList.adobeString();};pmc.formatSparcErrorMessage=function(error){if(error.errorType&&error.errorCode){return error.errorType+":"+error.errorCode;}
return"";};pmc.enrichSparcObjectWithErrorSpecificVariables=function(error,linkObj){if(!pmc.isArray(pmc.getNestedValue(error,"errorCode"))){return linkObj;}
var errorCodeMap={"promo conflict":[{key:"pmc_event179",value:"event179"},{key:"pmc_eVar6",value:"",custom:function(error){if(pmc.checkNestedValue(error,"attributes.promoCode")){return error.attributes.promoCode;}else{return"";}}}],"backorder":[{key:"pmc_event74",value:"event74"},{key:"pmc_event56",value:"event56"}]};var variablesArray=errorCodeMap[error.errorCode];if(pmc.isArray(variablesArray)){for(var i=0,len=variablesArray.length;i<len;i++){var variableObject=variablesArray[i];linkObj[variableObject.key]=variableObject.value||variableObject.custom(error)||"";}}
return linkObj;};pmc.enrichSparcObjectWithErrorVariables=function(eventData,linkObj){if(!pmc.isArray(pmc.getNestedValue(eventData,"errors"))){return linkObj;}
var errorsDestination=[];var errorsSource=eventData.errors;for(var i=0,len=errorsSource.length;i<len;i++){linkObj=pmc.enrichSparcObjectWithErrorSpecificVariables(errorsSource[i],linkObj);var formattedError=pmc.formatSparcErrorMessage(errorsSource[i]);if(formattedError&&errorsDestination.indexOf(formattedError)===-1){errorsDestination.push(formattedError);}}
if(errorsDestination.length>0){linkObj.pmc_prop24=linkObj.pmc_prop23=errorsDestination.join("|");}
return linkObj;};pmc.handleSparcCheckoutError=function(eventData){var sendObj={};sendObj=pmc.enrichSparcObjectWithErrorVariables(eventData,sendObj);var productString=pmc.buildSparcErrorProductString(eventData);if(productString){sendObj.pmc_products=productString;}
if(pmc.isVariableDefinedAndNonEmpty(sendObj)){sendObj.tealium_event="sparc_checkout_error";sendObj.pmc_pageName=pmc.currentSparcModuleName;pmc.fireLinkHit(sendObj);}};pmc.hasFurnitureValueChoice=function(subOrders){var hasImpression=false;var serviceLevels=[];for(var i=0;i<subOrders.length;i++){serviceLevels=pmc.getNestedValue(subOrders[i],"eligibleServiceLevels",[]);if(pmc.arrayContains(serviceLevels,"WHITE_GLOVE")&&pmc.arrayContains(serviceLevels,"DOORSTEP")){hasImpression=true;}}
return hasImpression;};pmc.setDgoCartVariables=function(eventData,sendObj){if(pmc.isNestedDataDefinedAndNonEmpty(eventData,"attributes.cart.attributes")){var cart=eventData.attributes.cart;var subOrders=cart.subOrders||[];var attributes=cart.attributes;sendObj=pmc.shipmentConsolidation.setDgoVariables(eventData,attributes.hasAutoDeliveryConsolidation,sendObj);if(attributes.hasConveyableConsolidation){sendObj.pmc_event260="event260";}
if(attributes.autoConsolidationEligibility&&attributes.autoConsolidationEligibility==="Eligible"){sendObj.pmc_event289="event289";}
if(attributes.hasInHomeConsolidation){sendObj.pmc_event261="event261";}
if(pmc.checkNestedValue(eventData,"attributes.deliverWithFurnitureOffered")){sendObj.pmc_event384="event384";}
sendObj.shippingConsolidationSelected=pmc.shipmentConsolidation.getTypes(cart.items,"readyToShip.shipMode");if(pmc.hasFurnitureValueChoice(subOrders)){sendObj.pmc_event325="event325";}}
if(pmc.checkNestedValue(eventData,"attributes.chooseYourDateImpression")){sendObj.pmc_event297="event297";}
return sendObj;};pmc.setCreditCardBannerVariables=function(eventData,sendObj){var bannerType=pmc.getNestedStringValue(eventData,"attributes.prescreenedCreditCardBanner");if(bannerType){sendObj.pmc_eVar106="prescreen credit banner "+bannerType;sendObj.pmc_event84="event84";}
return sendObj;};pmc.handleSparcModule=function(data){var itemList;try{if(!pmc.checkNestedValue(data,"attributes.next")){return;}
var sendObj={};var attributes=data.attributes||{};var newStep=attributes.next;var hasMerchandise;var user=data.user||attributes.user;if(user){sendObj=pmc.processAuthentication(user,sendObj);}
itemList=pmc.getSparcProductList(attributes.cart,sendObj);hasMerchandise=itemList.hasNonSwatches();sendObj=pmc.setCreditCardBannerVariables(data,sendObj);if(newStep==="signin"){sendObj.pmc_event1=hasMerchandise?"event1":"";sendObj.pmc_event351="event351";sendObj.pmc_pageName="checkout:module:signin";sendObj.tealium_event="sparc_module_signin";}else if(newStep==="welcomeback"){sendObj.pmc_pageName="checkout:module:welcomeback";sendObj.tealium_event="sparc_module_welcomeback";}else if(newStep==="createaccount"){sendObj.pmc_pageName="checkout:module:checkout:module:createaccount";sendObj.tealium_event="sparc_module_createaccount";}else if(newStep==="shipping"){sendObj.pmc_event2=hasMerchandise?"event2":"";sendObj.pmc_pageName="checkout:module:shipping";sendObj.tealium_event="sparc_module_shipping";}else if(newStep==="multiple_shipping"){sendObj.pmc_event3=hasMerchandise?"event3":"";sendObj.pmc_pageName="checkout:module:multipleaddresses";sendObj.tealium_event="sparc_module_multiple_shipping";}else if(newStep==="billing"){sendObj.pmc_event5=hasMerchandise?"event5":"";sendObj.pmc_pageName="checkout:module:billing";sendObj.tealium_event="sparc_module_billing";}else if(newStep==="payment"){sendObj.pmc_event6=hasMerchandise?"event6":"";sendObj.pmc_pageName="checkout:module:payment";sendObj.tealium_event="sparc_module_payment";if(pmc.checkNestedValue(data,"attributes.applePayImpression",true)){sendObj.pmc_event258="event258";}}else if(newStep==="review"){sendObj.pmc_event4=hasMerchandise?"event4":"";sendObj.pmc_pageName="checkout:module:review";sendObj.tealium_event="sparc_module_delivery";sendObj=pmc.setDgoCartVariables(data,sendObj);}else{var e=new Error("Invalid checkout step name '"+newStep+"' in data.attributes.next.");e.type="datalayer";pmc.logError(e);}
sendObj.pmc_products=itemList.adobeString();sendObj.pmc_eVar4=pmc.getCheckoutType(itemList,pmc.getNestedValue(data,"attributes.checkoutType"))||utag_data.pmc_eVar4;pmc.currentSparcModuleName=pmc.originalPageName=sendObj.pmc_pageName;pmc.fireLinkHit(sendObj);}catch(err){pmc.logError(err);}};pmc.handleSparcPromo=function(data){try{if(!pmc.checkNestedValue(data,"attributes")){return;}
var sendObj={tealium_event:"sparc_promo_event",pmc_eVar6:pmc.getNestedLowerCaseValue(data,"attributes.promoCode"),pmc_eVar62:data.attributes.promoType,};if(pmc.checkNestedValue(data,"errors")){sendObj.tealium_event="sparc_promo_error";sendObj.pmc_event178="event178";sendObj=pmc.enrichSparcObjectWithErrorVariables(data,sendObj);}else if(data.userAction==="apply"){sendObj.tealium_event="sparc_promo_apply";sendObj.pmc_event177="event177";sendObj.pmc_event79="event79";sendObj.pmc_eVar61="Promo Code Applied";}else if(data.userAction==="remove"){sendObj.tealium_event="sparc_promo_remove";sendObj.pmc_event179="event179";sendObj.pmc_event79="event79";sendObj.pmc_eVar61="Promo Code Removed";}
pmc.fireLinkHit(sendObj);}catch(e){pmc.logError(e);}};pmc.handleSparcGiftRewards=function(data){var sendObj={tealium_event:"sparc_gift_event",pmc_event79:"event79",};if(pmc.checkNestedValue(data,"errors")){sendObj=pmc.enrichSparcObjectWithErrorVariables(data,sendObj);}else if(pmc.checkNestedValue(data,"attributes.rewardType")){sendObj.pmc_eVar68=sendObj.pmc_eVar61=data.attributes.rewardType;if(data.userAction==="apply"){sendObj.tealium_event="sparc_gift_apply";sendObj.pmc_event190="event190";}else if(data.userAction==="remove"){sendObj.tealium_event="sparc_gift_remove";sendObj.pmc_event191="event191";}}
pmc.fireLinkHit(sendObj);};pmc.videoImpression=function(eventData){var sendObj={tealium_event:"video_impression",pmc_eVar19:eventData.title,};var prodId=pmc.getNormalProdId(digitalData.product);var product=pmc.items.createItem(prodId);sendObj=product.setEvent("event54",1,sendObj);sendObj.pmc_products=product.adobeString();pmc.fireLinkHit(sendObj);};pmc.contentImpression=function(eventData){if(eventData.type==="video"&&eventData.title){pmc.videoImpression(eventData);return;}};pmc.handleLegacyEvents=function(eventData){try{window.setTimeout(function(){if(eventData.name==="addChild"){pmc.addChildEvent(eventData);return;}
if(eventData.name=="contentImpression"){if(eventData.data){pmc.contentImpression(eventData.data);}
return;}
if(eventData.name==="mediaEvent"&&eventData.data.src==="YouTube"&&typeof(eventData.data.media)!=="undefined"){if(eventData.data.type==="StateChange"){if(typeof(pmc.youTubeInitialized)==="undefined"||pmc.youTubeInitialized===false){window.s.initializeMediaModule();pmc.youTubeInitialized=true;}
window.s.handleYTVideo(eventData.data.media);}}
if((eventData.name==="scrollSet"&&pmc.checkNestedValue(eventData.data,"category","SCROLLED CONTENT"))||pmc.checkNestedValue(eventData,"category","SCROLLED CONTENT")){pmc.handleScrollSet(eventData.data);return;}
if(eventData.name=="addComponent"){pmc.handleAddComponent(eventData);return;}
if(eventData.name=="accountCreate"){if(pmc.checkNestedValue(eventData,"data.profileEmail")){var email=pmc.getHashedEmail(eventData);var sendObject={tealium_event:"account_create",pmc_event52:"event52",pmc_event53:"event53",pmc_eVar48:"authenticated",pmc_event51:"event51",customer_email_public:email,}
pmc.fireLinkHit(sendObject);return;}}},200);}catch(e){e.data="name = "+eventData.name;pmc.logError(e);}};pmc.registerCallback=function(callback){try{var errObj;if(pmc.checkNestedValue(window,"WSI.dataLayer.registerCallback")&&typeof window.WSI.dataLayer.registerCallback==="function"){if(window.WSI.dataLayer._replay&&!pmc.isSparc()&&window.WSI.dataLayer.registerCallback.version!=="dp"){errObj=new Error("Unexpected WSI.dataLayer.registerCallback version");errObj.type="datalayer";pmc.logError(errObj);window.WSI.dataLayer.registerCallback=window.WSI.dataLayer.dpRegisterCallback||window.WSI.dataLayer.registerCallback;}
window.WSI.dataLayer.registerCallback(callback,true);}else{errObj=new Error("No WSI.dataLayer.registerCallback function found");errObj.type="datalayer";pmc.logError(errObj);}}catch(err){pmc.logError(err);}};pmc.registerDataLayerReadyCallback=function(){pmc.dataLayerReadyCallbackRegistered=true;pmc.registerCallback(function(dataLayer,eventData){try{if(eventData.name=="dataLayerReady"){pmc.handleDataLayerReady(eventData);}}catch(err){err.data="name = "+eventData.name;err.source="pmc.registerDataLayerReadyCallback | callback";pmc.logError(err);}},true);};pmc.registerEventCallbacks=function(){pmc.eventCallbacksRegistered=true;pmc.registerCallback(function(dataLayer,eventData){try{var errObj;dataLayer=dataLayer||window.digitalData;if(typeof eventData!=="object"){errObj=new Error("Event missing payload");errObj.type="datalayer";pmc.logError(errObj);}
if(eventData.name==="dataLayerReady"){return;}
if(eventData.name==="addToCart"){pmc.cartAdd(dataLayer,eventData);return;}
if(eventData.name==="elementInteraction"){if(eventData.target==="On Display In Store"){eventData.data.target=eventData.target;}
pmc.handleElementInteraction(eventData);return;}
if(eventData.name==="addToRegistry"){pmc.registryAddLegacy(eventData);return;}
if(eventData.name==="cartEvent"){pmc.cartEvent(eventData.data);return;}
if(pmc.isNewMfe()||(!eventData.name&&eventData.category)){pmc.handleImmediateEvent(eventData);return;}
if(eventData.name){pmc.handleLegacyEvents(eventData);return;}}catch(err){var bDataInfo="name = "+eventData.name+": ";if(eventData.data){if(eventData.data.item){bDataInfo+="data.item = "+eventData.data.item+": ";}
if(eventData.data.category){bDataInfo+="data.category = "+eventData.data.category+": ";}
if(eventData.data.type){bDataInfo+="data.type = "+eventData.data.type+": ";}
if(eventData.data.userAction){bDataInfo+="data.userAction = "+eventData.data.userAction+": ";}}else{bDataInfo+="category = "+eventData.category+": ";bDataInfo+="item = "+eventData.item+": ";}
err.data=bDataInfo;err.source="pmc.registerEventCallbacks | callback";pmc.logError(err);}},true);};pmc.getPreviousPageLoadTime=function(){if(pmc.readCookie){return pmc.readCookie("pageLoadTime");}};pmc.setPageLoadTimeCookie=function(){if(window.performance&&window.performance.timing.loadEventStart){pmc.pageLoadTimingStart=window.performance.timing.loadEventStart;var loadTiming=pmc.pageLoadTimingStart-window.performance.timing.requestStart;pmc.writeCookie("pageLoadTime",loadTiming);}};pmc.bindPageLoad=function(){if(!pmc.pageLoadTimingStart&&window.performance&&window.performance.timing){if(!window.performance.timing.loadEventStart){window.addEventListener("load",function(){try{pmc.setPageLoadTimeCookie();}catch(err){err.source="addEventListener | pmc.bindPageLoad";pmc.logError(err);}});}else{pmc.setPageLoadTimeCookie();}}};pmc.eventBinding=function(){pmc.listenForCustomMessageEvents();pmc.initializeCuralateUGC();pmc.bindPageLoad();pmc.quantumMetrics.registerOpenHandler();};try{pmc.initializeVariablesFromBrowser();}catch(e){pmc.logError(e);}
try{pmc.setDigitalDataPageObject();}catch(e){pmc.logError(e);}
try{utag_data.tag_priority=utag_data.tag_priority||'1';}catch(e){pmc.logError(e);}
try{var isNativeShoppingApp=(pmc.stringContains(document.location.pathname,"shopping-app"));if(isNativeShoppingApp){utag_data.market="us";}
var isRegApp=pmc.stringContains(navigator.userAgent,"[RegistryApp;iOS]");var hasDigitalData=typeof window.digitalData!=="undefined";var isNativeRegApp=isRegApp&&!hasDigitalData;if(!isNativeRegApp){pmc.eventBinding();}}catch(e){pmc.logError(e);}}catch(e){console.log(e);}}
if(!utag_condload){try{try{var com=com||{};var i;var h;var item;com.tealium=com.tealium||{};window.utag_data=window.utag_data||{};com.tealium.convert_to_udo=function(x){function populate_cart_product(prod,obj){obj.product_id.push(prod.productID.persistentProdID||prod.productID.primaryProdID||prod.productID.prodID);obj.product_sku.push(prod.productID.sku);obj.product_quantity.push(prod.quantity);obj.product_unit_price.push(prod.price.unitPrice);var discount_amount=0;if(prod.price.merchDiscount!=null&&!isNaN(prod.price.merchDiscount)){discount_amount=prod.price.merchDiscount;}
obj.product_discount.push(discount_amount);obj.product_discounted_price.push(parseFloat(prod.price.unitPrice)-parseFloat(discount_amount));obj.product_name.push("");}
if(x.page){if(x.page.pageCategory&&x.page.pageCategory.primaryCategory&&typeof x.page.pageCategory.primaryCategory==="string"){var dd_type=x.page.pageCategory.primaryCategory.toLowerCase();var type_map={'home':'home','account':'account','shop':'category','products':'product','search':'search','shoppingcart':'cart','shopping':'shopping','checkout':'checkout','recipe':'recipe','registry':'registry','pages':'pages'};utag_data.page_type=type_map[dd_type]||'unknown';if(utag_data.page_type==="shopping"&&x.page.attributes.cmCategoryId==="thematic-pages"){utag_data.page_type="thematic";}}
if(x.page.pageName&&!utag_data.page_name){utag_data.page_name=x.page.pageName;}}
if('category'==utag_data.page_type){if(x.page&&x.page.pageCategory&&x.page.pageCategory.categories&&x.page.pageCategory.categories instanceof Array){utag_data.category_path=x.page.pageCategory.categories.slice(0);}}
if(x.page.pageType){utag_data.page_category=x.page.pageType;if(utag_data.page_category==="shoproot"){utag_data.page_category="supercategory";}}
if(x.x_transaction&&x.x_transaction.orders){utag_data.page_type='order';utag_data.order_grand_total=0;utag_data.order_subtotal=0;utag_data.order_shipping_amount=0;utag_data.order_tax_amount=0;utag_data.order_discount_amount=0;utag_data.order_promo_code="";utag_data.purchase_total_quantity=0;for(i=0;i<x.x_transaction.orders.length;i++){if(x.x_transaction.orders[i].items){if(x.x_transaction.customer){if(x.x_transaction.customer.address){utag_data.customer_state=x.x_transaction.customer.address.stateProvince;utag_data.customer_zip=x.x_transaction.customer.address.postalCode;}}
if(x.x_transaction.orders[i].shiptos){utag_data.order_shipping_method=x.x_transaction.orders[i].shiptos[0].shipMethod;}
if(x.x_transaction.orders[i].payment){utag_data.order_payment_method=x.x_transaction.orders[i].payment.paymentType;}
var promoCode="";if(x.x_transaction.orders[i].promoCode){promoCode=x.x_transaction.orders[i].promoCode;}else if(x.x_transaction.orders[i].promoCode){promoCode=x.x_transaction.orders[i].promos;}
if(promoCode.length>0){if(utag_data.order_promo_code!==""){utag_data.order_promo_code+="|"+promoCode;}else{utag_data.order_promo_code=promoCode;}}
if(x.x_transaction.orders[i].price){if(x.x_transaction.orders[i].price.orderTotal){utag_data.order_grand_total+=x.x_transaction.orders[i].price.orderTotal;}
if(x.x_transaction.orders[i].price.merchTotal){utag_data.order_subtotal+=x.x_transaction.orders[i].price.merchTotal;}
if(x.x_transaction.orders[i].price.shippingTotal){utag_data.order_shipping_amount+=x.x_transaction.orders[i].price.shippingTotal;}
if(x.x_transaction.orders[i].price.taxTotal){utag_data.order_tax_amount=x.x_transaction.orders[i].price.taxTotal;}
if(x.x_transaction.orders[i].price.merchDiscount){utag_data.order_discount_amount+=x.x_transaction.orders[i].price.merchDiscount;}}
var itemRegistryId="";for(h=0;h<x.x_transaction.orders[i].items.length;h++){item=x.x_transaction.orders[i].items[h];populate_cart_product(item,utag_data);if(!isNaN(item.quantity)&&item.quantity>0){utag_data.purchase_total_quantity+=item.quantity;}
if(typeof(item.attributes.registryStoreId)!=="undefined"){itemRegistryId=item.attributes.registryStoreId;}}}}
utag_data.order_discounted_subtotal=utag_data.order_subtotal-utag_data.order_discount_amount;}};}catch(e){if(pmc){pmc.error("error setting Tealium data layer: "+e);}}}catch(e){console.log(e);}}
if(typeof utag=="undefined"&&!utag_condload){var utag={id:"wsi.williamssonoma",o:{},sender:{},send:{},rpt:{ts:{a:new Date()}},dbi:[],loader:{q:[],lc:0,f:{},p:0,ol:0,wq:[],lq:[],bq:{},bk:{},rf:0,ri:0,rp:0,rq:[],ready_q:[],sendq:{"pending":0},run_ready_q:function(){for(var i=0;i<utag.loader.ready_q.length;i++){utag.DB("READY_Q:"+i);try{utag.loader.ready_q[i]()}catch(e){utag.DB(e)};}},lh:function(a,b,c){a=""+location.hostname;b=a.split(".");c=(/\.co\.|\.com\.|\.org\.|\.edu\.|\.net\.|\.asn\./.test(a))?3:2;return b.splice(b.length-c,c).join(".");},WQ:function(a,b,c,d,g){utag.DB('WQ:'+utag.loader.wq.length);try{if(utag.udoname&&utag.udoname.indexOf(".")<0){utag.ut.merge(utag.data,window[utag.udoname],0);}
if(utag.cfg.load_rules_at_wait){utag.handler.LR(utag.data);}}catch(e){utag.DB(e)};d=0;g=[];for(a=0;a<utag.loader.wq.length;a++){b=utag.loader.wq[a];b.load=utag.loader.cfg[b.id].load;if(b.load==4){this.f[b.id]=0;utag.loader.LOAD(b.id)}else if(b.load>0){g.push(b);d++;}else{this.f[b.id]=1;}}
for(a=0;a<g.length;a++){utag.loader.AS(g[a]);}
if(d==0){utag.loader.END();}},AS:function(a,b,c,d){utag.send[a.id]=a;if(typeof a.src=='undefined'){a.src=utag.cfg.path+((typeof a.name!='undefined')?a.name:'ut'+'ag.'+a.id+'.js')}
a.src+=(a.src.indexOf('?')>0?'&':'?')+'utv='+(a.v?utag.cfg.template+a.v:utag.cfg.v);utag.rpt['l_'+a.id]=a.src;b=document;this.f[a.id]=0;if(a.load==2){utag.DB("Attach sync: "+a.src);a.uid=a.id;b.write('<script id="utag_'+a.id+'" src="'+a.src+'"></scr'+'ipt>')
if(typeof a.cb!='undefined')a.cb();}else if(a.load==1||a.load==3){if(b.createElement){c='utag_wsi.williamssonoma_'+a.id;if(!b.getElementById(c)){d={src:a.src,id:c,uid:a.id,loc:a.loc}
if(a.load==3){d.type="iframe"};if(typeof a.cb!='undefined')d.cb=a.cb;utag.ut.loader(d);}}}},GV:function(a,b,c){b={};for(c in a){if(a.hasOwnProperty(c)&&typeof a[c]!="function")b[c]=a[c];}
return b},OU:function(a,b,c,d,f){try{if(typeof utag.data['cp.OPTOUTMULTI']!='undefined'){c=utag.loader.cfg;a=utag.ut.decode(utag.data['cp.OPTOUTMULTI']).split('|');for(d=0;d<a.length;d++){b=a[d].split(':');if(b[1]*1!==0){if(b[0].indexOf('c')==0){for(f in utag.loader.GV(c)){if(c[f].tcat==b[0].substring(1))c[f].load=0}}else if(b[0]*1==0){utag.cfg.nocookie=true}else{for(f in utag.loader.GV(c)){if(c[f].tid==b[0])c[f].load=0}}}}}}catch(e){utag.DB(e)}},RDdom:function(o){var d=document||{},l=location||{};o["dom.referrer"]=eval("document."+"referrer");o["dom.title"]=""+d.title;o["dom.domain"]=""+l.hostname;o["dom.query_string"]=(""+l.search).substring(1);o["dom.hash"]=(""+l.hash).substring(1);o["dom.url"]=""+d.URL;o["dom.pathname"]=""+l.pathname;o["dom.viewport_height"]=window.innerHeight||(d.documentElement?d.documentElement.clientHeight:960);o["dom.viewport_width"]=window.innerWidth||(d.documentElement?d.documentElement.clientWidth:960);},RDcp:function(o,b,c,d){b=b||utag.loader.RC();for(d in b){if(d.match(/utag_(.*)/)){for(c in utag.loader.GV(b[d])){o["cp.utag_"+RegExp.$1+"_"+c]=b[d][c];}}}
for(c in utag.loader.GV((utag.cl&&!utag.cl['_all_'])?utag.cl:b)){if(c.indexOf("utag_")<0&&typeof b[c]!="undefined")o["cp."+c]=b[c];}
o["_t_visitor_id"]=o["cp.utag_main_v_id"];o["_t_session_id"]=o["cp.utag_main_ses_id"];},RDqp:function(o,a,b,c){a=location.search+(location.hash+'').replace("#","&");if(utag.cfg.lowerqp){a=a.toLowerCase()};if(a.length>1){b=a.substring(1).split('&');for(a=0;a<b.length;a++){c=b[a].split("=");if(c.length>1){o["qp."+c[0]]=utag.ut.decode(c[1])}}}},RDmeta:function(o,a,b,h){a=document.getElementsByTagName("meta");for(b=0;b<a.length;b++){try{h=a[b].name||a[b].getAttribute("property")||"";}catch(e){h="";utag.DB(e)};if(utag.cfg.lowermeta){h=h.toLowerCase()};if(h!=""){o["meta."+h]=a[b].content}}},RDva:function(o){var readAttr=function(o,l){var a="",b;a=localStorage.getItem(l);if(!a||a=="{}")return;b=utag.ut.flatten({va:JSON.parse(a)});utag.ut.merge(o,b,1);}
try{readAttr(o,"tealium_va");readAttr(o,"tealium_va_"+o["ut.account"]+"_"+o["ut.profile"]);}catch(e){utag.DB(e)}},RDut:function(o,a){o["ut.domain"]=utag.cfg.domain;o["ut.version"]=utag.cfg.v;o["ut.event"]=a||"view";try{o["ut.account"]=utag.cfg.utid.split("/")[0];o["ut.profile"]=utag.cfg.utid.split("/")[1];o["ut.env"]=utag.cfg.path.split("/")[6];}catch(e){utag.DB(e)}},RD:function(o,a,b,c,d){utag.DB("utag.loader.RD");utag.DB(o);if(!utag.loader.rd_flag){a=(new Date()).getTime();b=utag.loader.RC();c=a+parseInt(utag.cfg.session_timeout);d=a;if(!b.utag_main){b.utag_main={};}else if(b.utag_main.ses_id&&typeof b.utag_main._st!="undefined"&&parseInt(b.utag_main._st)<a){delete b.utag_main.ses_id;}
if(!b.utag_main.v_id){b.utag_main.v_id=utag.ut.vi(a);}
if(!b.utag_main.ses_id){b.utag_main.ses_id=d+'';b.utag_main._ss=b.utag_main._pn=1;b.utag_main._sn=1+parseInt(b.utag_main._sn||0);}else{d=b.utag_main.ses_id;b.utag_main._ss=0;b.utag_main._pn=1+parseInt(b.utag_main._pn);b.utag_main._sn=parseInt(b.utag_main._sn);}
if(isNaN(b.utag_main._sn)||b.utag_main._sn<1){b.utag_main._sn=b.utag_main._pn=1}
b.utag_main._st=c+'';utag.loader.SC("utag_main",{"v_id":b.utag_main.v_id,"_sn":b.utag_main._sn,"_ss":b.utag_main._ss,"_pn":b.utag_main._pn+";exp-session","_st":c,"ses_id":d+";exp-session"});}
utag.loader.rd_flag=1;this.RDqp(o);this.RDmeta(o);this.RDcp(o,b);this.RDdom(o);this.RDut(o);this.RDva(o);},RC:function(a,x,b,c,d,e,f,g,h,i,j,k,l,m,n,o,v,ck,cv,r,s,t){o={};b=(""+document.cookie!="")?(document.cookie).split("; "):[];r=/^(.*?)=(.*)$/;s=/^(.*);exp-(.*)$/;t=(new Date()).getTime();for(c=0;c<b.length;c++){if(b[c].match(r)){ck=RegExp.$1;cv=RegExp.$2;}
e=utag.ut.decode(cv);if(typeof ck!="undefined"){if(ck.indexOf("ulog")==0||ck.indexOf("utag_")==0){e=cv.split("$");g=[];j={};for(f=0;f<e.length;f++){try{g=e[f].split(":");if(g.length>2){g[1]=g.slice(1).join(":");}
v="";if((""+g[1]).indexOf("~")==0){h=g[1].substring(1).split("|");for(i=0;i<h.length;i++)h[i]=utag.ut.decode(h[i]);v=h}else v=utag.ut.decode(g[1]);j[g[0]]=v;}catch(er){utag.DB(er)};}
o[ck]={};for(f in utag.loader.GV(j)){if(j[f]instanceof Array){n=[];for(m=0;m<j[f].length;m++){if(j[f][m].match(s)){k=(RegExp.$2=="session")?(typeof j._st!="undefined"?j._st:t-1):parseInt(RegExp.$2);if(k>t)n[m]=(x==0)?j[f][m]:RegExp.$1;}}
j[f]=n.join("|");}else{j[f]=""+j[f];if(j[f].match(s)){k=(RegExp.$2=="session")?(typeof j._st!="undefined"?j._st:t-1):parseInt(RegExp.$2);j[f]=(k<t)?null:(x==0?j[f]:RegExp.$1);}}
if(j[f])o[ck][f]=j[f];}}else if(utag.cl[ck]||utag.cl['_all_']){o[ck]=e}}}
return(a)?(o[a]?o[a]:{}):o;},SC:function(a,b,c,d,e,f,g,h,i,j,k,x,v){if(!a)return 0;if(a=="utag_main"&&utag.cfg.nocookie)return 0;v="";var date=new Date();var exp=new Date();exp.setTime(date.getTime()+(365*24*60*60*1000));x=exp.toGMTString();if(c&&c=="da"){x="Thu, 31 Dec 2009 00:00:00 GMT";}else if(a.indexOf("utag_")!=0&&a.indexOf("ulog")!=0){if(typeof b!="object"){v=b}}else{d=utag.loader.RC(a,0);for(e in utag.loader.GV(b)){f=""+b[e];if(f.match(/^(.*);exp-(\d+)(\w)$/)){g=date.getTime()+parseInt(RegExp.$2)*((RegExp.$3=="h")?3600000:86400000);if(RegExp.$3=="u")g=parseInt(RegExp.$2);f=RegExp.$1+";exp-"+g;}
if(c=="i"){if(d[e]==null)d[e]=f;}else if(c=="d")delete d[e];else if(c=="a")d[e]=(d[e]!=null)?(f-0)+(d[e]-0):f;else if(c=="ap"||c=="au"){if(d[e]==null)d[e]=f;else{if(d[e].indexOf("|")>0){d[e]=d[e].split("|")}
g=(d[e]instanceof Array)?d[e]:[d[e]];g.push(f);if(c=="au"){h={};k={};for(i=0;i<g.length;i++){if(g[i].match(/^(.*);exp-(.*)$/)){j=RegExp.$1;}
if(typeof k[j]=="undefined"){k[j]=1;h[g[i]]=1;}}
g=[];for(i in utag.loader.GV(h)){g.push(i);}}
d[e]=g}}else d[e]=f;}
h=new Array();for(g in utag.loader.GV(d)){if(d[g]instanceof Array){for(c=0;c<d[g].length;c++){d[g][c]=encodeURIComponent(d[g][c])}
h.push(g+":~"+d[g].join("|"))}else h.push((g+":").replace(/[\,\$\;\?]/g,"")+encodeURIComponent(d[g]))}
if(h.length==0){h.push("");x=""}
v=(h.join("$"));}
document.cookie=a+"="+v+";path=/;domain="+utag.cfg.domain+";expires="+x;return 1},LOAD:function(a,b,c,d){if(!utag.loader.cfg){return}
if(this.ol==0){if(utag.loader.cfg[a].block&&utag.loader.cfg[a].cbf){this.f[a]=1;delete utag.loader.bq[a];}
for(b in utag.loader.GV(utag.loader.bq)){if(utag.loader.cfg[a].load==4&&utag.loader.cfg[a].wait==0){utag.loader.bk[a]=1;utag.DB("blocked: "+a);}
utag.DB("blocking: "+b);return;}
utag.loader.INIT();return;}
utag.DB('utag.loader.LOAD:'+a);if(this.f[a]==0){this.f[a]=1;if(utag.cfg.noview!=true){if(utag.loader.cfg[a].send){utag.DB("SENDING: "+a);try{if(utag.loader.sendq.pending>0&&utag.loader.sendq[a]){utag.DB("utag.loader.LOAD:sendq: "+a);while(d=utag.loader.sendq[a].shift()){utag.DB(d);utag.sender[a].send(d.event,utag.handler.C(d.data));utag.loader.sendq.pending--;}}else{utag.sender[a].send('view',utag.handler.C(utag.data));}
utag.rpt['s_'+a]=0;}catch(e){utag.DB(e);utag.rpt['s_'+a]=1;}}}
if(utag.loader.rf==0)return;for(b in utag.loader.GV(this.f)){if(this.f[b]==0||this.f[b]==2)return}
utag.loader.END();}},EV:function(a,b,c,d){if(b=="ready"){if(!utag.data){try{utag.cl={'_all_':1};utag.loader.initdata();utag.loader.RD(utag.data);}catch(e){utag.DB(e)};}
if((document.attachEvent||utag.cfg.dom_complete)?document.readyState==="complete":document.readyState!=="loading")setTimeout(c,1);else{utag.loader.ready_q.push(c);var RH;if(utag.loader.ready_q.length<=1){if(document.addEventListener){RH=function(){document.removeEventListener("DOMContentLoaded",RH,false);utag.loader.run_ready_q()};if(!utag.cfg.dom_complete)document.addEventListener("DOMContentLoaded",RH,false);window.addEventListener("load",utag.loader.run_ready_q,false);}else if(document.attachEvent){RH=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",RH);utag.loader.run_ready_q()}};document.attachEvent("onreadystatechange",RH);window.attachEvent("onload",utag.loader.run_ready_q);}}}}else{if(a.addEventListener){a.addEventListener(b,c,false)}else if(a.attachEvent){a.attachEvent(((d==1)?"":"on")+b,c)}}},END:function(b,c,d,e,v,w){if(this.ended){return};this.ended=1;utag.DB("loader.END");b=utag.data;if(utag.handler.base&&utag.handler.base!='*'){e=utag.handler.base.split(",");for(d=0;d<e.length;d++){if(typeof b[e[d]]!="undefined")utag.handler.df[e[d]]=b[e[d]]}}else if(utag.handler.base=='*'){utag.ut.merge(utag.handler.df,b,1);}
utag.rpt['r_0']="t";for(var r in utag.loader.GV(utag.cond)){utag.rpt['r_'+r]=(utag.cond[r])?"t":"f";}
utag.rpt.ts['s']=new Date();v=".tiqcdn.com";w=utag.cfg.path.indexOf(v);if(w>0&&b["cp.utag_main__ss"]==1&&!utag.cfg.no_session_count)utag.ut.loader({src:utag.cfg.path.substring(0,w)+v+"/ut"+"ag/tiqapp/ut"+"ag.v.js?a="+utag.cfg.utid+(utag.cfg.nocookie?"&nocookie=1":"&cb="+(new Date).getTime()),id:"tiqapp"})
if(utag.cfg.noview!=true)utag.handler.RE('view',b,"end");utag.handler.INIT();}},DB:function(a,b){if(utag.cfg.utagdb===false){return;}else if(typeof utag.cfg.utagdb=="undefined"){utag.db_log=[];b=document.cookie+'';utag.cfg.utagdb=((b.indexOf('utagdb=true')>=0)?true:false);}
if(utag.cfg.utagdb===true){var t;if(utag.ut.typeOf(a)=="object"){t=utag.handler.C(a)}else{t=a}
utag.db_log.push(t);try{console.log(t)}catch(e){}}},RP:function(a,b,c){if(typeof a!='undefined'&&typeof a.src!='undefined'&&a.src!=''){b=[];for(c in utag.loader.GV(a)){if(c!='src')b.push(c+'='+escape(a[c]))}
this.dbi.push((new Image()).src=a.src+'?utv='+utag.cfg.v+'&utid='+utag.cfg.utid+'&'+(b.join('&')))}},view:function(a,c,d){return this.track({event:'view',data:a,cfg:{cb:c,uids:d}})},link:function(a,c,d){return this.track({event:'link',data:a,cfg:{cb:c,uids:d}})},track:function(a,b,c,d){if(typeof a=="string")a={event:a,data:b,cfg:{cb:c}};for(d in utag.loader.GV(utag.o)){try{utag.o[d].handler.trigger(a.event||"view",a.data||a,a.cfg)}catch(e){utag.DB(e)};}
if(a.cfg&&a.cfg.cb)try{a.cfg.cb()}catch(e){utag.DB(e)};return true},handler:{base:"",df:{},o:{},send:{},iflag:0,INIT:function(a,b,c){utag.DB('utag.handler.INIT');if(utag.initcatch){utag.initcatch=0;return}
this.iflag=1;a=utag.loader.q.length;if(a>0){utag.DB("Loader queue");for(b=0;b<a;b++){c=utag.loader.q[b];utag.handler.trigger(c.a,c.b,c.c)}}
},test:function(){return 1},LR:function(b){utag.DB("Load Rules");for(var d in utag.loader.GV(utag.cond)){utag.cond[d]=false;}
utag.DB(utag.data);utag.loader.loadrules();utag.DB(utag.cond);utag.loader.initcfg();utag.loader.OU();for(var r in utag.loader.GV(utag.cond)){utag.rpt['r_'+r]=(utag.cond[r])?"t":"f";}},RE:function(a,b,c,d,e,f,g){if(c!="alr"&&!this.cfg_extend){return 0;}
utag.DB("RE: "+c);if(c=="alr")utag.DB("All Tags EXTENSIONS");utag.DB(b);if(typeof this.extend!="undefined"){g=0;for(d=0;d<this.extend.length;d++){try{e=0;if(typeof this.cfg_extend!="undefined"){f=this.cfg_extend[d];if(typeof f.count=="undefined")f.count=0;if(f[a]==0||(f.once==1&&f.count>0)||f[c]==0){e=1}else{if(f[c]==1){g=1};f.count++}}
if(e!=1){this.extend[d](a,b);utag.rpt['ex_'+d]=0}}catch(er){utag.DB(er);utag.rpt['ex_'+d]=1;utag.ut.error({e:er.message,s:utag.cfg.path+'utag.js',l:d,t:'ge'});}}
utag.DB(b);return g;}},trigger:function(a,b,c,d,e,f){utag.DB('trigger:'+a+(c&&c.uids?":"+c.uids.join(","):""));b=b||{};utag.DB(b);if(!this.iflag){utag.DB("trigger:called before tags loaded");for(d in utag.loader.f){if(!(utag.loader.f[d]===1))utag.DB('Tag '+d+' did not LOAD')}
utag.loader.q.push({a:a,b:utag.handler.C(b),c:c});return;}
utag.cfg.noview=false;utag.ut.merge(b,this.df,0);utag.loader.RDqp(b);utag.loader.RDcp(b);utag.loader.RDdom(b);utag.loader.RDmeta(b);utag.loader.RDut(b,a);utag.loader.RDva(b);function sendTag(a,b,d){try{if(typeof utag.sender[d]!="undefined"){utag.DB("SENDING: "+d);utag.sender[d].send(a,utag.handler.C(b));utag.rpt['s_'+d]=0;}else if(utag.loader.cfg[d].load!=2&&utag.loader.cfg[d].s2s!=1){utag.loader.sendq[d]=utag.loader.sendq[d]||[];utag.loader.sendq[d].push({"event":a,"data":utag.handler.C(b)});utag.loader.sendq.pending++;utag.loader.AS({id:d,load:1});}}catch(e){utag.DB(e)}}
if(c&&c.uids){this.RE(a,b,"alr");for(f=0;f<c.uids.length;f++){d=c.uids[f];sendTag(a,b,d);}}else if(utag.cfg.load_rules_ajax){this.RE(a,b,"blr");utag.ut.merge(utag.data,b,1);this.LR(b);this.RE(a,b,"alr");for(f=0;f<utag.loader.cfgsort.length;f++){d=utag.loader.cfgsort[f];if(utag.loader.cfg[d].load&&utag.loader.cfg[d].send){sendTag(a,b,d);}}}else{this.RE(a,b,"alr");for(d in utag.loader.GV(utag.sender)){sendTag(a,b,d);}}
this.RE(a,b,"end");utag.loader.SC("utag_main",{"_st":((new Date()).getTime()+parseInt(utag.cfg.session_timeout))});},C:function(a,b,c){b={};for(c in utag.loader.GV(a)){if(a[c]instanceof Array){b[c]=a[c].slice(0)}else{b[c]=a[c]}}
return b}},ut:{pad:function(a,b,c,d){a=""+((a-0).toString(16));d='';if(b>a.length){for(c=0;c<(b-a.length);c++){d+='0'}}return""+d+a},vi:function(t,a,b){if(!utag.v_id){a=this.pad(t,12);b=""+Math.random();a+=this.pad(b.substring(2,b.length),16);try{a+=this.pad((navigator.plugins.length?navigator.plugins.length:0),2);a+=this.pad(navigator.userAgent.length,3);a+=this.pad(document.URL.length,4);a+=this.pad(navigator.appVersion.length,3);a+=this.pad(screen.width+screen.height+parseInt((screen.colorDepth)?screen.colorDepth:screen.pixelDepth),5)}catch(e){utag.DB(e);a+="12345"};utag.v_id=a;}
return utag.v_id},hasOwn:function(o,a){return o!=null&&Object.prototype.hasOwnProperty.call(o,a)},isEmptyObject:function(o,a){for(a in o){if(utag.ut.hasOwn(o,a))return false}
return true},isEmpty:function(o){var t=utag.ut.typeOf(o);if(t=="number"){return isNaN(o)}else if(t=="boolean"){return false}else if(t=="string"){return o.length===0}else return utag.ut.isEmptyObject(o)},typeOf:function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();},flatten:function(o){var a={};function r(c,p){if(Object(c)!==c||c instanceof Array){a[p]=c;}else{if(utag.ut.isEmptyObject(c)){}else{for(var d in c){r(c[d],p?p+"."+d:d);}}}}
r(o,"");return a;},merge:function(a,b,c,d){if(c){for(d in utag.loader.GV(b)){a[d]=b[d]}}else{for(d in utag.loader.GV(b)){if(typeof a[d]=="undefined")a[d]=b[d]}}},decode:function(a,b){b="";try{b=decodeURIComponent(a)}catch(e){utag.DB(e)};if(b==""){b=unescape(a)};return b},error:function(a,b,c){if(typeof utag_err!="undefined"){utag_err.push(a)}},loader:function(o,a,b,c,l){a=document;if(o.type=="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l])}
b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l]}
b.src=o.src;}
if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}
l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}}}};utag.o['wsi.williamssonoma']=utag;utag.cfg={template:"ut4.39.",load_rules_ajax:true,load_rules_at_wait:false,lowerqp:false,session_timeout:1800000,readywait:0,noload:0,domain:utag.loader.lh(),path:"//tags.tiqcdn.com/utag/wsi/williamssonoma/prod/",utid:"wsi/williamssonoma/202306211433"};utag.cfg.v=utag.cfg.template+"202306211434";utag.cond={1318:0,1331:0,1339:0,1363:0,1364:0,1489:0,1498:0,1505:0,1521:0,1525:0,1529:0,1530:0,1537:0,1548:0,1563:0,1716:0,1717:0,1726:0,1731:0,1732:0,1748:0,1749:0,1753:0,1754:0,1760:0,1785:0,1789:0,1790:0,1791:0,1795:0,1796:0,1797:0,1798:0,1804:0,1805:0,1826:0,1834:0,1835:0,1840:0,1841:0,2078:0,2083:0,2084:0,2086:0,2087:0,2097:0,2100:0,2102:0,2110:0,2111:0,2113:0,2114:0,2115:0};utag.pagevars=function(ud){ud=ud||utag.data;try{ud['js_page.top_category']=top_category}catch(e){utag.DB(e)};};utag.loader.initdata=function(){try{utag.data=(typeof utag_data!='undefined')?utag_data:{};utag.udoname='utag_data';}catch(e){utag.data={};utag.DB('idf:'+e);}};utag.loader.loadrules=function(_pd,_pc){var d=_pd||utag.data;var c=_pc||utag.cond;for(var l in utag.loader.GV(c)){switch(l){case'1318':try{c[1318]|=(typeof d['tp_parameter']!='undefined'&&typeof d['tp_parameter']!='undefined'&&d['tp_parameter']!=''&&d['tealium_view_or_link']=='view'&&!/^fpv_/.test(d['tealium_event']))||(typeof d['order_id']!='undefined'&&d['order_id']!=''&&d['brand']=='pb'&&typeof d['cp.xyz_cr_100090_et_111']!='undefined'&&typeof d['cp.xyz_cr_100090_et_111']!='undefined'&&d['cp.xyz_cr_100090_et_111']!='')||(typeof d['order_id']!='undefined'&&d['order_id']!=''&&d['brand']=='pb'&&typeof d['cp.xyz_cr_100090_et_377']!='undefined'&&typeof d['cp.xyz_cr_100090_et_377']!='undefined'&&d['cp.xyz_cr_100090_et_377']!='')||(typeof d['order_id']!='undefined'&&d['order_id']!=''&&d['brand']=='pk'&&typeof d['cp.xyz_cr_100091_et_111']!='undefined'&&typeof d['cp.xyz_cr_100091_et_111']!='undefined'&&d['cp.xyz_cr_100091_et_111']!='')||(typeof d['order_id']!='undefined'&&d['order_id']!=''&&d['brand']=='pk'&&typeof d['cp.xyz_cr_100091_et_377']!='undefined'&&typeof d['cp.xyz_cr_100091_et_377']!='undefined'&&d['cp.xyz_cr_100091_et_377']!='')||(typeof d['order_id']!='undefined'&&d['order_id']!=''&&d['brand']=='pt'&&typeof d['cp.xyz_cr_100092_et_111']!='undefined'&&typeof d['cp.xyz_cr_100092_et_111']!='undefined'&&d['cp.xyz_cr_100092_et_111']!='')||(typeof d['order_id']!='undefined'&&d['order_id']!=''&&d['brand']=='pt'&&typeof d['cp.xyz_cr_100092_et_377']!='undefined'&&typeof d['cp.xyz_cr_100092_et_377']!='undefined'&&d['cp.xyz_cr_100092_et_377']!='')||(typeof d['order_id']!='undefined'&&d['order_id']!=''&&d['brand']=='we'&&typeof d['cp.xyz_cr_100093_et_111']!='undefined'&&typeof d['cp.xyz_cr_100093_et_111']!='undefined'&&d['cp.xyz_cr_100093_et_111']!='')||(typeof d['order_id']!='undefined'&&d['order_id']!=''&&d['brand']=='we'&&typeof d['cp.xyz_cr_100093_et_377']!='undefined'&&typeof d['cp.xyz_cr_100093_et_377']!='undefined'&&d['cp.xyz_cr_100093_et_377']!='')||(typeof d['order_id']!='undefined'&&d['order_id']!=''&&d['brand']=='mg'&&typeof d['cp.xyz_cr_100096_et_111']!='undefined'&&typeof d['cp.xyz_cr_100096_et_111']!='undefined'&&d['cp.xyz_cr_100096_et_111']!='')||(typeof d['order_id']!='undefined'&&d['order_id']!=''&&d['brand']=='ws'&&typeof d['cp.xyz_cr_100097_et_111']!='undefined'&&typeof d['cp.xyz_cr_100097_et_111']!='undefined'&&d['cp.xyz_cr_100097_et_111']!='')||(typeof d['order_id']!='undefined'&&d['order_id']!=''&&d['brand']=='ws'&&typeof d['xyz_cr_100097_et_377']!='undefined'&&typeof d['xyz_cr_100097_et_377']!='undefined'&&d['xyz_cr_100097_et_377']!='')}catch(e){utag.DB(e)};break;case'1331':try{c[1331]|=(d['brand']=='pt')}catch(e){utag.DB(e)};break;case'1339':try{c[1339]|=(d['brand']=='we')}catch(e){utag.DB(e)};break;case'1363':try{c[1363]|=(d['brand']=='pk')}catch(e){utag.DB(e)};break;case'1364':try{c[1364]|=(d['page_name'].toString().toLowerCase().indexOf('registry'.toLowerCase())>-1)||(d['page_name'].toString().indexOf('CATEGORY: BABY SHOP_B')>-1)}catch(e){utag.DB(e)};break;case'1489':try{c[1489]|=(d['tealium_event']=='registry_create')}catch(e){utag.DB(e)};break;case'1498':try{c[1498]|=(d['subBrand'].toString().toLowerCase()=='ws-home'.toLowerCase())}catch(e){utag.DB(e)};break;case'1505':try{c[1505]|=(d['tealium_event']!='purchase'&&!/^fpv_/.test(d['tealium_event']))}catch(e){utag.DB(e)};break;case'1521':try{c[1521]|=(d['brand']=='mg')}catch(e){utag.DB(e)};break;case'1525':try{c[1525]|=(parseFloat(d['days_since_last_visit'])>=parseFloat(91)&&d['cp.utag_main__pn']=='2')||(d['cp.utag_main__sn']=='1'&&d['cp.utag_main__pn']=='2')}catch(e){utag.DB(e)};break;case'1529':try{c[1529]|=(d['page_name'].toString().toLowerCase()=='williams-sonoma-home-landing'.toLowerCase())||(d['page_name']=='HOME'&&typeof d['is_mobile']!='undefined'&&d['is_mobile']!='0'&&d['is_mobile']!='false')}catch(e){utag.DB(e)};break;case'1530':try{c[1530]|=(typeof d['cm_ven']!='undefined'&&d['cm_ven']!='')}catch(e){utag.DB(e)};break;case'1537':try{c[1537]|=(d['tealium_event']=='purchase')||(d['tealium_event']=='cart_add')||(d['tealium_event']=='registry_create')||(d['dom.pathname'].toString().indexOf('thekey/enroll/unconfirmed')>-1)}catch(e){utag.DB(e)};break;case'1548':try{c[1548]|=(typeof d['pmc_pageName']!='undefined'&&d['pmc_pageName'].toString().indexOf('add item:add to registry')>-1)}catch(e){utag.DB(e)};break;case'1563':try{c[1563]|=(d['page_section1']=='furniture'&&d['page_type']=='product')||(d['tealium_event']=='purchase')}catch(e){utag.DB(e)};break;case'1716':try{c[1716]|=(d['tealium_event']=='purchase')}catch(e){utag.DB(e)};break;case'1717':try{c[1717]|=(d['dom.pathname'].toString().toLowerCase().indexOf('thekey/enroll/unconfirmed'.toLowerCase())>-1)}catch(e){utag.DB(e)};break;case'1726':try{c[1726]|=(d['brand']=='pb')}catch(e){utag.DB(e)};break;case'1731':try{c[1731]|=(d['tealium_view_or_link']=='view'&&!/^fpv_/.test(d['tealium_event']))}catch(e){utag.DB(e)};break;case'1732':try{c[1732]|=(d['tealium_view_or_link']=='view'&&d['tag_priority']!='1')||(d['tealium_event']=='cart_add')||(d['tealium_event']=='favorites_add')||(d['tealium_event']=='registry_create')}catch(e){utag.DB(e)};break;case'1748':try{c[1748]|=(d['tealium_view_or_link']=='view'&&!/^fpv_/.test(d['tealium_event']))||(d['tealium_event']=='cart_add')||(d['tealium_event']=='favorites_add')||(d['tealium_event']=='search_submission')}catch(e){utag.DB(e)};break;case'1749':try{c[1749]|=(d['tealium_view_or_link']=='view'&&!/^fpv_/.test(d['tealium_event']))||(d['tealium_event']=='cart_add')}catch(e){utag.DB(e)};break;case'1753':try{c[1753]|=(d['tealium_event']=='swatch_order_submit')||(d['tealium_event']=='swatch_legacy_submit')}catch(e){utag.DB(e)};break;case'1754':try{c[1754]|=(d['tealium_event']=='key_confirmation')}catch(e){utag.DB(e)};break;case'1760':try{c[1760]|=(d['tealium_view_or_link']=='view'&&!/^fpv_/.test(d['tealium_event']))||(d['tealium_event']=='cart_add')||(d['tealium_event']=='registry_add')||(d['tealium_event'].toString().indexOf('favorites_add')>-1)||(d['tealium_event'].toString().indexOf('sparc_module')>-1)||(d['tealium_event']=='registry_create')}catch(e){utag.DB(e)};break;case'1785':try{c[1785]|=(d['market']=='us'&&typeof d['cp.WSIRetailStore']=='undefined'&&typeof d['privacy_opt_out_att']=='undefined')}catch(e){utag.DB(e)};break;case'1789':try{c[1789]|=(d['brand']=='ws')}catch(e){utag.DB(e)};break;case'1790':try{c[1790]|=(d['cp.utag_main__pn']=='2')}catch(e){utag.DB(e)};break;case'1791':try{c[1791]|=(d['tealium_event']=='sweepstakes_thanks')}catch(e){utag.DB(e)};break;case'1795':try{c[1795]|=(d['tag_priority']=='9'&&typeof d['associatedTags']=='undefined'&&d['tealium_view_or_link']=='view'&&typeof d['cp.WSIRetailStore']=='undefined')||(d['tag_priority']=='9'&&typeof d['associatedTags']!='undefined'&&d['tealium_view_or_link']=='view'&&d['associatedTags'].toString().indexOf('adobeAnalytics')>-1&&typeof d['cp.WSIRetailStore']=='undefined')||(d['tag_priority']=='9'&&typeof d['associatedTags']!='undefined'&&d['associatedTags']==''&&d['tealium_view_or_link']=='view'&&typeof d['cp.WSIRetailStore']=='undefined')}catch(e){utag.DB(e)};break;case'1796':try{c[1796]|=(typeof d['associatedTags']=='undefined'&&d['tealium_view_or_link']=='link'&&typeof d['cp.WSIRetailStore']=='undefined')||(typeof d['associatedTags']!='undefined'&&d['tealium_view_or_link']=='link'&&d['associatedTags'].toString().indexOf('adobeAnalytics')>-1&&typeof d['cp.WSIRetailStore']=='undefined')||(typeof d['associatedTags']!='undefined'&&d['associatedTags']==''&&d['tealium_view_or_link']=='link'&&typeof d['cp.WSIRetailStore']=='undefined')}catch(e){utag.DB(e)};break;case'1797':try{c[1797]|=(d['ut.profile']=='ios-registry-app')||(d['ut.profile']=='shopping-app')}catch(e){utag.DB(e)};break;case'1798':try{c[1798]|=(d['privacy_opt_out_LDU'].toString().indexOf('false')>-1)}catch(e){utag.DB(e)};break;case'1804':try{c[1804]|=(typeof d['cp.doubleclick_24h']=='undefined')}catch(e){utag.DB(e)};break;case'1805':try{c[1805]|=(d['tealium_view_or_link']=='view'&&d['tag_priority']=='1')||(d['tealium_event']=='cart_add')||(d['tealium_event']=='favorites_add')||(d['tealium_event']=='registry_create')}catch(e){utag.DB(e)};break;case'1826':try{c[1826]|=(d['market']=='us'&&typeof d['cp.WSIRetailStore']=='undefined'&&typeof d['privacy_opt_out_att']=='undefined')||(d['market']=='ca'&&typeof d['cp.WSIRetailStore']=='undefined'&&typeof d['privacy_opt_out_att']=='undefined')}catch(e){utag.DB(e)};break;case'1834':try{c[1834]|=(d['tealium_event']=='credit_card_apply_now_view')}catch(e){utag.DB(e)};break;case'1835':try{c[1835]|=(d['tealium_event']=='apply_now_interaction'&&d['pmc_eVar14'].toString().indexOf('footer')<0)}catch(e){utag.DB(e)};break;case'1840':try{c[1840]|=(d['tealium_view_or_link']=='view'&&!/^fpv_/.test(d['tealium_event']))||(d['tealium_event']=='cart_add')||(d['tealium_event']=='registry_create')}catch(e){utag.DB(e)};break;case'1841':try{c[1841]|=(d['tealium_event']=='qudini_scheduling_appointment_open')||(d['tealium_event']=='qudini_scheduling_appointment_confirmation')}catch(e){utag.DB(e)};break;case'2078':try{c[2078]|=(d['pmc_event207']=='event207')||(d['tealium_event']=='key_confirmation')||(d['tealium_event']=='thekey_confirm_view')}catch(e){utag.DB(e)};break;case'2083':try{c[2083]|=(d['tealium_event']=='qudini_scheduling_appointment_confirmation')}catch(e){utag.DB(e)};break;case'2084':try{c[2084]|=(d['tealium_view_or_link']=='view'&&!/^fpv_/.test(d['tealium_event']))||(d['tealium_event']=='cart_add')||(d['tealium_event']=='registry_add')||(d['tealium_event']=='qudini_scheduling_appointment_confirmation')||(d['tealium_event']=='registry_create')}catch(e){utag.DB(e)};break;case'2086':try{c[2086]|=(d['market']=='us')}catch(e){utag.DB(e)};break;case'2087':try{c[2087]|=(typeof d['wsid_gclid']!='undefined'&&d['wsid_gclid']!='')}catch(e){utag.DB(e)};break;case'2097':try{c[2097]|=(d['tealium_view_or_link']=='view'&&d['hit_type']!='virtual_page_view')}catch(e){utag.DB(e)};break;case'2100':try{c[2100]|=(d['tealium_view_or_link']=='view'&&!/^fpv_/.test(d['tealium_event']))||(d['tealium_event']=='cart_add')||(d['tealium_event']=='registry_create')||(d['tealium_event']=='qudini_scheduling_appointment_confirmation')}catch(e){utag.DB(e)};break;case'2102':try{c[2102]|=(d['market']=='us')||(d['market']=='ca')}catch(e){utag.DB(e)};break;case'2110':try{c[2110]|=(d['pmc_eVar79']=='website')}catch(e){utag.DB(e)};break;case'2111':try{c[2111]|=(d['brand']!='rj')}catch(e){utag.DB(e)};break;case'2113':try{c[2113]|=(d['market']=='us'&&typeof d['cp.WSIRetailStore']=='undefined')||(d['market'].toString().indexOf('ca')>-1&&typeof d['cp.WSIRetailStore']=='undefined')}catch(e){utag.DB(e)};break;case'2114':try{c[2114]|=(d['brand'].toString().indexOf('gr')>-1)}catch(e){utag.DB(e)};break;case'2115':try{c[2115]|=(d['brand']!='gr')}catch(e){utag.DB(e)};break;}}};utag.pre=function(){utag.loader.initdata();utag.pagevars();try{utag.loader.RD(utag.data)}catch(e){utag.DB(e)};utag.loader.loadrules();};utag.loader.GET=function(){utag.cl={'_all_':1};utag.pre();utag.handler.extend=[function(a,b){try{if(1){try{b['tealium_view_or_link']=a}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(/^\/m\//.test(b['dom.pathname'])){b['is_mobile']='1'}}catch(e){utag.DB(e);}},function(a,b){try{if(1){try{b['subBrand']=pmc.subBrand}catch(e){};try{b['brand']=utag_data.brand}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if((typeof b['registry_id']!='undefined'&&typeof b['registry_id']!='undefined'&&b['registry_id']!=''&&b['dom.pathname'].toString().toLowerCase().indexOf('registry-list'.toLowerCase())>-1&&/^\/m\//i.test(b['dom.pathname'])&&typeof b['dom.query_string']!='undefined'&&b['dom.query_string'].toString().toLowerCase().indexOf('congrats'.toLowerCase())>-1)){b['page_name']='MANAGE REGISTRY: CREATE'}}catch(e){utag.DB(e);}},function(a,b){try{if(b['dom.pathname'].toString().indexOf('pages/gallery/')>-1){b['page_type']='gallery'}}catch(e){utag.DB(e);}},function(a,b){try{if(1){if(pmc.stringContains(pmc.location.hostname,"jukebox")){b["dom.domain"]=pmc.location.hostname;}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){try{b['privacy_opt_out_LDU']=utag_data.privacy_opt_out_LDU}catch(e){};try{b['privacy_opt_out_geo_on']=false}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(1){if(!pmc.dataLayerReadyCallbackRegistered){pmc.registerDataLayerReadyCallback();return false;}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){try{if(b.tealium_event==="err_event_fallback"||b.tealium_event==="error_event"){return;}
var payloadString=b.wsiapp_meta||"";var cookieString=pmc.readCookie("wsiapp_meta");if(payloadString||cookieString){var appString=payloadString||cookieString;var isNativeHit=payloadString.length>0;var metaArray=appString.split("|");var brand=(metaArray[1]||"").toLowerCase();var market=(metaArray[2]||"us").toLowerCase();var appVersion=metaArray[3]||"";var branch=metaArray[4]==="prod"?"prod":"dev";var visitorId=metaArray[6]||"";var previousPageNameFromApp=metaArray[7]||"";var previousPageTypeFromApp=metaArray[8]||"";var cmSrc="";var cmEm="";var decodedHashedEmail="";var privacy_opt_out_att=b.privacy_opt_out_att||metaArray[9];var incorrectTealiumEvents=["View","Event",];var error;var testIds=["03655528407170249674537976367909634200","62786382351563317100765902161014018266","84535286617267070703250351941462611576","00000000000000000000000000000000000000",];try{utag_data.pmc_eVar50=b.pmc_eVar50=utag_data.customer_id=b.customer_id=b.sc_visitor_id=utag_data.sc_visitor_id=visitorId;if(s&&s.visitor&&s.visitor.setAnalyticsVisitorID){s.visitor.setAnalyticsVisitorID(visitorId);}}catch(e){utag_data.pmc_eVar50=b.pmc_eVar50=utag_data.customer_id=b.customer_id=b.sc_visitor_id=utag_data.sc_visitor_id="00000000000000000000000000000000000000";b=pmc.setErrorData(e,b);}
try{pmc.environment.appIdentifier="shoppingapp";pmc.environment.brandCode=brand;pmc.environment.brandDomain=pmc.resolveMapLookup(pmc.environment._brandHostMap,pmc.environment.brandCode);pmc.environment.tealiumEnvironment=branch;utag_data.brand=b.brand=brand;utag_data.market=b.market=market;utag_data.brand_with_market=b.brand_with_market=brand+"-"+market;b.pmc_prop8=pmc.getAdobeSubBrand(brand);utag_data.pmc_eVar79=b.pmc_eVar79="shopping app";utag_data.pmc_eVar179=b.pmc_eVar179=appVersion;b.currency_code="USD";utag_data.domain_key=b.domain_key=b.bloomreach_domain_key;if(branch!=="prod"||testIds.indexOf(b.pmc_eVar50)>-1){utag_data.pmc_prop0=b.pmc_prop0=appString;}}catch(e){b=pmc.setErrorData(e,b);}
try{b=pmc.processQueryStringArray(b.query_string,b);cmSrc=pmc.getQueryStringValue("cm_src");utag_data.pmc_eVar9=b.pmc_eVar9=b.pmc_eVar9||pmc.getPfmFromNativeAppPayload(cmSrc);utag_data.pmc_eVar64=b.pmc_eVar64=pmc.getRecommendationStrategy();cmEm=pmc.getQueryStringValue("cm_em");decodedHashedEmail=(b.pmc_eVar43||cmEm).replace("%3A",":");utag_data.customer_email_public=b.customer_email_public=decodedHashedEmail;if(b.customer_email_public){if(pmc.stringContains(b.customer_email_public,"@")||pmc.stringContains(b.customer_email_public,"%40")){var err=new Error("Plain text email passed from app");err.type="datalayer";pmc.logError(err);}else{utag_data.pmc_eVar43=b.pmc_eVar43=cmEm;}}
if(b.pmc_eVar34){utag_data.registry_id=b.registry_id=b.pmc_eVar34;}
if(isNativeHit){b.pmc_eVar113=b.query_string;}}catch(e){b=pmc.setErrorData(e,b);}
try{utag_data.tealium_event=b.tealium_event=b.pmc_tealium_event||b.tealium_event;if(pmc.arrayContains(incorrectTealiumEvents,utag_data.tealium_event)){error=new Error("No tealium_event value");error.type="datalayer";b=pmc.setErrorData(error,b);}
utag_data.pmc_prop36=b.pmc_prop36=isNativeHit?"shopping app:native":"shopping app:webview";if(isNativeHit){utag_data.previous_page_name=b.previous_page_name=previousPageNameFromApp;utag_data.previous_page_type=b.previous_page_type=previousPageTypeFromApp;}else{if(!b.previous_page_name&&!b.previous_page_type){pmc.firstWebviewPreviousPageName=previousPageNameFromApp;pmc.firstWebviewPreviousPageType=previousPageTypeFromApp;}else{utag_data.previous_page_name=b.previous_page_name;utag_data.previous_page_type=b.previous_page_type;}}
if(pmc.stringContains(b.pmc_tealium_event,"category_view")){b.pmc_eVar93=b.pmc_eVar93||"D=v1";}}catch(e){b=pmc.setErrorData(e,b);}
try{pmc.setECommerceExtensionFromAdobeVariables(b);if(pmc.stringContains(utag_data.tealium_event,"product_view")){utag_data.product_highest_price=b.price_selling_max;}}catch(e){b=pmc.setErrorData(e,b);}
try{b.privacy_opt_out_att=(privacy_opt_out_att&&privacy_opt_out_att!="false")?true:undefined;if(b.privacy_opt_out_att){utag_data.privacy_request_type=b.privacy_request_type="ATT";}
pmc.privacy.initialize(pmc.environment.tealiumEnvironment,b.sc_visitor_id,b.pmc_eVar43);b.privacy_opt_out_LDU=utag_data.privacy_opt_out_LDU;utag_data.liveramp_ats_envelope=b.liveramp_ats_envelope=pmc.readCookie("wsid_lrenv");}catch(e){b=pmc.setErrorData(e,b);}}else{utag_data.pmc_eVar79=b.pmc_eVar79="website";}}catch(e){pmc.logError(e);}}}catch(e){utag.DB(e)}},function(a,b,c,d){b._ccity=(typeof b['customer_city']!='undefined')?b['customer_city']:'';b._ccountry=(typeof b['customer_country']!='undefined')?b['customer_country']:'';b._ccurrency=(typeof b['currency_code']!='undefined')?b['currency_code']:'';b._ccustid=(typeof b['customer_id']!='undefined')?b['customer_id']:'';b._corder=(typeof b['order_id']!='undefined')?b['order_id']:'';b._cpromo=(typeof b['order_promo_code']!='undefined')?b['order_promo_code']:'';b._cship=(typeof b['order_shipping_amount']!='undefined')?b['order_shipping_amount']:'';b._cstate=(typeof b['customer_state']!='undefined')?b['customer_state']:'';b._cstore='';b._csubtotal=(typeof b['order_discounted_subtotal']!='undefined')?b['order_discounted_subtotal']:'';b._ctax=(typeof b['order_tax_amount']!='undefined')?b['order_tax_amount']:'';b._ctotal=(typeof b['order_grand_total']!='undefined')?b['order_grand_total']:'';b._ctype='';b._czip=(typeof b['customer_postal_code']!='undefined')?b['customer_postal_code']:'';b._cprod=(typeof b['product_id']!='undefined'&&b['product_id'].length>0)?b['product_id']:[];b._cprodname=(typeof b['product_name']!='undefined'&&b['product_name'].length>0)?b['product_name']:[];b._cbrand=(typeof b['product_brand']!='undefined'&&b['product_brand'].length>0)?b['product_brand']:[];b._ccat=(typeof b['product_category']!='undefined'&&b['product_category'].length>0)?b['product_category']:[];b._ccat2=(typeof b['product_subcategory']!='undefined'&&b['product_subcategory'].length>0)?b['product_subcategory']:[];b._cquan=(typeof b['product_quantity']!='undefined'&&b['product_quantity'].length>0)?b['product_quantity']:[];b._cprice=(typeof b['product_unit_price']!='undefined'&&b['product_unit_price'].length>0)?b['product_unit_price']:[];b._csku=(typeof b['product_sku']!='undefined'&&b['product_sku'].length>0)?b['product_sku']:[];b._cpdisc=(typeof b['product_discount']!='undefined'&&b['product_discount'].length>0)?b['product_discount']:[];if(b._cprod.length==0){b._cprod=b._csku.slice()};if(b._cprodname.length==0){b._cprodname=b._csku.slice()};function tf(a){if(a==''||isNaN(parseFloat(a))){return a}else{return(parseFloat(a)).toFixed(2)}};b._ctotal=tf(b._ctotal);b._csubtotal=tf(b._csubtotal);b._ctax=tf(b._ctax);b._cship=tf(b._cship);for(c=0;c<b._cprice.length;c++){b._cprice[c]=tf(b._cprice[c])};for(c=0;c<b._cpdisc.length;c++){b._cpdisc[c]=tf(b._cpdisc[c])};},function(a,b){try{if(b['page_type']=='search'||b['pmc_eVar79']=='shopping app'){try{b['search_keyword']=pmc.getQueryStringValue("words")||b.pmc_eVar27||"";}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if((typeof b['category_path']!='undefined'&&typeof b['category_path']!='undefined'&&b['category_path']!='')){try{b['br_category_path']=b.category_path[b.category_path.length-1]}catch(e){};try{b['ta_category_path']=b.category_path.join('>')}catch(e){};try{b['rr_category_id']=b.category_path[b.category_path.length-1]}catch(e){};try{b['jl_category_path']=b.category_path.join(";")}catch(e){}}}catch(e){utag.DB(e);}},function(a,b,c,d,e,f,g){if(1){d=b['tealium_event'];if(typeof d=='undefined')return;c=[{'homepage_view':'home'},{'category_view':'category'},{'search_results':'searchresults'},{'product_view':'product'},{'cart_view':'cart'},{'purchase':'purchase'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['bing_page_type']=c[e][f];m=true};};if(m)break};if(!m)b['bing_page_type']='Other';}},function(a,b){try{utag.runonce=utag.runonce||{};utag.runonce.ext=utag.runonce.ext||{};if(typeof utag.runonce.ext[15322]=='undefined'){utag.runonce.ext[15322]=1;if(b['dom.pathname'].toString().indexOf('about-us/privacy-policy')>-1||b['dom.pathname'].toString().indexOf('customer-service/legal-statement')>-1){var privacyLinkNodeList=document.querySelectorAll('[href*="truyo.com"]');for(var i=0;i<privacyLinkNodeList.length;i++){var privacyUrl=privacyLinkNodeList[i].href;if(pmc.stringContains(privacyUrl,"donotsell")&&!pmc.stringContains(privacyUrl,"ext=")&&b.sc_visitor_id){privacyLinkNodeList[i].href+="?ext="+b.sc_visitor_id;}}}}}catch(e){utag.DB(e)}},function(a,b){try{utag.runonce=utag.runonce||{};utag.runonce.ext=utag.runonce.ext||{};if(typeof utag.runonce.ext[15422]=='undefined'){utag.runonce.ext[15422]=1;if(1){var buttonApplyNow;if(b['tealium_event']=='credit_card_apply_now_view'){buttonApplyNow=document.querySelector(".cta");if(buttonApplyNow){doApplyNowAddEvent(buttonApplyNow,"creditcard-_-body-cta-_-applynow");}
buttonApplyNow=document.querySelector(".cc-sustainable-copy-top a");if(buttonApplyNow){doApplyNowAddEvent(buttonApplyNow,"creditcard-_-body-sustainable-_-applynow");}}
else if(b['tealium_event']=='the_key_rewards_view'){buttonApplyNow=document.querySelector(".key-rewards-buttons .btn-apply-now a");if(buttonApplyNow){doApplyNowAddEvent(buttonApplyNow,"creditcard-_-keyrewards-hero-_-applynow");}
buttonApplyNow=document.querySelector(".key-rewards-table .btn-apply-now a");if(buttonApplyNow){doApplyNowAddEvent(buttonApplyNow,"creditcard-_-keyrewards-benefits-_-applynow");}
buttonApplyNow=document.querySelector(".cc-sustainable-copy-top a");if(buttonApplyNow){doApplyNowAddEvent(buttonApplyNow,"creditcard-_-keyrewards-sustainable-_-applynow");}}
function doApplyNowAddEvent(element,clickLocation){element.addEventListener("click",function(){WSI.dataLayer._addEvent({name:"elementInteraction",data:{category:"credit card application",item:"apply now interaction",clickLocation:clickLocation,},});});}}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){b['pmc_eVar10']=b['pmc_pageName']}}catch(e){utag.DB(e);}},function(a,b){try{if(1){b['tealium_event']=''}}catch(e){utag.DB(e);}},function(a,b){try{if(1){utag_data.associatedTags='';}}catch(e){utag.DB(e)}}];utag.handler.cfg_extend=[{"end":0,"alr":0,"id":"14338","bwq":0,"blr":1},{"blr":1,"bwq":0,"id":"12461","alr":0,"end":0},{"alr":0,"end":0,"blr":1,"bwq":0,"id":"14022"},{"end":0,"alr":0,"blr":1,"bwq":0,"id":"14082"},{"id":"15113","bwq":0,"blr":1,"alr":0,"end":0},{"alr":0,"end":0,"blr":1,"bwq":0,"id":"15159"},{"end":0,"alr":0,"id":"15335","bwq":0,"blr":1},{"id":"15438","bwq":0,"blr":1,"alr":0,"end":0},{"alr":0,"end":0,"blr":1,"bwq":0,"id":"16423"},{"alr":1,"end":0,"blr":0,"bwq":0,"id":"12460"},{"end":0,"alr":1,"blr":0,"bwq":0,"id":"12462"},{"id":"12466","bwq":0,"blr":0,"end":0,"alr":1},{"id":"14336","bwq":0,"blr":0,"end":0,"alr":1},{"blr":0,"bwq":0,"id":"15322","alr":1,"end":0},{"end":0,"alr":1,"blr":0,"bwq":0,"id":"15422"},{"id":"15441","bwq":0,"blr":0,"alr":1,"end":0},{"end":1,"alr":0,"id":"15133","bwq":0,"blr":0},{"id":"15358","bwq":0,"blr":0,"alr":0,"end":1}];utag.loader.initcfg=function(){utag.loader.cfg={"6491":{load:4,send:(utag.cond[1797]||utag.cond[1796]||utag.cond[1795]),v:202306211433,wait:0,tid:19063},"5967":{load:4,send:utag.cond[1826],v:202306211433,wait:0,tid:4049},"5349":{load:4,send:(utag.cond[2111]&&utag.cond[1318]&&utag.cond[1785]),v:202306211433,wait:1,tid:20010},"5997":{load:4,send:utag.cond[2113],v:202306211433,wait:1,tid:20010},"5348":{load:4,send:(utag.cond[1748]&&utag.cond[2102]),v:202306211433,wait:1,tid:2018},"5370":{load:4,send:(((utag.cond[2113])&&(utag.cond[1731]))),v:202306211433,wait:1,tid:1143},"5423":{load:4,send:utag.cond[2113],v:202306211433,wait:1,tid:20010},"5443":{load:(utag.cond[1363]&&utag.cond[1364]&&utag.cond[1785]),send:1,v:202306211433,wait:1,tid:4001},"5684":{load:4,send:(utag.cond[2100]&&utag.cond[1826]),v:202306211433,wait:1,tid:6026},"5733":{load:4,send:((((utag.cond[2084])&&(utag.cond[1798])&&(utag.cond[1785]))&&(utag.cond[2115]))),v:202306211433,wait:1,tid:16044},"5754":{load:(utag.cond[1331]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"5777":{load:(((utag.cond[1726]||utag.cond[1363]||utag.cond[1339]||utag.cond[1789])&&(utag.cond[2113])&&(utag.cond[1489]))),send:1,v:202306211433,wait:1,tid:20067},"5860":{load:(utag.cond[2111]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"5897":{load:(((utag.cond[1726]||utag.cond[1363]||utag.cond[1339]||utag.cond[1789])&&(utag.cond[1785])&&(utag.cond[1489]))),send:1,v:202306211433,wait:1,tid:20067},"5917":{load:4,send:(((utag.cond[1805])&&(utag.cond[2113]))),v:202306211433,wait:1,tid:9038},"5921":{load:4,send:(utag.cond[1804]&&utag.cond[1505]&&utag.cond[1785]),v:202306211433,wait:1,tid:20010},"5930":{load:(((utag.cond[1726]||utag.cond[1339]||utag.cond[1789])&&(utag.cond[1785])&&(utag.cond[1489]))),send:1,v:202306211433,wait:1,tid:20067},"5954":{load:(utag.cond[1521]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:7117},"5959":{load:4,send:(utag.cond[2111]&&utag.cond[1525]&&utag.cond[1785]),v:202306211433,wait:1,tid:20040},"5969":{load:(utag.cond[1826]&&utag.cond[1489]),send:1,v:202306211433,wait:1,tid:4049},"5971":{load:(utag.cond[1826]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:4049},"5972":{load:(utag.cond[1785]&&utag.cond[1529]&&utag.cond[1498]),send:1,v:202306211433,wait:1,tid:4049},"5995":{load:(utag.cond[2111]&&utag.cond[1530]&&utag.cond[1785]),send:1,v:202306211433,wait:1,tid:20010},"6006":{load:(utag.cond[1537]&&utag.cond[2113]),send:1,v:202306211433,wait:1,tid:11003},"6010":{load:(utag.cond[2111]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20040},"6024":{load:4,send:(utag.cond[1505]&&utag.cond[1785]),v:202306211433,wait:1,tid:20010},"6023":{load:(utag.cond[1785]&&utag.cond[1754]),send:1,v:202306211433,wait:1,tid:4049},"6039":{load:(utag.cond[1548]&&utag.cond[1785]),send:1,v:202306211433,wait:1,tid:20040},"6069":{load:(utag.cond[1826]&&utag.cond[1489]),send:1,v:202306211433,wait:1,tid:20010},"6070":{load:(utag.cond[2111]&&utag.cond[1826]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20010},"6092":{load:(utag.cond[1726]&&utag.cond[1563]&&utag.cond[1785]),send:1,v:202306211433,wait:1,tid:20010},"6103":{load:4,send:(utag.cond[1731]&&utag.cond[1798]&&utag.cond[1785]),v:202306211433,wait:1,tid:2063},"6478":{load:4,send:(utag.cond[2111]&&utag.cond[1826]),v:202306211433,wait:1,tid:7133},"6479":{load:(utag.cond[1826]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:7132},"6480":{load:((((utag.cond[1726]||utag.cond[1363]||utag.cond[1331]||utag.cond[1339]||utag.cond[1789])&&(utag.cond[1826])&&(utag.cond[1717]))&&!(utag.cond[1521]))),send:1,v:202306211433,wait:1,tid:20067},"6496":{load:4,send:(utag.cond[2111]&&utag.cond[1785]),v:202306211433,wait:1,tid:20010},"6528":{load:4,send:utag.cond[1785],v:202306211433,wait:1,tid:27004},"6534":{load:(utag.cond[1732]&&utag.cond[1785]&&utag.cond[1498]),send:1,v:202306211433,wait:1,tid:20010},"6543":{load:(((utag.cond[1726]||utag.cond[1363]||utag.cond[1339]||utag.cond[1789])&&(utag.cond[1785])&&(utag.cond[1716]))),send:1,v:202306211433,wait:1,tid:20067},"6558":{load:4,send:(((utag.cond[2086])&&(utag.cond[2115]))),v:202306211433,wait:1,tid:3162},"6568":{load:4,send:(((utag.cond[2111])&&(utag.cond[2115])&&(utag.cond[1749])&&(utag.cond[1785]))),v:202306211433,wait:1,tid:19129},"6570":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20040},"6571":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20040},"6573":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:4049},"6574":{load:(utag.cond[2111]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:4049},"6592":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:12047},"6593":{load:(utag.cond[1789]&&utag.cond[1826]&&utag.cond[1753]),send:1,v:202306211433,wait:1,tid:7132},"6596":{load:(utag.cond[2111]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20040},"6636":{load:4,send:(utag.cond[2111]&&utag.cond[1749]&&utag.cond[1785]),v:202306211433,wait:1,tid:20067},"6641":{load:(utag.cond[2111]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6644":{load:(((utag.cond[1726]||utag.cond[1789])&&(utag.cond[1785])&&(utag.cond[1489]))),send:1,v:202306211433,wait:1,tid:7132},"6646":{load:4,send:(utag.cond[1505]&&utag.cond[1749]&&utag.cond[1785]),v:202306211433,wait:1,tid:20067},"6649":{load:4,send:((utag.cond[2086])),v:202306211433,wait:1,tid:17013},"6650":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20040},"6651":{load:(utag.cond[1339]&&utag.cond[1785]&&utag.cond[1791]),send:1,v:202306211433,wait:1,tid:6037},"6653":{load:(utag.cond[1339]&&utag.cond[1785]&&utag.cond[1791]),send:1,v:202306211433,wait:1,tid:20040},"6682":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6683":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6684":{load:(utag.cond[2111]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6686":{load:(utag.cond[1789]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6706":{load:(utag.cond[2111]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:7132},"6709":{load:((((utag.cond[1716])&&(utag.cond[1785]))&&(utag.cond[2115]))),send:1,v:202306211433,wait:1,tid:20067},"6715":{load:(utag.cond[1789]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6719":{load:(((utag.cond[2111])&&(utag.cond[2115])&&(utag.cond[1785])&&(utag.cond[1716]))),send:1,v:202306211433,wait:1,tid:20010},"6721":{load:(utag.cond[1716]&&utag.cond[1785]),send:1,v:202306211433,wait:1,tid:20067},"6722":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6728":{load:4,send:(((utag.cond[2111])&&(utag.cond[2115])&&(utag.cond[1840])&&(utag.cond[1798])&&(utag.cond[1785]))),v:202306211433,wait:1,tid:20010},"6737":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6738":{load:(utag.cond[2111]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20040},"6741":{load:(utag.cond[1834]&&utag.cond[1785]),send:1,v:202306211433,wait:1,tid:20040},"6742":{load:(utag.cond[1835]&&utag.cond[1785]),send:1,v:202306211433,wait:1,tid:20040},"6744":{load:4,send:(utag.cond[1749]&&utag.cond[1785]),v:202306211433,wait:1,tid:20067},"6745":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6749":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6752":{load:(utag.cond[1789]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6753":{load:4,send:(utag.cond[2111]&&utag.cond[1785]&&utag.cond[1790]),v:202306211433,wait:1,tid:20067},"6754":{load:4,send:(utag.cond[1785]&&utag.cond[1790]),v:202306211433,wait:1,tid:20067},"6758":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6759":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6767":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6768":{load:4,send:(utag.cond[1505]&&utag.cond[1749]&&utag.cond[1785]),v:202306211433,wait:1,tid:20067},"6770":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6773":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"6780":{load:4,send:(utag.cond[1760]&&utag.cond[1826]),v:202306211433,wait:1,tid:7142},"6781":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:7132},"6782":{load:(utag.cond[1339]&&utag.cond[1841]&&utag.cond[1785]),send:1,v:202306211433,wait:1,tid:20040},"7203":{load:(utag.cond[1726]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:4049},"7207":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:4049},"7213":{load:4,send:(((utag.cond[1339]||utag.cond[1789])&&(utag.cond[1731])&&(utag.cond[1785]))),v:202306211433,wait:1,tid:3175},"7218":{load:4,send:(utag.cond[1785]&&utag.cond[1790]),v:202306211433,wait:1,tid:20067},"7220":{load:(((utag.cond[1521]||utag.cond[1339])&&(utag.cond[2078])&&(utag.cond[1785]))),send:1,v:202306211433,wait:1,tid:7132},"7224":{load:(utag.cond[1339]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"7226":{load:4,send:(utag.cond[1732]&&utag.cond[1785]),v:202306211433,wait:1,tid:20010},"7227":{load:(utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20010},"7228":{load:(utag.cond[1339]&&utag.cond[1785]&&utag.cond[2083]),send:1,v:202306211433,wait:1,tid:7132},"7231":{load:(utag.cond[2113]&&utag.cond[1716]&&utag.cond[2087]),send:1,v:202306211433,wait:1,tid:11003},"7233":{load:(utag.cond[1789]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"7247":{load:4,send:((((utag.cond[2097])&&(utag.cond[1826])&&(utag.cond[2110]))&&(utag.cond[2115]))),v:202306211433,wait:1,tid:20067},"7250":{load:(utag.cond[1339]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20040},"7252":{load:(utag.cond[2111]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"7253":{load:(((utag.cond[1339]||utag.cond[1789])&&(utag.cond[1785])&&(utag.cond[1716]))),send:1,v:202306211433,wait:1,tid:20067},"7260":{load:4,send:((utag.cond[2114])),v:202306211433,wait:1,tid:20067},"7261":{load:4,send:(((utag.cond[2114])&&(utag.cond[1716]))),v:202306211433,wait:1,tid:20067},"7263":{load:(utag.cond[1789]&&utag.cond[1785]&&utag.cond[1716]),send:1,v:202306211433,wait:1,tid:20067},"7266":{load:(((utag.cond[1789])&&(utag.cond[1785])&&(utag.cond[1716]))),send:1,v:202306211433,wait:1,tid:20067}};utag.loader.cfgsort=["6491","5967","5349","5997","5348","5370","5423","5443","5684","5733","5754","5777","5860","5897","5917","5921","5930","5954","5959","5969","5971","5972","5995","6006","6010","6024","6023","6039","6069","6070","6092","6103","6478","6479","6480","6496","6528","6534","6543","6558","6568","6570","6571","6573","6574","6592","6593","6596","6636","6641","6644","6646","6649","6650","6651","6653","6682","6683","6684","6686","6706","6709","6715","6719","6721","6722","6728","6737","6738","6741","6742","6744","6745","6749","6752","6753","6754","6758","6759","6767","6768","6770","6773","6780","6781","6782","7203","7207","7213","7218","7220","7224","7226","7227","7228","7231","7233","7247","7250","7252","7253","7260","7261","7263","7266"];}
utag.loader.initcfg();}
if(typeof utag_cfg_ovrd!='undefined'){for(var i in utag.loader.GV(utag_cfg_ovrd))utag.cfg[i]=utag_cfg_ovrd[i]};utag.loader.PINIT=function(a,b,c){utag.DB("Pre-INIT");if(utag.cfg.noload){return;}
try{this.GET();if(utag.handler.RE('view',utag.data,"blr")){utag.handler.LR(utag.data);}}catch(e){utag.DB(e)};a=this.cfg;c=0;for(b in this.GV(a)){if(a[b].block==1||(a[b].load>0&&(typeof a[b].src!='undefined'&&a[b].src!=''))){a[b].block=1;c=1;this.bq[b]=1;}}
if(c==1){for(b in this.GV(a)){if(a[b].block){a[b].id=b;if(a[b].load==4)a[b].load=1;a[b].cb=function(){var d=this.uid;utag.loader.cfg[d].cbf=1;utag.loader.LOAD(d)};this.AS(a[b]);}}}
if(c==0)this.INIT();};utag.loader.INIT=function(a,b,c,d,e){utag.DB('utag.loader.INIT');if(this.ol==1)return-1;else this.ol=1;if(utag.cfg.noview!=true)utag.handler.RE('view',utag.data,"alr");utag.rpt.ts['i']=new Date();d=this.cfgsort;for(a=0;a<d.length;a++){e=d[a];b=this.cfg[e];b.id=e;if(b.block!=1&&b.s2s!=1){if(utag.loader.bk[b.id]||((utag.cfg.readywait||utag.cfg.noview)&&b.load==4)){this.f[b.id]=0;utag.loader.LOAD(b.id)}else if(b.wait==1&&utag.loader.rf==0){utag.DB('utag.loader.INIT: waiting '+b.id);this.wq.push(b)
this.f[b.id]=2;}else if(b.load>0){utag.DB('utag.loader.INIT: loading '+b.id);this.lq.push(b);this.AS(b);}}}
if(this.wq.length>0)utag.loader.EV('','ready',function(a){if(utag.loader.rf==0){utag.DB('READY:utag.loader.wq');utag.loader.rf=1;utag.loader.WQ();}});else if(this.lq.length>0)utag.loader.rf=1;else if(this.lq.length==0)utag.loader.END();return 1};utag.loader.EV('','ready',function(a){if(utag.loader.efr!=1){utag.loader.efr=1;try{try{if(1){try{if(typeof(adobe)!=="undefined"&&typeof(adobe.target)!=="undefined"&&typeof(adobe.target.trackEvent)!=="undefined"){var mboxEventObject={"mbox":"idSync"};if(typeof(digitalData)!=="undefined"&&typeof(digitalData.x_transaction)!=="undefined"&&typeof(digitalData.x_transaction.orders)!=="undefined"){var orderArray=digitalData.x_transaction.orders;for(var i=0;i<orderArray.length;i++){if(typeof(orderArray[i].promoCode)!=="undefined"&&orderArray[i].promoCode.length>0){mboxEventObject.params={"profile.WS_usedPromoCode":orderArray[i].promoCode};}}}
adobe.target.trackEvent(mboxEventObject);}}catch(e){console.log("handled exception: "+e);}}}catch(e){utag.DB(e)}}catch(e){utag.DB(e)};try{try{if(1){try{if(!pmc.isMobile&&pmc.checkNestedValue(utag_data,"page_type","product")){if(utag_data.subBrand==="ws-home"||utag_data.subBrand==="ws-kitchen"){var handleDataLayerEvent=function(){var payload={name:"elementInteraction",data:{category:"Review Link Click",item:"Review Link Clicked",},};if(window.WSI.dataLayer){window.WSI.dataLayer._addEvent(payload);}}
var reviewlink=document.getElementsByClassName("read-reviews");var qaLink=document.getElementsByClassName("goToQA");if(reviewlink.length>0&&typeof reviewlink[0].addEventListener==="function"){reviewlink[0].addEventListener("click",handleDataLayerEvent);}
if(qaLink.length>0&&typeof qaLink[0].addEventListener==="function"){qaLink[0].addEventListener("click",handleDataLayerEvent);}}}}catch(e){e.data="Review Link Event Listener";pmc.fireErrorHit(e);}}}catch(e){utag.DB(e)}}catch(e){utag.DB(e)};}})
if(utag.cfg.readywait||utag.cfg.waittimer){utag.loader.EV('','ready',function(a){if(utag.loader.rf==0){utag.loader.rf=1;utag.cfg.readywait=1;utag.DB('READY:utag.cfg.readywait');setTimeout(function(){utag.loader.PINIT()},utag.cfg.waittimer||1);}})}else{utag.loader.PINIT()}}
//tealium universal tag - utag.6491 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
var s=s_gi("wsidefaultdev")
s.account="wsidefaultdev";s.trackDownloadLinks=true;s.trackExternalLinks=true;s.trackInlineStats=true;s.linkInternalFilters="javascript:,williams-sonoma.com,potterybarn.com,potterybarnkids.com,pbteen.com,potterybarnteen.com,westelm.com,markandgraham.com,rejuvenation.com,greenrow.com,cultivation.com,williams-sonoma.ca,potterybarn.ca,potterybarnkids.ca,westelm.ca,pbteen.ca,potterybarnteen.ca,markandgraham.ca,rejuvenation.ca,ab.mgimgs.com,rk.mgimgs.com,ab.pbimgs.com,rk.pbimgs.com,ab.pkimgs.com,rk.pkimgs.com,ab.ptimgs.com,rk.ptimgs.com,ab.weimgs.com,rk.weimgs.com,ab.wsimgs.com,rk.wsimgs.com,williams-sonoma.cashstar.com,potterybarn.cashstar.com,potterybarnkids.cashstar.com,pbteen.cashstar.com,potterybarnteen.cashstar.com,westelm.cashstar.com,markandgraham.cashstar.com,recs.richrelevance.com,-m.cashstar.com,cashstar.com,west-elm-progressive.herokuapp.com,ws-preprd-rk1v,pkimgs.com,pbimgs.com,ptimgs.com,wsimgs.com,weimgs.com,mgimgs.com,wsib2b.com";s.linkLeaveQueryString=false;s.linkTrackVars="None";s.linkTrackEvents="None";s.usePlugins=false;s.currencyCode="USD";s.visitorNamespace="williamssonoma";s.trackingServer="metrics.williams-sonoma.com";s.trackingServerSecure="smetrics.williams-sonoma.com";s.charSet="UTF-8";s.expectSupplementalData=true;s.debugTracking=(utag.cfg)?utag.cfg.utagdb:false;function AppMeasurement(r){var a=this;a.version="2.17.0";var h=window;h.s_c_in||(h.s_c_il=[],h.s_c_in=0);a._il=h.s_c_il;a._in=h.s_c_in;a._il[a._in]=a;h.s_c_in++;a._c="s_c";var q=h.AppMeasurement.ec;q||(q=null);var p=h,m,s;try{for(m=p.parent,s=p.location;m&&m.location&&s&&""+m.location!=""+s&&p.location&&""+m.location!=""+p.location&&m.location.host==s.host;)p=m,m=p.parent}catch(u){}a.C=function(a){try{console.log(a)}catch(b){}};a.Pa=function(a){return""+parseInt(a)==""+a};a.replace=function(a,b,d){return!a||0>a.indexOf(b)?a:a.split(b).join(d)};a.escape=function(c){var b,d;if(!c)return c;c=encodeURIComponent(c);for(b=0;7>b;b++)d="+~!*()'".substring(b,b+1),0<=c.indexOf(d)&&(c=a.replace(c,d,"%"+d.charCodeAt(0).toString(16).toUpperCase()));return c};a.unescape=function(c){if(!c)return c;c=0<=c.indexOf("+")?a.replace(c,"+"," "):c;try{return decodeURIComponent(c)}catch(b){}return unescape(c)};a.Kb=function(){var c=h.location.hostname,b=a.fpCookieDomainPeriods,d;b||(b=a.cookieDomainPeriods);if(c&&!a.Ia&&!/^[0-9.]+$/.test(c)&&(b=b?parseInt(b):2,b=2<b?b:2,d=c.lastIndexOf("."),0<=d)){for(;0<=d&&1<b;)d=c.lastIndexOf(".",d-1),b--;a.Ia=0<d?c.substring(d):c}return a.Ia};a.c_r=a.cookieRead=function(c){c=a.escape(c);var b=" "+a.d.cookie,d=b.indexOf(" "+c+"="),f=0>d?d:b.indexOf(";",d);c=0>d?"":a.unescape(b.substring(d+2+c.length,0>f?b.length:f));return"[[B]]"!=c?c:""};a.c_w=a.cookieWrite=function(c,b,d){var f=a.Kb(),e=a.cookieLifetime,g;b=""+b;e=e?(""+e).toUpperCase():"";d&&"SESSION"!=e&&"NONE"!=e&&((g=""!=b?parseInt(e?e:0):-60)?(d=new Date,d.setTime(d.getTime()+1E3*g)):1===d&&(d=new Date,g=d.getYear(),d.setYear(g+2+(1900>g?1900:0))));return c&&"NONE"!=e?(a.d.cookie=a.escape(c)+"="+a.escape(""!=b?b:"[[B]]")+"; path=/;"+(d&&"SESSION"!=e?" expires="+d.toUTCString()+";":"")+(f?" domain="+f+";":""),a.cookieRead(c)==b):0};a.Hb=function(){var c=a.Util.getIeVersion();"number"===typeof c&&10>c&&(a.unsupportedBrowser=!0,a.ub(a,function(){}))};a.ub=function(a,b){for(var d in a)a.hasOwnProperty(d)&&"function"===typeof a[d]&&(a[d]=b)};a.K=[];a.ea=function(c,b,d){if(a.Ja)return 0;a.maxDelay||(a.maxDelay=250);var f=0,e=(new Date).getTime()+a.maxDelay,g=a.d.visibilityState,k=["webkitvisibilitychange","visibilitychange"];g||(g=a.d.webkitVisibilityState);if(g&&"prerender"==g){if(!a.fa)for(a.fa=1,d=0;d<k.length;d++)a.d.addEventListener(k[d],function(){var c=a.d.visibilityState;c||(c=a.d.webkitVisibilityState);"visible"==c&&(a.fa=0,a.delayReady())});f=1;e=0}else d||a.u("_d")&&(f=1);f&&(a.K.push({m:c,a:b,t:e}),a.fa||setTimeout(a.delayReady,a.maxDelay));return f};a.delayReady=function(){var c=(new Date).getTime(),b=0,d;for(a.u("_d")?b=1:a.ya();0<a.K.length;){d=a.K.shift();if(b&&!d.t&&d.t>c){a.K.unshift(d);setTimeout(a.delayReady,parseInt(a.maxDelay/2));break}a.Ja=1;a[d.m].apply(a,d.a);a.Ja=0}};a.setAccount=a.sa=function(c){var b,d;if(!a.ea("setAccount",arguments))if(a.account=c,a.allAccounts)for(b=a.allAccounts.concat(c.split(",")),a.allAccounts=[],b.sort(),d=0;d<b.length;d++)0!=d&&b[d-1]==b[d]||a.allAccounts.push(b[d]);else a.allAccounts=c.split(",")};a.foreachVar=function(c,b){var d,f,e,g,k="";e=f="";if(a.lightProfileID)d=a.O,(k=a.lightTrackVars)&&(k=","+k+","+a.ka.join(",")+",");else{d=a.g;if(a.pe||a.linkType)k=a.linkTrackVars,f=a.linkTrackEvents,a.pe&&(e=a.pe.substring(0,1).toUpperCase()+a.pe.substring(1),a[e]&&(k=a[e].ac,f=a[e].$b));k&&(k=","+k+","+a.F.join(",")+",");f&&k&&(k+=",events,")}b&&(b=","+b+",");for(f=0;f<d.length;f++)e=d[f],(g=a[e])&&(!k||0<=k.indexOf(","+e+","))&&(!b||0<=b.indexOf(","+e+","))&&c(e,g)};a.o=function(c,b,d,f,e){var g="",k,l,h,n,m=0;"contextData"==c&&(c="c");if(b){for(k in b)if(!(Object.prototype[k]||e&&k.substring(0,e.length)!=e)&&b[k]&&(!d||0<=d.indexOf(","+(f?f+".":"")+k+","))){h=!1;if(m)for(l=0;l<m.length;l++)if(k.substring(0,m[l].length)==m[l]){h=!0;break}if(!h&&(""==g&&(g+="&"+c+"."),l=b[k],e&&(k=k.substring(e.length)),0<k.length))if(h=k.indexOf("."),0<h)l=k.substring(0,h),h=(e?e:"")+l+".",m||(m=[]),m.push(h),g+=a.o(l,b,d,f,h);else if("boolean"==typeof l&&(l=l?"true":"false"),l){if("retrieveLightData"==f&&0>e.indexOf(".contextData."))switch(h=k.substring(0,4),n=k.substring(4),k){case"transactionID":k="xact";break;case"channel":k="ch";break;case"campaign":k="v0";break;default:a.Pa(n)&&("prop"==h?k="c"+n:"eVar"==h?k="v"+n:"list"==h?k="l"+n:"hier"==h&&(k="h"+n,l=l.substring(0,255)))}g+="&"+a.escape(k)+"="+a.escape(l)}}""!=g&&(g+="&."+c)}return g};a.usePostbacks=0;a.Nb=function(){var c="",b,d,f,e,g,k,l,h,n="",m="",p=e="",r=a.T();if(a.lightProfileID)b=a.O,(n=a.lightTrackVars)&&(n=","+n+","+a.ka.join(",")+
",");else{b=a.g;if(a.pe||a.linkType)n=a.linkTrackVars,m=a.linkTrackEvents,a.pe&&(e=a.pe.substring(0,1).toUpperCase()+a.pe.substring(1),a[e]&&(n=a[e].ac,m=a[e].$b));n&&(n=","+n+","+a.F.join(",")+",");m&&(m=","+m+",",n&&(n+=",events,"));a.events2&&(p+=(""!=p?",":"")+a.events2)}if(r&&r.getCustomerIDs){e=q;if(g=r.getCustomerIDs())for(d in g)Object.prototype[d]||(f=g[d],"object"==typeof f&&(e||(e={}),f.id&&(e[d+".id"]=f.id),f.authState&&(e[d+".as"]=f.authState)));e&&(c+=a.o("cid",e))}a.AudienceManagement&&a.AudienceManagement.isReady()&&(c+=a.o("d",a.AudienceManagement.getEventCallConfigParams()));for(d=0;d<b.length;d++){e=b[d];g=a[e];f=e.substring(0,4);k=e.substring(4);g||("events"==e&&p?(g=p,p=""):"marketingCloudOrgID"==e&&r&&a.V("ECID")&&(g=r.marketingCloudOrgID));if(g&&(!n||0<=n.indexOf(","+e+","))){switch(e){case"customerPerspective":e="cp";break;case"marketingCloudOrgID":e="mcorgid";break;case"supplementalDataID":e="sdid";break;case"timestamp":e="ts";break;case"dynamicVariablePrefix":e="D";break;case"visitorID":e="vid";break;case"marketingCloudVisitorID":e="mid";break;case"analyticsVisitorID":e="aid";break;case"audienceManagerLocationHint":e="aamlh";break;case"audienceManagerBlob":e="aamb";break;case"authState":e="as";break;case"pageURL":e="g";255<g.length&&(a.pageURLRest=g.substring(255),g=g.substring(0,255));break;case"pageURLRest":e="-g";break;case"referrer":e="r";break;case"vmk":case"visitorMigrationKey":e="vmt";break;case"visitorMigrationServer":e="vmf";a.ssl&&a.visitorMigrationServerSecure&&(g="");break;case"visitorMigrationServerSecure":e="vmf";!a.ssl&&a.visitorMigrationServer&&(g="");break;case"charSet":e="ce";break;case"visitorNamespace":e="ns";break;case"cookieDomainPeriods":e="cdp";break;case"cookieLifetime":e="cl";break;case"variableProvider":e="vvp";break;case"currencyCode":e="cc";break;case"channel":e="ch";break;case"transactionID":e="xact";break;case"campaign":e="v0";break;case"latitude":e="lat";break;case"longitude":e="lon";break;case"resolution":e="s";break;case"colorDepth":e="c";break;case"javascriptVersion":e="j";break;case"javaEnabled":e="v";break;case"cookiesEnabled":e="k";break;case"browserWidth":e="bw";break;case"browserHeight":e="bh";break;case"connectionType":e="ct";break;case"homepage":e="hp";break;case"events":p&&(g+=(""!=g?",":"")+p);if(m)for(k=g.split(","),g="",f=0;f<k.length;f++)l=k[f],h=l.indexOf("="),0<=h&&(l=l.substring(0,h)),h=l.indexOf(":"),0<=h&&(l=l.substring(0,h)),0<=m.indexOf(","+l+",")&&(g+=(g?",":"")+k[f]);break;case"events2":g="";break;case"contextData":c+=a.o("c",a[e],n,e);g="";break;case"lightProfileID":e="mtp";break;case"lightStoreForSeconds":e="mtss";a.lightProfileID||(g="");break;case"lightIncrementBy":e="mti";a.lightProfileID||(g="");break;case"retrieveLightProfiles":e="mtsr";break;case"deleteLightProfiles":e="mtsd";break;case"retrieveLightData":a.retrieveLightProfiles&&(c+=a.o("mts",a[e],n,e));g="";break;default:a.Pa(k)&&("prop"==f?e="c"+k:"eVar"==f?e="v"+k:"list"==f?e="l"+k:"hier"==f&&(e="h"+k,g=g.substring(0,255)))}g&&(c+="&"+e+"="+("pev"!=e.substring(0,3)?a.escape(g):g))}"pev3"==e&&a.e&&(c+=a.e)}a.ja&&(c+="&lrt="+a.ja,a.ja=null);return c};a.B=function(a){var b=a.tagName;if("undefined"!=""+a.hc||"undefined"!=""+a.Wb&&"HTML"!=(""+a.Wb).toUpperCase())return"";b=b&&b.toUpperCase?b.toUpperCase():"";"SHAPE"==b&&(b="");b&&(("INPUT"==b||"BUTTON"==b)&&a.type&&a.type.toUpperCase?b=a.type.toUpperCase():!b&&a.href&&(b="A"));return b};a.La=function(a){var b=h.location,d=a.href?a.href:"",f,e,g;f=d.indexOf(":");e=d.indexOf("?");g=d.indexOf("/");d&&(0>f||0<=e&&f>e||0<=g&&f>g)&&(e=a.protocol&&1<a.protocol.length?a.protocol:b.protocol?b.protocol:"",f=b.pathname.lastIndexOf("/"),d=(e?e+"//":"")+(a.host?a.host:b.host?b.host:"")+("/"!=d.substring(0,1)?b.pathname.substring(0,0>f?0:f)+"/":"")+d);return d};a.L=function(c){var b=a.B(c),d,f,e="",g=0;return b&&(d=c.protocol,f=c.onclick,!c.href||"A"!=b&&"AREA"!=b||f&&d&&!(0>d.toLowerCase().indexOf("javascript"))?f?(e=a.replace(a.replace(a.replace(a.replace(""+
f,"\r",""),"\n",""),"\t","")," ",""),g=2):"INPUT"==b||"SUBMIT"==b?(c.value?e=c.value:c.innerText?e=c.innerText:c.textContent&&(e=c.textContent),g=3):"IMAGE"==b&&c.src&&(e=c.src):e=a.La(c),e)?{id:e.substring(0,100),type:g}:0};a.fc=function(c){for(var b=a.B(c),d=a.L(c);c&&!d&&"BODY"!=b;)if(c=c.parentElement?c.parentElement:c.parentNode)b=a.B(c),d=a.L(c);d&&"BODY"!=b||(c=0);c&&(b=c.onclick?""+c.onclick:"",0<=b.indexOf(".tl(")||0<=b.indexOf(".trackLink("))&&(c=0);return c};a.Vb=function(){var c,b,d=a.linkObject,f=a.linkType,e=a.linkURL,g,k;a.la=1;d||(a.la=0,d=a.clickObject);if(d){c=a.B(d);for(b=a.L(d);d&&!b&&"BODY"!=c;)if(d=d.parentElement?d.parentElement:d.parentNode)c=a.B(d),b=a.L(d);b&&"BODY"!=c||(d=0);if(d&&!a.linkObject){var l=d.onclick?""+d.onclick:"";if(0<=l.indexOf(".tl(")||0<=l.indexOf(".trackLink("))d=0}}else a.la=1;!e&&d&&(e=a.La(d));e&&!a.linkLeaveQueryString&&(g=e.indexOf("?"),0<=g&&(e=e.substring(0,g)));if(!f&&e){var m=0,n=0,p;if(a.trackDownloadLinks&&a.linkDownloadFileTypes)for(l=e.toLowerCase(),g=l.indexOf("?"),k=l.indexOf("#"),0<=g?0<=k&&k<g&&(g=k):g=k,0<=g&&(l=l.substring(0,g)),g=a.linkDownloadFileTypes.toLowerCase().split(","),k=0;k<g.length;k++)(p=g[k])&&l.substring(l.length-(p.length+1))=="."+p&&(f="d");if(a.trackExternalLinks&&!f&&(l=e.toLowerCase(),a.Oa(l)&&(a.linkInternalFilters||(a.linkInternalFilters=h.location.hostname),g=0,a.linkExternalFilters?(g=a.linkExternalFilters.toLowerCase().split(","),m=1):a.linkInternalFilters&&(g=a.linkInternalFilters.toLowerCase().split(",")),g))){for(k=0;k<g.length;k++)p=g[k],0<=l.indexOf(p)&&(n=1);n?m&&(f="e"):m||(f="e")}}a.linkObject=d;a.linkURL=e;a.linkType=f;if(a.trackClickMap||a.trackInlineStats)a.e="",d&&(f=a.pageName,e=1,d=d.sourceIndex,f||(f=a.pageURL,e=0),h.s_objectID&&(b.id=h.s_objectID,d=b.type=1),f&&b&&b.id&&c&&(a.e="&pid="+a.escape(f.substring(0,255))+(e?"&pidt="+e:"")+"&oid="+a.escape(b.id.substring(0,100))+(b.type?"&oidt="+b.type:"")+"&ot="+c+(d?"&oi="+d:"")))};a.Ob=function(){var c=a.la,b=a.linkType,d=a.linkURL,f=a.linkName;b&&(d||f)&&(b=b.toLowerCase(),"d"!=b&&"e"!=b&&(b="o"),a.pe="lnk_"+b,a.pev1=d?a.escape(d):"",a.pev2=f?a.escape(f):"",c=1);a.abort&&(c=0);if(a.trackClickMap||a.trackInlineStats||a.Rb()){var b={},d=0,e=a.pb(),g=e?e.split("&"):0,k,l,h,e=0;if(g)for(k=0;k<g.length;k++)l=g[k].split("="),f=a.unescape(l[0]).split(","),l=a.unescape(l[1]),b[l]=f;f=a.account.split(",");k={};for(h in a.contextData)h&&!Object.prototype[h]&&"a.activitymap."==h.substring(0,14)&&(k[h]=a.contextData[h],a.contextData[h]="");a.e=a.o("c",k)+
(a.e?a.e:"");if(c||a.e){c&&!a.e&&(e=1);for(l in b)if(!Object.prototype[l])for(h=0;h<f.length;h++)for(e&&(g=b[l].join(","),g==a.account&&(a.e+=("&"!=l.charAt(0)?"&":"")+l,b[l]=[],d=1)),k=0;k<b[l].length;k++)g=b[l][k],g==f[h]&&(e&&(a.e+="&u="+a.escape(g)+("&"!=l.charAt(0)?"&":"")+l+"&u=0"),b[l].splice(k,1),d=1);c||(d=1);if(d){e="";k=2;!c&&a.e&&(e=a.escape(f.join(","))+"="+a.escape(a.e),k=1);for(l in b)!Object.prototype[l]&&0<k&&0<b[l].length&&(e+=(e?"&":"")+a.escape(b[l].join(","))+"="+a.escape(l),k--);a.wb(e)}}}return c};a.pb=function(){if(a.useLinkTrackSessionStorage){if(a.Ca())return h.sessionStorage.getItem(a.P)}else return a.cookieRead(a.P)};a.Ca=function(){return h.sessionStorage?!0:!1};a.wb=function(c){a.useLinkTrackSessionStorage?a.Ca()&&h.sessionStorage.setItem(a.P,c):a.cookieWrite(a.P,c)};a.Pb=function(){if(!a.Zb){var c=new Date,b=p.location,d,f,e=f=d="",g="",k="",l="1.2",h=a.cookieWrite("s_cc","true",0)?"Y":"N",m="",q="";if(c.setUTCDate&&(l="1.3",(0).toPrecision&&(l="1.5",c=[],c.forEach))){l="1.6";f=0;d={};try{f=new Iterator(d),f.next&&(l="1.7",c.reduce&&(l="1.8",l.trim&&(l="1.8.1",Date.parse&&(l="1.8.2",Object.create&&(l="1.8.5")))))}catch(r){}}d=screen.width+"x"+screen.height;e=navigator.javaEnabled()?"Y":"N";f=screen.pixelDepth?screen.pixelDepth:screen.colorDepth;g=a.w.innerWidth?a.w.innerWidth:a.d.documentElement.offsetWidth;k=a.w.innerHeight?a.w.innerHeight:a.d.documentElement.offsetHeight;try{a.b.addBehavior("#default#homePage"),m=a.b.gc(b)?"Y":"N"}catch(s){}try{a.b.addBehavior("#default#clientCaps"),q=a.b.connectionType}catch(t){}a.resolution=d;a.colorDepth=f;a.javascriptVersion=l;a.javaEnabled=e;a.cookiesEnabled=h;a.browserWidth=g;a.browserHeight=k;a.connectionType=q;a.homepage=m;a.Zb=1}};a.Q={};a.loadModule=function(c,b){var d=a.Q[c];if(!d){d=h["AppMeasurement_Module_"+c]?new h["AppMeasurement_Module_"+c](a):{};a.Q[c]=a[c]=d;d.ib=function(){return d.sb};d.xb=function(b){if(d.sb=b)a[c+"_onLoad"]=b,a.ea(c+"_onLoad",[a,d],1)||b(a,d)};try{Object.defineProperty?Object.defineProperty(d,"onLoad",{get:d.ib,set:d.xb}):d._olc=1}catch(f){d._olc=1}}b&&(a[c+"_onLoad"]=b,a.ea(c+"_onLoad",[a,d],1)||b(a,d))};a.u=function(c){var b,d;for(b in a.Q)if(!Object.prototype[b]&&(d=a.Q[b])&&(d._olc&&d.onLoad&&(d._olc=0,d.onLoad(a,d)),d[c]&&d[c]()))return 1;return 0};a.Rb=function(){return a.ActivityMap&&a.ActivityMap._c?!0:!1};a.Sb=function(){var c=Math.floor(1E13*Math.random()),b=a.visitorSampling,d=a.visitorSamplingGroup,d="s_vsn_"+(a.visitorNamespace?a.visitorNamespace:a.account)+(d?"_"+d:""),f=a.cookieRead(d);if(b){b*=100;f&&(f=parseInt(f));if(!f){if(!a.cookieWrite(d,c))return 0;f=c}if(f%1E4>b)return 0}return 1};a.S=function(c,b){var d,f,e,g,k,h,m;m={};for(d=0;2>d;d++)for(f=0<d?a.Ea:a.g,e=0;e<f.length;e++)if(g=f[e],(k=c[g])||c["!"+g]){if(k&&!b&&("contextData"==g||"retrieveLightData"==g)&&a[g])for(h in a[g])k[h]||(k[h]=a[g][h]);a[g]||(m["!"+g]=1);m[g]=a[g];a[g]=k}return m};a.cc=function(c){var b,d,f,e;for(b=0;2>b;b++)for(d=0<b?a.Ea:a.g,f=0;f<d.length;f++)e=d[f],c[e]=a[e],c[e]||"prop"!==e.substring(0,4)&&"eVar"!==e.substring(0,4)&&"hier"!==e.substring(0,4)&&"list"!==e.substring(0,4)&&"channel"!==e&&"events"!==e&&"eventList"!==e&&"products"!==e&&"productList"!==e&&"purchaseID"!==e&&"transactionID"!==e&&"state"!==e&&"zip"!==e&&"campaign"!==e&&"events2"!==e&&"latitude"!==e&&"longitude"!==e&&"ms_a"!==e&&"contextData"!==e&&"supplementalDataID"!==e&&"tnt"!==e&&"timestamp"!==e&&"abort"!==e&&"useBeacon"!==e&&"linkObject"!==e&&"clickObject"!==e&&"linkType"!==e&&"linkName"!==e&&"linkURL"!==e&&"bodyClickTarget"!==e&&"bodyClickFunction"!==e||(c["!"+e]=1)};a.Jb=function(a){var b,d,f,e,g,k=0,h,m="",n="";if(a&&255<a.length&&(b=""+a,d=b.indexOf("?"),0<d&&(h=b.substring(d+1),b=b.substring(0,d),e=b.toLowerCase(),f=0,"http://"==e.substring(0,7)?f+=7:"https://"==e.substring(0,8)&&(f+=8),d=e.indexOf("/",f),0<d&&(e=e.substring(f,d),g=b.substring(d),b=b.substring(0,d),0<=e.indexOf("google")?k=",q,ie,start,search_key,word,kw,cd,":0<=e.indexOf("yahoo.co")?k=",p,ei,":0<=e.indexOf("baidu.")&&(k=",wd,word,"),k&&h)))){if((a=h.split("&"))&&1<a.length){for(f=0;f<a.length;f++)e=a[f],d=e.indexOf("="),0<d&&0<=k.indexOf(","+e.substring(0,d)+",")?m+=(m?"&":"")+e:n+=(n?"&":"")+e;m&&n?h=m+"&"+n:n=""}d=253-(h.length-n.length)-b.length;a=b+(0<d?g.substring(0,d):"")+"?"+h}return a};a.bb=function(c){var b=a.d.visibilityState,d=["webkitvisibilitychange","visibilitychange"];b||(b=a.d.webkitVisibilityState);if(b&&"prerender"==b){if(c)for(b=0;b<d.length;b++)a.d.addEventListener(d[b],function(){var b=a.d.visibilityState;b||(b=a.d.webkitVisibilityState);"visible"==b&&c()});return!1}return!0};a.ba=!1;a.H=!1;a.zb=function(){a.H=!0;a.p()};a.I=!1;a.Ab=function(c){a.marketingCloudVisitorID=c.MCMID;a.visitorOptedOut=c.MCOPTOUT;a.analyticsVisitorID=c.MCAID;a.audienceManagerLocationHint=c.MCAAMLH;a.audienceManagerBlob=c.MCAAMB;a.I=!1;a.p()};a.ab=function(c){a.maxDelay||(a.maxDelay=250);return a.u("_d")?(c&&setTimeout(function(){c()},a.maxDelay),!1):!0};a.Z=!1;a.G=!1;a.ya=function(){a.G=!0;a.p()};a.isReadyToTrack=function(){var c=!0;if(!a.mb()||!a.kb())return!1;a.ob()||(c=!1);a.rb()||(c=!1);return c};a.mb=function(){a.ba||a.H||(a.bb(a.zb)?a.H=!0:a.ba=!0);return a.ba&&!a.H?!1:!0};a.kb=function(){var c=a.va();if(c)if(a.ra||a.aa)if(a.ra){if(!c.isApproved(c.Categories.ANALYTICS))return!1}else return!1;else return c.fetchPermissions(a.tb,!0),a.aa=!0,!1;return!0};a.V=function(c){var b=a.va();return b&&!b.isApproved(b.Categories[c])?!1:!0};a.va=function(){return h.adobe&&h.adobe.optIn?h.adobe.optIn:null};a.Y=!0;a.ob=function(){var c=a.T();if(!c||!c.getVisitorValues)return!0;a.Y&&(a.Y=!1,a.I||(a.I=!0,c.getVisitorValues(a.Ab)));return!a.I};a.T=function(){var c=a.visitor;c&&!c.isAllowed()&&(c=null);return c};a.rb=function(){a.Z||a.G||(a.ab(a.ya)?a.G=!0:a.Z=!0);return a.Z&&!a.G?!1:!0};a.aa=!1;a.tb=function(){a.aa=!1;a.ra=!0};a.j=q;a.q=0;a.callbackWhenReadyToTrack=function(c,b,d){var f;f={};f.Eb=c;f.Db=b;f.Bb=d;a.j==q&&(a.j=[]);a.j.push(f);0==a.q&&(a.q=setInterval(a.p,100))};a.p=function(){var c;if(a.isReadyToTrack()&&(a.yb(),a.j!=q))for(;0<a.j.length;)c=a.j.shift(),c.Db.apply(c.Eb,c.Bb)};a.yb=function(){a.q&&(clearInterval(a.q),a.q=0)};a.ta=function(c){var b,d={};a.cc(d);if(c!=q)for(b in c)d[b]=c[b];a.callbackWhenReadyToTrack(a,a.Da,[d]);a.Ba()};a.Lb=function(){var c=a.cookieRead("s_fid"),b="",d="",f;f=8;var e=4;if(!c||0>c.indexOf("-")){for(c=0;16>c;c++)f=Math.floor(Math.random()*f),b+="0123456789ABCDEF".substring(f,f+1),f=Math.floor(Math.random()*e),d+="0123456789ABCDEF".substring(f,f+1),f=e=16;c=b+"-"+d}a.cookieWrite("s_fid",c,1)||(c=0);return c};a.Da=function(c){var b=new Date,d="s"+Math.floor(b.getTime()/108E5)%10+Math.floor(1E13*Math.random()),f=b.getYear(),f="t="+a.escape(b.getDate()+"/"+b.getMonth()+"/"+(1900>f?f+1900:f)+" "+b.getHours()+":"+b.getMinutes()+":"+b.getSeconds()+" "+b.getDay()+" "+b.getTimezoneOffset()),e=a.T(),g;c&&(g=a.S(c,1));a.Sb()&&!a.visitorOptedOut&&(a.wa()||(a.fid=a.Lb()),a.Vb(),a.usePlugins&&a.doPlugins&&a.doPlugins(a),a.account&&(a.abort||(a.trackOffline&&!a.timestamp&&(a.timestamp=Math.floor(b.getTime()/1E3)),c=h.location,a.pageURL||(a.pageURL=c.href?c.href:c),a.referrer||a.Za||(c=a.Util.getQueryParam("adobe_mc_ref",null,null,!0),a.referrer=c||void 0===c?void 0===c?"":c:p.document.referrer),a.Za=1,a.referrer=a.Jb(a.referrer),a.u("_g")),a.Ob()&&!a.abort&&(e&&a.V("TARGET")&&!a.supplementalDataID&&e.getSupplementalDataID&&(a.supplementalDataID=e.getSupplementalDataID("AppMeasurement:"+a._in,a.expectSupplementalData?!1:!0)),a.V("AAM")||(a.contextData["cm.ssf"]=1),a.Pb(),f+=a.Nb(),a.qb(d,f),a.u("_t"),a.referrer="")));a.Ba();g&&a.S(g,1)};a.t=a.track=function(c,b){b&&a.S(b);a.Y=!0;a.isReadyToTrack()?null!=a.j&&0<a.j.length?(a.ta(c),a.p()):a.Da(c):a.ta(c)};a.Ba=function(){a.abort=a.supplementalDataID=a.timestamp=a.pageURLRest=a.linkObject=a.clickObject=a.linkURL=a.linkName=a.linkType=h.s_objectID=a.pe=a.pev1=a.pev2=a.pev3=a.e=a.lightProfileID=a.useBeacon=a.referrer=0};a.Aa=[];a.registerPreTrackCallback=function(c){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);"function"==typeof c?a.Aa.push([c,b]):a.debugTracking&&a.C("DEBUG: Non function type passed to registerPreTrackCallback")};a.fb=function(c){a.ua(a.Aa,c)};a.za=[];a.registerPostTrackCallback=function(c){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);"function"==typeof c?a.za.push([c,b]):a.debugTracking&&a.C("DEBUG: Non function type passed to registerPostTrackCallback")};a.eb=function(c){a.ua(a.za,c)};a.ua=function(c,b){if("object"==typeof c)for(var d=0;d<c.length;d++){var f=c[d][0],e=c[d][1].slice();e.unshift(b);if("function"==typeof f)try{f.apply(null,e)}catch(g){a.debugTracking&&a.C(g.message)}}};a.tl=a.trackLink=function(c,b,d,f,e){a.linkObject=c;a.linkType=b;a.linkName=d;e&&(a.bodyClickTarget=c,a.bodyClickFunction=e);return a.track(f)};a.trackLight=function(c,b,d,f){a.lightProfileID=c;a.lightStoreForSeconds=b;a.lightIncrementBy=d;return a.track(f)};a.clearVars=function(){var c,b;for(c=0;c<a.g.length;c++)if(b=a.g[c],"prop"==b.substring(0,4)||"eVar"==b.substring(0,4)||"hier"==b.substring(0,4)||"list"==b.substring(0,4)||"channel"==b||"events"==b||"eventList"==b||"products"==b||"productList"==b||"purchaseID"==b||"transactionID"==b||"state"==b||"zip"==b||"campaign"==b)a[b]=void 0};a.tagContainerMarker="";a.qb=function(c,b){var d=a.gb()+"/"+c+"?AQB=1&ndh=1&pf=1&"+(a.xa()?"callback=s_c_il["+a._in+"].doPostbacks&et=1&":"")+b+"&AQE=1";a.fb(d);a.cb(d);a.U()};a.gb=function(){var c=a.hb();return"http"+(a.ssl?"s":"")+"://"+c+"/b/ss/"+a.account+"/"+(a.mobile?"5.":"")+(a.xa()?"10":"1")+"/JS-"+a.version+(a.Yb?"T":"")+(a.tagContainerMarker?"-"+a.tagContainerMarker:"")};a.xa=function(){return a.AudienceManagement&&a.AudienceManagement.isReady()||0!=a.usePostbacks};a.hb=function(){var c=a.dc,b=a.trackingServer;b?a.trackingServerSecure&&a.ssl&&(b=a.trackingServerSecure):(c=c?(""+c).toLowerCase():"d1","d1"==c?c="112":"d2"==c&&(c="122"),b=a.jb()+"."+c+".2o7.net");return b};a.jb=function(){var c=a.visitorNamespace;c||(c=a.account.split(",")[0],c=c.replace(/[^0-9a-z]/gi,""));return c};a.Ya=/{(%?)(.*?)(%?)}/;a.bc=RegExp(a.Ya.source,"g");a.Ib=function(c){if("object"==typeof c.dests)for(var b=0;b<c.dests.length;++b){var d=c.dests[b];if("string"==typeof d.c&&"aa."==d.id.substr(0,3))for(var f=d.c.match(a.bc),e=0;e<f.length;++e){var g=f[e],k=g.match(a.Ya),h="";"%"==k[1]&&"timezone_offset"==k[2]?h=(new Date).getTimezoneOffset():"%"==k[1]&&"timestampz"==k[2]&&(h=a.Mb());d.c=d.c.replace(g,a.escape(h))}}};a.Mb=function(){var c=new Date,b=new Date(6E4*Math.abs(c.getTimezoneOffset()));return a.k(4,c.getFullYear())+"-"+a.k(2,c.getMonth()+1)+"-"+a.k(2,c.getDate())+"T"+a.k(2,c.getHours())+":"+a.k(2,c.getMinutes())+":"+a.k(2,c.getSeconds())+
(0<c.getTimezoneOffset()?"-":"+")+a.k(2,b.getUTCHours())+":"+a.k(2,b.getUTCMinutes())};a.k=function(a,b){return(Array(a+1).join(0)+b).slice(-a)};a.pa={};a.doPostbacks=function(c){if("object"==typeof c)if(a.Ib(c),"object"==typeof a.AudienceManagement&&"function"==typeof a.AudienceManagement.isReady&&a.AudienceManagement.isReady()&&"function"==typeof a.AudienceManagement.passData)a.AudienceManagement.passData(c);else if("object"==typeof c&&"object"==typeof c.dests)for(var b=0;b<c.dests.length;++b){var d=c.dests[b];"object"==typeof d&&"string"==typeof d.c&&"string"==typeof d.id&&"aa."==d.id.substr(0,3)&&(a.pa[d.id]=new Image,a.pa[d.id].alt="",a.pa[d.id].src=d.c)}};a.cb=function(c){a.i||a.Qb();a.i.push(c);a.ia=a.A();a.Wa()};a.Qb=function(){a.i=a.Tb();a.i||(a.i=[])};a.Tb=function(){var c,b;if(a.oa()){try{(b=h.localStorage.getItem(a.ma()))&&(c=h.JSON.parse(b))}catch(d){}return c}};a.oa=function(){var c=!0;a.trackOffline&&a.offlineFilename&&h.localStorage&&h.JSON||(c=!1);return c};a.Ma=function(){var c=0;a.i&&(c=a.i.length);a.l&&c++;return c};a.U=function(){if(a.l&&(a.v&&a.v.complete&&a.v.D&&a.v.R(),a.l))return;a.Na=q;if(a.na)a.ia>a.N&&a.Ua(a.i),a.qa(500);else{var c=a.Cb();if(0<c)a.qa(c);else if(c=a.Ka())a.l=1,a.Ub(c),a.Xb(c)}};a.qa=function(c){a.Na||(c||(c=0),a.Na=setTimeout(a.U,c))};a.Cb=function(){var c;if(!a.trackOffline||0>=a.offlineThrottleDelay)return 0;c=a.A()-a.Sa;return a.offlineThrottleDelay<c?0:a.offlineThrottleDelay-c};a.Ka=function(){if(0<a.i.length)return a.i.shift()};a.Ub=function(c){if(a.debugTracking){var b="AppMeasurement Debug: "+c;c=c.split("&");var d;for(d=0;d<c.length;d++)b+="\n\t"+a.unescape(c[d]);a.C(b)}};a.wa=function(){return a.marketingCloudVisitorID||a.analyticsVisitorID};a.X=!1;var t;try{t=JSON.parse('{"x":"y"}')}catch(w){t=null}t&&"y"==t.x?(a.X=!0,a.W=function(a){return JSON.parse(a)}):h.$&&h.$.parseJSON?(a.W=function(a){return h.$.parseJSON(a)},a.X=!0):a.W=function(){return null};a.Xb=function(c){var b,d,f;a.lb(c)&&(d=1,b={send:function(c){a.useBeacon=!1;navigator.sendBeacon(c)?b.R():b.ga()}});!b&&a.wa()&&2047<c.length&&(a.$a()&&(d=2,b=new XMLHttpRequest),b&&(a.AudienceManagement&&a.AudienceManagement.isReady()||0!=a.usePostbacks)&&(a.X?b.Fa=!0:b=0));!b&&a.Xa&&(c=c.substring(0,2047));!b&&a.d.createElement&&(0!=a.usePostbacks||a.AudienceManagement&&a.AudienceManagement.isReady())&&(b=a.d.createElement("SCRIPT"))&&"async"in b&&((f=(f=a.d.getElementsByTagName("HEAD"))&&f[0]?f[0]:a.d.body)?(b.type="text/javascript",b.setAttribute("async","async"),d=3):b=0);b||(b=new Image,b.alt="",b.abort||"undefined"===typeof h.InstallTrigger||(b.abort=function(){b.src=q}));b.Ta=Date.now();b.Ha=function(){try{b.D&&(clearTimeout(b.D),b.D=0)}catch(a){}};b.onload=b.R=function(){b.Ta&&(a.ja=Date.now()-b.Ta);a.eb(c);b.Ha();a.Gb();a.ca();a.l=0;a.U();if(b.Fa){b.Fa=!1;try{a.doPostbacks(a.W(b.responseText))}catch(d){}}};b.onabort=b.onerror=b.ga=function(){b.Ha();(a.trackOffline||a.na)&&a.l&&a.i.unshift(a.Fb);a.l=0;a.ia>a.N&&a.Ua(a.i);a.ca();a.qa(500)};b.onreadystatechange=function(){4==b.readyState&&(200==b.status?b.R():b.ga())};a.Sa=a.A();if(1===d)b.send(c);else if(2===d)f=c.indexOf("?"),d=c.substring(0,f),f=c.substring(f+1),f=f.replace(/&callback=[a-zA-Z0-9_.\[\]]+/,""),b.open("POST",d,!0),b.withCredentials=!0,b.send(f);else if(b.src=c,3===d){if(a.Qa)try{f.removeChild(a.Qa)}catch(e){}f.firstChild?f.insertBefore(b,f.firstChild):f.appendChild(b);a.Qa=a.v}b.D=setTimeout(function(){b.D&&(b.complete?b.R():(a.trackOffline&&b.abort&&b.abort(),b.ga()))},5E3);a.Fb=c;a.v=h["s_i_"+a.replace(a.account,",","_")]=b;if(a.useForcedLinkTracking&&a.J||a.bodyClickFunction)a.forcedLinkTrackingTimeout||(a.forcedLinkTrackingTimeout=250),a.da=setTimeout(a.ca,a.forcedLinkTrackingTimeout)};a.lb=function(c){var b=!1;navigator.sendBeacon&&(a.nb(c)?b=!0:a.useBeacon&&(b=!0));a.vb(c)&&(b=!1);return b};a.nb=function(a){return a&&0<a.indexOf("pe=lnk_e")?!0:!1};a.vb=function(a){return 64E3<=a.length};a.$a=function(){return"undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest?!0:!1};a.Gb=function(){if(a.oa()&&!(a.Ra>a.N))try{h.localStorage.removeItem(a.ma()),a.Ra=a.A()}catch(c){}};a.Ua=function(c){if(a.oa()){a.Wa();try{h.localStorage.setItem(a.ma(),h.JSON.stringify(c)),a.N=a.A()}catch(b){}}};a.Wa=function(){if(a.trackOffline){if(!a.offlineLimit||0>=a.offlineLimit)a.offlineLimit=10;for(;a.i.length>a.offlineLimit;)a.Ka()}};a.forceOffline=function(){a.na=!0};a.forceOnline=function(){a.na=!1};a.ma=function(){return a.offlineFilename+"-"+a.visitorNamespace+a.account};a.A=function(){return(new Date).getTime()};a.Oa=function(a){a=a.toLowerCase();return 0!=a.indexOf("#")&&0!=a.indexOf("about:")&&0!=a.indexOf("opera:")&&0!=a.indexOf("javascript:")?!0:!1};a.setTagContainer=function(c){var b,d,f;a.Yb=c;for(b=0;b<a._il.length;b++)if((d=a._il[b])&&"s_l"==d._c&&d.tagContainerName==c){a.S(d);if(d.lmq)for(b=0;b<d.lmq.length;b++)f=d.lmq[b],a.loadModule(f.n);if(d.ml)for(f in d.ml)if(a[f])for(b in c=a[f],f=d.ml[f],f)!Object.prototype[b]&&("function"!=typeof f[b]||0>(""+f[b]).indexOf("s_c_il"))&&(c[b]=f[b]);if(d.mmq)for(b=0;b<d.mmq.length;b++)f=d.mmq[b],a[f.m]&&(c=a[f.m],c[f.f]&&"function"==typeof c[f.f]&&(f.a?c[f.f].apply(c,f.a):c[f.f].apply(c)));if(d.tq)for(b=0;b<d.tq.length;b++)a.track(d.tq[b]);d.s=a;break}};a.Util={urlEncode:a.escape,urlDecode:a.unescape,cookieRead:a.cookieRead,cookieWrite:a.cookieWrite,getQueryParam:function(c,b,d,f){var e,g="";b||(b=a.pageURL?a.pageURL:h.location);d=d?d:"&";if(!c||!b)return g;b=""+b;e=b.indexOf("?");if(0>e)return g;b=d+b.substring(e+1)+d;if(!f||!(0<=b.indexOf(d+c+d)||0<=b.indexOf(d+
c+"="+d))){e=b.indexOf("#");0<=e&&(b=b.substr(0,e)+d);e=b.indexOf(d+c+"=");if(0>e)return g;b=b.substring(e+d.length+c.length+1);e=b.indexOf(d);0<=e&&(b=b.substring(0,e));0<b.length&&(g=a.unescape(b));return g}},getIeVersion:function(){if(document.documentMode)return document.documentMode;for(var a=7;4<a;a--){var b=document.createElement("div");b.innerHTML="\x3c!--[if IE "+a+"]><span></span><![endif]--\x3e";if(b.getElementsByTagName("span").length)return a}return null}};a.F="supplementalDataID timestamp dynamicVariablePrefix visitorID marketingCloudVisitorID analyticsVisitorID audienceManagerLocationHint authState fid vmk visitorMigrationKey visitorMigrationServer visitorMigrationServerSecure charSet visitorNamespace cookieDomainPeriods fpCookieDomainPeriods cookieLifetime pageName pageURL customerPerspective referrer contextData currencyCode lightProfileID lightStoreForSeconds lightIncrementBy retrieveLightProfiles deleteLightProfiles retrieveLightData".split(" ");a.g=a.F.concat("purchaseID variableProvider channel server pageType transactionID campaign state zip events events2 products audienceManagerBlob tnt".split(" "));a.ka="timestamp charSet visitorNamespace cookieDomainPeriods cookieLifetime contextData lightProfileID lightStoreForSeconds lightIncrementBy".split(" ");a.O=a.ka.slice(0);a.Ea="account allAccounts debugTracking visitor visitorOptedOut trackOffline offlineLimit offlineThrottleDelay offlineFilename usePlugins doPlugins configURL visitorSampling visitorSamplingGroup linkObject clickObject linkURL linkName linkType trackDownloadLinks trackExternalLinks trackClickMap trackInlineStats linkLeaveQueryString linkTrackVars linkTrackEvents linkDownloadFileTypes linkExternalFilters linkInternalFilters useForcedLinkTracking forcedLinkTrackingTimeout useLinkTrackSessionStorage trackingServer trackingServerSecure ssl abort mobile dc lightTrackVars maxDelay expectSupplementalData useBeacon usePostbacks registerPreTrackCallback registerPostTrackCallback bodyClickTarget bodyClickFunction AudienceManagement".split(" ");for(m=0;250>=m;m++)76>m&&(a.g.push("prop"+m),a.O.push("prop"+m)),a.g.push("eVar"+m),a.O.push("eVar"+m),6>m&&a.g.push("hier"+m),4>m&&a.g.push("list"+m);m="pe pev1 pev2 pev3 latitude longitude resolution colorDepth javascriptVersion javaEnabled cookiesEnabled browserWidth browserHeight connectionType homepage pageURLRest marketingCloudOrgID ms_a".split(" ");a.g=a.g.concat(m);a.F=a.F.concat(m);a.ssl=0<=h.location.protocol.toLowerCase().indexOf("https");a.charSet="UTF-8";a.contextData={};a.offlineThrottleDelay=0;a.offlineFilename="AppMeasurement.offline";a.P="s_sq";a.Sa=0;a.ia=0;a.N=0;a.Ra=0;a.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx";a.w=h;a.d=h.document;try{if(a.Xa=!1,navigator){var v=navigator.userAgent;if("Microsoft Internet Explorer"==navigator.appName||0<=v.indexOf("MSIE ")||0<=v.indexOf("Trident/")&&0<=v.indexOf("Windows NT 6"))a.Xa=!0}}catch(x){}a.ca=function(){a.da&&(h.clearTimeout(a.da),a.da=q);a.bodyClickTarget&&a.J&&a.bodyClickTarget.dispatchEvent(a.J);a.bodyClickFunction&&("function"==typeof a.bodyClickFunction?a.bodyClickFunction():a.bodyClickTarget&&a.bodyClickTarget.href&&(a.d.location=a.bodyClickTarget.href));a.bodyClickTarget=a.J=a.bodyClickFunction=0};a.Va=function(){a.b=a.d.body;a.b?(a.r=function(c){var b,d,f,e,g;if(!(a.d&&a.d.getElementById("cppXYctnr")||c&&c["s_fe_"+a._in])){if(a.Ga)if(a.useForcedLinkTracking)a.b.removeEventListener("click",a.r,!1);else{a.b.removeEventListener("click",a.r,!0);a.Ga=a.useForcedLinkTracking=0;return}else a.useForcedLinkTracking=0;a.clickObject=c.srcElement?c.srcElement:c.target;try{if(!a.clickObject||a.M&&a.M==a.clickObject||!(a.clickObject.tagName||a.clickObject.parentElement||a.clickObject.parentNode))a.clickObject=0;else{var k=a.M=a.clickObject;a.ha&&(clearTimeout(a.ha),a.ha=0);a.ha=setTimeout(function(){a.M==k&&(a.M=0)},1E4);f=a.Ma();a.track();if(f<a.Ma()&&a.useForcedLinkTracking&&c.target){for(e=c.target;e&&e!=a.b&&"A"!=e.tagName.toUpperCase()&&"AREA"!=e.tagName.toUpperCase();)e=e.parentNode;if(e&&(g=e.href,a.Oa(g)||(g=0),d=e.target,c.target.dispatchEvent&&g&&(!d||"_self"==d||"_top"==d||"_parent"==d||h.name&&d==h.name))){try{b=a.d.createEvent("MouseEvents")}catch(l){b=new h.MouseEvent}if(b){try{b.initMouseEvent("click",c.bubbles,c.cancelable,c.view,c.detail,c.screenX,c.screenY,c.clientX,c.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,c.relatedTarget)}catch(m){b=0}b&&(b["s_fe_"+a._in]=b.s_fe=1,c.stopPropagation(),c.stopImmediatePropagation&&c.stopImmediatePropagation(),c.preventDefault(),a.bodyClickTarget=c.target,a.J=b)}}}}}catch(n){a.clickObject=0}}},a.b&&a.b.attachEvent?a.b.attachEvent("onclick",a.r):a.b&&a.b.addEventListener&&(navigator&&(0<=navigator.userAgent.indexOf("WebKit")&&a.d.createEvent||0<=navigator.userAgent.indexOf("Firefox/2")&&h.MouseEvent)&&(a.Ga=1,a.useForcedLinkTracking=1,a.b.addEventListener("click",a.r,!0)),a.b.addEventListener("click",a.r,!1))):setTimeout(a.Va,30)};a.Hb();a.ic||(r?a.setAccount(r):a.C("Error, missing Report Suite ID in AppMeasurement initialization"),a.Va(),a.loadModule("ActivityMap"))}function s_gi(r){var a,h=window.s_c_il,q,p,m=r.split(","),s,u,t=0;if(h)for(q=0;!t&&q<h.length;){a=h[q];if("s_c"==a._c&&(a.account||a.oun))if(a.account&&a.account==r)t=1;else for(p=a.account?a.account:a.oun,p=a.allAccounts?a.allAccounts:p.split(","),s=0;s<m.length;s++)for(u=0;u<p.length;u++)m[s]==p[u]&&(t=1);q++}t?a.setAccount&&a.setAccount(r):a=new AppMeasurement(r);return a}AppMeasurement.getInstance=s_gi;window.s_objectID||(window.s_objectID=0);function s_pgicq(){var r=window,a=r.s_giq,h,q,p;if(a)for(h=0;h<a.length;h++)q=a[h],p=s_gi(q.oun),p.setAccount(q.un),p.setTagContainer(q.tagContainerName);r.s_giq=0}s_pgicq();function AppMeasurement_Module_Integrate(l){var c=this;c.s=l;var e=window;e.s_c_in||(e.s_c_il=[],e.s_c_in=0);c._il=e.s_c_il;c._in=e.s_c_in;c._il[c._in]=c;e.s_c_in++;c._c="s_m";c.list=[];c.add=function(d,b){var a;b||(b="s_Integrate_"+d);e[b]||(e[b]={});a=c[d]=e[b];a.a=d;a.e=c;a._c=0;a._d=0;void 0==a.disable&&(a.disable=0);a.get=function(b,d){var f=document,h=f.getElementsByTagName("HEAD"),k;if(!a.disable&&(d||(v="s_"+c._in+"_Integrate_"+a.a+"_get_"+a._c),a._c++,a.VAR=v,a.CALLBACK="s_c_il["+c._in+"]."+
a.a+".callback",a.delay(),h=h&&0<h.length?h[0]:f.body))try{k=f.createElement("SCRIPT"),k.type="text/javascript",k.setAttribute("async","async"),k.src=c.c(a,b),0>b.indexOf("[CALLBACK]")&&(k.onload=k.onreadystatechange=function(){a.callback(e[v])}),h.firstChild?h.insertBefore(k,h.firstChild):h.appendChild(k)}catch(l){}};a.callback=function(b){var c;if(b)for(c in b)Object.prototype[c]||(a[c]=b[c]);a.ready()};a.beacon=function(b){var d="s_i_"+c._in+"_Integrate_"+a.a+"_"+a._c;a.disable||(a._c++,d=e[d]=new Image,d.src=c.c(a,b))};a.script=function(b){a.get(b,1)};a.delay=function(){a._d++};a.ready=function(){a._d--;a.disable||l.delayReady()};c.list.push(d)};c._g=function(d){var b,a=(d?"use":"set")+"Vars";for(d=0;d<c.list.length;d++)if((b=c[c.list[d]])&&!b.disable&&b[a])try{b[a](l,b)}catch(e){}};c._t=function(){c._g(1)};c._d=function(){var d,b;for(d=0;d<c.list.length;d++)if((b=c[c.list[d]])&&!b.disable&&0<b._d)return 1;return 0};c.c=function(c,b){var a,e,g,f;"http"!=b.toLowerCase().substring(0,4)&&(b="http://"+b);l.ssl&&(b=l.replace(b,"http:","https:"));c.RAND=Math.floor(1E13*Math.random());for(a=0;0<=a;)a=b.indexOf("[",a),0<=a&&(e=b.indexOf("]",a),e>a&&(g=b.substring(a+1,e),2<g.length&&"s."==g.substring(0,2)?(f=l[g.substring(2)])||(f=""):(f=""+c[g],f!=c[g]&&parseFloat(f)!=c[g]&&(g=0)),g&&(b=b.substring(0,a)+encodeURIComponent(f)+b.substring(e+1)),a=e));return b}}
function AppMeasurement_Module_ActivityMap(h){function q(){var a=f.pageYOffset+(f.innerHeight||0);a&&a>+g&&(g=a)}function r(){if(e.scrollReachSelector){var a=h.d.querySelector&&h.d.querySelector(e.scrollReachSelector);a?(g=a.scrollTop||0,a.addEventListener("scroll",function(){var d;(d=a&&a.scrollTop+a.clientHeight||0)>g&&(g=d)})):0<w--&&setTimeout(r,1E3)}}function l(a,d){var c,b,n;if(a&&d&&(c=e.c[d]||(e.c[d]=d.split(","))))for(n=0;n<c.length&&(b=c[n++]);)if(-1<a.indexOf(b))return null;p=1;return a}
function s(a,d,c,b,e){var f,k;if(a.dataset&&(k=a.dataset[d]))f=k;else if(a.getAttribute)if(k=a.getAttribute("data-"+c))f=k;else if(k=a.getAttribute(c))f=k;if(!f&&h.useForcedLinkTracking&&e){var g;a=a.onclick?""+a.onclick:"";varValue="";if(b&&a&&(d=a.indexOf(b),0<=d)){for(d+=b.length;d<a.length;)if(c=a.charAt(d++),0<="'\"".indexOf(c)){g=c;break}for(k=!1;d<a.length&&g;){c=a.charAt(d);if(!k&&c===g)break;"\\"===c?k=!0:(varValue+=c,k=!1);d++}}(g=varValue)&&(h.w[b]=g)}return f||e&&h.w[b]}function t(a,d,c){var b;return(b=e[d](a,c))&&(p?(p=0,b):l(m(b),e[d+"Exclusions"]))}function u(a,d,c){var b;if(a&&!(1===(b=a.nodeType)&&(b=a.nodeName)&&(b=b.toUpperCase())&&x[b])&&(1===a.nodeType&&(b=a.nodeValue)&&(d[d.length]=b),c.a||c.t||c.s||!a.getAttribute||((b=a.getAttribute("alt"))?c.a=b:(b=a.getAttribute("title"))?c.t=b:"IMG"==(""+a.nodeName).toUpperCase()&&(b=a.getAttribute("src")||a.src)&&(c.s=b)),(b=a.childNodes)&&b.length))for(a=0;a<b.length;a++)u(b[a],d,c)}function m(a){if(null==a||void 0==a)return a;try{return a.replace(RegExp("^[\\s\\n\\f\\r\\t\t-\r \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u205f\u3000\ufeff]+","mg"),"").replace(RegExp("[\\s\\n\\f\\r\\t\t-\r \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u205f\u3000\ufeff]+$","mg"),"").replace(RegExp("[\\s\\n\\f\\r\\t\t-\r \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u205f\u3000\ufeff]{1,}","mg")," ").substring(0,254)}catch(d){}}var e=this;e.s=h;var f=window;f.s_c_in||(f.s_c_il=[],f.s_c_in=0);e._il=f.s_c_il;e._in=f.s_c_in;e._il[e._in]=e;f.s_c_in++;e._c="s_m";var g=0,v,w=60;e.c={};var p=0,x={SCRIPT:1,STYLE:1,LINK:1,CANVAS:1};e._g=function(){var a,d,c,b=h.contextData,e=h.linkObject;(a=h.pageName||h.pageURL)&&(d=t(e,"link",h.linkName))&&(c=t(e,"region"))&&(b["a.activitymap.page"]=a.substring(0,255),b["a.activitymap.link"]=128<d.length?d.substring(0,128):d,b["a.activitymap.region"]=127<c.length?c.substring(0,127):c,0<g&&(b["a.activitymap.xy"]=10*Math.floor(g/10)),b["a.activitymap.pageIDType"]=h.pageName?1:0)};e.e=function(){e.trackScrollReach&&!v&&(e.scrollReachSelector?r():(q(),f.addEventListener&&f.addEventListener("scroll",q,!1)),v=!0)};e.link=function(a,d){var c;if(d)c=l(m(d),e.linkExclusions);else if((c=a)&&!(c=s(a,"sObjectId","s-object-id","s_objectID",1))){var b,f;(f=l(m(a.innerText||a.textContent),e.linkExclusions))||(u(a,b=[],c={a:void 0,t:void 0,s:void 0}),(f=l(m(b.join(""))))||(f=l(m(c.a?c.a:c.t?c.t:c.s?c.s:void 0)))||!(b=(b=a.tagName)&&b.toUpperCase?b.toUpperCase():"")||("INPUT"==b||"SUBMIT"==b&&a.value?f=l(m(a.value)):"IMAGE"==b&&a.src&&(f=l(m(a.src)))));c=f}return c};e.region=function(a){for(var d,c=e.regionIDAttribute||"id";a&&(a=a.parentNode);){if(d=s(a,c,c,c))return d;if("BODY"==a.nodeName)return"BODY"}}}
try{(function(id,loader){window.utag.tagsettings=window.utag.tagsettings||{};window.utag.tagsettings.adobe=window.utag.tagsettings.adobe||{};var vAPI=window.utag.tagsettings.adobe.visitorAPI=window.utag.tagsettings.adobe.visitorAPI||(function(){return{getInstance:function(orgID,callback){if(orgID){utag.DB("["+u.id+"] OrgID used, but no 'Adobe Marketing Cloud ID Service' tag detected");}
return callback();}};}());var u={"id":id};u.queue=[];utag.o[loader].sender[id]=u;u.ev={'view':1,'link':1,'video':1};u.o=s;u.varlist={pageName:'pageName',channel:'ch',campaign:'v0',hier1:'h1',hier2:'h2',hier3:'h3',hier4:'h4'};for(var i=1;i<76;i++){u.varlist['prop'+i]='c'+i;u.varlist['eVar'+i]='v'+i;}
u.combineLinkVar=false;u.pushlt=function(l,v){if(typeof l!="undefined")l.push(v)};if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.typeCheck=function(linkTrack,type){if(u.typeOf(linkTrack)==="string"){u[type]=linkTrack.split(",");}else if(u.typeOf(linkTrack)==="array"){u[type]=linkTrack;}else{u[type]=[];}}
u.hasadobeView=function(){if(utag.ut.adobeViewScriptRequested){return true;}
var i,s=document.getElementsByTagName("script");for(i=0;i<s.length;i++){if(s[i].src&&s[i].src.indexOf("https://www.everestjs.net/static/le/last-event-tag-latest.min.js")>=0){return true;}}
return false;};u.map={"AdobeAnalytics_s_account":"s_account","pmc_event41:event41":"event41","pmc_products":"products","pmc_scAdd:scAdd":"scAdd","pmc_eVar5":"eVar5,SERIAL_event115","pmc_eVar7":"eVar7","pmc_purchase:purchase":"purchase","pmc_state":"state","pmc_zip":"zip","order_id":"purchaseID","pmc_event11:event11":"event11","pmc_event12:event12":"event12","pmc_scOpen:scOpen":"scOpen","pmc_scView:scView":"scView","pmc_event16:event16":"event16","pmc_event17:event17":"event17","pmc_event32:event32":"event32","pmc_event42:event42":"event42","pmc_eVar35":"eVar35","pmc_pageName":"pageName,eVar10","pmc_prop1":"prop1","pmc_prop2":"prop2","pmc_prop3":"prop3","pmc_prop4":"prop4","pmc_prop5":"prop5","pmc_prodView:prodView":"prodView","pmc_eVar31":"eVar31","pmc_eVar4":"eVar4","pmc_eVar6":"eVar6","pmc_prop6":"prop6","pmc_prop7":"prop7","pmc_event36:event36":"event36","pmc_event39:event39":"event39","pmc_eVar21":"eVar21","pmc_prop14":"prop14","pmc_event47:event47":"event47","pmc_event56:event56":"event56","pmc_event50:event50":"event50","pmc_eVar41":"eVar41","pmc_eVar42":"eVar42","pmc_event49:event49":"event49","pmc_eVar16":"eVar16","pmc_eVar17":"eVar17","pmc_event22:event22":"event22","pmc_eVar39":"eVar39","pmc_eVar40":"eVar40","pmc_prop16":"prop16","pmc_prop17":"prop17","pmc_eVar47":"eVar47","pmc_event18:event18":"event18","pmc_event6:event6":"event6","pmc_scCheckout:checkout":"scCheckout","pmc_event53:event53":"event53","pmc_prop23":"prop23","pmc_prop24":"prop24","pmc_event55:event55":"event55","pmc_eVar18":"eVar18","pmc_prop18":"prop18","pmc_eVar1":"eVar1","pmc_eVar2":"eVar2","pmc_eVar3":"eVar3","pmc_prop20":"prop20","pmc_event69:event69":"event69","pmc_event70:event70":"event70","pmc_prop8":"prop8","pmc_event72:event72":"event72","pmc_prop72":"prop72","pmc_prop73":"prop73","pmc_eVar9":"eVar9","pmc_event52:event52":"event52","pmc_event51:event51":"event51","pmc_event71:event71":"event71","pmc_eVar71":"eVar71","pmc_event30:event30":"event30","pmc_eVar48":"eVar48","pmc_event57:event57":"event57","pmc_eVar27":"eVar27","pmc_eVar29":"eVar29","pmc_eVar51":"eVar51","pmc_event34:event34":"event34","pmc_prop11":"prop11","pmc_prop22":"prop22","pmc_prop10":"prop10","pmc_eVar8":"eVar8","pmc_event10":"VALUE_event10","pmc_eVar28":"eVar28","pmc_event37:event37":"event37","pmc_prop12":"prop12","pmc_prop9":"prop9","pmc_event38":"VALUE_event38","pmc_event59:event59":"event59","pmc_event33:event33":"event33","pmc_eVar38":"eVar38","pmc_event73:event73":"event73","pmc_event1:event1":"event1","pmc_event2:event2":"event2","pmc_event3:event3":"event3","pmc_event4:event4":"event4","pmc_event5:event5":"event5","pmc_event45:event45":"event45","pmc_event58:event58":"event58","pmc_event19:event19":"event19","pmc_event74:event74":"event74","pmc_prop31":"prop31","pmc_eVar72":"eVar72","pmc_eVar73":"eVar73","pmc_eVar74":"eVar74","pmc_eVar75":"eVar75","pmc_event35:event35":"event35","pmc_eVar19":"eVar19","pmc_event54:event54":"event54","pmc_event31:event31":"event31","pmc_event85:event85":"event85","pmc_eVar60":"eVar60","pmc_prop60":"prop60","pmc_event86:event86":"event86","pmc_event87:event87":"event87","pmc_event91:event91":"event91","pmc_eVar91":"eVar91","pmc_event79:event79":"event79","pmc_eVar61":"eVar61","pmc_event65:event65":"event65","pmc_event66:event66":"event66","strategy":"eVar99","pmc_event101:event101":"event101","pmc_event94:event94":"event94","pmc_event95:event95":"event95","pmc_event97:event97":"event97","pmc_event98:event98":"event98","pmc_event99:event99":"event99","pmc_event100:event100":"event100","pmc_eVar100":"eVar100","pmc_event111:event111":"event111","pmc_event112:event112":"event112","pmc_event113:event113":"event113","pmc_eVar63":"eVar63","pmc_prop35":"prop35","pmc_event107:event107":"event107","pmc_event108:event108":"event108","pmc_event125:event125":"event125","pmc_event127:event127":"event127","pmc_event129:event129":"event129","pmc_event130:event130":"event130","pmc_event131:event131":"event131","pmc_event121:event121":"event121","pmc_event123:event123":"event123","pmc_event124:event124":"event124","pmc_event122:event122":"event122","pmc_eVar121":"eVar121","pmc_prop40":"prop40","pmc_prop41":"prop41","pmc_prop42":"prop42","pmc_prop43":"prop43","pmc_prop36":"prop36","pmc_event134:event134":"event134","pmc_event135:event135":"event135","pmc_event136:event136":"event136","pmc_event137:event137":"event137","pmc_event138:event138":"event138","pmc_event119:event119":"event119","pmc_event120:event120":"event120","pmc_campaign":"campaign","pmc_eVar12":"eVar12","pmc_prop25":"prop25","pmc_event139:event139":"event139","pmc_event140:event140":"event140","pmc_event141:event141":"event141","pmc_event155:event155":"event155","pip_error_list":"list1","pmc_event142:event142":"event142","pmc_event143:event143":"event143","pmc_event144:event144":"event144","pmc_event145:event145":"event145","pmc_event146:event146":"event146","pmc_event147:event147":"event147","pmc_event148:event148":"event148","pmc_event149:event149":"event149","pmc_event150:event150":"event150","pmc_event151:event151":"event151","pmc_event152:event152":"event152","pmc_event160:event160":"event160","pmc_event163:event163":"event163","pmc_event164:event164":"event164","pmc_eVar65":"eVar65","pmc_event171:event171":"event171","pmc_event172:event172":"event172","pmc_event157:event157":"event157","pmc_event158:event158":"event158","pmc_prop44":"prop44","pmc_prop45":"prop45","pmc_event169:event169":"event169","pmc_event170:event170":"event170","pmc_scRemove:scRemove":"scRemove","pmc_event173:event173":"event173","pmc_event174:event174":"event174","pmc_event175:event175":"event175","pmc_event176:event176":"event176","pmc_eVar25":"eVar25","pmc_eVar14":"eVar14","pmc_eVar15":"eVar15","pmc_event103:event103":"event103","pmc_event104:event104":"event104","pmc_event177:event177":"event177","pmc_event178:event178":"event178","pmc_event165:event165":"event165","pmc_event166:event166":"event166","pmc_event179:event179":"event179","pmc_event180:event180":"event180","pmc_event181:event181":"event181","pmc_event182:event182":"event182","pmc_event105:event105":"event105","pmc_event190:event190":"event190","pmc_eVar52":"eVar52","pmc_event132:event132":"event132","pmc_event106:event106":"event106","pmc_eVar33":"eVar33","pmc_event168:event168":"event168","pmc_event196:event196":"event196","pmc_event201:event201":"event201","pmc_event202:event202":"event202","pmc_event203:event203":"event203","pmc_prop49":"prop49","pmc_eVar62":"eVar62","pmc_event197:event197":"event197","pmc_event198:event198":"event198","pmc_event199:event199":"event199","pmc_eVar64":"eVar64","pmc_event211:event211":"event211","pmc_event212:event212":"event212","pmc_event191:event191":"event191","pmc_event192:event192":"event192","pmc_event193:event193":"event193","pmc_eVar68":"eVar68","pmc_event161:event161":"event161","digitalDataPageName":"prop75","fixAuditPageName":"prop74","pmc_event210:event210":"event210","search_type_ahead_event:recommendation_clicked":"event118","pmc_event207:event207":"event207","pmc_event206:event206":"event206","pmc_eVar81":"eVar81","pmc_event213:event213":"event213","pmc_event183:event183":"event183","authentication_action:persistent login":"event243","authentication_action:login":"event242","authentication_action:logout":"event241","shippingConsolidationSelected":"eVar82","pmc_event262:event262":"event262","pmc_event263:event263":"event263","pmc_event266:event266":"event266","pmc_event260:event260":"event260","pmc_event222:event222":"event222","pmc_event223:event223":"event223","pmc_event224:event224":"event224","pmc_eVar50":"eVar50","pmc_eVar44":"eVar44","pmc_event60:event60":"event60","pmc_event246:event246":"event246","pmc_event268:event268":"event268","pmc_event267:event267":"event267","pmc_event258:event258":"event258","pmc_event257:event257":"event257","tealium_event:shopbyroom_engagement":"event274","tealium_event:shop_sort_by":"event214","tealium_event:registry_sort_by":"event213","tealium_event:pip_fabric_toggle_shipping":"event185","tealium_event:pip_fabric_toggle_fabric":"event186","tealium_event":"prop63","tealium_event:pip_swatch_recent":"event248","tealium_event:pickup_delivery_ships_to_home":"event222","tealium_event:pickup_delivery_store_change":"event113","tealium_event:pickup_delivery_zip_change":"event224","tealium_event:pickup_delivery_bopis":"event223","tealium_event:pickup_delivery_bopis_toggle":"event221","tealium_event:bosts_select_store":"event302","tealium_event:favorites_add":"event88","tealium_event:fabric_filter_interaction":"event308","tealium_event:favorites_remove":"event90","tealium_event:favorites_pip_click":"event89","tealium_event:sitewide_carousel_impression":"event317","tealium_event:sitewide_carousel_scroll":"event318","tealium_event:sitewide_carousel_click":"event319","tealium_event:smart_bundle_cart_close":"event209","tealium_event:facet_show":"event299","tealium_event:facet_hide":"event300","tealium_event:pip_urgency_impression":"event328","tealium_event:purchase":"purchase","tealium_event:update_email_complete":"event7","tealium_event:account_update_email_complete":"event313","tealium_event:account_update_password_complete":"event314","tealium_event:account_resend_confirmation_email":"event315","tealium_event:pzn_carousel_impression":"event335","tealium_event:pzn_carousel_scroll":"event336","tealium_event:pzn_carousel_see_more":"event337","tealium_event:swatch_preview_hover":"event192","tealium_event:swatch_preview_click":"event193","tealium_event:search_sort_by":"event215","tealium_event:return_initiated":"event344","tealium_event:alt_image_swipe":"event343","tealium_event:store_locator_search":"event346","tealium_event:3d_fabric_open":"event130","tealium_event:3d_fabric_apply":"event131","tealium_event:cart_urgency_impression":"event347","tealium_event:link_card_click":"event354","tealium_event:skip_this_login_step":"event348","tealium_event:apply_now_interaction":"event356","tealium_event:null_search_xbrand_results":"event357","tealium_event:null_search_xbrand_interaction":"event358","tealium_event:optimized_registry_create_event_type":"event157","tealium_event:optimized_registry_create_address":"event158","tealium_event:registry_create":"event44","tealium_event:registry_discount_opt_in":"event147","tealium_event:registry_banner_open":"event199","tealium_event:initiate_smart_login":"event351","tealium_event:on_display_impression":"event125","tealium_event:on_display_open":"event126,event126","tealium_event:on_display_change_location":"event128,event128","tealium_event:on_display_store_info":"event129","tealium_event:review_link_click":"event270","tealium_event:zip_event_start":"event82","tealium_event:zip_event_submit":"event83","tealium_event:registry_edit_open":"event387","tealium_event:registry_edit_complete":"event388","tealium_event:registry_app_click":"event389","tealium_event:design_chat_start":"event188","tealium_event:design_chat_hide":"event189","tealium_event:cart_share_initiation":"event377","tealium_event:cart_share_completion":"event378","tealium_event:registry_search":"event17","tealium_event:inline_monogram_initiation":"event49","tealium_event:xbrand_search_xbrand_results":"event406","tealium_event:xbrand_search_xbrand_interaction":"event407","tealium_event:credit_card_banner_click":"event85","tealium_event:customer_service_initiate_payment_update":"event409","tealium_event:availability_backorder":"event166","tealium_event:availability_nla":"event165","tealium_event:availability_instock":"event162","tealium_event:initiate_payment_update":"event409","tealium_event:affirm_overlay_open":"event194","tealium_event:biometric_authentication_start":"event393","tealium_event:cart_move_to_saved":"event76","tealium_event:cart_add_from_saved":"event77","tealium_event:swatch_order_open":"event245","tealium_event:swatch_order_submit":"event246","tealium_event:continue_as_guest":"event395","tealium_event:push_notifications_optin":"event396","tealium_event:pip_error":"event156","tealium_event:user_content_upload_impression":"event322","tealium_event:user_content_upload_submit":"event323","tealium_event:pip_ar_place_object":"event400","tealium_event:pip_ar_view_details":"event400","tealium_event:pip_ar_change_open":"event400","tealium_event:pip_ar_change_update":"event400","tealium_event:swatch_legacy_open":"event245","tealium_event:pip_ar_open_view":"event400","tealium_event:shopbyroom_impression":"event273","tealium_event:shopbyroom_interaction":"event419","tealium_event:pip_instock_toggle_interaction":"event422","tealium_event:stylitics_mood_board_impression":"event426","tealium_event:product_scarcity_impression":"event423","tealium_event:grid_size_toggle_interaction":"event425","tealium_event:overlay_double_dare":"event109","tealium_event:share_favorites_start":"event435","tealium_event:share_favorites_finish":"event436","tealium_event:scrollable_hero_end":"event438","tealium_event:dorm_checklist_interaction":"event460","tealium_event:dorm_checklist_rac_impression":"event461","tealium_event:product_recs_attribute_selection_impression":"event442","tealium_event:bi_directional_unavailable_attribute":"event445","tealium_event:bi_directional_clear_all_attributes":"event446","pmc_event275:event275":"event275","pmc_prop46":"prop46","pmc_event240:event240":"event240","pmc_event270:event270":"event270","pmc_event290:event290":"event290","pmc_event291:event291":"event291","pmc_event292:event292":"event292","pmc_event293:event293":"event293","pmc_event294:event294":"event294","pmc_event271:event271":"event271","pmc_event272:event272":"event272","pmc_eVar83":"eVar83","pmc_eVar84":"eVar84","pmc_eVar96":"eVar96","pmc_event221:event221":"event221","pmc_eVar143":"eVar143","pmc_event216:event216":"event216","pmc_event296:event296":"event296","pmc_event289:event289":"event289","pmc_event295:event295":"event295","pmc_event261:event261":"event261","pmc_event264:event264":"event264","pmc_event265:event265":"event265","pmc_event297:event297":"event297","pmc_event301:event301":"event301","pmc_event298:event298":"event298","pmc_event304:event304":"event304","pmc_event305:event305":"event305","pmc_event306:event306":"event306","pmc_event303:event303":"event303","splitPip":"eVar85","pmc_event307:event307":"event307","pmc_event309:event309":"event309","pmc_event316:event316":"event316","pmc_event320:event320":"event320","pmc_event321:event321":"event321","pmc_event208:event208":"event208","pmc_event273:event273":"event273","dom.domain":"eVar111","dom.pathname":"eVar112","dom.query_string":"eVar113","pmc_eVar98":"eVar98","pmc_event324:event324":"event324","qudini_scheduling:appointment_open":"event329","qudini_scheduling:event_open":"event330","qudini_scheduling:event_scroll":"event331","qudini_scheduling:appointment_confirmation":"event332","qudini_scheduling:event_confirmation":"event333","qudini_scheduling:choice_in_person":"event340","qudini_scheduling:choice_virtual":"event341","qudini_scheduling:choice_contact_requested":"event342","qudini_scheduling:contact_request":"event334","qudini_scheduling:choice_in_home":"event371","qudini_scheduling:appointment_reschedule":"event359","qudini_scheduling:appointment_cancellation":"event402","qudini_scheduling:product_scarcity_impression":"event423","qudini_scheduling:stylitics_mood_board_impression":"event426","pmc_event325:event325":"event325","pmc_event326:event326":"event326","pmc_event327:event327":"event327","pmc_prop58":"prop58","pmc_event20:event20":"event20","pmc_eVar54":"eVar54","pmc_event338:event338":"event338","pmc_event339:event339":"event339","pmc_event345:event345":"event345","pmc_eVar139":"eVar139","pmc_eVar140":"eVar140","pmc_eVar10":"eVar10","pmc_event349:event349":"event349","pmc_event350:event350":"event350","pmc_event352:event352":"event352","pmc_eVar95":"eVar95","pmc_event920:event920":"event920","pmc_event921:event921":"event921","pmc_eVar89":"eVar89","pmc_eVar92":"eVar92","pmc_eVar77":"eVar77","pmc_event440:event440":"event440","pmc_event360:event360":"event360","pmc_event361:event361":"event361","pmc_event362:event362":"event362","pmc_event364:event364":"event364","pmc_eVar94":"eVar94","pmc_eVar36":"eVar36","pmc_event367:event367":"event367","pmc_event368:event368":"event368","wsid_kpid":"eVar159","pmc_event351:event351":"event351","pmc_event369:event369":"event369","pmc_event370:event370":"event370","pmc_event372:event372":"event372","pmc_event217:event217":"event217","pmc_event218:event218":"event218","pmc_event385:event385":"event385","pmc_event374:event374":"event374","pmc_event375:event375":"event375","pmc_event376:event376":"event376","pmc_event386:event386":"event386","pmc_eVar102":"eVar102","pmc_event384:event384":"event384","pmc_eVar93":"eVar93","ut.version":"prop59","pmc_eVar104":"eVar104","pmc_eVar105":"eVar105","pmc_event390":"VALUE_event390","pmc_event391:event391":"event391","pmc_event392:event392":"event392","pmc_event455:event455":"event455","pmc_event44:event44":"event44","pmc_event403":"VALUE_event403","pmc_event404:event404":"event404","pmc_event405:event405":"event405","pmc_event381:event381":"event381","pmc_event133:event133":"event133","fabricFeatures":"VALUE_event310","fabricColors":"VALUE_event311","fabrics":"VALUE_event312","pmc_event7":"VALUE_event7","pmc_event8":"VALUE_event8","pmc_event9":"VALUE_event9","pmc_event13":"VALUE_event13","pmc_event14":"VALUE_event14","pmc_event15":"VALUE_event15","pmc_event116":"VALUE_event116","pmc_event117:event117":"event117","pmc_event363:event363":"event363","pmc_event365":"VALUE_event365","pmc_event366":"VALUE_event366","pmc_event115:event115":"event115","numberOfNotifications":"VALUE_event198","multilineDgoCount":"VALUE_event284","multilineDgoRevenue":"VALUE_event285","consolidationMagnitude":"VALUE_event288","revenueCreditCard":"VALUE_event250","revenueSVC":"VALUE_event251","revenueKeyRewards":"VALUE_event252","revenueCCReward":"VALUE_event253","revenuePayPal":"VALUE_event254","revenueVenmo":"VALUE_event255","revenueApplePay":"VALUE_event256","revenueAffirm":"VALUE_event195","multilineOrderCount":"VALUE_event286","multilineOrderRevenue":"VALUE_event287","swatchesOrdered":"VALUE_event247","pmc_eVar79":"eVar79","sc_visitor_id":"eVar78","pmc_event397:event397":"event397","pmc_event398:event398":"event398","pmc_eVar106":"eVar106","pmc_event84:event84":"event84","pmc_event412:event412":"event412","pmc_event411":"VALUE_event411","pmc_event410":"event410","pmc_event382:event382":"event382","pmc_event167:event167":"event167","pmc_event383:event383":"event383","privacy_request_type":"eVar108","s_trackingServerSecure_AdobeAnalytics":"trackingServer,trackingServerSecure","pmc_eVar113":"eVar113","pmc_event394:event394":"event394","pmc_event399:event399":"event399","pmc_event78":"VALUE_event78","pmc_prop0":"prop0","pmc_event413:event413":"event413","pmc_event414:event414":"event414","pmc_eVar179":"eVar179","pmc_event415:event415":"event415","pmc_event416:event416":"event416","pmc_event417:event417":"event417","pmc_event418:event418":"event418","pmc_eVar107":"eVar107","previous_page_name":"prop19","previous_page_type":"prop30","pmc_eVar110":"eVar110","pmc_eVar115":"eVar115","pmc_event424:event424":"event424","pmc_eVar116":"eVar116","customer_email_public":"eVar43","registry_id":"eVar34","pmc_event427:event427":"event427","pmc_eVar117":"eVar117","pmc_event373:event373":"event373","pmc_event428:event428":"event428","pmc_event429:event429":"event429","pmc_event430:event430":"event430","pmc_event431:event431":"event431","pmc_event432:event432":"event432","pmc_event433:event433":"event433","pmc_event421:event421":"event421","pmc_event420:event420":"event420","quantum_session_id":"eVar109","pmc_event437:event437":"event437","pmc_eVar90":"eVar90","pmc_event434:event434":"event434","pmc_eVar118":"eVar118","pmc_eVar119":"eVar119","pmc_eVar120":"eVar120","pmc_eVar123":"eVar123","pmc_event462:event462":"event462","cp.ret_split":"eVar76","pmc_event442:event442":"event442","pmc_event441:event441":"event441","pmc_event443:event443":"event443","pmc_event444:event444":"event444"};u.extend=[function(a,b){try{if(1){var s_account="wsidefaultdev";if(pmc.initializeAdobeAnalytics){try{s_account=pmc.initializeAdobeAnalytics();}catch(e){utag_data.pmc_event100="event100";utag_data.pmc_eVar100="initialization error setting report suite: "+location.domain+"/"+location.pathname+" : "+e.message;}}
b.AdobeAnalytics_s_account=utag_data.AdobeAnalytics_s_account=s_account;b.s_trackingServerSecure_AdobeAnalytics=pmc.environment._setAdobeTrackingServer();try{if(typeof(Visitor)!=="undefined"){s.visitor=Visitor.getInstance("D38758195432E1050A4C98A2@AdobeOrg");}}catch(e){utag_data.pmc_event100="event100";utag_data.pmc_eVar100="initialization error setting visitor library: "+location.domain+"/"+location.pathname+" : "+e.message;}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){if(!pmc.stringContains(b["dom.domain"],"tags.tiqcdn")&&!window.digitalData){return false;}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){if(utag_data["dom.domain"]&&utag_data["dom.domain"].indexOf("localhost")>-1){return false;}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){s.currencyCode=(pmc.environment.market==="ca")?"CAD":s.currencyCode||"USD";s.s_codeVersion="5.6";s.trackDownloadLinks=true;s.trackExternalLinks=true;s.trackInlineStats=true;s.linkLeaveQueryString=false;s.linkTrackVars=s.linkTrackVars+",contextData.EVENTS";s.linkTrackEvents="None";s._tpDST={2014:'3/9,11/2',2015:'3/8,11/1',2016:'3/13,11/6',2017:'3/12,11/5',2018:'3/11,11/4',2019:'3/10,11/3',2020:"3/8,11/1",2021:"3/14,11/7",2022:"3/13,11/6",2023:"3/12,11/5",2024:"3/9,11/2",2025:"3/8,11/1",};s.usePlugins=true;s.doPlugins=function(s){try{window.pmc=window.pmc||{products:"",};function setRegAppReportSuiteFromEnvironment(){s.account="wsidefaultdev";var brandApp="";var brand=pmc.environment.brandCode;var market=pmc.environment.market;var nonUsMarket=market==="us"?"":market;if(brand&&utag_data["ut.env"]){brandApp="wsi"+brand+nonUsMarket+"regapp";if(utag_data["ut.env"]==="prod"){s.account=brandApp+"production";}else{s.account=brandApp+"dev";}}}
function setRegAppReportSuiteFromUserAgent(brand){var brandMap=[{key:"pk",value:{reportSuiteBrand:"pk",trackingServerDomain:"potterybarnkids.com"}},{key:"we",value:{reportSuiteBrand:"we",trackingServerDomain:"westelm.com"}},{key:"ws",value:{reportSuiteBrand:"ws",trackingServerDomain:"williams-sonoma.com"}},{key:"pb",value:{reportSuiteBrand:"pb",trackingServerDomain:"potterybarn.com"}},];var reportSuiteData=pmc.resolveMapLookup(brandMap,brand);var appEnvironment=utag_data["ut.env"]==="prod"?"production":"dev";if(pmc.isVariableDefinedAndNonEmpty(reportSuiteData)){s.account="wsi"+reportSuiteData.reportSuiteBrand+"regapp"+appEnvironment;s.trackingServerSecure="smetrics."+reportSuiteData.trackingServerDomain;s.trackingServer="metrics."+reportSuiteData.trackingServerDomain;}else{s.account="wsipkregapp"+appEnvironment;s.trackingServerSecure="smetrics.potterybarnkids.com";s.trackingServer="metrics.potterybarnkids.com";}}
try{pmc.registryApp=pmc.registryApp||{appName:"",appId:"",visId:"",userAgent:"",previousPageName:"",previousPageType:"",isNative:false,initialized:false,setAppName:function(appName){registryApp.appName=appName;},removeLoginEvents:function(){var eventArray=s.events.split(",");var finalArray=[];for(var i=0;i<eventArray.length;i++){if(eventArray[i]!=="event51"&&eventArray[i]!=="event243"){finalArray.push(eventArray[i]);}}
s.events=finalArray.join(",");},init:function(appName,agent,expectedAppId,cookieName){registryApp.setAppName(appName);var keyValue=new pmc.KeyValue(agent,",","=");registryApp.visId=keyValue.getValue("visId");registryApp.appBrand=keyValue.getValue("appBrand");registryApp.previousPageName=keyValue.getValue("ppn").toLowerCase();registryApp.previousPageType=keyValue.getValue("ppt").toLowerCase();s.prop19=registryApp.previousPageName||s.prop19;s.prop30=registryApp.previousPageType||s.prop30;s.linkTrackVars=s.apl(s.linkTrackVars,'prop19,prop30',',',2);if(registryApp.visId){registryApp.appId=expectedAppId;}
if(registryApp.appId){s.events=pmc.removeStringsFromArray(s.events.split(","),["event20"]).join(",");}
registryApp.initialized=true;},setAdobeHitVariables:function(pmc_native_app_brand,pmc_native_app_market){if(s.prop36==="Registry App: Native"){registryApp.isNative=true;pmc.environment.brandCode=pmc_native_app_brand||"pk";pmc.environment.market=pmc_native_app_market||"";registryApp.appId=registryApp.appName;if(!s.eVar50){throw"eVar50 must be set to visitorID in native app.";}else{registryApp.visId=s.eVar50;}}else if(registryApp.appId===registryApp.appName){s.prop36="Registry App: WebView";s.prop18=s.eVar18="Registry App";s.eVar44="Repeat";if(!pmc.stringContains(utag_data.previous_page_name,"login")&&(utag_data.page_type==="product"||utag_data.page_type==="category"||utag_data.page_type==="cart")){registryApp.removeLoginEvents();}
s.linkTrackVars=s.apl(s.linkTrackVars,"prop36,prop18,eVar18,eVar44,prop30,eVar50",",",2);registryApp.previousPageType="";}
},setAdobeAccountVariables:function(cookieName){if(registryApp.appId===registryApp.appName){if(pmc.environment.brandCode!=="pk"&&pmc.environment.market!=="us"){setRegAppReportSuiteFromEnvironment();}else{s.account="wsipkregappdev";if(utag_data["ut.env"]==="prod"){s.account="wsipkregappproduction";}
s.trackingServerSecure="smetrics.potterybarnkids.com";s.trackingServer="metrics.potterybarnkids.com";}
if(registryApp.visId){s.visitorID=registryApp.visId;}else if(registryApp.oldVisId){s.visitorID=registryApp.oldVisId;}}}};var visitorCookieName="",expectedAppId="",registryApp={};registryApp=pmc.registryApp;registryApp.userAgent=registryApp.userAgent||navigator.userAgent;if(registryApp.userAgent.indexOf("[RegistryApp;iOS]")>-1||s.prop36==="Registry App: Native"){expectedAppId="RegistryApp;iOS";if(!registryApp.initialized){registryApp.init("RegistryApp;iOS",registryApp.userAgent,expectedAppId,visitorCookieName);}
registryApp.setAdobeHitVariables(b.pmc_native_app_brand,b.pmc_native_app_market);registryApp.setAdobeAccountVariables(visitorCookieName);}}catch(e){s.events=s.apl(s.events,'event100',',',2);s.linkTrackEvents=s.apl(s.linkTrackEvents,'event100',',',2);s.eVar100="doPlugins Error: "+e.message;}
var brandFromUserAgent=registryApp.appBrand;if(brandFromUserAgent){setRegAppReportSuiteFromUserAgent(brandFromUserAgent);}else if(pmc.readCookie("ws_source")==="RegistryApp"||pmc.readCookie("pb_source")==="RegistryApp"||pmc.readCookie("we_source")==="RegistryApp"){setRegAppReportSuiteFromEnvironment();}
if(!s.postTrackCallbacksRegistered){s.registerPostTrackCallback(function(){if(!pmc.eventCallbacksRegistered){pmc.registerEventCallbacks();}
s.postTrackCallbacksRegistered=true;s.clearVars();s.events="";s.products="";s.linkTrackVars="";s.linkTrackEvents="";pmc.products="";});}
if(!s.products&&b.pmc_products){s.products=b.pmc_products;}
if(!s.preTrackCallbacksRegistered){s.registerPreTrackCallback(function(){s.preTrackCallbacksRegistered=true;window.setTimeout(function(){try{var event=new Event('AdobeAnalyticsDone');document.dispatchEvent(event);}catch(e){utag.DB(e);}},2000);});}
utag_data.pmc_event367=utag_data.pmc_event397=utag_data.pmc_event398=utag_data.cart_remove_swatch_only=utag_data.cart_add_swatch_only="";s.contextData['vidAPICheck']=(typeof(Visitor)!="undefined"?"VisitorAPI Present":"VisitorAPI Not Present");s.eVar79=utag_data.pmc_eVar79;if(utag_data.pmc_prop36==="shopping app:webview"){s.prop36=utag_data.pmc_prop36;if(pmc.firstWebviewPreviousPageName&&pmc.firstWebviewPreviousPageType){s.prop19=pmc.firstWebviewPreviousPageName;s.prop30=pmc.firstWebviewPreviousPageType;s.linkTrackVars=s.apl(s.linkTrackVars,'prop19,prop30',',',2);pmc.firstWebviewPreviousPageName="";pmc.firstWebviewPreviousPageType="";}}
try{var t_search=undefined;if(s.eVar27){s.eVar27=s.eVar27.replace("%20"," ");t_search=s.getValOnce(s.eVar27+s.eVar42,'s_stv',30,"m");}
if(t_search===""){var eventsArray=s.events.split(",");s.events=pmc.removeStringsFromArray(eventsArray,["event33","event34","event37","event59"]).join(",");}}catch(e){s.events=s.apl(s.events,'event100',',',2);s.linkTrackEvents=s.apl(s.linkTrackEvents,'event100',',',2);s.eVar100="doPlugins search double fire suppression Error: "+e.message;}
try{if(s.events&&s.events.indexOf('prodView')>-1){s.events=s.apl(s.events,'event22',',',2);}}catch(e){s.events=s.apl(s.events,'event100',',',2);s.linkTrackEvents=s.apl(s.linkTrackEvents,'event100',',',2);s.eVar100="doPlugins event22 Error: "+e.message;}
try{if(s.events&&s.events.indexOf('event33')>-1&&s.prop10){s.linkTrackEvents=s.apl(s.linkTrackEvents,'event67',',',2);if(s.prop10==="redirect"){s.events=s.apl(s.events,'event67=0',',',2);}else{s.events=s.apl(s.events,'event67='+s.prop10,',',2);}}}catch(e){s.events=s.apl(s.events,'event100',',',2);s.linkTrackEvents=s.apl(s.linkTrackEvents,'event100',',',2);s.eVar100="doPlugins event67 Error: "+e.message;}
if(s.pageName&&a==="view"){s.eVar10="D=pageName";}
if(!registryApp.isNative&&s.prop36!=="shopping app:native"){s.eVar22=s.getTimeParting('n','-8');s.eVar24=(s.prop36!=="shopping app:webview")?s.getDaysSinceLastVisit('s_lv'):"";s.eVar11="D=g";if(s.prop36!=="shopping app:webview"){utag_data.new_or_repeat_visitor=s.eVar44=(registryApp.appId==="iOS:PBKRegistryApp")?"Repeat":s.getNewRepeat(3650,'s_nr44');}
if(s.eVar12){s.eVar37=s.eVar13=s.eVar26="D=v12";}
var homePageNav=[];pmc.getQueryStringValue("cm_type")?homePageNav.push("cm_type:"+pmc.getQueryStringValue("cm_type")):"";pmc.getQueryStringValue("cm_re")?homePageNav.push("cm_re:"+pmc.getQueryStringValue("cm_re")):"";pmc.getQueryStringValue("cm_src")?homePageNav.push("cm_src:"+pmc.getQueryStringValue("cm_src")):"";if(homePageNav.length>0){if(s.prop19&&["home page","pages:pbdorm","pages:williams-sonoma-home","pages:apartment","pages:baby","pages:modern-baby"].indexOf(s.prop19)>-1){s.eVar25=homePageNav.join("|");}else{s.eVar25="";}}
try{s.getPercentPageViewed();s.prop26=s._ppvHighestPercentViewed;if(!s.prop19||s.prop19=='no value')s.prop26="";}catch(e){s.events=s.apl(s.events,'event100',',',2);s.linkTrackEvents=s.apl(s.linkTrackEvents,'event100',',',2);s.eVar100="doPlugins previouse page viewed Error: "+e.message;}
if((s.eVar9=="external natural referral"||s.eVar9=="internal ad"||s.eVar9=="external campaign referral")&&s.eVar27){var ae=s.split(s.events,',');var e='';for(var i=0;i<ae.length;i++){if(ae[i]=='event33'||ae[i]=='event37'||ae[i]=='event59')continue;else e+=ae[i]?ae[i]+',':ae[i];}
s.events=e.substring(0,e.length-1);}}
var isNativeApp=registryApp.isNative||b.pmc_prop36==="shopping app:native";var isEmptyProduct=!s.products||(s.products&&s.products.indexOf(';productmerch')>-1)||s.newProduct=='true';var isLinkHit=s.p_fo('onemerch')==1||isNativeApp||(s.linkType!=''&&s.linkTrackVars.indexOf('eVar9')>-1);if(s.eVar9&&isEmptyProduct&&isLinkHit){if(!s.c_r('productnum'))
s.productNum=1;else
s.productNum=parseInt(s.c_r('productnum'))+1;s.products=';productmerch'+s.productNum;var e=new Date();e.setTime(e.getTime()+(30*86400000));s.c_w('productnum',s.productNum,e);s.linkTrackVars=s.apl(s.linkTrackVars,'events,products',',',2);s.linkTrackEvents=s.apl(s.linkTrackEvents,'event60',',',2);s.events=s.apl(s.events,'event60',',',2);}
if(s.eVar9&&!(s.events.indexOf('prodView')>-1||s.events.indexOf("scAdd")>-1||pmc.stringStartsWith(s.prop63,"fpv_"))){s.events=s.apl(s.events,'event60',',',2);}
if(s.eVar9&&!pmc.stringStartsWith(s.prop63,"fpv_")){pmc.setMerchEvarNonValues(s);}
if(!registryApp.isNative){if(s.c_r('productnum')&&s.events&&s.events.indexOf('purchase')>-1){s.c_w('productnum','0',0);}
if(s.c_r('CoreID6')){s.eVar49=s.c_r('CoreID6');if(s.eVar49.match(/[a-z]/i)){s.eVar49='';}}
if(pmc.stringContains(s.prop36,"shopping app")&&utag_data.sc_visitor_id){s.visitorID=s.eVar50=utag_data.sc_visitor_id;}else if(registryApp.visId){s.c_w("s_vi","",0);s.eVar50=registryApp.visId;}else if(s.c_r('s_vi')){s.eVar50=sVItoDecimal('s_vi');}else if(s.visitor){s.eVar50=sVItoDecimal(s.visitor.getMarketingCloudVisitorID());}
s._e43c2=s.c_r('e43C2');s._isCookiePlaintext=s._e43c2.search(/\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/i)>-1;if(s.events&&s.events.match(/(event32)|(event51)|(event52)|(event53)|(purchase)/)){if(s.eVar43&&s.eVar43!=""){hashedVal(s.eVar43);if(s._e43c2!=s._encryption){encodeCookie(true);}}
if(s.state&&s.state!=""){if(s.c_r('eStC2')!=s.state){var e=new Date();e.setTime(e.getTime()+(730*86400000));s.c_w('eStC2',s.state,e);s.events=s.apl(s.events,'event68',',',2);}}
if(s.zip&&s.zip!=""){if(s.c_r('eZpC2')!=s.zip){var e=new Date();e.setTime(e.getTime()+(730*86400000));s.c_w('eZpC2',s.zip,e);s.events=s.apl(s.events,'event68',',',2);}}
if(s.eVar34&&s.eVar34!=""){if(s.c_r('e34C2')!=s.eVar34){var e=new Date();e.setTime(e.getTime()+(730*86400000));s.c_w('e34C2',s.eVar34,e);s.events=s.apl(s.events,'event68',',',2);}}
s.eVar159=s.eVar159||utag_data.wsid_kpid;utag.DB("registration code - s.linkTrackEvents: "+s.linkTrackEvents);utag.DB("registration code - s.linkTrackVars: "+s.linkTrackVars);utag.DB("registration code - s.events: "+s.events);utag.DB("registration code - s.eVar34: "+s.eVar34);utag.DB("registration code - s.eVar34: "+s.eVar43);if(((typeof(a)==="string"&&a==="link")||utag_data["ut.event"]==="link")&&s.events.indexOf("event68")>-1){s.linkTrackEvents=s.apl(s.linkTrackEvents,'event68',',',2);}}else{cookieCheck();}
if(pmc&&pmc.isMobile){s.linkTrackVars=s.apl(s.linkTrackVars,'prop18,eVar18',',',2);if(!s.prop18){s.linkTrackVars=s.apl(s.linkTrackVars,'prop18,eVar18',',',2);s.prop18="mobile site";s.eVar18="mobile site";}}
s.eVar43=s.eVar43?s.eVar43.replace("%3A",":"):"";if(s.eVar43&&!pmc.stringContains(s.eVar43,"@")){s.eVar143=s.eVar43;}
try{if(a==="view"&&!pmc.wsiTrackingInitialized&&s.prop63&&!pmc.stringStartsWith(s.prop63,"fpv_")&&!pmc.stringStartsWith(s.prop63,"quick")){pmc.wsiTrackingInitialized=true;window.WSI.tracking.wsiTracking=pmc.wsiTrackingInit(window.digitalData,s.prop63);}}catch(err){s.events=s.apl(s.events,'event100',',',2);s.linkTrackEvents=s.apl(s.linkTrackEvents,'event100',',',2);s.eVar100="wsiTracking Session Storage Error: "+err.message;}
try{if(window.performance){var doPluginsNow;if(typeof window.performance.mark==="function"){window.performance.mark("do_plugins_end");}
if(typeof window.performance.getEntriesByName==="function"){doPluginsEndMarkArray=window.performance.getEntriesByName("do_plugins_end");doPluginsEndMarkPosition=doPluginsEndMarkArray.length-1;doPluginsNow=Math.floor(doPluginsEndMarkArray[doPluginsEndMarkPosition].startTime);if(!s.timingPerformanceTracked&&a==="view"){s.timingPerformanceTracked=true;var getPerformanceEntry=function(performanceMark){var mark=window.performance.getEntriesByName(performanceMark);if(pmc.isArray(mark)&&mark.length>0){return Math.floor(mark[0].startTime);}
return 0;};var performanceTracking={maxValue:75000,isValid:function(){for(var j in performanceTracking){if(performanceTracking.hasOwnProperty(j)&&typeof(performanceTracking[j])!=="function"){if(isNaN(performanceTracking[j])){return false;}
performanceTracking[j]*=1;if(performanceTracking[j]<0||performanceTracking[j]>performanceTracking.maxValue){return false;}}}
return true;},setAdobeVariables:function(){var tealiumInitStartTime=getPerformanceEntry("tealium_init_start");var analyticsPageViewDuration=getPerformanceEntry("analytics_page_view_start");var adobeProcessTime=doPluginsNow-tealiumInitStartTime;if(performanceTracking.isValid()){var map=["event226="+analyticsPageViewDuration,"event230="+adobeProcessTime,"event238="+tealiumInitStartTime,"event239",];for(var i=0;i<map.length;i++){s.events=s.apl(s.events,map[i],",",2);}
s.prop68=tealiumInitStartTime;s.prop69=adobeProcessTime;s.prop70=analyticsPageViewDuration;}}};if(performanceTracking&&performanceTracking.setAdobeVariables){performanceTracking.setAdobeVariables();}
utag.DB("doPlugins ends at "+doPluginsNow);}
if(a==="link"&&!s.clickObject&&pmc.performanceMarkCounter&&typeof performance.getEntriesByName==="function"){var analyticsEventDuration=pmc.checkNestedValue(window.performance.getEntriesByName("analytics_event_start")[pmc.performanceMarkCounter-1],"startTime")?Math.floor(doPluginsNow-window.performance.getEntriesByName("analytics_event_start")[pmc.performanceMarkCounter-1].startTime):0;if(analyticsEventDuration){s.events=s.apl(s.events,"event227="+analyticsEventDuration,",",2);s.prop71=analyticsEventDuration;s.linkTrackVars=s.apl(s.linkTrackVars,'prop71',',',2);s.linkTrackEvents=s.apl(s.linkTrackEvents,'event227',',',2);}}}}}catch(err){s.events=s.apl(s.events,'event100',',',2);s.linkTrackEvents=s.apl(s.linkTrackEvents,'event100',',',2);s.eVar100="Performance Timing Error: "+err.message;}}
s.plugins="";s.tnt=s.trackTNT();s.contextData['EVENTS']=s.events?s.events+',':'';if(!s.prop36||s.prop36!=="pwa"){}}catch(e){s.events=s.apl(s.events,'event100',',',2);s.linkTrackEvents=s.apl(s.linkTrackEvents,'event100',',',2);s.eVar100="doPlugins Error: "+e.message;s.linkTrackVars=s.apl(s.linkTrackVars,"eVar100",",",2);}}
try{s.trackTNT=new Function("v","p","b",""+
"var s=this,n='s_tnt',q='s_tntref',p=(p)?p:n,v=(v)?v:n,r='',pm=false"+
",b=(b)?b:true;if(s.Util.getQueryParam(q)!=''){s.referrer=s.Util.get"+
"QueryParam(q);}else if(s.c_r(q)!=''){s.referrer=s.c_r(q);document.c"+
"ookie=q+'=;path=/;expires=Thu, 01-Jan-1970 00:00:01 GMT;';}else if("+
"(document.cookie.indexOf(q)!=-1&&s.c_r(q)=='')||(location.search.in"+
"dexOf(q+'=')!=-1&&s.Util.getQueryParam(q)=='')){s.referrer='Typed/B"+
"ookmarked';document.cookie=q+'=;path=/;expires=Thu, 01-Jan-1970 00:"+
"00:01 GMT;';}if(s.Util.getQueryParam(p)!=''){pm=s.Util.getQueryPara"+
"m(p);}else if(s.c_r(p)){pm=s.c_r(p);document.cookie=p+'=;path=/;exp"+
"ires=Thu, 01-Jan-1970 00:00:01 GMT;';}else if(s.c_r(p)==''&&s.Util."+
"getQueryParam(p)==''){pm='';}if(pm)r+=(pm+',');if(window[v]!=undefi"+
"ned)r+=window[v];if(b)window[v]='';return r;");s.getVisitStart=new Function("c",""+
"var s=this,n,t=new Date;if(typeof s.callType=='function'&&s.callTyp"+
"e()=='+')return 0;if(!c)c='s_visit';t.setTime(t.getTime()+18e5);n=s"+
".c_r(c)?0:1;if(!s.c_w(c,1,t))s.c_w(c,1,0);if(!s.c_r(c))n=0;return n");s.apl=new Function("l","v","d","u",""+
"var s=this,m=0;if(!l)l='';if(u){var i,n,a=s.split(l,d);for(i=0;i<a."+
"length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCas"+
"e()));}}if(!m)l=l?l+d+v:v;return l");s.getNewRepeat=new Function("d","cn",""+
"var s=this,e=new Date(),cval,sval,ct=e.getTime();d=d?d:30;cn=cn?cn:"+
"'s_nr';e.setTime(ct+d*24*60*60*1000);cval=s.c_r(cn);if(cval.length="+
"=0){s.c_w(cn,ct+'-New',e);return'New';}sval=s.split(cval,'-');if(ct"+
"-sval[0]<30*60*1000&&sval[1]=='New'){s.c_w(cn,ct+'-New',e);return'N"+
"ew';}else{s.c_w(cn,ct+'-Repeat',e);return'Repeat';}");s.getPreviousValue=new Function("v","c","el",""+
"var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el"+
"){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i"+
"){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t)"+
":s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?"+
"s.c_w(c,v,t):s.c_w(c,'no value',t);return r}");s.split=new Function("l","d",""+
"var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i>-1?i:l.length;a[x"+
"++]=l.substring(0,i);l=l.substring(i+d.length);}return a");s.p_fo=new Function("n",""+
"var s=this;if(!s.__fo){s.__fo=new Object;}if(!s.__fo[n]){s.__fo[n]="+
"new Object;return 1;}else {return 0;}");s.getQueryParam=new Function("p","d","u","h",""+
"var s=this,v='',i,j,t;d=d?d:'';u=u?u:(s.pageURL?s.pageURL:(s.wd?s.w"+
"d.location:window.location));while(p){i=p.indexOf(',');i=i<0?p.leng"+
"th:i;t=s.p_gpv(p.substring(0,i),u+'',h);if(t){t=t.indexOf('#')>-1?t"+
".substring(0,t.indexOf('#')):t;}if(t)v+=v?d+t:t;p=p.substring(i==p."+
"length?i:i+1)}return v");s.p_gpv=new Function("k","u","h",""+
"var s=this,v='',q;j=h==1?'#':'?';i=u.indexOf(j);if(k&&i>-1){q=u.sub"+
"string(i+1);v=s.pt(q,'&','p_gvf',k)}return v");s.p_gvf=new Function("t","k",""+
"if(t){var s=this,i=t.indexOf('='),p=i<0?t:t.substring(0,i),v=i<0?'T"+
"rue':t.substring(i+1);if(p.toLowerCase()==k.toLowerCase())return s."+
"epa?s.epa(v):s.unescape(v);}return''");s.pt=new Function("x","d","f","a",""+
"var s=this,t=x,z=0,y,r;while(t){y=t.indexOf(d);y=y<0?t.length:y;t=t"+
".substring(0,y);r=s[f](t,a);if(r)return r;z+=y+d.length;t=x.substri"+
"ng(z,x.length);t=z<x.length?t:''}return''");s.pt=new Function("x","d","f","a",""+
"var s=this,t=x,z=0,y,r;while(t){y=t.indexOf(d);y=y<0?t.length:y;t=t"+
".substring(0,y);r=s[f](t,a);if(r)return r;z+=y+d.length;t=x.substri"+
"ng(z,x.length);t=z<x.length?t:''}return''");s.getValOnce=new Function("v","c","e","t",""+
"var s=this,a=new Date,v=v?v:'',c=c?c:'s_gvo',e=e?e:0,i=t=='m'?6000"+
"0:86400000,k=s.c_r(c);if(v){a.setTime(a.getTime()+e*i);s.c_w(c,v,e"+
"==0?0:a);}return v==k?'':v");s.getTimeParting=new Function("h","z",""+
"var s=this,od;od=new Date('1/1/2000');if(od.getDay()!=6||od.getMont"+
"h()!=0){return'Data Not Available';}else{var H,M,D,U,ds,de,tm,da=['"+
"Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturda"+
"y'],d=new Date();z=z?z:0;z=parseFloat(z);if(s._tpDST){var dso=s._tp"+
"DST[d.getFullYear()].split(/,/);ds=new Date(dso[0]+'/'+d.getFullYea"+
"r());de=new Date(dso[1]+'/'+d.getFullYear());if(h=='n'&&d>ds&&d<de)"+
"{z=z+1;}else if(h=='s'&&(d>de||d<ds)){z=z+1;}}d=d.getTime()+(d.getT"+
"imezoneOffset()*60000);d=new Date(d+(3600000*z));H=d.getHours();M=d"+
".getMinutes();M=(M<10)?'0'+M:M;D=d.getDay();U=' AM';if(H>=12){U=' P"+
"M';H=H-12;}if(H==0){H=12;}D=da[D];tm=H+':'+M+U;return(tm+'|'+D);}");s.getDaysSinceLastVisit=new Function("c",""+
"var s=this,e=new Date(),es=new Date(),cval,cval_s,cval_ss,ct=e.getT"+
"ime(),day=24*60*60*1000,f1,f2,f3,f4,f5;e.setTime(ct+3*365*day);es.s"+
"etTime(ct+30*60*1000);f0='Cookies Not Supported';f1='First Visit';f"+
"2='More than 30 days';f3='More than 7 days';f4='Less than 7 days';f"+
"5='Less than 1 day';cval=s.c_r(c);if(cval.length==0){s.c_w(c,ct,e);"+
"s.c_w(c+'_s',f1,es);}else{var d=ct-cval;if(d>30*60*1000){if(d>30*da"+
"y){s.c_w(c,ct,e);s.c_w(c+'_s',f2,es);}else if(d<30*day+1 && d>7*day"+
"){s.c_w(c,ct,e);s.c_w(c+'_s',f3,es);}else if(d<7*day+1 && d>day){s."+
"c_w(c,ct,e);s.c_w(c+'_s',f4,es);}else if(d<day+1){s.c_w(c,ct,e);s.c"+
"_w(c+'_s',f5,es);}}else{s.c_w(c,ct,e);cval_ss=s.c_r(c+'_s');s.c_w(c"+
"+'_s',cval_ss,es);}}cval_s=s.c_r(c+'_s');if(cval_s.length==0) retur"+
"n f0;else if(cval_s!=f1&&cval_s!=f2&&cval_s!=f3&&cval_s!=f4&&cval_s"+
"!=f5) return '';else return cval_s;");s.pte="event230,event231,event232,event233,event234,event235,event236,event237,event238,event239";s.ptc=false;s.performanceTiming=new Function("v",""+
"var s=this;if(v)s.ptv=v;if(typeof performance!='undefined'){if(perf"+
"ormance.timing.loadEventEnd==0){s.pi=setInterval(function(){s.perfo"+
"rmanceWrite()},250);}if(!s.ptc||s.linkType=='e'){s.performanceRead("+
");}else{s.rfe();s[s.ptv]='';}}");s.performanceWrite=new Function("",""+
"var s=this;if(performance.timing.loadEventEnd>0)clearInterval(s.pi)"+
";try{if(s.c_r('s_ptc')==''&&performance.timing.loadEventEnd>0){try{"+
"var pt=performance.timing;var pta='';pta=s.performanceCheck(pt.fetc"+
"hStart,pt.navigationStart);pta+='^^'+s.performanceCheck(pt.domainLo"+
"okupStart,pt.fetchStart);pta+='^^'+s.performanceCheck(pt.domainLook"+
"upEnd,pt.domainLookupStart);pta+='^^'+s.performanceCheck(pt.connect"+
"End,pt.connectStart);pta+='^^'+s.performanceCheck(pt.responseStart,"+
"pt.connectEnd);pta+='^^'+s.performanceCheck(pt.responseEnd,pt.respo"+
"nseStart);pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoad"+
"ing);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart"+
");pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);"+
"s.c_w('s_ptc',pta);if(sessionStorage&&navigator.cookieEnabled&&s.pt"+
"v!='undefined'){var pe=performance.getEntries();var tempPe='';for(v"+
"ar i=0;i<pe.length;i++){tempPe+='!';tempPe+=pe[i].name.indexOf('?')"+
">-1?pe[i].name.split('?')[0]:pe[i].name;tempPe+='|'+(Math.round(pe["+
"i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000"+
").toFixed(1)+'|'+pe[i].initiatorType;}sessionStorage.setItem('s_pec"+
"',tempPe);}}catch(err){return;}}}catch(err){return;}");s.performanceCheck=new Function("a","b",""+
"if(a>=0&&b>=0){if((a-b)<60000&&((a-b)>=0)){return((a-b)/1000).toFix"+
"ed(2);}else{return 600;}}");s.performanceRead=new Function("",""+
"var s=this;if(performance.timing.loadEventEnd>0)clearInterval(s.pi)"+
";var cv=s.c_r('s_ptc');if(s.pte){var ela=s.pte.split(',');}if(cv!='"+
"'){var cva=s.split(cv,'^^');if(cva[1]!=''){for(var x=0;x<(ela.lengt"+
"h-1);x++){s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);}}s.even"+
"ts=s.apl(s.events,ela[ela.length-1],',',2);}s.linkTrackEvents=s.apl"+
"(s.linkTrackEvents,s.pte,',',2);s.c_w('s_ptc','',0);if(sessionStora"+
"ge&&navigator.cookieEnabled&&s.ptv!='undefined'){s[s.ptv]=sessionSt"+
"orage.getItem('s_pec');sessionStorage.setItem('s_pec','',0);}else{s"+
"[s.ptv]='sessionStorage Unavailable';}s.ptc=true;");s.rfe=new Function("",""+
"var s=this;var ea=s.split(s.events,',');var pta=s.split(s.pte,',');"+
"try{for(x in pta){s.events=s.rfl(s.events,pta[x]);s.contextData['ev"+
"ents']=s.events;}}catch(e){return;}");s.rfl=new Function("l","v","d1","d2","ku",""+
"var s=this,R=new Array(),C='',d1=!d1?',':d1,d2=!d2?',':d2,ku=!ku?0:"+
"1;if(!l)return'';L=l.split(d1);for(i=0;i<L.length;i++){if(L[i].inde"+
"xOf(':')>-1){C=L[i].split(':');C[1]=C[0]+':'+C[1];L[i]=C[0];}if(L[i"+
"].indexOf('=')>-1){C=L[i].split('=');C[1]=C[0]+'='+C[1];L[i]=C[0];}"+
"if(L[i]!=v&&C)R.push(C[1]);else if(L[i]!=v)R.push(L[i]);else if(L[i"+
"]==v&&ku){ku=0;if(C)R.push(C[1]);else R.push(L[i]);}C='';}return s."+
"join(R,{delim:d2})");}catch(e){e.data="doPlugins error in Adobe code";s.events=s.apl(s.events,'event100',',',2);s.linkTrackEvents=s.apl(s.linkTrackEvents,'event100',',',2);s.eVar100="doPlugins PK RegApp Error: "+e.message;}
s.handleYTVideo=function(event){if(event&&event.videoData&&event.data){var videoData=event.videoData;var playerState=event.data;}else{return;}
var videoPlayer="YouTube";var videoTitle=videoData.videoTitle;var videoId=videoData.videoId;var mediaName=videoData.videoTitle;var mediaLength=videoData.mediaLength;var mediaOffset=videoData.mediaOffset;if(mediaLength){mediaLength=Math.floor(mediaLength);}
if(mediaLength){mediaOffset=Math.floor(mediaOffset);}
if(playerState==YT.PlayerState.PLAYING){if(mediaOffset==0){s.Media.open(mediaName,mediaLength,videoPlayer);s.Media.play(mediaName,mediaOffset);}else{s.Media.play(mediaName,mediaOffset);}}
if(playerState==YT.PlayerState.PAUSED){s.Media.stop(mediaName,mediaOffset);}
if(playerState==YT.PlayerState.BUFFERING){s.Media.stop(mediaName,mediaOffset);}
if(playerState==YT.PlayerState.ENDED){mediaOffset=0;s.Media.stop(mediaName,mediaOffset);s.Media.close(mediaName);}};s.initializeMediaModule=function(){try{if(typeof(s.Media)==="undefined"){s.Media=new AppMeasurement_Module_Media(s);s.Media.autoTrack=false;s.Media.playerName='My Media Player';s.Media.segmentByMilestones=true;s.Media.trackMilestones='25,50,75,100';s.Media.trackUsingContextData=true;s.Media.contextDataMapping={'a.contentType':'','a.media.name':'eVar19,prop15','a.media.segment':'eVar20,eVar10','a.media.view':'event23','a.media.segmentView':'event29','a.media.timePlayed':'event28',"a.media.complete":"event27",'a.media.milestones':{25:'event24',50:'event25',75:'event26'}}
s.Media.trackVars='events,eVar19,eVar20,prop15,eVar10,pageName';s.Media.trackEvents='event23,event29,event28,event24,event25,event26,event27';}}catch(e){utag.DB(e);}}
s.handlePPVevents=function(){if(!s_c_il)return;for(var i=0,scill=s_c_il.length;i<scill;i++)
if(typeof s_c_il[i]!="undefined"&&s_c_il[i]._c&&s_c_il[i]._c=="s_c"){var s=s_c_il[i];break}if(!s)return;if(!s.getPPVid)return;var dh=Math.max(Math.max(s.d.body.scrollHeight,s.d.documentElement.scrollHeight),Math.max(s.d.body.offsetHeight,s.d.documentElement.offsetHeight),Math.max(s.d.body.clientHeight,s.d.documentElement.clientHeight)),vph=window.innerHeight||(s.d.documentElement.clientHeight||s.d.body.clientHeight),st=window.pageYOffset||(window.document.documentElement.scrollTop||window.document.body.scrollTop),vh=st+vph,pv=Math.min(Math.round(vh/dh*100),100),c="";if(!s.c_r("s_tp")||decodeURIComponent(s.c_r("s_ppv").split(",")[0])!=s.getPPVid||s.ppvChange=="1"&&(s.c_r("s_tp")&&dh!=s.c_r("s_tp"))){s.c_w("s_tp",dh);s.c_w("s_ppv","")}else c=s.c_r("s_ppv");var a=c&&c.indexOf(",")>-1?c.split(",",4):[],id=a.length>0?a[0]:escape(s.getPPVid),cv=a.length>1?parseInt(a[1]):0,p0=a.length>2?parseInt(a[2]):pv,cy=a.length>3?parseInt(a[3]):0,cn=pv>0?id+","+(pv>cv?pv:cv)+","+p0+","+(vh>cy?vh:cy):"";s.c_w("s_ppv",cn)};s.getPercentPageViewed=function(pid,ch){var n=pid,r=ch;function p(){if(window.ppvID){var a=Math.max(Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),Math.max(document.body.clientHeight,document.documentElement.clientHeight)),b=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,d=(window.pageYOffset||window.document.documentElement.scrollTop||window.document.body.scrollTop)+b,f=Math.min(Math.round(d/a*100),100),l=Math.floor(d/b);b=Math.floor(a/b);var c="";if(!window.cookieRead("s_tp")||decodeURIComponent(window.cookieRead("s_ppv").split(",")[0])!==window.ppvID||window.p_fo(window.ppvID)||1==window.ppvChange&&window.cookieRead("s_tp")&&a!=window.cookieRead("s_tp")){(decodeURIComponent(window.cookieRead("s_ppv").split(",")[0])!==window.ppvID||window.p_fo(window.ppvID+"1"))&&window.cookieWrite("s_ips",d);if(window.cookieRead("s_tp")&&decodeURIComponent(window.cookieRead("s_ppv").split(",")[0])===window.ppvID){window.cookieRead("s_tp");c=window.cookieRead("s_ppv");var h=-1<c.indexOf(",")?c.split(","):[];c=h[0]?h[0]:"";h=h[3]?h[3]:"";var q=window.cookieRead("s_ips");c=c+","+Math.round(h/a*100)+","+Math.round(q/a*100)+","+h+","+l}
window.cookieWrite("s_tp",a)}else c=window.cookieRead("s_ppv");var k=c&&-1<c.indexOf(",")?c.split(",",6):[];a=0<k.length?k[0]:encodeURIComponent(window.ppvID);h=1<k.length?parseInt(k[1]):f;q=2<k.length?parseInt(k[2]):f;var t=3<k.length?parseInt(k[3]):d,u=4<k.length?parseInt(k[4]):l;k=5<k.length?parseInt(k[5]):b;0<f&&(c=a+","+(f>h?f:h)+","+q+","+(d>t?d:t)+","+(l>u?l:u)+","+(b>k?b:k));window.cookieWrite("s_ppv",c)}}
if("-v"===n)return{plugin:"getPercentPageViewed",version:"5.0.1"};var m=function(){if("undefined"!==typeof window.s_c_il)
for(var a=0,b;a<window.s_c_il.length;a++)
if(b=window.s_c_il[a],b._c&&"s_c"===b._c)return b}();"undefined"!==typeof m&&(m.contextData.getPercentPageViewed="5.0.1");window.pageName="undefined"!==typeof m&&m.pageName||"";window.cookieWrite=window.cookieWrite||function(a,b,d){if("string"===typeof a){var f=window.location.hostname,l=window.location.hostname.split(".").length-1;if(f&&!/^[0-9.]+$/.test(f)){l=2<l?l:2;var c=f.lastIndexOf(".");if(0<=c){for(;0<=c&&1<l;)c=f.lastIndexOf(".",c-1),l--;c=0<c?f.substring(c):f}}
g=c;b="undefined"!==typeof b?""+b:"";if(d||""===b)
if(""===b&&(d=-60),"number"===typeof d){var h=new Date;h.setTime(h.getTime()+6E4*d)}else h=d;return a&&(document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+"; path=/;"+(d?" expires="+h.toUTCString()+";":"")+(g?" domain="+g+";":""),"undefined"!==typeof window.cookieRead)?window.cookieRead(a)===b:!1}};window.cookieRead=window.cookieRead||function(a){if("string"===typeof a)a=encodeURIComponent(a);else return"";var b=" "+document.cookie,d=b.indexOf(" "+a+"="),f=0>d?d:b.indexOf(";",d);return(a=0>d?"":decodeURIComponent(b.substring(d+2+a.length,0>f?b.length:f)))?a:""};window.p_fo=window.p_fo||function(a){window.__fo||(window.__fo={});if(window.__fo[a])return!1;window.__fo[a]={};return!0};var e=window.cookieRead("s_ppv");e=-1<e.indexOf(",")?e.split(","):[];n=n?n:window.pageName?window.pageName:document.location.href;e[0]=decodeURIComponent(e[0]);window.ppvChange="undefined"===typeof r||1==r?!0:!1;"undefined"!==typeof m&&m.linkType&&"o"===m.linkType||(window.ppvID&&window.ppvID===n||(window.ppvID=n,window.cookieWrite("s_ppv",""),p()),window.p_fo("s_gppvLoad")&&window.addEventListener&&(window.addEventListener("load",p,!1),window.addEventListener("click",p,!1),window.addEventListener("scroll",p,!1)),this._ppvPreviousPage=e[0]?e[0]:"",this._ppvHighestPercentViewed=e[1]?e[1]:"",this._ppvInitialPercentViewed=e[2]?e[2]:"",this._ppvHighestPixelsSeen=e[3]?e[3]:"",this._ppvFoldsSeen=e[4]?e[4]:"",this._ppvFoldsAvailable=e[5]?e[5]:"")};function add(x,y,base){var z=[];var n=Math.max(x.length,y.length);var carry=0;var i=0;while(i<n||carry){var xi=i<x.length?x[i]:0;var yi=i<y.length?y[i]:0;var zi=carry+xi+yi;z.push(zi%base);carry=Math.floor(zi/base);i++;}
return z;}
function multiplyByNumber(num,x,base){if(num<0)return null;if(num==0)return[];var result=[];var power=x;while(true){if(num&1){result=add(result,power,base);}
num=num>>1;if(num===0)break;power=add(power,power,base);}
return result;}
function parseToDigitsArray(str,base){var digits=str.split('');var ary=[];for(var i=digits.length-1;i>=0;i--){var n=parseInt(digits[i],base);if(isNaN(n))return null;ary.push(n);}
return ary;}
function convertBase(str,fromBase,toBase){var digits=parseToDigitsArray(str,fromBase);if(digits===null)return null;var outArray=[];var power=[1];for(var i=0;i<digits.length;i++){if(digits[i]){outArray=add(outArray,multiplyByNumber(digits[i],power,toBase),toBase);}
power=multiplyByNumber(fromBase,power,toBase);}
var out='';for(var i=outArray.length-1;i>=0;i--){out+=outArray[i].toString(toBase);}
return out;}
function hexToDec(hexStr){if(hexStr.substring(0,2)==='0x')hexStr=hexStr.substring(2);hexStr=hexStr.toLowerCase();return convertBase(hexStr,16,10);}
function sVItoDecimal(a,isPriority){if(a&&isPriority){var sVI=sVI_orig=a;}else if(s.c_r("s_vi")){var sVI=s.c_r(a);var sVI_orig=sVI;sVI=sVI.split('-');sVI[0]=sVI[0].slice(7);sVI[1]=sVI[1].slice(0,-4);sVI[0]=hexToDec(sVI[0]);sVI[1]=hexToDec(sVI[1]);sVI=sVI.join('');}else{var sVI=visitor.getMarketingCloudVisitorID();var sVI_orig=sVI;}
var b=new Date();b.setDate(b.getFullYear()+10);s.c_w('svi_orig',s.c_r(sVI_orig),b);s.c_w('svi_dec',sVI,b);return sVI;}
function cookieCheck(){if(s._isCookiePlaintext){hashedVal(s._e43c2);encodeCookie(false);}}
function hashedVal(val){s._hash=CryptoJS.SHA1(val);s._encryption=CryptoJS.enc.Base64.stringify(s._hash);}
function encodeCookie(_isNewCookie){var e=new Date();e.setTime(e.getTime()+(730*86400000));s.c_w('e43C2',s._encryption,e);if(_isNewCookie){s.events=s.apl(s.events,'event68',',',2);}}
var CryptoJS=CryptoJS||function(e,m){var p={},j=p.lib={},l=function(){},f=j.Base={extend:function(a){l.prototype=this;var c=new l;a&&c.mixIn(a);c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)});c.init.prototype=c;c.$super=this;return c},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},n=j.WordArray=f.extend({init:function(a,c){a=this.words=a||[];this.sigBytes=c!=m?c:4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var c=this.words,q=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)
for(var b=0;b<a;b++)c[d+b>>>2]|=(q[b>>>2]>>>24-8*(b%4)&255)<<24-8*((d+b)%4);else if(65535<q.length)
for(b=0;b<a;b+=4)c[d+b>>>2]=q[b>>>2];else c.push.apply(c,q);this.sigBytes+=a;return this},clamp:function(){var a=this.words,c=this.sigBytes;a[c>>>2]&=4294967295<<32-8*(c%4);a.length=e.ceil(c/4)},clone:function(){var a=f.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var c=[],b=0;b<a;b+=4)c.push(4294967296*e.random()|0);return new n.init(c,a)}}),b=p.enc={},h=b.Hex={stringify:function(a){var c=a.words;a=a.sigBytes;for(var b=[],d=0;d<a;d++){var f=c[d>>>2]>>>24-8*(d%4)&255;b.push((f>>>4).toString(16));b.push((f&15).toString(16))}
return b.join("")},parse:function(a){for(var c=a.length,b=[],d=0;d<c;d+=2)b[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new n.init(b,c/2)}},g=b.Latin1={stringify:function(a){var c=a.words;a=a.sigBytes;for(var b=[],d=0;d<a;d++)b.push(String.fromCharCode(c[d>>>2]>>>24-8*(d%4)&255));return b.join("")},parse:function(a){for(var c=a.length,b=[],d=0;d<c;d++)b[d>>>2]|=(a.charCodeAt(d)&255)<<24-8*(d%4);return new n.init(b,c)}},r=b.Utf8={stringify:function(a){try{return decodeURIComponent(escape(g.stringify(a)))}catch(c){throw Error("Malformed UTF-8 data");}},parse:function(a){return g.parse(unescape(encodeURIComponent(a)))}},k=j.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new n.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=r.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var c=this._data,b=c.words,d=c.sigBytes,f=this.blockSize,h=d/(4*f),h=a?e.ceil(h):e.max((h|0)-this._minBufferSize,0);a=h*f;d=e.min(4*a,d);if(a){for(var g=0;g<a;g+=f)this._doProcessBlock(b,g);g=b.splice(0,a);c.sigBytes-=d}
return new n.init(g,d)},clone:function(){var a=f.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});j.Hasher=k.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){k.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(c,b){return(new a.init(b)).finalize(c)}},_createHmacHelper:function(a){return function(b,f){return(new s.HMAC.init(a,f)).finalize(b)}}});var s=p.algo={};return p}(Math);(function(){var e=CryptoJS,m=e.lib,p=m.WordArray,j=m.Hasher,l=[],m=e.algo.SHA1=j.extend({_doReset:function(){this._hash=new p.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(f,n){for(var b=this._hash.words,h=b[0],g=b[1],e=b[2],k=b[3],j=b[4],a=0;80>a;a++){if(16>a)l[a]=f[n+a]|0;else{var c=l[a-3]^l[a-8]^l[a-14]^l[a-16];l[a]=c<<1|c>>>31}
c=(h<<5|h>>>27)+j+l[a];c=20>a?c+((g&e|~g&k)+1518500249):40>a?c+((g^e^k)+1859775393):60>a?c+((g&e|g&k|e&k)-1894007588):c+((g^e^k)-899497514);j=k;k=e;e=g<<30|g>>>2;g=h;h=c}
b[0]=b[0]+h|0;b[1]=b[1]+g|0;b[2]=b[2]+e|0;b[3]=b[3]+k|0;b[4]=b[4]+j|0},_doFinalize:function(){var f=this._data,e=f.words,b=8*this._nDataBytes,h=8*f.sigBytes;e[h>>>5]|=128<<24-h%32;e[(h+64>>>9<<4)+14]=Math.floor(b/4294967296);e[(h+64>>>9<<4)+15]=b;f.sigBytes=4*e.length;this._process();return this._hash},clone:function(){var e=j.clone.call(this);e._hash=this._hash.clone();return e}});e.SHA1=j._createHelper(m);e.HmacSHA1=j._createHmacHelper(m)})();(function(){var h=CryptoJS,j=h.lib.WordArray;h.enc.Base64={stringify:function(b){var e=b.words,f=b.sigBytes,c=this._map;b.clamp();b=[];for(var a=0;a<f;a+=3)
for(var d=(e[a>>>2]>>>24-8*(a%4)&255)<<16|(e[a+1>>>2]>>>24-8*((a+1)%4)&255)<<8|e[a+2>>>2]>>>24-8*((a+2)%4)&255,g=0;4>g&&a+0.75*g<f;g++)b.push(c.charAt(d>>>6*(3-g)&63));if(e=c.charAt(64))
for(;b.length%4;)b.push(e);return b.join("")},parse:function(b){var e=b.length,f=this._map,c=f.charAt(64);c&&(c=b.indexOf(c),-1!=c&&(e=c));for(var c=[],a=0,d=0;d<e;d++)
if(d%4){var g=f.indexOf(b.charAt(d-1))<<2*(d%4),h=f.indexOf(b.charAt(d))>>>6-2*(d%4);c[a>>>2]|=(g|h)<<24-8*(a%4);a++}return j.create(c,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();function AppMeasurement_Module_Media(q){var b=this;b.s=q;q=window;q.s_c_in||(q.s_c_il=[],q.s_c_in=0);b._il=q.s_c_il;b._in=q.s_c_in;b._il[b._in]=b;q.s_c_in++;b._c="s_m";b.list=[];b.open=function(d,c,e,k){var f={},a=new Date,l="",g;c||(c=-1);if(d&&e){b.list||(b.list={});b.list[d]&&b.close(d);k&&k.id&&(l=k.id);if(l)
for(g in b.list)!Object.prototype[g]&&b.list[g]&&b.list[g].R==l&&b.close(b.list[g].name);f.name=d;f.length=c;f.offset=0;f.e=0;f.playerName=b.playerName?b.playerName:e;f.R=l;f.C=0;f.a=0;f.timestamp=Math.floor(a.getTime()/1E3);f.k=0;f.u=f.timestamp;f.c=-1;f.n="";f.g=-1;f.D=0;f.I={};f.G=0;f.m=0;f.f="";f.B=0;f.L=0;f.A=0;f.F=0;f.l=!1;f.v="";f.J="";f.K=0;f.r=!1;f.H="";f.complete=0;f.Q=0;f.p=0;f.q=0;b.list[d]=f}};b.openAd=function(d,c,e,k,f,a,l,g){var h={};b.open(d,c,e,g);if(h=b.list[d])h.l=!0,h.v=k,h.J=f,h.K=a,h.H=l};b.M=function(d){var c=b.list[d];b.list[d]=0;c&&c.monitor&&clearTimeout(c.monitor.interval)};b.close=function(d){b.i(d,0,-1)};b.play=function(d,c,e,k){var f=b.i(d,1,c,e,k);f&&!f.monitor&&(f.monitor={},f.monitor.update=function(){1==f.k&&b.i(f.name,3,-1);f.monitor.interval=setTimeout(f.monitor.update,1E3)},f.monitor.update())};b.click=function(d,c){b.i(d,7,c)};b.complete=function(d,c){b.i(d,5,c)};b.stop=function(d,c){b.i(d,2,c)};b.track=function(d){b.i(d,4,-1)};b.P=function(d,c){var e="a.media.",k=d.linkTrackVars,f=d.linkTrackEvents,a="m_i",l,g=d.contextData,h;c.l&&(e+="ad.",c.v&&(g["a.media.name"]=c.v,g[e+"pod"]=c.J,g[e+"podPosition"]=c.K),c.G||(g[e+"CPM"]=c.H));c.r&&(g[e+"clicked"]=!0,c.r=!1);g["a.contentType"]="video"+(c.l?"Ad":"");g["a.media.channel"]=b.channel;g[e+"name"]=c.name;g[e+"playerName"]=c.playerName;0<c.length&&(g[e+"length"]=c.length);g[e+"timePlayed"]=Math.floor(c.a);0<Math.floor(c.a)&&(g[e+"timePlayed"]=Math.floor(c.a));c.G||(g[e+"view"]=!0,a="m_s",b.Heartbeat&&b.Heartbeat.enabled&&(a=c.l?b.__primetime?"mspa_s":"msa_s":b.__primetime?"msp_s":"ms_s"),c.G=1);c.f&&(g[e+"segmentNum"]=c.m,g[e+"segment"]=c.f,0<c.B&&(g[e+"segmentLength"]=c.B),c.A&&0<c.a&&(g[e+"segmentView"]=!0));!c.Q&&c.complete&&(g[e+"complete"]=!0,c.S=1);0<c.p&&(g[e+"milestone"]=c.p);0<c.q&&(g[e+"offsetMilestone"]=c.q);if(k)
for(h in g)Object.prototype[h]||(k+=",contextData."+h);l=g["a.contentType"];d.pe=a;d.pev3=l;var q,s;if(b.contextDataMapping)
for(h in d.events2||(d.events2=""),k&&(k+=",events"),b.contextDataMapping)
if(!Object.prototype[h]){a=h.length>e.length&&h.substring(0,e.length)==e?h.substring(e.length):"";l=b.contextDataMapping[h];if("string"==typeof l)
for(q=l.split(","),s=0;s<q.length;s++)l=q[s],"a.contentType"==h?(k&&(k+=","+l),d[l]=g[h]):"view"==a||"segmentView"==a||"clicked"==a||"complete"==a||"timePlayed"==a||"CPM"==a?(f&&(f+=","+l),"timePlayed"==a||"CPM"==a?g[h]&&(d.events2+=(d.events2?",":"")+l+"="+g[h]):g[h]&&(d.events2+=(d.events2?",":"")+l)):"segment"==a&&g[h+"Num"]?(k&&(k+=","+l),d[l]=g[h+"Num"]+":"+g[h]):(k&&(k+=","+l),d[l]=g[h]);else if("milestones"==a||"offsetMilestones"==a)h=h.substring(0,h.length-1),g[h]&&b.contextDataMapping[h+"s"][g[h]]&&(f&&(f+=","+b.contextDataMapping[h+
"s"][g[h]]),d.events2+=(d.events2?",":"")+b.contextDataMapping[h+"s"][g[h]]);g[h]&&(g[h]=0);"segment"==a&&g[h+"Num"]&&(g[h+"Num"]=0)}d.linkTrackVars=k;d.linkTrackEvents=f};b.i=function(d,c,e,k,f){var a={},l=(new Date).getTime()/1E3,g,h,q=b.trackVars,s=b.trackEvents,t=b.trackSeconds,u=b.trackMilestones,v=b.trackOffsetMilestones,w=b.segmentByMilestones,x=b.segmentByOffsetMilestones,p,n,r=1,m={},y;b.channel||(b.channel=b.s.w.location.hostname);if(a=d&&b.list&&b.list[d]?b.list[d]:0)
if(a.l&&(t=b.adTrackSeconds,u=b.adTrackMilestones,v=b.adTrackOffsetMilestones,w=b.adSegmentByMilestones,x=b.adSegmentByOffsetMilestones),0>e&&(e=1==a.k&&0<a.u?l-a.u+a.c:a.c),0<a.length&&(e=e<a.length?e:a.length),0>e&&(e=0),a.offset=e,0<a.length&&(a.e=a.offset/a.length*100,a.e=100<a.e?100:a.e),0>a.c&&(a.c=e),y=a.D,m.name=d,m.ad=a.l,m.length=a.length,m.openTime=new Date,m.openTime.setTime(1E3*a.timestamp),m.offset=a.offset,m.percent=a.e,m.playerName=a.playerName,m.mediaEvent=0>a.g?"OPEN":1==c?"PLAY":2==c?"STOP":3==c?"MONITOR":4==c?"TRACK":5==c?"COMPLETE":7==c?"CLICK":"CLOSE",2<c||c!=a.k&&(2!=c||1==a.k)){f||(k=a.m,f=a.f);if(c){1==c&&(a.c=e);if((3>=c||5<=c)&&0<=a.g&&(r=!1,q=s="None",a.g!=e)){h=a.g;h>e&&(h=a.c,h>e&&(h=e));p=u?u.split(","):0;if(0<a.length&&p&&e>=h)
for(n=0;n<p.length;n++)(g=p[n]?parseFloat(""+p[n]):0)&&h/a.length*100<g&&a.e>=g&&(r=!0,n=p.length,m.mediaEvent="MILESTONE",a.p=m.milestone=g);if((p=v?v.split(","):0)&&e>=h)
for(n=0;n<p.length;n++)(g=p[n]?parseFloat(""+p[n]):0)&&h<g&&e>=g&&(r=!0,n=p.length,m.mediaEvent="OFFSET_MILESTONE",a.q=m.offsetMilestone=g)}
if(a.L||!f){if(w&&u&&0<a.length){if(p=u.split(","))
for(p.push("100"),n=h=0;n<p.length;n++)
if(g=p[n]?parseFloat(""+p[n]):0)a.e<g&&(k=n+1,f="M:"+h+"-"+g,n=p.length),h=g}else if(x&&v&&(p=v.split(",")))
for(p.push(""+(0<a.length?a.length:"E")),n=h=0;n<p.length;n++)
if((g=p[n]?parseFloat(""+p[n]):0)||"E"==p[n]){if(e<g||"E"==p[n])k=n+1,f="O:"+h+"-"+g,n=p.length;h=g}f&&(a.L=!0)}(f||a.f)&&f!=a.f&&(a.F=!0,a.f||(a.m=k,a.f=f),0<=a.g&&(r=!0));(2<=c||100<=a.e)&&a.c<e&&(a.C+=e-a.c,a.a+=e-a.c);if(2>=c||3==c&&!a.k)a.n+=(1==c||3==c?"S":"E")+Math.floor(e),a.k=3==c?1:c;!r&&0<=a.g&&3>=c&&(t=t?t:0)&&a.a>=t&&(r=!0,m.mediaEvent="SECONDS");a.u=l;a.c=e}
if(!c||3>=c&&100<=a.e)2!=a.k&&(a.n+="E"+Math.floor(e)),c=0,q=s="None",m.mediaEvent="CLOSE";7==c&&(r=m.clicked=a.r=!0);if(5==c||b.completeByCloseOffset&&(!c||100<=a.e)&&0<a.length&&e>=a.length-b.completeCloseOffsetThreshold)r=m.complete=a.complete=!0;l=m.mediaEvent;"MILESTONE"==l?l+="_"+m.milestone:"OFFSET_MILESTONE"==l&&(l+="_"+m.offsetMilestone);a.I[l]?m.eventFirstTime=!1:(m.eventFirstTime=!0,a.I[l]=1);m.event=m.mediaEvent;m.timePlayed=a.C;m.segmentNum=a.m;m.segment=a.f;m.segmentLength=a.B;b.monitor&&4!=c&&b.monitor(b.s,m);b.Heartbeat&&b.Heartbeat.enabled&&0<=a.g&&(r=!1);0==c&&b.M(d);r&&a.D==y&&(d={contextData:{}},d.linkTrackVars=q,d.linkTrackEvents=s,d.linkTrackVars||(d.linkTrackVars=""),d.linkTrackEvents||(d.linkTrackEvents=""),b.P(d,a),d.linkTrackVars||(d["!linkTrackVars"]=1),d.linkTrackEvents||(d["!linkTrackEvents"]=1),b.s.track(d),a.F?(a.m=k,a.f=f,a.A=!0,a.F=!1):0<a.a&&(a.A=!1),a.n="",a.p=a.q=0,a.a-=Math.floor(a.a),a.g=e,a.D++)}return a};b.O=function(d,c,e,k,f){var a=0;if(d&&(!b.autoTrackMediaLengthRequired||c&&0<c)){if(b.list&&b.list[d])a=1;else if(1==e||3==e)b.open(d,c,"HTML5 Video",f),a=1;a&&b.i(d,e,k,-1,0)}};b.attach=function(d){var c,e,k;d&&d.tagName&&"VIDEO"==d.tagName.toUpperCase()&&(b.o||(b.o=function(c,a,d){var e,h;b.autoTrack&&(e=c.currentSrc,(h=c.duration)||(h=-1),0>d&&(d=c.currentTime),b.O(e,h,a,d,c))}),c=function(){b.o(d,1,-1)},e=function(){b.o(d,1,-1)},b.j(d,"play",c),b.j(d,"pause",e),b.j(d,"seeking",e),b.j(d,"seeked",c),b.j(d,"ended",function(){b.o(d,0,-1)}),b.j(d,"timeupdate",c),k=function(){d.paused||d.ended||d.seeking||b.o(d,3,-1);setTimeout(k,1E3)},k())};b.j=function(b,c,e){b.attachEvent?b.attachEvent("on"+c,e):b.addEventListener&&b.addEventListener(c,e,!1)};void 0==b.completeByCloseOffset&&(b.completeByCloseOffset=1);void 0==b.completeCloseOffsetThreshold&&(b.completeCloseOffsetThreshold=1);b.Heartbeat={};b.N=function(){var d,c;if(b.autoTrack&&(d=b.s.d.getElementsByTagName("VIDEO")))
for(c=0;c<d.length;c++)b.attach(d[c])};b.j(q,"load",b.N)}
function AppMeasurement_Module_ActivityMap(f){function g(a,d){var b,c,n;if(a&&d&&(b=e.c[d]||(e.c[d]=d.split(","))))
for(n=0;n<b.length&&(c=b[n++]);)
if(-1<a.indexOf(c))return null;p=1;return a}
function q(a,d,b,c,e){var g,h;if(a.dataset&&(h=a.dataset[d]))g=h;else if(a.getAttribute)
if(h=a.getAttribute("data-"+b))g=h;else if(h=a.getAttribute(b))g=h;if(!g&&f.useForcedLinkTracking&&e&&(g="",d=a.onclick?""+a.onclick:"")){b=d.indexOf(c);var l,k;if(0<=b){for(b+=10;b<d.length&&0<="= \t\r\n".indexOf(d.charAt(b));)b++;if(b<d.length){h=b;for(l=k=0;h<d.length&&(";"!=d.charAt(h)||l);)l?d.charAt(h)!=l||k?k="\\"==d.charAt(h)?!k:0:l=0:(l=d.charAt(h),'"'!=l&&"'"!=l&&(l=0)),h++;if(d=d.substring(b,h))a.e=new Function("s","var e;try{s.w."+c+"="+d+"}catch(e){}"),a.e(f)}}}
return g||e&&f.w[c]}
function r(a,d,b){var c;return(c=e[d](a,b))&&(p?(p=0,c):g(k(c),e[d+"Exclusions"]))}
function s(a,d,b){var c;if(a&&!(1===(c=a.nodeType)&&(c=a.nodeName)&&(c=c.toUpperCase())&&t[c])&&(1===a.nodeType&&(c=a.nodeValue)&&(d[d.length]=c),b.a||b.t||b.s||!a.getAttribute||((c=a.getAttribute("alt"))?b.a=c:(c=a.getAttribute("title"))?b.t=c:"IMG"==(""+a.nodeName).toUpperCase()&&(c=a.getAttribute("src")||a.src)&&(b.s=c)),(c=a.childNodes)&&c.length))
for(a=0;a<c.length;a++)s(c[a],d,b)}
function k(a){if(null==a||void 0==a)return a;try{return a.replace(RegExp("^[\\s\\n\\f\\r\\t\t-\r \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u205f\u3000\ufeff]+","mg"),"").replace(RegExp("[\\s\\n\\f\\r\\t\t-\r \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u205f\u3000\ufeff]+$","mg"),"").replace(RegExp("[\\s\\n\\f\\r\\t\t-\r \u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u205f\u3000\ufeff]{1,}","mg")," ").substring(0,254)}catch(d){}}
var e=this;e.s=f;var m=window;m.s_c_in||(m.s_c_il=[],m.s_c_in=0);e._il=m.s_c_il;e._in=m.s_c_in;e._il[e._in]=e;m.s_c_in++;e._c="s_m";e.c={};var p=0,t={SCRIPT:1,STYLE:1,LINK:1,CANVAS:1};e._g=function(){var a,d,b,c=f.contextData,e=f.linkObject;(a=f.pageName||f.pageURL)&&(d=r(e,"link",f.linkName))&&(b=r(e,"region"))&&(c["a.activitymap.page"]=a.substring(0,255),c["a.activitymap.link"]=128<d.length?d.substring(0,128):d,c["a.activitymap.region"]=127<b.length?b.substring(0,127):b,c["a.activitymap.pageIDType"]=f.pageName?1:0)};e.link=function(a,d){var b;if(d)b=g(k(d),e.linkExclusions);else if((b=a)&&!(b=q(a,"sObjectId","s-object-id","s_objectID",1))){var c,f;(f=g(k(a.innerText||a.textContent),e.linkExclusions))||(s(a,c=[],b={a:void 0,t:void 0,s:void 0}),(f=g(k(c.join(""))))||(f=g(k(b.a?b.a:b.t?b.t:b.s?b.s:void 0)))||!(c=(c=a.tagName)&&c.toUpperCase?c.toUpperCase():"")||("INPUT"==c||"SUBMIT"==c&&a.value?f=g(k(a.value)):a.src&&"IMAGE"==c&&(f=g(k(a.src)))));b=f}
return ba};e.region=function(a){for(var d,b=e.regionIDAttribute||"id";a&&(a=a.parentNode);){if(d=q(a,b,b,b))return d;if("BODY"==a.nodeName)return"BODY"}}}
}}catch(e){utag.DB(e)}},function(a,b){try{if(b['dom.pathname'].toString().toLowerCase().indexOf('/thekey/enroll/unconfirmed/'.toLowerCase())>-1){b['pmc_event206']='event206'}}catch(e){utag.DB(e);}},function(a,b){try{if(b['pmc_pageName'].toString().indexOf(':app:')>-1){try{b['pmc_pageName']=b.pmc_pageName.replace(":app:",":module:");}catch(e){};b['pmc_eVar10']=b['pmc_pageName']}}catch(e){utag.DB(e);}},function(a,b){try{if((b['_pathname1'].toString().toLowerCase().indexOf('pages'.toLowerCase())>-1&&b['_pathname2'].toString().toLowerCase().indexOf('ecatalog'.toLowerCase())>-1&&b['brand']=='mg')){b['pmc_eVar1']='pages';b['pmc_eVar2']='pages:ecatalog';b['pmc_eVar3']='pages:ecatalog'}}catch(e){utag.DB(e);}},function(a,b){try{if(typeof b['pmc_prop1']!='undefined'){utag.loader.SC('utag_main',{'prev_page_primary_category':b['pmc_prop1']+';exp-session'});b['cp.utag_main_prev_page_primary_category']=b['pmc_prop1'];}}catch(e){utag.DB(e);}},function(a,b,c,d){c=['pmc_pageName'];for(d=0;d<c.length;d++){try{b[c[d]]=b[c[d]]instanceof Array?b[c[d]]:b[c[d]]instanceof Object?b[c[d]]:b[c[d]].toString().toLowerCase()}catch(e){utag.DB(e);}}},function(a,b){try{if(1){function isValid(param){if(typeof(param)!=="undefined"&&param.length>0&&param!=="True"&&param!==false){return true;}
return false;}
function hasLowPriorityPfm(pfm){if(pfm){return pmc.arrayContains(["shop","favorites","search:search results"],pfm);}
return false;}
function getSocialReferrer(referrer){var socialReferrersRegex=[/^(t.co)$/,/(com.twitter)/,/(com.linkedin)/,/(com.pinterest)/,/(com.plurk)/,/(vimeo.com)$/,/(tiktok.com)$/,/(snapchat.com)$/,/(flickr.com)$/,/(blogspot.com)$/,/(blogster.com)$/,/(cafemom.com)$/,/(classmates.com)$/,/(collegeblender.com)$/,/(diigo.com)$/,/(disqus.com)$/,/(facebook.com)$/,/(fc2.com)$/,/(foursquare.com)$/,/(instagram.com)$/,/(like2buy.curalate.com)$/,/(linkedin.com)$/,/(livejournal.com)$/,/(lnkd.in)$/,/(meetup.com)$/,/(mobile.ok.ru)$/,/(mp.weixin.qq.com)$/,/(mumsnet.com)$/,/(myheritage.com)$/,/(netvibes.com)$/,/(nextdoor.com)$/,/(pinterest).com$/,/(pinterest).[a-zA-Z]{2}$/,/(pinterest).co.[a-zA-Z]{2}$/,/(pinterest).com.[a-zA-Z]{2}$/,/(plurk.com)$/,/(plus.url.google.com)$/,/(reddit.com)$/,/(tagged.com)$/,/(tumblr.com)$/,/(twitter.com)$/,/(vk.com)$/,/(wordpress.com)$/,/(yammer.com)$/,/(yelp.co.uk)$/,/(yelp.com)$/,/(youtube.com)$/,];var matchValue;for(var i=0,len=socialReferrersRegex.length;i<len;i++){matchValue=referrer.match(socialReferrersRegex[i]);if(matchValue){return"OrganicSocial^"+matchValue[1];}}
return"";}
try{utag_data.page_hit_depth=!utag_data.page_hit_depth?1:++utag_data.page_hit_depth;s.visitStart=0;if(a==="view"&&!pmc.stringContains(b.tealium_event,"fpv_")){if(utag_data.pmc_prop36==="shopping app:native"&&b.pmc_event20==="event20"){s.visitStart=1;}else if(typeof(s)!=="undefined"&&typeof(s.getVisitStart)!=="undefined"&&!pmc.stringContains(utag_data.pmc_prop36,"shopping app")){s.visitStart=s.getVisitStart("s_vst1");}
if(s.visitStart==1){b.pmc_event20="event20";b.pmc_eVar54=location.protocol+"//"+location.host+location.pathname;}else{b.pmc_eVar54="";}
if(pmc.visitStart){b.pmc_event920="event920";pmc.visitStart=0;}
if(utag_data["cp.utag_main__ss"]==="1"&&utag_data.page_hit_depth===1){b.pmc_event921="event921";}
var campaign="";var cmVenReferrer=pmc.getQueryStringValue("cm_ven",pmc.referrerQueryArray);var cmCatReferrer=pmc.getQueryStringValue("cm_cat",pmc.referrerQueryArray);var cmPlaReferrer=pmc.getQueryStringValue("cm_pla",pmc.referrerQueryArray);var cmIteReferrer=pmc.getQueryStringValue("cm_ite",pmc.referrerQueryArray);var cmMmcReferrer=pmc.getQueryStringValue("cm_mmc",pmc.referrerQueryArray);var cmVen=pmc.getQueryStringValue("cm_ven",pmc.queryArray);var cmCat=pmc.getQueryStringValue("cm_cat",pmc.queryArray);var cmPla=pmc.getQueryStringValue("cm_pla",pmc.queryArray);var cmIte=pmc.getQueryStringValue("cm_ite",pmc.queryArray);var cmMmc=pmc.getQueryStringValue("cm_mmc",pmc.queryArray);if(isValid(cmMmc)){campaign=cmMmc.replace(/-_-/g,'^');b.pmc_eVar12=decodeURI(campaign).replace("%26","&");}else if(isValid(cmVen)&&isValid(cmCat)){if(!isValid(cmPla)){cmPla="not_provided";}
if(!isValid(cmIte)){cmIte="not_provided";}
campaign=cmVen+"^"+cmCat+"^"+cmPla+"^"+cmIte;b.pmc_eVar12=decodeURI(campaign).replace("%26","&");}else if(isValid(cmMmcReferrer)){campaign=cmMmcReferrer.replace(/-_-/g,'^');}else if(isValid(cmVenReferrer)&&isValid(cmCatReferrer)){if(!isValid(cmPlaReferrer)){cmPlaReferrer="not_provided";}
if(!isValid(cmIteReferrer)){cmIteReferrer="not_provided";}
campaign=cmVenReferrer+"^"+cmCatReferrer+"^"+cmPlaReferrer+"^"+cmIteReferrer;}
var referrer=document.referrer;if(!s.campaign&&s.visitStart==1){if(isValid(campaign)){b.pmc_campaign=b.pmc_prop25=decodeURI(campaign).replace("%26","&");}else if(referrer){b.pmc_campaign=b.pmc_prop25=b.pmc_eVar12=getSocialReferrer(pmc.referrer.hostname);}}
if(!b.pmc_eVar9||hasLowPriorityPfm(b.pmc_eVar9)){var isInternal=pmc.isInternal(referrer);if(b.pmc_eVar12){b.pmc_eVar9=utag_data.external_pfm=(isInternal)?"cross-brand referral":"external campaign referral";}else if(referrer&&!isInternal){b.pmc_eVar9=utag_data.external_pfm=pmc.getPfmFromReferrer(referrer,isInternal,b);}
if(!b.pmc_eVar9&&s.visitStart===1&&!referrer){b.pmc_eVar9="direct load";}}
utag_data.campaign=b.pmc_eVar12;utag_data.internal_ad=b.pmc_eVar15=pmc.getQueryStringValue("cm_re");}}catch(e){b.pmc_event100="event100";b.pmc_eVar100="Setting Campaign Error: handle campaign variables extension: "+e.message;}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){if(utag_data['dom.pathname'].toString().toLowerCase().indexOf('thekey/enroll/unconfirmed'.toLowerCase())>-1){if(pmc.isNestedDataDefinedAndNonEmpty(digitalData,"page.attributes.notificationType")&&digitalData.page.attributes.notificationType==="sms_text"){b["pmc_event267"]="event267";}}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){try{if(a==="view"&&(b.pmc_prop36||(s&&s.c_r("gpv_p46")))){var cookieVal=b.pmc_prop36||"";b.pmc_prop46=s.getPreviousValue(cookieVal,'gpv_p46','');b.pmc_prop46=(b.pmc_prop46==="no value")?"":b.pmc_prop46;}}catch(e){b.pmc_event100="event100";b.pmc_eVar100="Page Load Custom prop46 Error: "+location.pathname+": "+e.message;}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){if(!pmc.setCustomerIdWithHashedEmail){if(b.customer_email_public&&!pmc.stringContains(b.customer_email_public,"@")){pmc.setCustomerIdWithHashedEmail=true;if(pmc.isNestedDataDefinedAndNonEmpty(window.adobe,"target.trackEvent")){window.adobe.target.trackEvent({"mbox":"hashSync",});}
b.pmc_eVar143=b.customer_email_public;if(visitor){visitor.setCustomerIDs({"hashID02":{"id":b.customer_email_public,"authState":Visitor.AuthState.AUTHENTICATED,},"hashID":{"id":b.customer_email_public,"authState":Visitor.AuthState.AUTHENTICATED,}});}}}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){if(b.customer_email_public&&!b.pmc_eVar38){b.pmc_eVar38="D=c2";}}}catch(e){utag.DB(e)}}];u.send=function(a,b,c,d,e,f,g,h,ev){if(u.ev[a]||typeof u.ev.all!="undefined"){utag.DB("send:6491");try{if(window.performance){if(!b.associatedTags||(b.associatedTags&&pmc.stringContains(b.associatedTags,"adobeAnalytics"))){if(a==="view"&&!pmc.performanceMarkCountPage){pmc.performanceMarkCountPage=1;window.performance.mark("analytics_page_view_start");}else if(a==="link"){pmc.performanceMarkCounter=pmc.performanceMarkCounter?pmc.performanceMarkCounter+1:1;window.performance.mark("analytics_event_start");}}}}catch(e){utag.DB("error setting performance mark: "+e.message);}
u.data={"adobe_org_id":"D38758195432E1050A4C98A2@AdobeOrg","cookieDomain":(function(){return utag.loader.RC('utag_main').vapi_domain||(function(){var i=0,d=document.domain,p=d.split('.'),s='_vapi'+new Date().getTime();while(i<(p.length-1)&&document.cookie.indexOf(s+'='+s)===-1){d=p.slice(-1-(++i)).join('.');document.cookie=s+'='+s+';domain='+d+';';}
document.cookie=s+'=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain='+d+';';utag.loader.SC('utag_main',{'vapi_domain':d});return d;}());}()),"a":{},"serial":{},"linkName":"","linkType":"","runviewthrough":"no","viewthroughloaded":u.hasadobeView(),"viewthroughinterval":100,"viewthroughmaxtries":3};if(u.data.runviewthrough&&!u.data.viewthroughloaded){(function(el,script){el=document.createElement("script");el.async=!0;el.src="https://www.everestjs.net/static/le/last-event-tag-latest.min.js";script=document.getElementsByTagName("script")[0];script.parentNode.insertBefore(el,script);})();utag.ut.adobeViewScriptRequested=true;u.data.viewthroughloaded=true;}
for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(e[f]==="adobe_org_id"||e[f]==="linkTrackVars"||e[f]==="linkTrackEvents"||e[f]==="linkType"||e[f]==="linkName"){u.data[e[f]]=b[d];}else if(e[f]==="combineLinkVar"){u.combineLinkVar=b[d];}}}}
u.queue.push({"a":a,"b":b,"u.data":u.data});vAPI.getInstance(u.data.adobe_org_id,function(instance){var data=u.queue.shift();a=data["a"];b=data["b"];u.data=data["u.data"];u.a=a;b.sc_events=b.sc_events||{};u.addEvent=function(v,n){var t=[];if(v instanceof Array){t=v.slice(0);}else if(typeof n!=="undefined"){t.push(v+"="+n);}else{t.push(v);}
for(var i=0;i<t.length;i++){b.sc_events[t[i]]=1;u.pushlt(u.lte,t[i].indexOf("=")>-1?t[i].split('=')[0]:t[i].split(':')[0]);}
return b.sc_events;};u.addProduct=function(v){u.data.sc_addProd="";if(v instanceof Array){u.data.sc_addProd=v.join(",");}else{u.data.sc_addProd=v;}};if(u.data.runviewthrough==="yes"){var editedReportSuite="wsidefaultdev".toLowerCase();editedReportSuite=editedReportSuite.replace(/\s/g,"");var attempt_counter=0;var adcloud_interval=setInterval(function(){attempt_counter++;if(window["AdCloudEvent"]){clearInterval(adcloud_interval);AdCloudEvent(u.data.adobe_org_id,editedReportSuite);processAnalytics();}else if(attempt_counter>u.data.viewthroughmaxtries){clearInterval(adcloud_interval);processAnalytics();}},u.data.viewthroughinterval);}else{processAnalytics();}
function processAnalytics(){if(u.a==="link"){u.ltflag=true;if(typeof u.data.linkTrackVars==="undefined"&&typeof b.linkTrackVars==="undefined"){u.ltv=[];}
if(u.combineLinkVar&&typeof u.data.linkTrackVars!=="undefined"){u.typeCheck(u.data.linkTrackVars,"ltv");}else if(u.combineLinkVar&&typeof b.linkTrackVars!=="undefined"){u.typeCheck(b.linkTrackVars,"ltv");}
if(typeof u.data.linkTrackEvents==="undefined"&&typeof b.linkTrackEvents==="undefined"){u.lte=[];}
if(u.combineLinkVar&&typeof u.data.linkTrackEvents!=="undefined"){u.typeCheck(u.data.linkTrackEvents,"lte");}else if(u.combineLinkVar&&typeof b.linkTrackEvents!=="undefined"){u.typeCheck(b.linkTrackEvents,"lte");}}
u.data.tagdevicetype="standard";u.data.detectserial="yes";for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};try{if(window.sessionStorage){var standardDimensions=sessionStorage.getItem("s_dmdbase")||"";var customDimensions1=sessionStorage.getItem("s_dmdbase_custom1")||"";var customDimensions2=sessionStorage.getItem("s_dmdbase_custom2")||"";var customDimensions3=sessionStorage.getItem("s_dmdbase_custom3")||"";var customDimensions4=sessionStorage.getItem("s_dmdbase_custom4")||"";u.o.contextData.s_dmdbase=standardDimensions;u.o.contextData.s_dmdbase_custom1=customDimensions1;u.o.contextData.s_dmdbase_custom2=customDimensions2;u.o.contextData.s_dmdbase_custom3=customDimensions3;u.o.contextData.s_dmdbase_custom4=customDimensions4;}}
catch(e){utag.DB("AppMeasurement Demandbase Error: "+e.message);}
if(u.data.tagdevicetype==="mobile"){if(b.timestamp||b.timestamp_unix){u.o.timestamp=b.timestamp||b.timestamp_unix;}
u.data.a={"AppID":b.app_id||"","CarrierName":b.carrier||"","DeviceName":b.device||"","HourOfDay":b.lifecycle_hourofday_local||"","DayOfWeek":b.lifecycle_dayofweek_local||"","OSVersion":b.os_version||b.platform_version||"","Resolution":b.device_resolution||""};if(b.lifecycle_type){u.data.a.disable_wake_track=false;u.data.a.disable_sleep_track=false;u.data.a.DaysSinceFirstUse=b.lifecycle_dayssincelaunch||"";u.data.a.DaysSinceLastUpgrade=b.lifecycle_dayssinceupdate||"";u.data.a.DaysSinceLastUse=b.lifecycle_dayssincelastwake||"";u.data.a.Launches=b.lifecycle_launchcount||"";u.data.a.InstallDate=b.lifecycle_firstlaunchdate_MMDDYYYY||"";u.data.a.UpgradeEvent=b.lifecycle_isfirstlaunchupdate||"";u.data.a.PrevSessionLength=b.lifecycle_priorsecondsawake||"";}
if(b.lifecycle_isfirstlaunch){u.data.a.InstallEvent="InstallEvent";}
if(b.lifecycle_diddetectcrash){u.data.a.CrashEvent="CrashEvent";}
if(b.lifecycle_type==="launch"){u.data.a.LaunchEvent="LaunchEvent";}
if(b.lifecycle_isfirslaunchupdate){u.data.a.UpgradeEvent="UpgradeEvent";}}
for(e in utag.loader.GV(u.map)){if(u.data.tagdevicetype==="mobile"){if(typeof b[e]!="undefined"&&typeof u.map[e]=="string"&&u.map[e].indexOf("contextData.a.")>-1){f=u.map[e].split(",");for(g=0;g<f.length;g++){if(f[g].indexOf("contextData.a.")===0){u.data.a[f[g].substring(14)]=b[e];}}}}else if(typeof b[e]!="undefined"&&typeof u.map[e]=="string"&&u.map[e].indexOf("SERIAL_")>-1){f=u.map[e].split(",");for(g=0;g<f.length;g++){if(f[g].indexOf("SERIAL_")===0){u.data.serial[f[g].substring(7)]=b[e];}}}else if(typeof b[e]!="undefined"&&typeof u.map[e]=="string"&&u.map[e].indexOf("PRODUCTS_")>-1){f=u.map[e].split(",");for(g=0;g<f.length;g++){if(f[g].indexOf("PRODUCTS_id")||f[g].indexOf("PRODUCTS_category")||f[g].indexOf("PRODUCTS_quantity")||f[g].indexOf("PRODUCTS_price")){u.data[f[g].substring(9)]=b[e];}}}}
if(u.data.a.disable_wake_track===true||u.data.a.disable_wake_track==="true"){if(b.lifecycle_type==="wake"){return false;}}
if(u.data.a.disable_sleep_track===true||u.data.a.disable_sleep_track==="true"){if(b.lifecycle_type==="sleep"){return false;}}
u.data.id=u.data.id||(typeof b._cprod!="undefined"?b._cprod.slice(0):[]);u.data.category=u.data.category||(typeof b._ccat!="undefined"?b._ccat.slice(0):[]);u.data.quantity=u.data.quantity||(typeof b._cquan!="undefined"?b._cquan.slice(0):[]);u.data.price=u.data.price||(typeof b._cprice!="undefined"?b._cprice.slice(0):[]);if(typeof u.data.id!="undefined"&&u.data.id!=""){c=[];d={};ev={};for(e in utag.loader.GV(u.map)){if(typeof b[e]!="undefined"&&typeof u.map[e]=="string"&&u.map[e].indexOf("PRODUCTS_")>-1){f=u.map[e].split(",");for(g=0;g<f.length;g++){var pv=f[g].substring(9);if(f[g].indexOf("PRODUCTS_evar")==0||f[g].indexOf("PRODUCTS_eVar")==0){if(b[e]instanceof Array){b.sc_prodevars=b.sc_prodevars||[];for(var i=0;i<b[e].length;i++){var prodvars={};if(typeof b.sc_prodevars[i]!="undefined"&&b.sc_prodevars[i]!=""){b.sc_prodevars[i][pv]=b[e][i];}else{prodvars[pv]=b[e][i];b.sc_prodevars.push(prodvars);}}}else{d[pv]=(b[e]+"").split(",");}}else if(f[g].indexOf("PRODUCTS_event")==0){if(b[e]instanceof Array){b.sc_prodevents=b.sc_prodevents||[];for(var i=0;i<b[e].length;i++){var prodevents={};if(typeof b.sc_prodevents[i]!="undefined"&&b.sc_prodevents[i]!=""){b.sc_prodevents[i][pv]=b[e][i];}else{prodevents[pv]=b[e][i];b.sc_prodevents.push(prodevents);}}
u.addEvent(pv);}else if(b[e]!==""){ev[pv]=b[e];u.addEvent(pv);}}}}}
e="";for(f in utag.loader.GV(d)){for(g=0;g<d[f].length;g++){if(e!=""){e+="|"+f+"="+d[f][g];}else{e=f+"="+d[f][g];}}}
h="";for(f in utag.loader.GV(ev)){if(h){h+="|"+f+"="+((isNaN(ev[f]))?"1":ev[f]);}else{h=f+"="+((isNaN(ev[f]))?"1":ev[f]);}}
b.sc_prodevents=b.sc_prodevents||[];b.sc_prodevars=b.sc_prodevars||[];for(d=0;d<u.data.id.length;d++){var h2=h;var h3=e;if(typeof b.sc_prodevents!="undefined"){for(f in b.sc_prodevents[d]){if(typeof b.sc_prodevents[d][f]!="undefined"){var l=b.sc_prodevents[d][f];if(typeof l!="undefined"&&l!=""&&isNaN(l)==false){if(h2){h2+="|"+f+"="+l;}else{h2=f+"="+l;}}}}}
if(typeof b.sc_prodevars!="undefined"){for(f in b.sc_prodevars[d]){if(typeof b.sc_prodevars[d][f]!="undefined"){var l=b.sc_prodevars[d][f];if(typeof l!="undefined"&&l!=""){if(h3){h3+="|"+f+'='+l;}else{h3=f+'='+l;}}}}}
c.push((u.data.category[d]?u.data.category[d]:"")+";"+u.data.id[d]+";"+(u.data.quantity[d]?u.data.quantity[d]:"")+";"+(u.data.price[d]?((u.data.quantity[d]?parseInt(u.data.quantity[d]):1)*parseFloat(u.data.price[d])).toFixed(2):"")+";"+h2+";"+h3);}
if(typeof u.data.sc_addProd!=="undefined"&&u.data.sc_addProd){c.push(u.data.sc_addProd);}
u.o.products=c.join(",");}else{u.o.products="";}
var evt=/^event|prodView|scOpen|scAdd|scRemove|scView|scCheckout|purchase$/;for(c in utag.loader.GV(b)){if(b[c]!==""){f=(""+b[c]).split(",");for(g=0;g<f.length;g++){h=f[g].split(":");d=[];if(u.data.detectserial==="no"){if(typeof u.map[c+":"+h.join(":")]!="undefined"){d=u.map[c+":"+h.join(":")].split(",");}else if(typeof u.map[c]!="undefined"){d=u.map[c].split(",");}}else{if(h.length>1){var subTrigger=h[0];for(var i=1;i<h.length-1;i++){subTrigger+=":"+h[i];}
h[0]=subTrigger;h[1]=h[h.length-1];}
if(typeof u.map[c+":"+h[0]]!="undefined"){d=u.map[c+":"+h[0]].split(",");}else if(typeof u.map[c]!="undefined"){d=u.map[c].split(",");}}
for(e=0;e<d.length;e++){if(d[e]!="events"&&evt.test(d[e])&&d[e].indexOf("SERIAL_")!==0){if(u.data.serial[d[e]]!==undefined&&u.data.serial[d[e]]!==""){u.addEvent(d[e]+":"+u.data.serial[d[e]]);}else{if(u.data.detectserial==="yes"){u.addEvent(d[e]+(h.length>1?":"+h[1]:""));}else{u.addEvent(d[e]);}}}}}}}
for(var m in u.data.a){u.o.contextData["a."+m]=u.data.a[m];u.pushlt(u.ltv,"contextData.a."+m);}
for(c in utag.loader.GV(b)){if(typeof u.map[c]!="undefined"){d=u.map[c].split(",");for(e=0;e<d.length;e++){if(d[e].indexOf("VALUE_")==0){if(u.data.serial[d[e]]!==undefined&&u.data.serial[d[e]]!==""){u.addEvent(d[e].substring(6),b[c]+":"+u.data.serial[d[e]]);}else{u.addEvent(d[e].substring(6),b[c]);}}else if(d[e]=="doneAction"){b.doneAction=b[c];if(b.doneAction!="navigate"){b.doneAction=eval(b[c]);}}else if(d[e].indexOf("c.")==0||d[e].indexOf("contextData.")==0){d[e]=d[e].replace("contextData.","c.");if(!(d[e][2]==="a"&&d[e][3]===".")){u.o.contextData[d[e].substring(2)]=b[c];u.pushlt(u.ltv,"contextData."+d[e].substring(2))}}else{if(c=="sc_events"||c=="sc_prodevents"||c=="sc_prodevars"){utag.DB("Error:6491: Mapping reserved object name "+c)}else{u.o[d[e]]=b[c];}
if(d[e]=="s_account"){u.o.account=b[c];}else if(d[e]=="linkTrackVars"){u.ltflag=false;}else{if(u.combineLinkVar){u.ltflag=true;}
if(d[e]!=="combineLinkVar"){u.pushlt(u.ltv,d[e]);}}}}}}
d=[];for(c in utag.loader.GV(b.sc_events)){if(b.sc_events[c]){d.push(c)}}
if(d.length>0){u.o.events=d.join(",");u.pushlt(u.lte,u.o.events);}else{u.o.events="";}
if(b._ccurrency){u.o.currencyCode=b._ccurrency;}
if(b._corder){u.pushlt(u.lte,"purchase");u.pushlt(u.ltv,"purchaseID");u.o.purchaseID=((u.o.purchaseID)?u.o.purchaseID:b._corder);u.o.events=((u.o.events)?u.o.events:"purchase");if(u.o.events.indexOf("purchase")<0){u.o.events+=",purchase";}}
if(instance){u.o.visitor=instance;}
if(!u.o.visitor){if(typeof visitor!=="undefined"){u.o.visitor=window.visitor;}else if(typeof Visitor!=="undefined"&&typeof Visitor.getInstance!=="undefined"){u.o.visitor=Visitor.getInstance(u.data.adobe_org_id);}}
u.o.cookieDomain=u.o.visitor?u.o.visitor.cookieDomain||u.data.cookieDomain:u.data.cookieDomain;if(u.a==="view"){var img=u.o.t();if(typeof img!=="undefined"&&img!==""){u.img=new Image();u.img.src=img.substring(img.indexOf("src=")+5,img.indexOf("width=")-2);}}else if(u.a==="link"){if(typeof u.ltv!=="undefined"&&u.ltflag){if(u.o.events){u.ltv.push("events");}
if(u.o.products){u.ltv.push("products");}
b.linkTrackVars=u.ltv.join(",");}
if(typeof u.lte!=="undefined"&&u.ltflag){b.linkTrackEvents=u.lte.join(",");}
u.o.linkTrackVars=(b.linkTrackVars)?b.linkTrackVars:"None";u.o.linkTrackEvents=(b.linkTrackEvents)?b.linkTrackEvents:"None";if(!u.data.linkType){if(b.link_type==="download link"){u.data.linkType="d";}else if(b.link_type==="exit link"){u.data.linkType="e";}}
u.o.linkType=u.data.linkType||u.o.linkType||"o";u.data.linkName=u.data.linkName||b.link_name||b.link_text||"no link_name";u.o.tl(((b.link_obj)?b.link_obj:true),u.o.linkType,u.data.linkName,null,(b.doneAction?b.doneAction:null));}
if("no"==="yes"){u.o.registerPostTrackCallback(u.o.clearVars);}};utag.DB("send:6491:COMPLETE");});}};try{utag.o[loader].loader.LOAD(id)}catch(e){utag.loader.LOAD(id)}})("6491","wsi.williamssonoma");}catch(e){utag.DB(e);}

//tealium universal tag - utag.5967 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
var match=/ut\d\.(\d*)\..*/.exec(utag.cfg.v);if(utag.ut.loader===undefined||!match||parseInt(match[1])<41){u.loader=function(o,a,b,c,l,m){utag.DB(o);a=document;if(o.type=="iframe"){m=a.getElementById(o.id);if(m&&m.tagName=="IFRAME"){b=m;}else{b=a.createElement("iframe");}o.attrs=o.attrs||{};utag.ut.merge(o.attrs,{"height":"1","width":"1","style":"display:none"},0);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";}if(o.id){b.id=o.id;}for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){this.onreadystatechange=null;o.cb();}};}}if(o.type!="img"&&!m){l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}}};}else{u.loader=utag.ut.loader;}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={"view":1,"link":1};u.hasgtagjs=function(){window.gtagRename=window.gtagRename||""||"gtag";if(typeof window[window.gtagRename]==="function"){return true;}
var i,s=document.getElementsByTagName("script");for(i=0;i<s.length;i++){if(s[i].src&&s[i].src.indexOf("gtag/js")>=0){return true;}}
window.dataLayer=window.dataLayer||[];window[window.gtagRename]=function(){dataLayer.push(arguments);};window[window.gtagRename]("js",new Date());};u.initialized=u.hasgtagjs();u.scriptrequested=false;u.queue=[];u.o=window[window.gtagRename];u.map_func=function(arr,obj,item){var i=arr.shift();obj[i]=obj[i]||{};if(arr.length>0){u.map_func(arr,obj[i],item);}else{obj[i]=item;}};u.hasOwn=function(o,a){return o!=null&&Object.prototype.hasOwnProperty.call(o,a);};u.isEmptyObject=function(o,a){for(a in o){if(u.hasOwn(o,a)){return false;}}return true;};u.map={"privacy_opt_out_LDU":"rdpOptOut,gtag_enable_tcf_support","gtag_dcacctid":"advertiser_id","random_order_id":"order_id"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pb-us':'DC-3372346'},{'we-us':'DC-3372350'},{'pk-us':'DC-3372349'},{'ws-us':'DC-3372348'},{'pt-us':'DC-3352677'},{'mg-us':'DC-3753551'},{'pb-ca':'DC-9015880'},{'pk-ca':'DC-9015883'},{'we-ca':'DC-8796002'},{'ws-ca':'DC-9016789'},{'rj-us':'DC-3451600'},{'gr-us':'DC-12862152'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['gtag_dcacctid']=c[e][f];m=true};};if(m)break};if(!m)b['gtag_dcacctid']='';}}];u.loader_cb=function(a,b){utag.DB("send:5967:CALLBACK");u.initialized=true;var i,j,_event,p,key;for(i=0;i<u.data.advertiser_id.length;i++){u.o("config",u.data.advertiser_id[i]);}
if(u.data.order_id){for(i=0;i<u.data.event.length;i++){if(u.data.event[i]==="purchase"){p=true;}}
if(!p){u.data.event.push("purchase");}}
var total_qty=1;if(typeof(u.data.product_quantity)==="number"){total_qty=u.data.product_quantity;}else if(u.data.product_quantity.length===1){total_qty=u.data.product_quantity[0];}else if(u.data.product_quantity.length>1){for(i=0;i<u.data.product_quantity.length;i++){total_qty+=parseInt(u.data.product_quantity[i],10);}}
for(i=0;i<u.data.event.length;i++){_event=u.data.event[i];for(j=0;j<u.data.advertiser_id.length;j++){var eventIdData={};if(u.data.custom_scripts==="true"||u.data.custom_scripts){eventIdData.allow_custom_scripts=true;}else if(u.data.custom_scripts==="false"||!u.data.custom_scripts){eventIdData.allow_custom_scripts=false;}
if(u.data.session_id.length===1&&u.data.session_id[0]!==""){eventIdData.session_id=u.data.session_id[0];}else if(u.data.session_id[j]!==""){eventIdData.session_id=u.data.session_id[j];}
if(u.data.order_total){eventIdData.value=u.data.order_total;eventIdData.transaction_id=b.random_order_id||utag_data.random_order_id||"";}
if(u.data.product_quantity){eventIdData.quantity=total_qty;}
for(key in u.data.custom){eventIdData[key]=u.data.custom[key];}
if(!u.isEmptyObject(u.data.dc_custom_params)){eventIdData.dc_custom_params={};for(key in u.data.dc_custom_params){eventIdData.dc_custom_params[key]=u.data.dc_custom_params[key];}}
eventIdData.send_to=u.data.advertiser_id[j]+"/"+u.data.activity_group[j]+"/"+u.data.activity[j]+"+"+u.data.counting_method[j];if(_event==="purchase"){u.o("event","purchase",eventIdData);}
if(_event==="conversion"){u.o("event","conversion",eventIdData);}}}
utag.DB("send:5967:CALLBACK:COMPLETE");};u.callBack=function(){var data={};while(data=u.queue.shift()){u.data=data.data;u.loader_cb(data.a,data.b);}};u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){utag.DB("send:5967");utag.DB(b);var d,e,f,h;u.data={"qsp_delim":"&","kvp_delim":"=","base_url":"https://www.googletagmanager.com/gtag/js","advertiser_id":"","activity_group":"","activity":"","counting_method":"","custom_scripts":"true","session_id":"","product_quantity":[],"dc_custom_params":{},"event_name":"","event":[],"custom":{}};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:5967:EXTENSIONS");utag.DB(b);for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.map_func(e[f].split("."),u.data,b[d]);}}else{h=d.split(":");if(h.length===2&&b[h[0]]===h[1]){if(u.map[d]){u.data.event=u.data.event.concat(u.map[d].split(","));}}}}
utag.DB("send:5967:MAPPINGS");utag.DB(u.data);u.data.order_id=u.data.order_id||b._corder||"";u.data.order_total=u.data.order_total||b._ctotal||"";if(u.data.product_quantity.length===0&&b._cquan!==undefined){u.data.product_quantity=b._cquan.slice(0);}
if(typeof(u.data.advertiser_id)==="string"){u.data.advertiser_id=u.data.advertiser_id.split(",");}
if(typeof(u.data.activity_group)==="string"){u.data.activity_group=u.data.activity_group.split(",");}
if(typeof(u.data.activity)==="string"){u.data.activity=u.data.activity.split(",");}
if(typeof(u.data.counting_method)==="string"){u.data.counting_method=u.data.counting_method.split(",");}
if(typeof(u.data.session_id)==="string"){u.data.session_id=u.data.session_id.split(",");}
if(!u.data.advertiser_id){utag.DB(u.id+": Tag not fired: Required attribute not populated");return;}
u.data.base_url+="?id="+(u.data.advertiser_id[0]);if(u.initialized){u.loader_cb(a,b);}else{u.queue.push({"data":u.data,"a":a,"b":b});if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":"script","src":u.data.base_url,"cb":u.callBack,"loc":"script","id":"utag_5967","attrs":{}});}}
utag.DB("send:5967:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("5967","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.5349 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{if(typeof utag.runonce=='undefined')utag.runonce={};if(!utag.libloader){utag.libloader=function(src,handler,a,b){a=document;b=a.createElement('script');b.language='javascript';b.type='text/javascript';b.src=src;if(typeof handler=='function'){b.handlerFlag=0;b.onreadystatechange=function(){if((this.readyState=='complete'||this.readyState=='loaded')&&!b.handlerFlag){b.handlerFlag=1;handler()}};b.onload=function(){if(!b.handlerFlag){b.handlerFlag=1;handler()}};}
a.getElementsByTagName('head')[0].appendChild(b)}};(function(id,loader,u){u=utag.o[loader].sender[id]={};u.ev={'view':1};u.map={"experian_cust_id":"custId","experian_entity":"entityId","experian_facebook_enabled":"enableFacebook","experian_social_enabled":"enableSocialEvents","experian_site_id":"siteId"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pt-us':'100092'},{'mg-us':'100096'},{'pk-us':'100091'},{'we-us':'100093'},{'ws-us':'100097'},{'pb-us':'100090'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['experian_cust_id']=c[e][f];m=true};};if(m)break};if(!m)b['experian_cust_id']='';}},function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pt-us':'3'},{'mg-us':'7'},{'pk-us':'1'},{'we-us':'6'},{'ws-us':'5'},{'pb-us':'4'},{'pk-ca':'14'},{'we-ca':'12'},{'ws-ca':'15'},{'pb-ca':'13'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['experian_site_id']=c[e][f];m=true};};if(m)break};if(!m)b['experian_site_id']='0';}},function(a,b,c,d,e,f,g){if(1){d=b['market'];if(typeof d=='undefined')return;c=[{'us':'111'},{'ca':'377'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['experian_entity']=c[e][f];m=true};};if(m)break};if(!m)b['experian_entity']='';}}];u.send=function(a,b,c,d,e,f){if(u.ev[a]||typeof u.ev.all!="undefined"){var data={};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};for(d in utag.loader.GV(u.map)){if(typeof b[d]!='undefined'){e=u.map[d].split(',');for(f=0;f<e.length;f++){data[e[f]]=b[d];}}}
if(typeof utag.runonce['5349']=='undefined'){utag.runonce['5349']=1;window.cnvAsyncInit=function(){Cnv.init({'custId':data.custId||'','entityId':data.entityId||'111','restLink':'sts.eccmp.com','enableFacebook':(data.enableFacebook?true:false),'enableSocialEvents':(data.enableSocialEvents?true:false)});if(b._corder||data.ORDER_ID){var dt=new Date().toISOString().replace("T"," ").replace("Z","");Cnv.PostWebEvent({'ORDER_ID':data.ORDER_ID||b._corder,'ORDER_TOTAL':data.ORDER_TOTAL||b._csubtotal,'TIMESTAMP':dt},data.siteId);}};}
utag.ut.loader({src:'//sts.eccmp.com/sts/scripts/conversen-SDK.js',id:'tealium_experian_5349'});};}
try{utag.o[loader].loader.LOAD(id)}catch(e){utag.loader.LOAD(id)}})('5349','wsi.williamssonoma');}catch(e){}

//tealium universal tag - utag.5997 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}
if(utag.ut===undefined){utag.ut={};}
if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}
if(o.id){b.id=o.id;}
if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}
l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'view':1};u.initialized=false;u.map={};u.extend=[];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,i;u.data={};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
!function(a,b,c,d,e,f,g){a.ktag||(e=function(){e.sendEvent?e.sendEvent(arguments):e.ktq.push(arguments)},e.ktq=[],a.ktag=e,f=b.getElementsByTagName(d)[0],g=b.createElement(d),g.async=!0,g.src=c,f.parentNode.appendChild(g))}(window,document,"//resources.xg4ken.com/js/v2/ktag.js?tid=KT-N27A1-3F0","script");ktag('setup','KT-N27A1-3F0',u.data.userId);}};utag.o[loader].loader.LOAD(id);})("5997","wsi.williamssonoma");}catch(error){utag.DB(error);}
//tealium universal tag - utag.5348 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
var br_data=br_data||{};try{(function(id,loader,u){u=utag.o[loader].sender[id]={};u.ev={'view':1,'link':1};u.data={};u.data.ptype="product";u.account="";u.map={"br_page_type":"ptype","br_account_id":"acct_id","br_category_path":"cat","br_category_id":"cat_id","search_keyword":"search_term","_corder":"order_id","_csubtotal":"order_subtotal","_cprodname":"product_name","_cprod":"product_id","_csku":"product_sku","_cquan":"product_quantity","_cprice":"product_unit_price","br_action":"action","br_group":"group","br_type":"type","pmc_searchTerm":"q","experienceType":"abtest","searchTermEntered":"qa","domain_key":"domain_key"};u.extend=[function(a,b){try{if(b['pmc_prop36']!='shopping app:native'){try{b['domain_key']=pmc.getNestedValue(digitalData,"page.attributes.bloomreachDomainKey")||pmc.getNestedValue(window.WSI,"search.domainKey")||pmc.getNestedValue(window.__INITIAL_STATE__,"product.brConfig.domainKey")||pmc.getNestedValue(window.__INITIAL_STATE__,"shop.brConfig.domainKey")||pmc.getBloomreachDomainKeyFromLocalStorage("BR_CONFIG")}catch(e){}}}catch(e){utag.DB(e);}},function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pb-us':'4068'},{'pt-us':'4070'},{'mg-us':'5095'},{'pk-us':'4071'},{'we-us':'4083'},{'ws-us':'4060'},{'ws-ca':'6532'},{'pb-ca':'6533'},{'pk-ca':'6534'},{'we-ca':'6535'},{'pt-ca':'6741'},{'rj-us':'7022'},{'gr-us':'7244'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['br_account_id']=c[e][f];m=true};};if(m)break};if(!m)b['br_account_id']='';}},function(a,b,c,d,e,f,g){if(1){d=b['page_type'];if(typeof d=='undefined')return;c=[{'product':'product'},{'search':'search'},{'category':'category'},{'order':'other'},{'home':'homepage'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['br_page_type']=c[e][f];m=true};};if(m)break};if(!m)b['br_page_type']='other';}},function(a,b){if(typeof b.order_discount_amount!='undefined'&&b.order_discount_amount>0){for(c=0;c<b._cprice.length;c++){try{if(b._cpdisc[c]>0){b._cprice[c]=(parseFloat(b._cprice[c])-parseFloat(b._cpdisc[c])).toFixed(2);}}catch(e){};}}},function(a,b){try{if((b['pmc_pageName']!='checkout'&&b['tealium_event']!='purchase')){try{b['_csku']=[]}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if((typeof b['_cprod']!='undefined'&&typeof b['_corder']!='undefined'&&typeof b['_corder']!='undefined'&&b['_corder']!='')){b['_cprodname']=b['_cprod']}}catch(e){utag.DB(e);}},function(a,b){try{if((typeof b['pmc_scAdd']!='undefined'&&b['pmc_scAdd']=='scAdd')){b['br_action']='click-add';b['br_group']='cart';b['br_type']='event'}}catch(e){utag.DB(e);}},function(a,b){try{if(b['page_type']!='product'){b['br_category_id']=b['br_category_path']}}catch(e){utag.DB(e);}},function(a,b){try{if(b['page_type'].toString().toLowerCase()=='product'.toLowerCase()){b['br_category_path']=''}}catch(e){utag.DB(e);}},function(a,b){try{if(1){var searchElement=document.getElementById("search-field");if(b.pmc_searchTerm&&b.pmc_searchTerm.length>0&&typeof(searchElement)==="object"){if(b.pmc_searchTerm!==searchElement.value){b.searchTermEntered=searchElement.value;}}}}catch(e){utag.DB(e)}}];u.send=function(a,b){u.data={};u.data.ptype="product";window.br_data={};if(u.ev[a]||typeof u.ev.all!="undefined"){for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};var c,d,e,f;for(d in utag.loader.GV(u.map)){if(typeof b[d]!="undefined"&&b[d]!=""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
br_data.acct_id=u.account||u.data.acct_id;br_data.type=u.data.type||"pageview";if(u.data.domain_key){br_data.domain_key=u.data.domain_key;}
if(br_data.type==="event"){br_data.ptype="event";}else{br_data.ptype=u.data.ptype;}
u.data.order_id=u.data.order_id||b._corder;if(u.data.order_id){br_data.basket={items:[]};br_data.order_id=u.data.order_id;br_data.is_conversion=1;br_data.basket_value=u.data.basket_value||b._csubtotal;u.data.prod_id=u.data.prod_id||b._cprod.slice(0);u.data.sku=u.data.sku||b._csku.slice(0);u.data.prod_name=u.data.prod_name||b._cprodname.slice(0);u.data.quantity=u.data.quantity||b._cquan.slice(0);u.data.price=u.data.price||b._cprice.slice(0);for(d=0;d<u.data.prod_id.length;d++){br_data.basket.items.push({"prod_id":u.data.prod_id[d],"sku":u.data.sku[d],"name":u.data.prod_name[d],"quantity":u.data.quantity[d],"price":u.data.price[d]});}}else{br_data.is_conversion=0;br_data.cat=u.data.cat;if(u.data.group){br_data.group=u.data.group;}
if(u.data.action){br_data.action=u.data.action;if(br_data.action==="click-add"){br_data.type="event";}}
if(u.data.q&&u.data.q.length>0){br_data.search_term=br_data.q=u.data.q;br_data.abtest=u.data.abtest;br_data.type="event";}
if(u.data.cat_id){br_data.cat_id=u.data.cat_id;}
if(u.data.search_term){br_data.search_term=u.data.search_term;}
if(u.data.abtest){br_data.abtest=u.data.abtest;}
if(u.data.ptype=="product"){br_data.prod_id=u.data.prod_id||b._cprod+"";br_data.prod_name=u.data.prod_name||b._cprodname+"";br_data.sku=u.data.sku||b._csku+"";br_data.price=u.data.price||b._cprice+"";br_data.sale_price=u.data.sale_price||u.data.price;if(u.data.pstatus){br_data.pstatus=u.data.pstatus;}}}
if(br_data.type==="event"&&typeof BrTrk==="object"&&typeof BrTrk.getTracker==="function"&&typeof BrTrk.getTracker().logEvent==="function"){if(typeof(u.data.q)!=="undefined"&&u.data.q.length>0){var searchData={};searchData["q"]=searchData["search_term"]=u.data.q;if(u.data.qa&&u.data.qa.length>0){searchData["aq"]=u.data.qa;BrTrk.getTracker().logEvent("suggest","click",searchData,{},true);}else{BrTrk.getTracker().logEvent("suggest","submit",searchData,{},true);}}else{BrTrk.getTracker().logEvent(br_data.group,br_data.action,{'prod_id':br_data.prod_id,'sku':br_data.sku,'price':br_data.price});}}else{u.base_url=location.protocol=="https:"?"https://cdns.brsrvr.com/v1/"+"br-trk-"+br_data.acct_id+".js":"http://cdn.brcdn.com/v1/"+"br-trk-"+br_data.acct_id+".js";u.s=document.getElementsByTagName("script")[0];u.scr=document.createElement("script");u.scr.type="text/javascript";u.scr.src=u.base_url;u.s.parentNode.insertBefore(u.scr,u.s);}}}
utag.o[loader].loader.LOAD(id);})('5348','wsi.williamssonoma');}catch(e){}

//tealium universal tag - utag.5370 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
window.orderData=[];try{(function(id,loader,u){u=utag.o[loader].sender[id]={};u.ev={'view':1};u.data={};u.data.retailer="Populated_by_extension";u.base_url="//tracking.deepsearch.adlucent.com/adl.js";u.map={"adlucent_retailer_id":"retailer","adlucent_customer_type":"customerType"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'ws-us':'williamssonoma'},{'pb-us':'potterybarn'},{'pk-us':'potterybarnkids'},{'pt-us':'potterybarnteen'},{'we-us':'westelm'},{'mg-us':'markandgraham'},{'pb-ca':'potterybarnca'},{'pk-ca':'potterybarnkidsca'},{'we-ca':'westelmca'},{'ws-ca':'williamssonomaca'},{'pt-ca':'potterybarnteenca'},{'rj-us':'rejuvenation'},{'gr-us':'greenrow'},{'mg-ca':'markandgrahamca'},{'rj-ca':'rejuvenationca'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['adlucent_retailer_id']=c[e][f];m=true};};if(m)break};if(!m)b['adlucent_retailer_id']='';}},function(a,b){if(typeof b.order_discount_amount!='undefined'&&b.order_discount_amount>0){for(c=0;c<b._cprice.length;c++){try{if(b._cpdisc[c]>0){b._cprice[c]=(parseFloat(b._cprice[c])-parseFloat(b._cpdisc[c])).toFixed(2);}}catch(e){};}}},function(a,b){try{if(1){(function(){var adlDays=30;var adlRetailer=b.adlucent_retailer_id;adlDomain=pmc.environment.brandDomain+"."+pmc.environment.primaryDomain;if(!adlDomain){adlDomain="markandgraham.com";}
var qs=document.location.search;var clickid;var legacyClickId;var adlName;var legacyAdlPxID;var adlPxID;var adlURL;var host;var gclidFromHttpOnly=b.wsid_gclid;var adlclidFromHttpOnly=b.wsid_adlclid;if(/[?&]gclid=/.test(qs)){adlName="gclid";}else if(/[?&]adlclid=/.test(qs)){adlName="adlclid";}
if(adlName){legacyClickId=qs.substring(qs.match("[?&]"+adlName.toString()+"=").index+adlName.length+2).split("&")[0];}
clickid=legacyClickId||adlclidFromHttpOnly||gclidFromHttpOnly;if(pmc.environment.primaryDomain==="ca"){host="tracking.deepsearch.adlucent.com";}else{host="adltrk."+adlDomain;}
if(clickid){adlURL=document.location.protocol+"//"+host+"/adlucent/Redirector/cbeacon?retailer="+adlRetailer+"&clickid="+clickid;var pix=new Image(1,1);pix.src=adlURL;}
if(/[?&]adlpxid=/.test(qs)){adlPxID=qs.substring(qs.match("[?&]adlpxid=").index+9).split("&")[0];adlURL=document.location.protocol+"//tracking.deepsearch.adlucent.com/adlucent/Redirector/beacon?retailer="+adlRetailer+"&clickid="+adlClkID+"&pixelid="+adlPxID;var pix=new Image(1,1);pix.src=adlURL;}})();if(b.tealium_event!=="purchase"){return false;}}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){if(1){d=b['order_has_bopis'];if(typeof d=='undefined')return;c=[{'true':'bopis'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['adlucent_customer_type']=c[e][f];m=true};};if(m)break};if(!m)b['adlucent_customer_type']='regular';}}];u.send=function(a,b){if(u.ev[a]||typeof u.ev.all!="undefined"){for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};var c,d,e,f;c=[];for(d in utag.loader.GV(u.map)){if(typeof b[d]!="undefined"&&b[d]!=""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
var getCookieValue=function(a){if(typeof(WSI)!=="undefined"&&typeof(WSI.RequestCookie)!=="undefined"&&typeof(WSI.RequestCookie.consume)!=="undefined"){return WSI.RequestCookie.consume(a);}else{var b=document.cookie.match('(^|;)\\s*'+a+'\\s*=\\s*([^;]+)');return b?b.pop():'';}}
window.clickId=getCookieValue("_adlClkID")||utag_data.wsid_gclid||utag_data.wsid_adlclid;window.retailer=u.data.retailer;window.customerID=u.data.customerID||b._ccustid;if(u.data.customerType){window.customerType=u.data.customerType;}
window.orderKey=u.data.orderKey||b._corder;u.data.sku=u.data.sku||(b._csku?b._csku.slice(0):[]);u.data.qty=u.data.qty||(b._cquan?b._cquan.slice(0):[]);u.data.price=u.data.price||(b._cprice?b._cprice.slice(0):[]);u.data.category=u.data.category||(b._ccat?b._ccat.slice(0):[]);u.data.tax=u.data.tax||b._ctax;u.data.shipping=u.data.shipping||b._cship;for(var i=0;i<u.data.sku.length;i++){window.orderData.push([u.data.sku[i],u.data.qty[i],u.data.price[i],u.data.category[i]]);}
u.s=document.getElementsByTagName("script")[0];u.scr=document.createElement("script");u.scr.type="text/javascript";u.scr.src=u.base_url;u.s.parentNode.insertBefore(u.scr,u.s);}}
utag.o[loader].loader.LOAD(id);})('5370','wsi.williamssonoma');}catch(e){}

//tealium universal tag - utag.5423 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'view':1};u.initialized=false;u.map={"sc_visitor_id":"userid"};u.extend=[];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,i;u.data={"base_url":"//services.xg4ken.com/js/kenshoo.js","userid":""
};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
u.loader_cb=function(){u.initialized=true;kenshoo.match(u.data.userid);};if(!u.initialized){u.loader({"type":"script","src":u.data.base_url,"cb":u.loader_cb,"loc":"script","id":'utag_5423'});}else{u.loader_cb();}
}};utag.o[loader].loader.LOAD(id);})("5423","wsi.williamssonoma");}catch(error){utag.DB(error);}

//tealium universal tag - utag.5684 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(1){u.loader=function(o){var b,c,l,a=document;var isIE8=(("Microsoft Internet Explorer"==navigator.appName||0<=navigator.appName.indexOf("MSIE ")||0<=navigator.appName.indexOf("Trident/")&&0<=navigator.appName.indexOf("Windows NT 6"))&&a.documentMode===8);utag.DB("isIE8 = "+isIE8);if(o.type==="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l];}b.src=o.src;}if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener&&!isIE8){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}};}else{u.loader=utag.ut.loader;}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
if(utag.ut.merge===undefined){u.merge=function(a,b,c,d){if(c){for(d in utag.loader.GV(b)){a[d]=b[d];}}else{for(d in utag.loader.GV(b)){if(typeof a[d]=="undefined"){a[d]=b[d];}}}};}else{u.merge=utag.ut.merge;}
u.ev={"view":1,"link":1};u.initialized=false;u.scriptrequested=false;u.queue=[];u.event_lookup={"ViewContent":{obj:"vc","map":["value","currency","content_name","content_ids","content_category"]},"ViewCategory":{obj:"cat","map":["value","currency","content_name","content_category"]},"Search":{obj:"search","map":["value","currency","content_category","content_ids"]},"AddToCart":{obj:"cart","map":["value","currency","content_name","content_ids"]},"AddToWishlist":{obj:"wish","map":["value","currency","content_name","content_ids"]},"InitiateCheckout":{obj:"cout","map":["value","currency","content_name","content_ids","num_items"]},"AddPaymentInfo":{obj:"payment","map":["value","currency","content_category","content_ids"]},"Purchase":{obj:"purch","map":["value","currency","content_name","content_ids","num_items"]},"Lead":{obj:"lead","map":["value","currency","content_name","content_category"]},"CompleteRegistration":{obj:"reg","map":["value","currency","content_name"]},"Conversion":{obj:"cnv","map":["value","currency"]},"Custom":{obj:"cust","map":["currency"]},"PageView":{obj:"page","map":["currency"]}};u.std_params={"value":function(g,event){if(g.value===undefined||g.value===""){if(event==="ViewContent"||event==="AddToCart"){g.value=u.data.ecom.product_unit_price;}else{g.value=u.data.ecom.order_subtotal;}}
g.value=u.val(g.value);},"currency":function(g){if(!g.currency){g.currency=u.data.ecom.order_currency;}},"content_name":function(g){if(!g.content_name){g.content_name=u.data.ecom.product_name;}
g.content_name=u.val(g.content_name);},"content_ids":function(g){if(!g.content_ids){g.content_ids=u.data.ecom.product_id;}
if(u.typeOf(g.content_ids)!=="array"){g.content_ids=g.content_ids.split(/\s*,\s*/);}},"content_category":function(g){if(!g.content_category){g.content_category=u.data.ecom.product_category;}
g.content_category=u.val(g.content_category);},"num_items":function(g){if(!g.num_items&&u.data.calc_items==="true"){g.num_items=u.calc_items(u.data.ecom.product_quantity);}}};u.map_func=function(arr,obj,item){var i=arr.shift();obj[i]=obj[i]||{};if(arr.length>0){u.map_func(arr,obj[i],item);}else{obj[i]=item;}};u.val=function(value){return u.typeOf(value)==="array"?value[0]:value;};u.hasOwn=u.hasOwn||function(o,a){return o!==null&&Object.prototype.hasOwnProperty.call(o,a);};u.isEmptyObject=u.isEmptyObject||function(o,a){for(a in o){if(utag.ut.hasOwn(o,a))
return false;}
return true;};u.remove_empty=function(a){var b,t;for(b in utag.loader.GV(a)){t=u.typeOf(a[b]);if(t==="undefined"||typeof(a[b])==="undefined"){}else if(t==="object"){u.remove_empty(a[b]);if(u.isEmptyObject(a[b])){try{delete a[b];}catch(e){a[b]=undefined;}}}else if(!((a[b]===0||a[b]===false)?!0:(t==="array"&&a[b].length===0)?!1:!!a[b])){try{delete a[b];}catch(e){a[b]=undefined;}}}
return a;};u.calc_items=function(quan){var q,i=0;for(q=0;q<quan.length;q++){i+=parseInt(quan[q]);}
return i;};u.map={"fb_tw_pixel_id":"cust_pixel","fb_tw_events:ViewContent":"ViewContent","fb_tw_events:AddToCart":"AddToCart","fb_tw_events:Purchase":"Purchase","fb_tw_events:PageView":"PageView","fb_tw_events:Lead":"Lead","fb_tw_events:Search":"Search","fb_tw_events:ViewCategory":"ViewCategory","fb_tw_events:CompleteRegistration":"CompleteRegistration","fb_tw_events:Schedule":"Schedule","fb_tw_content_type":"vc.content_type,cart.content_type,purch.content_type","fb_tw_content_id":"vc.content_ids,cart.content_ids,purch.content_ids","fb_tw_content_name":"vc.content_name,page.content_name,cart.content_name,purch.content_name,cat.content_name","search_keyword":"search.search_string","new_site_visitor_90":"page.new_site_visitor_90,vc.new_site_visitor_90,search.new_site_visitor_90,cart.new_site_visitor_90,purch.new_site_visitor_90,lead.new_site_visitor_90,cnv.new_site_visitor_90,cat.new_site_visitor_90,cd[new_site_visitor_90]","cart_value":"page.cart_total,purch.value,page.value","currency_code":"order_currency","bopisType":"purch.pickup","privacy_opt_out_LDU":"privacy_opt_out_LDU","privacy_opt_out_geo_on":"privacy_opt_out_geo_on","turn_top_cat":"vc.TopCat,cart.TopCat,purch.TopCat,cat.TopCat","top_category":"vc.SuperCat,cart.SuperCat,cat.SuperCat,cat.content_category,page.content_category,vc.content_category","page_section1":"page.content_category","customer_email":"am.em"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pb-us':'243121982709292'},{'pt-us':'1590282707954567'},{'pk-us':'1579730225689260'},{'we-us':'217516805287861'},{'ws-us':'632714243545814'},{'mg-us':'1549874091973373'},{'we-ca':'215539945689296'},{'pb-ca':'442096549537242'},{'pk-ca':'222103425039949'},{'ws-ca':'1690645707685070'},{'pt-ca':'1097232447794367'},{'rj-us':'253969768280495'},{'gr-us':'744642447077338'},{'mg-ca':'511146281074562'},{'rj-ca':'234937642462763'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['fb_tw_pixel_id']=c[e][f];m=true};};if(m)break};}},function(a,b){try{if((typeof b['pmc_pageName']!='undefined'&&typeof b['pmc_pageName']!='undefined'&&b['pmc_pageName']!='')){b['fb_tw_content_name']=b['pmc_pageName']}}catch(e){utag.DB(e);}},function(a,b){try{if((typeof b['pmc_event42']!='undefined'&&b['pmc_event42'].toString().toLowerCase().indexOf('event41'.toLowerCase())>-1)||(typeof b['pmc_event41']!='undefined'&&b['pmc_event41'].toString().toLowerCase().indexOf('event41'.toLowerCase())>-1)){b['_cprod']=b['product_sku'];b['fb_tw_content_id']=b['_cprod'];b['fb_tw_content_type']='product_group'}}catch(e){utag.DB(e);}},function(a,b){try{if((typeof b['product_id']!='undefined'&&typeof b['pmc_scAdd']!='undefined'&&b['pmc_scAdd']=='scAdd'&&typeof b['product_quantity']!='undefined'&&typeof b['product_unit_price']!='undefined')){b['fb_tw_content_id']=b['product_id'];b['_csubtotal']=b['subtotal_price'];b['fb_tw_content_type']='product_group';b['_cquan']=b['product_quantity'];b['_cprice']=b['product_unit_price']}}catch(e){utag.DB(e);}},function(a,b){try{if((typeof b['page_type']!='undefined'&&b['page_type']=='order')){b['fb_tw_content_type']='product_group'}}catch(e){utag.DB(e);}},function(a,b){try{if((typeof b['page_type']!='undefined'&&b['page_type']=='product')){b['fb_tw_content_type']='product_group'}}catch(e){utag.DB(e);}},function(a,b){try{if(1){try{b['top_category']=(function(){return b["top_category"]})();}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(parseFloat(b['days_since_last_visit'])>parseFloat(90)||b['cp.utag_main__sn']=='1'){b['new_site_visitor_90']='true'}}catch(e){utag.DB(e);}},function(a,b){try{if((typeof b['_cprice']!='undefined'&&b['page_name'].toString().toLowerCase().indexOf('cart'.toLowerCase())>-1)){try{b['cart_value']=(function(){var total=0;for(var i=0;i<b._cprice.length;i++){total+=parseFloat(b._cprice[i]);}return total.toFixed(2);})();}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(1){if(utag_data["pmc_event115"]){b["bopisType"]="in_store";}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){var fbEventName=function(tevent){if(tevent==="purchase"){return"Purchase";}else if(tevent==="search_results"){return"Search";}else if(tevent==="qudini_scheduling_appointment_confirmation"){return"Schedule";}else if(tevent==="category_view"){return"ViewCategory";}else if(tevent==="product_view"||tevent==="quicklook"||tevent==="quickbuy"){return"ViewContent";}else if(tevent==="registry_create"){return"CompleteRegistration";}else if(tevent==="contest_view"||tevent==="email_signup"){return"Lead";}else if(tevent==="cart_add"){return"AddToCart";}else if(a==="view"){return"PageView";}
return"";};b.fb_tw_events=fbEventName(b.tealium_event);}}catch(e){utag.DB(e)}},function(a,b){try{if(1){var turnTopCatMap=[{key:"pb",value:"potterybarn",},{key:"pb-apartment",value:"pb-apartment",},{key:"ws-kitchen",value:"ws-kitchen",},{key:"ws-home",value:"ws-home",},{key:"we",value:"west-elm",},{key:"we-collection",value:"west-elm-collection",},{key:"we-kids",value:"west-elm",},{key:"pt",value:"pbteen",},{key:"pt-dorm",value:"pbdorm",},{key:"pk",value:"pk-kids",},{key:"pk-baby",value:"pk-baby",},{key:"pk-modern-baby",value:"pk-baby",},{key:"mg",value:"markandgraham",},{key:"rj",value:"rejuvenation",},{key:"gr",value:"greenrow",},];b.turn_top_cat=pmc.resolveMapLookup(turnTopCatMap,b.subBrand);}}catch(e){utag.DB(e)}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,g,h,evt=[];u.data={"qsp_delim":"&","kvp_delim":"=","base_url":"https://connect.facebook.net/en_US/fbevents.js","cust_pixel":"NOT DEFINED","conv_pixel":"OVERRIDE FROM EXTENSTION","page_view":"false","calc_items":"true","default_event":"None","custom_data":{},"custom_event":"","product_id":[],"product_name":[],"product_category":[],"product_unit_price":[],"product_quantity":[],"evt_list":[],"ecom":{}};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};c=[];for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.map_func(e[f].split("."),u.data,b[d]);}}else{h=d.split(":");if(h.length===2&&b[h[0]]===h[1]){if(u.map[d]){evt=evt.concat(u.map[d].split(","));}}}}
u.data["cm.em"]=u.data["cm.em"]||utag_data.customer_email;u.data["cm.ex"]=u.data["cm.ex"]||utag_data.sc_visitor_id;if(u.data["cm.em"]||u.data["cm.ex"]){u.data.am={em:u.data["cm.em"],external_id:u.data["cm.ex"],};}
u.data.privacy_opt_out_LDU=u.data.privacy_opt_out_LDU||utag_data.privacy_opt_out_LDU;u.data.privacy_opt_out_geo_on=u.data.privacy_opt_out_geo_on||utag_data.privacy_opt_out_geo_on;if(u.data.evt_list&&u.typeOf(u.data.evt_list)!=="array"){u.data.evt_list=u.data.evt_list.split(/\s*,\s*/);}
if(u.data.default_event!=="None"&&u.data.default_event!==""){u.data.evt_list.push(u.data.default_event);}
u.data.evt_list=u.data.evt_list.concat(evt);g=u.data.ecom;g.order_id=u.data.order_id||b._corder||"";g.order_subtotal=u.data.order_subtotal||b._csubtotal||"";g.order_currency=u.data.order_currency||b._ccurrency||"";if(u.data.product_name.length===0&&b._cprodname!==undefined){g.product_name=b._cprodname.slice(0);}else{g.product_name=u.data.product_name;}
if(u.data.product_id.length===0&&b._cprod!==undefined){g.product_id=b._cprod.slice(0);}else{g.product_id=u.data.product_id;}
if(u.data.product_category.length===0&&b._ccat!==undefined){g.product_category=b._ccat.slice(0);}else{g.product_category=u.data.product_category;}
if(u.data.product_unit_price.length===0&&b._cprice!==undefined){g.product_unit_price=b._cprice.slice(0);}else{g.product_unit_price=u.data.product_unit_price;}
if(u.data.product_quantity.length===0&&b._cquan!==undefined){g.product_quantity=b._cquan.slice(0);}else{g.product_quantity=u.data.product_quantity;}
u.loader_cb=function(){var g={},i,j,_event,_track="track";if(u.data.evt_list.toString().indexOf("Purchase")===-1&&u.data.ecom.order_id){u.data.evt_list.push("Purchase");}
if(u.data.cust_pixel&&typeof(u.data.cust_pixel)==="string"){u.data.cust_pixel=u.data.cust_pixel.split(/\s*,\s*/);for(i=0;i<u.data.cust_pixel.length;i++){u.data.cust_pixel[i]=u.data.cust_pixel[i].replace(/^\s*/,"").replace(/\s*$/,"");}}
for(i=0;i<u.data.evt_list.length;i++){_event=u.data.evt_list[i];f=u.event_lookup[_event];c=f?f.map:[];f=f?f.obj:_event;g=u.data[f]||{};for(j=0;j<c.length;j++){u.std_params[c[j]](g,_event);}
if(u.data.privacy_opt_out_LDU){if(u.data.privacy_opt_out_geo_on){fbq('dataProcessingOptions',['LDU'],0,0);}else{fbq('dataProcessingOptions',['LDU']);}}
if(pmc.wsiTrackingEvent||(window.WSI.tracking&&window.WSI.tracking.wsiTracking)){pmc.wsiTrackingEvent=pmc.wsiTrackingEvent||{};u.data.generate_event_id=true;u.data["fb_event_id_"+_event]=pmc.wsiTrackingEvent.eventId||window.WSI.tracking.wsiTracking.eventId;var event_id={eventID:u.data["fb_event_id_"+_event],};}
if(_event==="PageView"){fbq("trackSingle",u.data.cust_pixel[i],"PageView",u.data.page,event_id);}else if(_event==="ViewContent"){fbq(_track,_event,u.remove_empty(g),event_id);}else if(_event==="AddToCart"){fbq(_track,_event,u.remove_empty(g),event_id);}else if(_event==="CompleteRegistration"){fbq("trackSingle",u.data.cust_pixel[i],_event,event_id);}else if(_event==="Lead"){if(!g.content_category){g.content_category='Quote';}}else if(_event==="Search"){if(!g.content_category){g.content_category='Product Search';}}else if(_event==="Conversion"&&u.data.conv_pixel){_event=u.data.conv_pixel;}else if(_event==="Schedule"){fbq("trackSingle",u.data.cust_pixel[i],_event,event_id);}else if(_event==="ViewCategory"){fbq("track","PageView",g);_track="trackCustom";fbq(_track,_event,u.remove_empty(g),event_id);}else if(_event==="Purchase"){g.order_id=u.data.ecom.order_id;fbq("trackSingle",u.data.cust_pixel[i],_event,u.remove_empty(g),event_id);}else if(_event&&!u.event_lookup[_event]){_track="trackCustom";g=u.data[_event];}
if(g.value!==undefined){if(u.typeOf(g.value)==="array"){for(j=0;j<g.value.length;j++){g.value[j]=parseFloat(g.value[j])||0.00;}}else{g.value=parseFloat(g.value)||0.00;}}}};u.callBack=function(){var data={};u.initialized=true;while(data=u.queue.shift()){u.data=data.data;u.loader_cb();}};if(u.initialized){u.loader_cb();}else{u.queue.push({"data":u.data});if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":"script","src":u.data.base_url,"cb":u.callBack,"loc":"script","id":'utag_5684'});!function(f,b,e){if(f.fbq)return;e=f.fbq=function(){e.callMethod?e.callMethod.apply(e,arguments):e.queue.push(arguments);};if(!f._fbq)f._fbq=e;e.push=e;e.loaded=!0;e.version='2.0';e.queue=[];e.agent='tmtealium';}(window,document);if(u.data.cust_pixel&&typeof(u.data.cust_pixel)==="string"){u.data.cust_pixel=u.data.cust_pixel.split(/\s*,\s*/);for(var i=0;i<u.data.cust_pixel.length;i++){u.data.cust_pixel[i]=u.data.cust_pixel[i].replace(/^\s*/,"").replace(/\s*$/,"");fbq('init',u.data.cust_pixel[i],u.data.am);}}}}
}};utag.o[loader].loader.LOAD(id);}("5684","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.5733 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
if(!window.pintrk){window.pintrk=function(){window.pintrk.queue.push(Array.prototype.slice.call(arguments));};var n=window.pintrk;n.queue=[];n.version="3.0";}
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
var match=/ut\d\.(\d*)\..*/.exec(utag.cfg.v);if(utag.ut.loader===undefined||!match||parseInt(match[1])<41){u.loader=function(o,a,b,c,l,m){utag.DB(o);a=document;if(o.type=="iframe"){m=a.getElementById(o.id);if(m&&m.tagName=="IFRAME"){b=m;}else{b=a.createElement("iframe");}o.attrs=o.attrs||{};utag.ut.merge(o.attrs,{"height":"1","width":"1","style":"display:none"},0);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";}if(o.id){b.id=o.id;}for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){this.onreadystatechange=null;o.cb();}};}}if(o.type!="img"&&!m){l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}}};}else{u.loader=utag.ut.loader;}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={"view":1,"link":1};u.initialized=false;u.scriptrequested=false;u.queue=[];u.event_lookup={"pagevisit":"PageVisit","viewcategory":"ViewCategory","search":"Search","addtocart":"AddToCart","checkout":"Checkout","watchvideo":"WatchVideo","signup":"Signup","lead":"Lead","custom":"Custom"};u.map={"pinterest_tag_id":"tag_id","page_name":"page_title,page_name","page_category":"page_category","tealium_event:registry_add":"custom","tealium_event:cart_add":"addtocart","tealium_event:purchase":"checkout","tealium_event:search_results":"search","tealium_event:category_view":"viewcategory","tealium_event:product_view":"pagevisit","tealium_event:registry_create":"signup","tealium_event:qudini_scheduling_appointment_confirmation":"lead","_csku":"product_id","product_quantity":"product_quantity","product_unit_price":"product_unit_price","pinterest_lead_type":"lead_type","customer_email":"hashed_email"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pb-us':'2618408691251'},{'ws-us':'2618074099223'},{'we-us':'2614022238023'},{'pk-us':'2616372569770'},{'pt-us':'2620680115104'},{'mg-us':'2617390407915'},{'pb-ca':'2613281419836'},{'rj-us':'2617494128148'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['pinterest_tag_id']=c[e][f];m=true};};if(m)break};if(!m)b['pinterest_tag_id']='';}},function(a,b){try{if(b['tealium_event']=='cart_add'){b['_csubtotal']=b['subtotal_price'];b['_cquan']=b['product_quantity'];b['_cprice']=b['product_unit_price']}}catch(e){utag.DB(e);}},function(a,b){try{if(b['tealium_event']=='qudini_scheduling_appointment_confirmation'){b['pinterest_lead_type']='design_crew'}}catch(e){utag.DB(e);}}];u.loader_cb=function(a,b,c){utag.DB("send:5733:CALLBACK");u.initialized=true;var obj={};if(u.data.order_subtotal){obj.value=parseFloat(u.data.order_subtotal);}
if(u.data.order_currency){obj.currency=u.data.order_currency;}
if(u.data.property){obj.property=u.data.property;}
if(u.data.search_query){obj.search_query=u.data.search_query;}
if(u.data.order_coupon_code){obj.promo_code=u.data.order_coupon_code;}
if(u.data.page_title){obj.page_title=u.data.page_title;}
if(u.data.video_title){obj.video_title=u.data.video_title;}
if(u.data.lead_type){obj.lead_type=u.data.lead_type;}
if(u.data.product_id&&u.data.product_id.length){obj.line_items=[];for(var i=0;i<u.data.product_id.length;i++){var item={};if(u.data.product_id&&u.data.product_id[i]){item.product_id=u.data.product_id[i];}
if(u.data.product_name&&u.data.product_name[i]){item.product_name=u.data.product_name[i];}
if(u.data.product_unit_price&&u.data.product_unit_price[i]){item.product_price=parseFloat(u.data.product_unit_price[i]);}
if(u.data.product_category&&u.data.product_category[i]){item.product_category=u.data.product_category[i];}
if(u.data.product_variant&&u.data.product_variant[i]){item.product_variant=u.data.product_variant[i];}
if(u.data.product_variant_id&&u.data.product_variant_id[i]){item.product_variant_id=u.data.product_variant_id[i];}
if(u.data.product_brand&&u.data.product_brand[i]){item.product_brand=u.data.product_brand[i];}
if(u.data.product_quantity&&u.data.product_quantity[i]){item.product_quantity=parseInt(u.data.product_quantity[i]);if(u.data.order_id){if(!obj.order_quantity){obj.order_quantity=0;}
obj.order_quantity+=item.product_quantity;}}
obj.line_items.push(item);}}
if(u.data.order_id){u.data.event='checkout';obj.order_id=u.data.order_id;}
if(!u.data.event){u.data.event="PageVisit";}
if(pmc.wsiTrackingEvent||(window.WSI.tracking&&window.WSI.tracking.wsiTracking)){pmc.wsiTrackingEvent=pmc.wsiTrackingEvent||{};obj.event_id=pmc.wsiTrackingEvent.eventId||window.WSI.tracking.wsiTracking.eventId;}
if(Object.keys(obj).length===0&&obj.constructor===Object){return;}else{pintrk('track',u.data.event,obj,u.track_error);}
utag.DB("send:5733:CALLBACK:COMPLETE");};u.callBack=function(){var data={};while(data=u.queue.shift()){u.data=data.data;u.loader_cb();}};u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){utag.DB("send:5733");utag.DB(b);var c,d,e,f;u.data={"qsp_delim":"&","kvp_delim":"=","base_url":"https://s.pinimg.com/ct/core.js","tag_id":"","page_name":"","page_category":"","event":"","product_variant":"","product_variant_id":"","property":"","search_query":"","page_title":"","video_title":"","lead_type":"","hashed_email":"","product_id":[],"product_name":[],"product_brand":[],"product_category":[],"product_quantity":[],"product_unit_price":[]};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:5733:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}else{h=d.split(":");if(h.length===2&&b[h[0]]===h[1]){if(u.map[d]){u.data.event=u.data.event.concat(u.map[d].split(","));}}}}
utag.DB("send:5733:MAPPINGS");utag.DB(u.data);u.data.order_id=u.data.order_id||b._corder||"";u.data.order_subtotal=u.data.order_subtotal||b._csubtotal||"";u.data.order_currency=u.data.order_currency||b._ccurrency||"";u.data.order_coupon_code=u.data.order_coupon_code||b._cpromo||"";u.data.hashed_email=u.data.hashed_email||utag_data.customer_email;if(u.data.product_id.length===0&&b._cprod!==undefined){u.data.product_id=b._cprod.slice(0);}
if(u.data.product_name.length===0&&b._cprodname!==undefined){u.data.product_name=b._cprodname.slice(0);}
if(u.data.product_brand.length===0&&b._cbrand!==undefined){u.data.product_brand=b._cbrand.slice(0);}
if(u.data.product_category.length===0&&b._ccat!==undefined){u.data.product_category=b._ccat.slice(0);}
if(u.data.product_quantity.length===0&&b._cquan!==undefined){u.data.product_quantity=b._cquan.slice(0);}
if(u.data.product_unit_price.length===0&&b._cprice!==undefined){u.data.product_unit_price=b._cprice.slice(0);}
if(u.data.event.length===0&&b._cevent!==undefined){u.data.event=(u.typeOf(b._cevent)==="array")?b._cevent.slice(0):[b._cevent];}
u.data.page_name=u.data.page_name||b["dom.title"];if(!u.data.tag_id){utag.DB(u.id+": Tag not fired: Required attribute not populated");return;}
u.track_error=function(didInit,error){utag.DB("u.track_error: ",error);if(!didInit){utag.DB(error);}}
if(u.scriptrequested){u.loader_cb(a,b,c);}else{u.queue.push({"data":u.data});pintrk('load',u.data.tag_id,{em:u.data.hashed_email});pintrk('page',{page_name:u.data.page_name,page_category:u.data.page_category,});if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":"script","src":u.data.base_url,"cb":u.callBack,"loc":"script","id":"utag_5733","attrs":{}});}}
utag.DB("send:5733:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("5733","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.5917 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
var match=/ut\d\.(\d*)\..*/.exec(utag.cfg.v);if(utag.ut.loader===undefined||!match||parseInt(match[1])<41){u.loader=function(o,a,b,c,l,m){utag.DB(o);a=document;if(o.type=="iframe"){m=a.getElementById(o.id);if(m&&m.tagName=="IFRAME"){b=m;}else{b=a.createElement("iframe");}o.attrs=o.attrs||{};utag.ut.merge(o.attrs,{"height":"1","width":"1","style":"display:none"},0);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";}if(o.id){b.id=o.id;}for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){this.onreadystatechange=null;o.cb();}};}}if(o.type!="img"&&!m){l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}}};}else{u.loader=utag.ut.loader;}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={"view":1,"link":1};u.initialized=false;u.scriptrequested=false;u.queue=[];u.map_func=function(arr,obj,item){var i=arr.shift();obj[i]=obj[i]||{};if(arr.length>0){u.map_func(arr,obj[i],item);}else{obj[i]=item;}};u.clearEmptyKeys=function(object){for(var key in object){if(object[key]===""||object[key]===undefined){delete object[key];}}
return object;};u.buildItems=function(data){var maxLength=0;for(var key in data.ecom){if(data.ecom[key].length>maxLength){maxLength=data.ecom[key].length;}}
for(var key in data.ecom){if(maxLength!==data.ecom[key].length&&data.ecom[key].length!==0){utag.DB("WARNING : Missing Data in "+key);}}
for(var i=0;i<maxLength;i++){var temp={};for(var key in data.ecom){if(maxLength===data.ecom[key].length){var identifier=key.slice(8);temp[identifier]=data.ecom[key][i];}}
data.property.items.push(temp);}};u.map={"action_tracker":"actionTrackerId","registry_id":"property.orderId","order_has_bopis":"property.text2,bopis","wsid_ir_clickid":"clickid","sc_visitor_id":"customerId","customer_email_public":"customerEmail"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'ws-us':'9675'},{'pb-us':'9792'},{'pk-us':'9794'},{'pt-us':'9796'},{'we-us':'9797'},{'mg-us':'9800'},{'we-ca':'17403'},{'rj-us':'9798'},{'gr-us':'36848'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['action_tracker_order']=c[e][f];m=true};};if(m)break};}},function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'ws':'9676'},{'pb':'9793'},{'pk':'9795'},{'we':'9799'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['action_tracker_registry']=c[e][f];m=true};};if(m)break};}},function(a,b){try{if((typeof b['order_id']!='undefined'&&typeof b['order_id']!='undefined'&&b['order_id']!='')){b['action_tracker']=b['action_tracker_order'];b['tealium_event']='purchase'}}catch(e){utag.DB(e);}},function(a,b){try{if(b['tealium_event']=='registry_create'){b['action_tracker']=b['action_tracker_registry']}}catch(e){utag.DB(e);}}];u.loader_cb=function(a,b,c){utag.DB("send:5917:CALLBACK");u.initialized=true;try{if(!u.data.identifyFired){u.data.identifyFired=true;u.data.customerId=u.data.customerId||"";u.data.customerEmail=u.data.customerEmail||"";ire('identify',{customerId:u.data.customerId,customerEmail:u.data.customerEmail});}}catch(e){utag.DB("error in Impact Radius identify call: "+e);}
var propertyArray=u.data.property;for(var ind=0;ind<propertyArray.length;ind++){var properties=propertyArray[ind];var options={};if(b.tealium_event==="purchase"){properties.text2=u.data.bopis?"BOPIS Indo":"";ire('trackConversion',u.data.actionTrackerId,properties,options);}else if(properties.tealium_event==="registry_create"){properties.orderId=digitalData.page.attributes.registryStoreId||b.registry_id||"";ire('trackConversion',u.data.actionTrackerId,properties,options);}else if(b.tealium_event==="cart_view"){ire('trackCart',u.data.actionTrackerId,properties,options);}}
utag.DB("send:5917:CALLBACK:COMPLETE");};u.callBack=function(){var data={};while(data=u.queue.shift()){u.data=data.data;u.loader_cb(data.a,data.b,data.c);}};u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){utag.DB("send:5917");utag.DB(b);var c,d,e,f;u.data={"qsp_delim":"&","kvp_delim":"=","base_url":"//d.impactradius-event.com/","actionTrackerId":"","scriptName":"A225183-fe20-421f-acda-5e941f92935b1.js","property":[],"options":[],"customerId":"","customerEmail":"","clickid":"",}
for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:5917:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.map_func(e[f].split("."),u.data,b[d]);}}}
utag.DB("send:5917:MAPPINGS");utag.DB(u.data);if(!u.data.scriptName){utag.DB(u.id+": Tag not fired: Required attribute not populated");return;}
try{if(b['tealium_event']==="purchase"&&typeof(digitalData.x_transaction)!=="undefined"&&typeof(digitalData.x_transaction.orders)!=="undefined"){var orderArray=digitalData.x_transaction.orders;for(var i=0;i<orderArray.length;i++){var order=orderArray[i];var irOrder={items:[]};irOrder.orderId=order.orderID;if(typeof(order.promoCode)!=="undefined"){irOrder.orderPromoCode=order.promoCode.toString();}else if(typeof(order.promos)!=="undefined"){irOrder.orderPromoCode=order.promos.toString();}
u.data.clickid=u.data.clickid||b.wsid_ir_clickid||utag_data.wsid_ir_clickid
if(u.data.clickid){irOrder.clickId=u.data.clickid;}
irOrder.currencyCode=b._ccurrency;irOrder.customerCity=b._ccity||"";irOrder.customerCountry=b._ccountry||"";if(typeof(order.items)!=="undefined"&&order.items.length>0){var itemArray=order.items;irOrder.text1="";for(var j=0;j<itemArray.length;j++){var item=itemArray[j];var irItem={};irItem.sku=item.productID.sku;irItem.name=item.productID.prodID;irItem.category="CATEGORY";irItem.quantity=item.quantity;var itemPrice=item.price.unitPrice;irItem.subTotal=0;if(!isNaN(itemPrice)&&!isNaN(irItem.quantity)){irItem.subTotal=irItem.quantity*itemPrice;}
if(typeof(item.attributes.registryStoreId)!=="undefined"){irOrder.text1="registry_order";}
irOrder.items.push(irItem);}}
u.data.property.push(irOrder);}}else if((b['tealium_event']==="registry_create"||b['tealium_event']==="registryCreation")&&!utag.impactRadiusRegistryFired&&(b.registry_id||s.eVar34)){utag.impactRadiusRegistryFired=true;b.registry_id=b.registry_id||s.eVar34;var irRegistry={tealium_event:"registry_create",text1:"",orderId:b.registry_id,clickId:u.data.clickid,};u.data.property.push(irRegistry);}}catch(e){utag.DB("error in Impact Radius custom code"+e);}
u.data.base_url+=u.data.scriptName;u.buildItems(u.data);if(u.initialized){u.loader_cb(a,b,c);}else{u.queue.push({"data":u.data,"a":a,"b":b,"c":c});if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":"script","src":u.data.base_url,"cb":u.callBack,"loc":"script","id":"utag_5917","attrs":{}});}}
utag.DB("send:5917:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("5917","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.5921 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'view':1};u.initialized=false;u.map={"gtag_dcacctid":"dcacctid","gtag_eventpath":"eventpath","pmc_pageName":"custom.u4,u4","category_id":"u5,custom.u5","order_id":"u1,custom.u1","sc_visitor_id":"custom.u12"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pb-us':'DC-3372346'},{'we-us':'DC-3372350'},{'pk-us':'DC-3372349'},{'ws-us':'DC-3372348'},{'pt-us':'DC-3352677'},{'mg-us':'DC-3753551'},{'pb-ca':'DC-9015880'},{'pk-ca':'DC-9015883'},{'we-ca':'DC-8796002'},{'ws-ca':'DC-9016789'},{'rj-us':'DC-3451600'},{'gr-us':'DC-12862152'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['gtag_dcacctid']=c[e][f];m=true};};if(m)break};if(!m)b['gtag_dcacctid']='';}},function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'pb':'/sitesup/pbsit0+unique'},{'we':'/sitesup/wesit0+unique'},{'pk':'/sitesup/pksit0+unique'},{'ws':'/sitesup/wssit0+unique'},{'pt':'/sitesup/ptsit0+unique'},{'mg':'/sitesup/mgsit0+unique'},{'rj':'/sitesup/wssit0+unique'},{'gr':'/sitesup2/grsit00+unique'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['gtag_eventpath']=c[e][f];m=true};};if(m)break};if(!m)b['gtag_eventpath']='';}},function(a,b){try{if(1){try{b['gtag_event_type']=(function(){if(typeof(b.order_id)!=="undefined"&&b.order_id.length>0){return"purchase"}else{return"conversion"};})();}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(1){if(!pmc.readCookie("doubleclick_24h")){pmc.writeCookie("doubleclick_24h","true",1*24*60);}}}catch(e){utag.DB(e)}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,i;u.data={};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
window.dataLayer=window.dataLayer||[];function gtag(){window.dataLayer.push(arguments);};var sendObj={'allow_custom_scripts':true,'send_to':u.data.dcacctid+u.data.eventpath};if(typeof(u.data.u9)==="undefined"){u.data.u9="";}else{sendObj.u9=u.data.u9;}
if(typeof(u.data.u4)==="undefined"){u.data.u4="";}else{sendObj.u4=u.data.u4;}
if(typeof(u.data.u5)==="undefined"){u.data.u5="";}else{sendObj.u5=u.data.u5;}
gtag('config',u.data.dcacctid);gtag('event','conversion',sendObj);}};utag.o[loader].loader.LOAD(id);})("5921","wsi.williamssonoma");}catch(error){utag.DB(error);}

//tealium universal tag - utag.5959 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader,u){try{u=utag.o[loader].sender[id]={}}catch(e){u=utag.sender[id]};u.ev={'view':1};u.kvp_delim="=";u.acct="";u.cid="";u.tagtype="r.turn.com";u.base_url="";u.map={"turn_b2":"acct"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pt-us':'93jf1PuNa9RFiW9a1hSfz9ApNqFwZJCL6qjaayNK8bunrWIKKC9atrUI1qHXbokTvk30si4P3wMzRJ-4tFOeMA'},{'pk-us':'0lIJI-XfoZPX2F7dlvnMtyX856p9CSKM5BetCwHd2pGnrWIKKC9atrUI1qHXbokT7kUD98s2iVxnkILw-EWR9A'},{'we-us':'4nIqyWhQj64jCYGRRSqc0v8KSUJ4KhcKqFWY0hzql22sCJLkQIhfpxDKJ4UubRDPQiHPzfAEwwpKWY5nSYm_vg'},{'ws-us':'M3EzYFzVbAnYc99jIwZhuOeCvuRHBaR0mOgSBYrbx9KnrWIKKC9atrUI1qHXbokTCU2kkhdHpqb_oZbqIlaB6w'},{'mg-us':'3TChac9RBcPUtKIkyLv5cfvdFerHDvA6H5OmDMYexYanrWIKKC9atrUI1qHXbokTXNqW4Ac0YAJMU0HddcmR0A'},{'pb-us':'K5lem3lK5AIYkYo2OIZPyKZRH5ZdIcc8Oxe53hYTUqBfJqTKGXGQ6XncON9JIrldzYroZ6FV4LbkaYVUBFk2Dw'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['turn_b2']=c[e][f];m=true};};if(m)break};}},function(a,b){try{if(1){if(a==="link"&&b.associatedTags){return false;}}}catch(e){utag.DB(e)}}];u.send=function(a,b,c,d,e,f){if(u.ev[a]||typeof u.ev.all!="undefined"){for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};c=[];for(d in utag.loader.GV(u.map)){if(typeof b[d]!=="undefined"&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(e[f]=="cid"){u.cid=encodeURIComponent(b[d]);}else if(e[f]=="acct"||e[f]=="b2"){u.acct=encodeURIComponent(b[d]);}else{c.push(e[f]+u.kvp_delim+encodeURIComponent(b[d]));}}}}
if(u.tagtype=="r.turn.com"){u.base_url="//r.turn.com/r/beacon?b2="+u.acct+"&cid="+u.cid;if(c.length>0){u.base_url+="&"};u.img=new Image();u.img.src=u.base_url+c.join("&");}else{u.base_url="//d.turn.com/r/dd/id/L21rdC8yNTcvY2lkLzI0OTE3MTg2L3QvMA/dpuid/"+u.acct+"/kv/";u.s=document.getElementsByTagName("script")[0];u.scr=document.createElement("script");u.scr.type="text/javascript";u.scr.src=u.base_url+c.join(",");u.s.parentNode.insertBefore(u.scr,u.s);}}}
try{utag.o[loader].loader.LOAD(id)}catch(e){utag.loader.LOAD(id)}})('5959','wsi.williamssonoma');}catch(e){}

//tealium universal tag - utag.6024 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'view':1};u.initialized=false;u.map={"gtag_dcacctid":"dcacctid","gtag_eventpath":"eventpath","pmc_pageName":"custom.u4,u4","category_id":"u5,custom.u5","order_id":"u1,custom.u1","sc_visitor_id":"custom.u12"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pb-us':'DC-3372346'},{'we-us':'DC-3372350'},{'pk-us':'DC-3372349'},{'ws-us':'DC-3372348'},{'pt-us':'DC-3352677'},{'mg-us':'DC-3753551'},{'pb-ca':'DC-9015880'},{'pk-ca':'DC-9015883'},{'we-ca':'DC-8796002'},{'ws-ca':'DC-9016789'},{'rj-us':'DC-3451600'},{'gr-us':'DC-12862152'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['gtag_dcacctid']=c[e][f];m=true};};if(m)break};if(!m)b['gtag_dcacctid']='';}},function(a,b){try{if(1){try{b['gtag_event_type']=(function(){if(typeof(b.order_id)!=="undefined"&&b.order_id.length>0){return"purchase"}else{return"conversion"};})();}catch(e){}}}catch(e){utag.DB(e);}},function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'pb':'/sitesup/pbsit00+standard'},{'we':'/sitesup/wesit00+standard'},{'pk':'/sitesup/pksit00+standard'},{'ws':'/sitesup/wssit00+standard'},{'pt':'/sitesup/ptsit00+standard'},{'mg':'/sitesup/mgsit00+standard'},{'rj':'/sitesup/wssit0+unique'},{'gr':'/sitesup1/grsit0+standard'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['gtag_eventpath']=c[e][f];m=true};};if(m)break};if(!m)b['gtag_eventpath']='';}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,i;u.data={};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
window.dataLayer=window.dataLayer||[];function gtag(){window.dataLayer.push(arguments);};var sendObj={'allow_custom_scripts':true,'send_to':u.data.dcacctid+u.data.eventpath};if(typeof(u.data.u9)==="undefined"){u.data.u9="";}else{sendObj.u9=u.data.u9;}
if(typeof(u.data.u4)==="undefined"){u.data.u4="";}else{sendObj.u4=u.data.u4;}
if(typeof(u.data.u5)==="undefined"){u.data.u5="";}else{sendObj.u5=u.data.u5;}
gtag('config',u.data.dcacctid);gtag('event','conversion',sendObj);}};utag.o[loader].loader.LOAD(id);})("6024","wsi.williamssonoma");}catch(error){utag.DB(error);}

//tealium universal tag - utag.6103 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
var uetq=uetq||[];try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
var match=/ut\d\.(\d*)\..*/.exec(utag.cfg.v);if(utag.ut.loader===undefined||!match||parseInt(match[1])<41){u.loader=function(o,a,b,c,l,m){utag.DB(o);a=document;if(o.type=="iframe"){m=a.getElementById(o.id);if(m&&m.tagName=="IFRAME"){b=m;}else{b=a.createElement("iframe");}o.attrs=o.attrs||{};utag.ut.merge(o.attrs,{"height":"1","width":"1","style":"display:none"},0);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";}if(o.id){b.id=o.id;}for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){this.onreadystatechange=null;o.cb();}};}}if(o.type!="img"&&!m){l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}}};}else{u.loader=utag.ut.loader;}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={"view":1,"link":1};u.initialized=false;u.scriptrequested=false;u.queue=[];u.map_func=function(arr,obj,item){var i=arr.shift();obj[i]=obj[i]||{};if(arr.length>0){u.map_func(arr,obj[i],item);}else{obj[i]=item;}};u.clearEmptyKeys=function(object){for(var key in object){if(object[key]===""||object[key]===undefined){delete object[key];}}
return object;};u.items=function(eventData){var i,items=[];if(eventData&&u.typeOf(eventData.product_id)==="array"&&eventData.product_id.length>0){for(i=0;i<eventData.product_id.length;i++){var config={};if(eventData.product_brand){config.brand=eventData.product_brand[i];}else{config.brand=u.data.product_brand[i];}
if(eventData.product_category){config.category=eventData.product_category[i];}else{config.category=u.data.product_category[i];}
if(eventData.product_creative_name){config.creative_name=eventData.product_creative_name[i];}else{config.creative_name=u.data.product_creative_name[i];}
if(eventData.product_creative_slot){config.creative_slot=eventData.product_creative_slot[i];}else{config.creative_slot=u.data.product_creative_slot[i];}
if(eventData.product_id){config.id=eventData.product_id[i];}else{config.id=u.data.product_id[i];}
if(eventData.product_location_id){config.location_id=eventData.product_location_id[i];}else{config.location_id=u.data.product_location_id[i];}
if(eventData.product_name){config.name=eventData.product_name[i];}else{config.name=u.data.product_name[i];}
if(eventData.product_unit_price){config.price=eventData.product_unit_price[i];}else{config.price=u.data.product_unit_price[i];}
if(eventData.product_quantity){config.quantity=eventData.product_quantity[i];}else{config.quantity=u.data.product_quantity[i];}
items.push(config);}}else if(eventData&&u.data.product_id.length>0){for(i=0;i<u.data.product_id.length;i++){var config={};if(eventData.product_brand){config.brand=eventData.product_brand[i];}else{config.brand=u.data.product_brand[i];}
if(eventData.product_category){config.category=eventData.product_category[i];}else{config.category=u.data.product_category[i];}
if(eventData.product_creative_name){config.creative_name=eventData.product_creative_name[i];}else{config.creative_name=u.data.product_creative_name[i];}
if(eventData.product_creative_slot){config.creative_slot=eventData.product_creative_slot[i];}else{config.creative_slot=u.data.product_creative_slot[i];}
if(eventData.product_id){config.id=eventData.product_id[i];}else{config.id=u.data.product_id[i];}
if(eventData.product_location_id){config.location_id=eventData.product_location_id[i];}else{config.location_id=u.data.product_location_id[i];}
if(eventData.product_name){config.name=eventData.product_name[i];}else{config.name=u.data.product_name[i];}
if(eventData.product_unit_price){config.price=eventData.product_unit_price[i];}else{config.price=u.data.product_unit_price[i];}
if(eventData.product_quantity){config.quantity=eventData.product_quantity[i];}else{config.quantity=u.data.product_quantity[i];}
items.push(config);}}else if(u.data.product_id.length>0){for(i=0;i<u.data.product_id.length;i++){var config={};if(u.data.product_brand){config.brand=u.data.product_brand[i];}
if(u.data.product_category){config.category=u.data.product_category[i];}
if(u.data.product_creative_name){config.creative_name=u.data.product_creative_name[i];}
if(u.data.product_creative_slot){config.creative_slot=u.data.product_creative_slot[i];}
if(u.data.product_id){config.id=u.data.product_id[i];}
if(u.data.product_location_id){config.location_id=u.data.product_location_id[i];}
if(u.data.product_name){config.name=u.data.product_name[i];}
if(u.data.product_unit_price){config.price=u.data.product_unit_price[i];}
if(u.data.product_quantity){config.quantity=u.data.product_quantity[i];}
items.push(config);}}
return items;};u.promotions=function(eventData){var i,items=[];if(eventData&&u.typeOf(eventData.promotion_id)==="array"&&eventData.promotion_id.length>0){for(i=0;i<eventData.promotion_id.length;i++){var config={};if(eventData.promotion_creative_name){config.creative_name=eventData.promotion_creative_name[i];}else{config.creative_name=u.data.promotion_creative_name[i];}
if(eventData.promotion_creative_slot){config.creative_slot=eventData.promotion_creative_slot[i];}else{config.creative_slot=u.data.promotion_creative_slot[i];}
if(eventData.promotion_id){config.id=eventData.promotion_id[i];}else{config.id=u.data.promotion_id[i];}
if(eventData.promotion_name){config.name=eventData.promotion_name[i];}else{config.name=u.data.promotion_name[i];}
items.push(config);}}else if(eventData&&u.data.promotion_id.length>0){for(i=0;i<u.data.promotion_id.length;i++){var config={};if(eventData.promotion_creative_name){config.creative_name=eventData.promotion_creative_name[i];}else{config.creative_name=u.data.promotion_creative_name[i];}
if(eventData.promotion_creative_slot){config.creative_slot=eventData.promotion_creative_slot[i];}else{config.creative_slot=u.data.promotion_creative_slot[i];}
if(eventData.promotion_id){config.id=eventData.promotion_id[i];}else{config.id=u.data.promotion_id[i];}
if(eventData.promotion_name){config.name=eventData.promotion_name[i];}else{config.name=u.data.promotion_name[i];}
items.push(config);}}else if(u.data.promotion_id.length>0){for(i=0;i<u.data.promotion_id.length;i++){var config={};if(u.data.promotion_creative_name){config.creative_name=u.data.promotion_creative_name[i];}
if(u.data.promotion_creative_slot){config.creative_slot=u.data.purchaseId[i];}
if(u.data.promotion_id){config.id=u.data.promotion_id[i];}
if(u.data.promotion_name){config.name=u.data.promotion_name[i];}
items.push(config);}}
return items;};u.event_map={"add_payment_info":[],"add_to_cart":[{"name":"event_value"},{"name":"currency"},{"name":"items"}],"add_to_wishlist":[{"name":"event_value"},{"name":"currency"},{"name":"items"}],"begin_checkout":[{"name":"event_value"},{"name":"currency"},{"name":"items"},{"name":"coupon"}],"checkout_progress":[{"name":"event_value"},{"name":"currency"},{"name":"items"},{"name":"coupon"},{"name":"checkout_step"},{"name":"checkout_option"}],"exception":[{"name":"description"},{"name":"fatal"}],"generate_lead":[{"name":"event_value"},{"name":"currency"},{"name":"transaction_id"}],"login":[{"name":"method"}],"page_view":[],"purchase":[{"name":"transaction_id"},{"name":"event_value"},{"name":"currency"},{"name":"tax"},{"name":"shipping"},{"name":"items"},{"name":"coupon"}],"refund":[{"name":"transaction_id"},{"name":"event_value"},{"name":"currency"},{"name":"tax"},{"name":"shipping"},{"name":"items"}],"remove_from_cart":[{"name":"event_value"},{"name":"currency"},{"name":"items"}],"screen_view":[{"name":"screen_name"}],"search":[{"name":"search_term"}],"select_content":[{"name":"items"},{"name":"promotion"},{"name":"content_type"},{"name":"content_id"}],"set_checkout_option":[{"name":"checkout_step"},{"name":"checkout_option"}],"share":[{"name":"method"},{"name":"content_type"},{"name":"content_id"}],"sign_up":[{"name":"method"}],"timing_complete":[{"name":"name"},{"name":"event_value"}],"view_item":[{"name":"items"}],"view_item_list":[{"name":"items"}],"view_promotion":[{"name":"promotions"}],"view_search_results":[{"name":"search_term"}],"retail":[{"name":"event_action"},{"name":"ecomm_prodid"},{"name":"ecomm_pagetype"},{"name":"ecomm_totalvalue"},{"name":"ecomm_category"}],"travel":[{"name":"event_action"},{"name":"travel_destid"},{"name":"travel_originid"},{"name":"travel_pagetype"},{"name":"travel_startdate"},{"name":"travel_enddate"},{"name":"travel_totalvalue"}],"hotel":[{"name":"event_action"},{"name":"hct_bpr"},{"name":"hct_tpr"},{"name":"hct_bid"},{"name":"hct_cid"},{"name":"hct_cod"},{"name":"hct_los"},{"name":"hct_pid"},{"name":"hct_pagetype"}]};u.std_params={"event_value":function(_event){if(u.data[_event]&&u.data[_event].event_value){return u.data[_event].event_value;}else if(u.data.event_value){return u.data.event_value;}else if(u.data[_event]&&u.data[_event].order_subtotal){return u.data[_event].order_subtotal;}else{return u.data.order_subtotal;}},"event_action":function(_event){if(u.data[_event]&&u.data[_event].event_action){return u.data[_event].event_action;}else{return u.data.event_action;}},"event_label":function(_event){if(u.data[_event]&&u.data[_event].order_subtotal){return u.data[_event].order_subtotal;}else{return u.data.order_subtotal;}},"event_category":function(_event){if(u.data[_event]&&u.data[_event].event_category){return u.data[_event].event_category;}else{return u.data.event_category;}},"currency":function(_event){if(u.data[_event]&&u.data[_event].order_currency){return u.data[_event].order_currency;}else{return u.data.order_currency;}},"items":function(_event){return u.items(u.data[_event]);},"coupon":function(_event){if(u.data[_event]&&u.data[_event].order_coupon_code){return u.data[_event].order_coupon_code;}else{return u.data.order_coupon_code;}},"checkout_step":function(_event){if(u.data[_event]&&u.data[_event].checkout_step){return u.data[_event].checkout_step;}else{return u.data.checkout_step;}},"checkout_option":function(_event){if(u.data[_event]&&u.data[_event].checkout_option){return u.data[_event].checkout_option;}else{return u.data.checkout_option;}},"description":function(_event){if(u.data[_event]&&u.data[_event].description){return u.data[_event].description;}else{return u.data.description;}},"fatal":function(_event){if(u.data[_event]&&u.data[_event].fatal){return u.data[_event].fatal;}else{return u.data.fatal;}},"tax":function(_event){if(u.data[_event]&&u.data[_event].order_tax){return u.data[_event].order_tax;}else{return u.data.order_tax;}},"shipping":function(_event){if(u.data[_event]&&u.data[_event].order_shipping){return u.data[_event].order_shipping;}else{return u.data.order_shipping;}},"transaction_id":function(_event){if(u.data[_event]&&u.data[_event].order_id){return u.data[_event].order_id;}else{return u.data.order_id;}},"method":function(_event){if(u.data[_event]&&u.data[_event].method){return u.data[_event].method;}else{return u.data.method;}},"screen_name":function(_event){if(u.data[_event]&&u.data[_event].screen_name){return u.data[_event].screen_name;}else{return u.data.screen_name;}},"search_term":function(_event){if(u.data[_event]&&u.data[_event].search_term){return u.data[_event].search_term;}else{return u.data.search_term;}},"promotions":function(_event){return u.promotions(u.data[_event]);},"content_type":function(_event){if(u.data[_event]&&u.data[_event].content_type){return u.data[_event].content_type;}else{return u.data.content_type;}},"content_id":function(_event){if(u.data[_event]&&u.data[_event].content_id){return u.data[_event].content_id;}else{return u.data.content_id;}},"name":function(_event){if(u.data[_event]&&u.data[_event].name){return u.data[_event].name;}else{return u.data.name;}},"ecomm_prodid":function(_event){if(u.data[_event]&&u.data[_event].ecomm_prodid){return u.data[_event].ecomm_prodid;}else{return u.data.ecomm_prodid;}},"ecomm_pagetype":function(_event){if(u.data[_event]&&u.data[_event].ecomm_pagetype){return u.data[_event].ecomm_pagetype;}else{return u.data.ecomm_pagetype;}},"ecomm_totalvalue":function(_event){if(u.data[_event]&&u.data[_event].ecomm_totalvalue){return u.data[_event].ecomm_totalvalue;}else{return u.data.ecomm_totalvalue;}},"ecomm_category":function(_event){if(u.data[_event]&&u.data[_event].ecomm_category){return u.data[_event].ecomm_category;}else{return u.data.ecomm_category;}},"travel_destid":function(_event){if(u.data[_event]&&u.data[_event].travel_destid){return u.data[_event].travel_destid;}else{return u.data.travel_destid;}},"travel_originid":function(_event){if(u.data[_event]&&u.data[_event].travel_originid){return u.data[_event].travel_originid;}else{return u.data.travel_originid;}},"travel_pagetype":function(_event){if(u.data[_event]&&u.data[_event].travel_pagetype){return u.data[_event].travel_pagetype;}else{return u.data.travel_pagetype;}},"travel_startdate":function(_event){if(u.data[_event]&&u.data[_event].travel_startdate){return u.data[_event].travel_startdate;}else{return u.data.travel_startdate;}},"travel_enddate":function(_event){if(u.data[_event]&&u.data[_event].travel_enddate){return u.data[_event].travel_enddate;}else{return u.data.travel_enddate;}},"travel_totalvalue":function(_event){if(u.data[_event]&&u.data[_event].travel_totalvalue){return u.data[_event].travel_totalvalue;}else{return u.data.travel_totalvalue;}},"hct_bpr":function(_event){if(u.data[_event]&&u.data[_event].hct_bpr){return u.data[_event].hct_bpr;}else{return u.data.hct_bpr;}},"hct_tpr":function(_event){if(u.data[_event]&&u.data[_event].hct_tpr){return u.data[_event].hct_tpr;}else{return u.data.hct_tpr;}},"hct_bid":function(_event){if(u.data[_event]&&u.data[_event].hct_bid){return u.data[_event].hct_bid;}else{return u.data.hct_bid;}},"hct_cid":function(_event){if(u.data[_event]&&u.data[_event].hct_cid){return u.data[_event].hct_cid;}else{return u.data.hct_cid;}},"hct_cod":function(_event){if(u.data[_event]&&u.data[_event].hct_cod){return u.data[_event].hct_cod;}else{return u.data.hct_cod;}},"hct_los":function(_event){if(u.data[_event]&&u.data[_event].hct_los){return u.data[_event].hct_los;}else{return u.data.hct_los;}},"hct_pid":function(_event){if(u.data[_event]&&u.data[_event].hct_pid){return u.data[_event].hct_pid;}else{return u.data.hct_pid;}},"hct_pagetype":function(_event){if(u.data[_event]&&u.data[_event].hct_pagetype){return u.data[_event].hct_pagetype;}else{return u.data.hct_pagetype;}}};u.map={"tealium_event:purchase":"purchase","bing_tag_id":"tagid"};u.extend=[function(a,b){try{if(1){var data={pagetype:b.bing_page_type};if(b.product_sku.length>0){data.prodid=b.product_sku[0]}
data.prodid=data.prodid||b.PIPGroupID;if(b._csubtotal){data.gv=b._csubtotal;}
window.uetq.push(data);}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'rj':'5281512'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['bing_tag_id']=c[e][f];m=true};};if(m)break};if(!m)b['bing_tag_id']='4064908';}}];u.loader_cb=function(a,b,c){utag.DB("send:6103:CALLBACK");if(!u.initialized){var o={ti:u.data.tagid};o.q=uetq;uetq=new UET(o);uetq.push("pageLoad");}
u.initialized=true;var i,j,event_param,_event;for(i=0;i<u.data.event.length;i++){_event=u.data.event[i];u.data.eventData[_event]=u.data.eventData[_event]||{};if(u.event_map[_event]){for(j=0;j<u.event_map[_event].length;j++){event_param=u.event_map[_event][j];u.data.eventData[_event][event_param.name]=u.std_params[event_param.name](_event);if(u.data.eventData[_event][event_param.name]===undefined&&event_param.required){utag.DB(u.id+": Event: "+_event+": Required attribute not populated");}}}
var data={},keyname;var customEventData={};for(keyname in u.data.custom){customEventData[keyname]=u.data.custom[keyname];}
if(u.data[_event]&&u.data[_event].custom){for(keyname in u.data[_event].custom){customEventData[keyname]=u.data[_event].custom[keyname];}}
switch(_event){case"add_payment_info":case"page_view":window.uetq.push("event",_event,{});break;case"add_to_cart":case"remove_from_cart":case"add_to_wishlist":case"begin_checkout":case"checkout_progress":data={event_value:u.data.eventData[_event].event_value,currency:u.data.eventData[_event].currency,items:u.data.eventData[_event].items};if(_event==="begin_checkout"||_event==="checkout_progress"){data.coupon=u.data.eventData[_event].coupon;}
if(_event==="checkout_progress"){data.checkout_step=u.data.eventData[_event].checkout_step;data.checkout_option=u.data.eventData[_event].checkout_option;}
for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",_event,data);break;case"exception":data={description:u.data.eventData[_event].description,fatal:u.data.eventData[_event].fatal};for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",_event,data);break;case"generate_lead":case"purchase":case"refund":data={event_value:u.data.eventData[_event].event_value,currency:u.data.eventData[_event].currency,transaction_id:u.data.eventData[_event].transaction_id};if(_event==="purchase"){data.coupon=u.data.eventData[_event].coupon;}
if(_event==="purchase"||_event==="refund"){data.tax=u.data.eventData[_event].tax;data.shipping=u.data.eventData[_event].shipping;data.items=u.data.eventData[_event].items;}
for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",_event,data);break;case"login":case"sign_up":case"share":data={method:u.data.eventData[_event].method};if(_event==="share"){data.content_type=u.data.eventData[_event].content_type;data.content_id=u.data.eventData[_event].content_id;}
for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",_event,data);break;case"select_content":data={items:u.data.eventData[_event].items,promotions:u.data.eventData[_event].promotions,content_type:u.data.eventData[_event].content_type,content_id:u.data.eventData[_event].content_id};for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",_event,data);break;case"set_checkout_option":data={checkout_step:u.data.eventData[_event].checkout_step,checkout_option:u.data.eventData[_event].checkout_option};for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",_event,data);break;case"screen_view":data={screen_name:u.data.eventData[_event].screen_name};for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",_event,data);break;case"search":case"view_search_results":data={search_term:u.data.eventData[_event].search_term};for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",_event,data);break;case"view_item":case"view_item_list":data={items:u.data.eventData[_event].items};for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",'',data);break;case"timing_complete":data={name:u.data.eventData[_event].name,event_value:u.data.eventData[_event].event_value};for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",_event,data);break;case"view_promotion":data={promotions:u.data.eventData[_event].promotions};for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",_event,data);break;case"retail":data={ecomm_pagetype:u.data.eventData[_event].ecomm_pagetype,ecomm_prodid:u.data.eventData[_event].ecomm_prodid,ecomm_totalvalue:u.data.eventData[_event].ecomm_totalvalue,ecomm_category:u.data.eventData[_event].ecomm_category};for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",u.data.eventData[_event].event_action||"",data);break;case"travel":data={travel_destid:u.data.eventData[_event].travel_destid,travel_originid:u.data.eventData[_event].travel_originid,travel_pagetype:u.data.eventData[_event].travel_pagetype,travel_startdate:u.data.eventData[_event].travel_startdate,travel_endadate:u.data.eventData[_event].travel_endadate,travel_totalvalue:u.data.eventData[_event].travel_totalvalue};for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",u.data.eventData[_event].event_action||"",data);break;case"hotel":data={hct_bpr:u.data.eventData[_event].hct_bpr,hct_tpr:u.data.eventData[_event].hct_tpr,hct_bid:u.data.eventData[_event].hct_bid,hct_cod:u.data.eventData[_event].hct_cod,hct_los:u.data.eventData[_event].hct_los,hct_pid:u.data.eventData[_event].hct_pid,hct_pagetype:u.data.eventData[_event].hct_pagetype};for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",u.data.eventData[_event].event_action||"",data);break;default:data={event_category:u.data.eventData[_event].event_category,event_label:u.data.eventData[_event].event_label,event_value:u.data.eventData[_event].event_value};for(var keyname in customEventData){data[keyname]=customEventData[keyname];}
u.clearEmptyKeys(data);window.uetq.push("event",u.data.eventData[_event].event_action||"",data);break;}}
utag.DB("send:6103:CALLBACK:COMPLETE");};u.callBack=function(){var data={};while(data=u.queue.shift()){u.data=data.data;u.loader_cb(data.a,data.b,data.c);}};u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){utag.DB("send:6103");utag.DB(b);var c,d,e,f,h;u.data={"qsp_delim":"&","kvp_delim":"=","base_url":"//bat.bing.com/bat.js","tagid":"SET_IN_EXTENSION","product_id":[],"product_name":[],"product_brand":[],"product_category":[],"product_quantity":[],"product_unit_price":[],"product_creative_slot":[],"product_creative_name":[],"product_location_id":[],"promotion_creative_name":[],"promotion_creative_slot":[],"promotion_id":[],"promotion_name":[],"event":[],"eventData":{},"custom":{},"gc":""};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:6103:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.map_func(e[f].split("."),u.data,b[d]);}}else{h=d.split(":");if(h.length===2&&b[h[0]]===h[1]){if(u.map[d]){u.data.event=u.data.event.concat(u.map[d].split(","));}}}}
utag.DB("send:6103:MAPPINGS");utag.DB(u.data);u.data.order_id=u.data.order_id||b._corder||"";u.data.order_subtotal=u.data.order_subtotal||b._csubtotal||"";u.data.order_shipping=u.data.order_shipping||b._cship||"";u.data.order_tax=u.data.order_tax||b._ctax||"";u.data.order_currency=u.data.order_currency||b._ccurrency||"";u.data.order_coupon_code=u.data.order_coupon_code||b._cpromo||"";if(u.data.product_id.length===0&&b._cprod!==undefined){u.data.product_id=b._cprod.slice(0);}
if(u.data.product_name.length===0&&b._cprodname!==undefined){u.data.product_name=b._cprodname.slice(0);}
if(u.data.product_brand.length===0&&b._cbrand!==undefined){u.data.product_brand=b._cbrand.slice(0);}
if(u.data.product_category.length===0&&b._ccat!==undefined){u.data.product_category=b._ccat.slice(0);}
if(u.data.product_quantity.length===0&&b._cquan!==undefined){u.data.product_quantity=b._cquan.slice(0);}
if(u.data.product_unit_price.length===0&&b._cprice!==undefined){u.data.product_unit_price=b._cprice.slice(0);}
if(u.data.event.length===0&&b._cevent!==undefined){u.data.event=(u.typeOf(b._cevent)==="array")?b._cevent.slice(0):[b._cevent];}
u.data.gc=u.data.gc||b._ccurrency||"";if(!u.data.tagid){utag.DB(u.id+": Tag not fired: Required attribute not populated");return;}
if(u.initialized){u.loader_cb(a,b,c);}else{u.queue.push({"data":u.data,"a":a,"b":b,"c":c});if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":"script","src":u.data.base_url,"cb":u.callBack,"loc":"script","id":"utag_6103","attrs":{}});}}
utag.DB("send:6103:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("6103","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.6478 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
var match=/ut\d\.(\d*)\..*/.exec(utag.cfg.v);if(utag.ut.loader===undefined||!match||parseInt(match[1])<41){u.loader=function(o,a,b,c,l,m){utag.DB(o);a=document;if(o.type=="iframe"){m=a.getElementById(o.id);if(m&&m.tagName=="IFRAME"){b=m;}else{b=a.createElement("iframe");}o.attrs=o.attrs||{};utag.ut.merge(o.attrs,{"height":"1","width":"1","style":"display:none"},0);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";}if(o.id){b.id=o.id;}for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){this.onreadystatechange=null;o.cb();}};}}if(o.type!="img"&&!m){l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}}};}else{u.loader=utag.ut.loader;}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={"view":1};u.isEmptyObject=function(o,a){for(a in o){if(utag.ut.hasOwn(o,a))return false;}
return true;};u.toBoolean=function(val){val=val||"";return val===true||val.toLowerCase()==="true"||val.toLowerCase()==="on";};u.shouldUpdateConfigOnLink=function(){var key;if(!u.isEmptyObject(u.data.config.custom_map)||!u.isEmptyObject(u.data.set)){return true;}
for(key in u.data.config){if(key.match("user_id|page_path|page_title|page_location")){return true;}}
return false;};u.hasgtagjs=function(){window.gtagRename=window.gtagRename||""||"gtag";if(utag.ut.gtagScriptRequested){return true;}
var i,s=document.getElementsByTagName("script");for(i=0;i<s.length;i++){if(s[i].src&&s[i].src.indexOf("gtag/js")>=0&&(s[i].id&&s[i].id.indexOf("utag")>-1)){return true;}}
var data_layer_name=""||"dataLayer";window[data_layer_name]=window[data_layer_name]||[];if(typeof window[window.gtagRename]!=="function"){window[window.gtagRename]=function(){window[data_layer_name].push(arguments);};var cross_track=u.toBoolean("false"),cross_track_domains="";if(cross_track&&cross_track_domains!==""){window[window.gtagRename]("set","linker",{domains:cross_track_domains.split(","),accept_incoming:true});}
window[window.gtagRename]("js",new Date());}
return false;};u.scriptrequested=u.hasgtagjs();u.o=window[window.gtagRename];u.map_func=function(arr,obj,item){var i=arr.shift();obj[i]=obj[i]||{};if(arr.length>0){u.map_func(arr,obj[i],item);}else{obj[i]=item;}};u.setGlobalProperties=function(data,reset,custom_property){var map={"user_id":{"name":"user_id","type":"exists","reset":true},"page_path":{"name":"page_path","type":"exists","reset":true},"page_title":{"name":"page_title","type":"exists","reset":true},"page_location":{"name":"page_location","type":"exists","reset":false}},prop,g={};if(custom_property&&reset){g[custom_property]="";}
for(prop in utag.loader.GV(map)){if(reset&&map[prop].reset){g[map[prop].name]="";}else{if(map[prop].type==="bool"){if(data[prop]==true||data[prop]==="true"){g[map[prop].name]=true;}}
else if(map[prop].type==="exists"){if(data[prop]){g[map[prop].name]=data[prop];}}}}
if(!u.isEmptyObject(g)){u.o("set",g);}};u.item=function(imp,len){var g={},i,j,key,items=[];if(imp===true){len=len||u.data.impression_id.length||u.data.impression_name.length;for(i=0;i<len;i++){g={};g.id=(u.data.impression_id[i]?u.data.impression_id[i]:"");g.name=(u.data.impression_name[i]?u.data.impression_name[i]:"");g.brand=(u.data.impression_brand[i]?u.data.impression_brand[i]:"");g.variant=(u.data.impression_variant[i]?u.data.impression_variant[i]:"");g.category=(u.data.impression_category[i]?u.data.impression_category[i]:"");g.price=(u.data.impression_price[i]?u.data.impression_price[i]:"");g.list_name=(u.data.impression_list_name?u.data.impression_list_name:"");g.list_position=(u.data.impression_list_position[i]?u.data.impression_list_position[i]:"");for(key in u.data.cdm_product_scope){if(Array.isArray(u.data.cdm_product_scope[key])){g[key]=u.data.cdm_product_scope[key][i];}else{g[key]=u.data.cdm_product_scope[key];}}
items.push(g);}}else{len=len||u.data.product_id.length||u.data.product_name.length;for(i=0;i<len;i++){g={};if(u.data.autofill_params==="true"){for(j=0;j<u.data.product_id.length;j++){u.data.product_name[j]=u.data.product_name[j]||u.data.product_id[j];u.data.product_unit_price[j]=u.data.product_unit_price[j]||"1.00";u.data.product_quantity[j]=u.data.product_quantity[j]||"1";}}
g.id=u.data.product_id[i];g.name=(u.data.product_name[i]?u.data.product_name[i]:"");g.brand=(u.data.product_brand[i]?u.data.product_brand[i]:"");g.category=(u.data.product_category[i]?u.data.product_category[i]:"");g.coupon=(u.data.product_promo_code[i]?u.data.product_promo_code[i]:"");g.price=(u.data.product_unit_price[i]?u.data.product_unit_price[i]:"");g.quantity=(u.data.product_quantity[i]?u.data.product_quantity[i]:"");g.variant=(u.data.product_variant[i]?u.data.product_variant[i]:"");g.list_position=(u.data.product_list_position[i]?u.data.product_list_position[i]:"");g.list_name=(u.data.product_list_name?u.data.product_list_name:"");for(key in u.data.cdm_product_scope){if(Array.isArray(u.data.cdm_product_scope[key])){g[key]=u.data.cdm_product_scope[key][i];}else{g[key]=u.data.cdm_product_scope[key];}}
items.push(g);}}
return items;};u.promotion=function(len){var f,g,promo=[];len=len||u.data.promo_id.length;for(f=0;f<len;f++){g={};g.id=u.data.promo_id[f];g.name=(u.data.promo_name[f]?u.data.promo_name[f]:u.data.promo_id[f]);g.creative_name=(u.data.promo_creative_name[f]?u.data.promo_creative_name[f]:"");g.creative_slot=(u.data.promo_creative_slot[f]?u.data.promo_creative_slot[f]:"");promo.push(g);}
return promo;};u.event_map={"add_to_cart":[{"name":"value"},{"name":"currency"},{"name":"items"}],"add_to_wishlist":[{"name":"value"},{"name":"currency"},{"name":"items"}],"begin_checkout":[{"name":"value"},{"name":"currency"},{"name":"items"},{"name":"coupon"}],"checkout_progress":[{"name":"value"},{"name":"currency"},{"name":"items"},{"name":"coupon"},{"name":"checkout_step"}],"exception":[{"name":"description"},{"name":"fatal"}],"generate_lead":[{"name":"value"},{"name":"currency"},{"name":"transaction_id"}],"login":[{"name":"method"}],"purchase":[{"name":"transaction_id","required":true},{"name":"value"},{"name":"currency"},{"name":"tax"},{"name":"shipping"},{"name":"affiliation"},{"name":"coupon"},{"name":"items"}],"refund":[{"name":"transaction_id","required":true},{"name":"value"},{"name":"currency"},{"name":"tax"},{"name":"shipping"},{"name":"affiliation"},{"name":"coupon"},{"name":"items"}],"remove_from_cart":[{"name":"value"},{"name":"currency"},{"name":"items"}],"screen_view":[{"name":"screen_name"}],"search":[{"name":"search_term"}],"select_content":[{"name":"content_type"},{"name":"items"},{"name":"promotions"}],"set_checkout_option":[{"name":"checkout_step"},{"name":"checkout_option"}],"share":[{"name":"method"},{"name":"content_type"},{"name":"content_id"}],"sign_up":[{"name":"method"}],"timing_complete":[{"name":"name","required":true},{"name":"value","required":true},{"name":"event_category"},{"name":"event_label"}],"view_item":[{"name":"items"}],"view_item_list":[{"name":"items"}],"view_promotion":[{"name":"promotions"}],"view_search_results":[{"name":"search_term"}]};u.std_params={"transaction_id":function(){return u.data.order_id;},"affiliation":function(){return u.data.order_store;},"value":function(event){if(event==="timing_complete"){return u.data.event.value;}
return u.data.order_total;},"currency":function(){return u.data.order_currency;},"tax":function(){return u.data.order_tax;},"shipping":function(){return u.data.order_shipping;},"coupon":function(){return u.data.order_coupon_code;},"description":function(){return u.data.event.description;},"fatal":function(){return u.toBoolean(u.data.event.fatal);},"screen_name":function(){return u.data.event.screen_name;},"method":function(){return u.data.event.method;},"search_term":function(){return u.data.event.search_term;},"content_type":function(){return u.data.event.content_type;},"content_id":function(){return u.data.event.content_id;},"promotions":function(event){if(event==="select_content"&&u.data.event.content_type!=="product"){return u.promotion(1);}else if(event!=="select_content"){return u.promotion();}},"name":function(){return u.data.event.name;},"event_category":function(){return u.data.event.event_category;},"event_label":function(){return u.data.event.event_label;},"checkout_step":function(){return u.data.checkout_step;},"checkout_option":function(){return u.data.checkout_option;},"items":function(event){if(event==="view_item"||event==="add_to_cart"||event==="remove_from_cart"){return u.item(false,1);}
if(event==="view_item_list"){return u.item(true);}
if(event==="select_content"&&u.data.event.content_type){return u.item(false,1);}
return u.item();}};u.map={"ga_property_id":"tracking_id","privacy_opt_out_LDU":"rdpOptOut,gtag_enable_tcf_support","random_order_id":"order_id","sc_visitor_id":"cdm.dimension1--all,cdm.dimension2--all"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pb-us':'UA-108284962-1'},{'we-us':'UA-108264884-1'},{'mg-us':'UA-108280599-1'},{'pk-us':'UA-108243259-1'},{'pt-us':'UA-108267289-1'},{'ws-us':'UA-108259718-1'},{'we-ca':'UA-106414771-1'},{'pb-ca':'UA-108240168-1'},{'pk-ca':'UA-108262786-1'},{'ws-ca':'UA-108256213-1'},{'pt-ca':'UA-225058291-1'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['ga_property_id']=c[e][f];m=true};};if(m)break};if(!m)b['ga_property_id']='';}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){utag.DB("send:6478");utag.DB(b);var c,d,e,f,h,i,cdm,cdm_event_flag,event_param,prop;u.data={"qsp_delim":"&","kvp_delim":"=","base_url":"https://www.googletagmanager.com/gtag/js?id=##utag_tracking_id##","tracking_id":"","cross_track":"false","cross_track_domains":"","allow_display_features":"true","screen_view":"false","anonymize_ip":"false","clear_global_vars":"false","optimize_id":"","use_amp_client_id":"false","data_layer_name":"","checkout_step":"","checkout_option":"","product_action_list":"","product_list_position":"","product_variant":[],"impression_id":[],"impression_name":[],"impression_price":[],"impression_category":[],"impression_brand":[],"impression_variant":[],"impression_list_name":[],"impression_list_position":[],"promo_id":[],"promo_name":[],"promo_creative_name":[],"promo_creative_slot":[],"product_id":[],"product_name":[],"product_sku":[],"product_brand":[],"product_category":[],"product_subcategory":[],"product_quantity":[],"product_unit_price":[],"product_discount":[],"product_promo_code":[],"cdm_product_scope":{},"page_view_event_data":{},"set":{},"config":{"custom_map":{}},"event":{},"items":[]};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:6478:EXTENSIONS");utag.DB(b);for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.map_func(e[f].split("."),u.data,b[d]);}}else{h=d.split(":");if(h.length===2&&b[h[0]]===h[1]){if(u.map[d]){u.data.event_name=u.map[d];}}}}
utag.DB("send:6478:MAPPINGS");utag.DB(u.data);u.data.order_id=u.data.order_id||b._corder||"";u.data.order_total=u.data.order_total||b._ctotal||"";u.data.order_subtotal=u.data.order_subtotal||b._csubtotal||"";u.data.order_shipping=u.data.order_shipping||b._cship||"";u.data.order_tax=u.data.order_tax||b._ctax||"";u.data.order_store=u.data.order_store||b._cstore||"";u.data.order_currency=u.data.order_currency||b._ccurrency||"";u.data.order_coupon_code=u.data.order_coupon_code||b._cpromo||"";u.data.customer_id=u.data.customer_id||b._ccustid||"";if(u.data.product_id.length===0&&b._cprod!==undefined){u.data.product_id=b._cprod.slice(0);}
if(u.data.product_name.length===0&&b._cprodname!==undefined){u.data.product_name=b._cprodname.slice(0);}
if(u.data.product_sku.length===0&&b._csku!==undefined){u.data.product_sku=b._csku.slice(0);}
if(u.data.product_brand.length===0&&b._cbrand!==undefined){u.data.product_brand=b._cbrand.slice(0);}
if(u.data.product_category.length===0&&b._ccat!==undefined){u.data.product_category=b._ccat.slice(0);}
if(u.data.product_subcategory.length===0&&b._ccat2!==undefined){u.data.product_subcategory=b._ccat2.slice(0);}
if(u.data.product_quantity.length===0&&b._cquan!==undefined){u.data.product_quantity=b._cquan.slice(0);}
if(u.data.product_unit_price.length===0&&b._cprice!==undefined){u.data.product_unit_price=b._cprice.slice(0);}
if(u.typeOf(u.data.tracking_id)==="string"&&u.data.tracking_id!==""){u.data.tracking_id=u.data.tracking_id.replace(/\s/g,"").split(",");}
if(!u.data.tracking_id){utag.DB(u.id+": Tag not fired: Required attribute not populated");return;}
for(i=0;i<u.data.tracking_id.length;i++){if(!/^[a-zA-Z]{1}-|^[a-zA-Z]{2}-/.test(u.data.tracking_id[i])){u.data.tracking_id[i]="UA-"+u.data.tracking_id[i];}}
u.data.base_url=u.data.base_url.replace("##utag_tracking_id##",u.data.tracking_id[0]);if(u.data.data_layer_name){u.data.base_url=u.data.base_url+"&l="+u.data.data_layer_name;}
u.data.event.send_to=u.data.event.send_to||u.data.tracking_id;if(u.data.customer_id){u.data.config.user_id=u.data.customer_id;}
if(u.toBoolean(u.data.clear_global_vars)){u.setGlobalProperties(u.data.config,true);for(prop in utag.loader.GV(u.data.set)){u.setGlobalProperties(u.data.set,true,prop);}}
u.setGlobalProperties(u.data.config,false);u.setGlobalProperties(u.data.set,false);if(!u.data.event_name&&u.data.order_id&&!utag_data[u.data.tracking_id[0]]){utag_data[u.data.tracking_id[0]]=true;u.data.event_name="purchase";}
cdm=[];for(d in u.data.cdm){cdm_event_flag=false;cdm=d.split("-");var cdm_name,cdm_event;cdm[0]=cdm[0].replace("contentGroup","content_group");if(cdm[0].indexOf("content_group")>=0){cdm_name=cdm[0];cdm_event=cdm[2]||cdm[1]||"all";}else{cdm_name=cdm[1]||cdm[0];cdm_event=cdm[2];u.data.config.custom_map[cdm[0]]=cdm_name;}
if(cdm_event==="all"){u.data.config[cdm_name]=u.data.cdm[d];}else if(cdm_event==="link"&&a==="link"){cdm_event_flag=true;}else if(cdm_event==="ecom"&&u.data.event_name&&u.data.event_name.match(/add_payment_info|add_to_cart|add_to_wishlist|begin_checkout|checkout_progress|purchase|refund|remove_from_cart|product_click|promotion_click|set_checkout_option|view_item|view_item_list|view_promotion/)){cdm_event_flag=true;}else if(cdm_event==="prod"){u.data.cdm_product_scope[cdm_name]=u.data.cdm[d];}else if(cdm_event==="page_view"){u.data.page_view_event_data[cdm_name]=u.data.cdm[d];}else if(u.data.event_name===cdm_event){cdm_event_flag=true;}
if(cdm_event_flag){u.data.event[cdm_name]=u.data.cdm[d];}}
if(u.toBoolean(u.data.anonymize_ip)&&u.data.config.anonymize_ip===undefined){u.data.config.anonymize_ip=true;}
if(u.toBoolean(u.data.cross_track)&&u.data.config.linker===undefined){u.data.config.linker={"accept_incoming":u.toBoolean(u.data.cross_track),"domains":u.data.cross_track_domains};}
if(u.data.allow_display_features==="false"&&u.data.config.allow_display_features===undefined&&u.data.config.allow_ad_personalization_signals===undefined){u.data.config.allow_ad_personalization_signals=false;}
if(u.data.config.allow_display_features!==undefined&&u.data.config.allow_ad_personalization_signals===undefined){u.data.config.allow_ad_personalization_signals=u.toBoolean(u.data.config.allow_display_features);delete u.data.config.allow_display_features;}
if(u.toBoolean(u.data.enhanced_link_attribution)&&!u.data.config.link_attribution){u.data.config.link_attribution=true;}
if(u.data.optimize_id&&u.data.config.optimize_id===undefined){u.data.config.optimize_id=u.data.optimize_id;}
if(u.data.use_amp_client_id&&u.data.config.use_amp_client_id===undefined){u.data.config.use_amp_client_id=u.data.use_amp_client_id;}
u.data.config.send_page_view=false;if(a==="view"){if(typeof u.data.rdpOptOut!=="undefined"){u.o("set","allow_ad_personalization_signals",!u.data.rdpOptOut);}
for(i=0;i<u.data.tracking_id.length;i++){u.o("config",u.data.tracking_id[i],u.data.config);}
if(u.toBoolean(u.data.screen_view)){u.o("event","screen_view",u.data.event);}else{u.o("event","page_view",u.data.page_view_event_data);}}
if(u.data.event_name){if(u.data.event_name==="product_click"&&a==="link"){u.data.event.content_type="product";u.data.event_name="select_content";}else if(u.data.event_name==="promotion_click"&&a==="link"){u.data.event_name="select_content";}
if(u.data.event.non_interaction){u.data.event.non_interaction=true;}
if(u.event_map[u.data.event_name]){for(i=0;i<u.event_map[u.data.event_name].length;i++){event_param=u.event_map[u.data.event_name][i];u.data.event[event_param.name]=u.std_params[event_param.name](u.data.event_name);if(u.data.event[event_param.name]===undefined&&event_param.required){utag.DB(u.id+": Event: "+u.data.event_name+": Required attribute not populated");}}}
if(u.data.event_name!=="product_click"&&u.data.event_name!=="promotion_click"){if(a==="link"&&u.shouldUpdateConfigOnLink()){for(i=0;i<u.data.tracking_id.length;i++){u.o("config",u.data.tracking_id[i],u.data.config);}}
u.o("event",u.data.event_name,u.data.event);}}
if(!u.hasgtagjs()){u.scriptrequested=true;utag.ut.gtagScriptRequested=true;u.loader({"type":"script","src":u.data.base_url,"cb":null,"loc":"script","id":"utag_6478","attrs":{}});}
utag.DB("send:6478:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("6478","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.6496 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'view':1,'link':1};u.initialized=false;u.map={"turn_b2":"turn_account_id","productRecProdString":"productRecString","encoded_path_name":"PathName","sc_visitor_id":"SiteCat"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pb-us':'L21rdC84NjEvY2lkLzE3NDg4Mjg0NjcvdC8w'},{'pk-us':'L21rdC84NjEvY2lkLzE3NDg5NzE0NzIvdC8w'},{'we-us':'L21rdC84NjEvY2lkLzE3NDg5NzE0NzUvdC8w'},{'ws-us':'L21rdC84NjEvY2lkLzE3NDg5NzE0NzQvdC8w'},{'pt-us':'L21rdC84NjEvY2lkLzE3NDg5NzE0NzEvdC8w'},{'mg-us':'L21rdC84NjEvY2lkLzE3NDg5NzE0NzYvdC8w'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['turn_b2']=c[e][f];m=true};};if(m)break};if(!m)b['turn_b2']='';}},function(a,b){try{if(1){if(!pmc.stringContains(b.associatedTags,"amobee-prod-recs")){return false;}}}catch(e){utag.DB(e)}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,i;u.data={"base_url":"//d.turn.com/server/dp_data_call.js?dp=/r/dd/id/","turn_account_id":"","SiteCat":"","PageType":"","ProdCode":[],"product_id":[],"CatID":"","CatCode":"","TopCat":"","Fave":"","Price":"","cb":""};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
if(typeof(u.data["ProdCode"][0])==="undefined"){u.data["ProdCode"][0]=""};if(!u.data.productRecString){return;}
if(!u.initialized){u.loader({"type":"script","src":u.data.base_url+u.data.turn_account_id+"/kv/SiteCat="+u.data.SiteCat+",RecProd="+u.data.productRecString.split(",").slice(0,15).join(",RecProd="),"cb":u.loader_cb,"loc":"script","id":'utag_6496'});}else{u.loader_cb();}
}};utag.o[loader].loader.LOAD(id);})("6496","wsi.williamssonoma");}catch(error){utag.DB(error);}

//tealium universal tag - utag.6528 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
var _svq=_svq||[];try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.loader===undefined){u.loader=function(o){var b,c,l,a=document;if(o.type==="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l];}b.src=o.src;}if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}}}else{u.loader=utag.ut.loader;}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={"view":1,"link":1};u.initialized=false;u.scriptrequested=false;u.queue=[];u.map={"fourcite_citeid":"fourcite_citeid,_setAccount","tealium_event":"link_event"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'ws':'0053_00595'},{'pb':'0053_00597'},{'pt':'0053_00600'},{'pk':'0053_00598'},{'we':'0053_00601'},{'mg':'4231_04296'},{'rj':'0053_04966'},{'gr':'0053_04997'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['fourcite_citeid']=c[e][f];m=true};};if(m)break};if(!m)b['fourcite_citeid']='';}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f;u.data={"qsp_delim":"&","kvp_delim":"=","base_url":"//track.securedvisit.com/js/sv.js","_setAccount":"","_setIsCart":"","_setPurchID":"","_setPurchDollar":"","_setPurchProduct":"","_setPurchShip":"","_setPurchTax":"","_setCartProduct":"","_setCustAcct":"","_setCustAdd1":"","_setCustAdd2":"","_setCustCity":"","_setCustFName":"","_setCustLName":"","_setCustState":"","_setCustZIP":"","_setEm":"","_setContext":"","product_id":[],"product_category":[],"link_event":"",};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};c=[];for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(u.data[e[f]]===undefined&&e[f].indexOf("_set")===0){c.push(e[f]);c.push(b[d]);window._svq.push(c);c=[];}
u.data[e[f]]=b[d];}}}
u.data.order_id=u.data._setPurchID||u.data.order_id||b._corder||"";u.data.order_subtotal=u.data._setPurchDollar||u.data.order_subtotal||b._csubtotal||"";u.data.customer_id=u.data._setCustAcct||u.data.customer_id||b._ccustid||"";u.data.order_shipping=u.data._setPurchShip||u.data.order_shipping||b._cship||"";u.data.order_tax=u.data._setPurchTax||u.data.order_tax||b._ctax||"";u.data.customer_city=u.data.customer_city||b._ccity||"";u.data.customer_state=u.data.customer_state||b._cstate||"";u.data.customer_zip=u.data.customer_zip||b._czip||"";if(u.data.product_id.length===0&&b._csku!==undefined){u.data.product_id=b._csku.slice(0);}
if(u.data.product_id.length===0&&b._cprod!==undefined){u.data.product_id=b._cprod.slice(0);}
if(u.data.product_category.length===0&&b._ccat!==undefined){u.data.product_category=b._ccat.slice(0);}
window._svq.push(["_setAccount",u.data.fourcite_citeid]);if(a==="view"){if(u.data.order_id){window._svq.push(["_setIsPurch",true]);window._svq.push(["_setPurchID",u.data.order_id]);window._svq.push(["_setPurchDollar",u.data.order_subtotal]);window._svq.push(["_setPurchProduct",u.data.product_id]);if(u.data._setPurchDiscount){window._svq.push(["_setPurchDiscount",u.data._setPurchDiscount]);}
if(u.data.order_shipping){window._svq.push(["_setPurchShip",u.data.order_shipping]);}
if(u.data.order_tax){window._svq.push(["_setPurchTax",u.data.order_tax]);}
if(u.data.customer_id){window._svq.push(["_setCustAcct",u.data.customer_id]);}
if(u.data._setCustAdd1){window._svq.push(["_setCustAdd1",u.data._setCustAdd1]);}
if(u.data._setCustAdd2){window._svq.push(["_setCustAdd2",u.data._setCustAdd2]);}
if(u.data._setCustFName){window._svq.push(["_setCustFName",u.data._setCustFName]);}
if(u.data._setCustLName){window._svq.push(["_setCustLName",u.data._setCustLName]);}
if(u.data.customer_city){window._svq.push(["_setCustCity",u.data.customer_city]);}
if(u.data.customer_state){window._svq.push(["_setCustState",u.data.customer_state]);}
if(u.data.customer_zip){window._svq.push(["_setCustZIP",u.data.customer_zip]);}
if(u.data._setEm){window._svq.push(["_setEm",u.data._setEm]);}}else if(u.data._setIsCart){window._svq.push(["_setIsCart",true]);window._svq.push(["_setCartProduct",u.data.product_id]);}else{if(u.data._setEm){window._svq.push(["_setEm",u.data._setEm]);}
if(u.data.product_id.length>0){c.push("'productid':'"+u.data.product_id.toString()+"'");}
if(u.data.product_category.length>0){c.push("'productcat':'"+u.data.product_category.toString()+"'");}
if(c.length>0){window._svq.push(["_setContext",c.join(",")]);}}
window._svq.push(["_trackPageView",true]);}
u.loader_cb=function(a){u.initialized=true;if(a==="link"){if(u.data.product_id.length>0&&u.data.link_event==="cart_add"){var tracker=window._svt._getTracker(u.data._setAccount);tracker._setIsCart(true);tracker._setCartProduct(u.data.product_id);tracker._trackPageView();}}};u.callBack=function(){var data={};while(data=u.queue.shift()){u.data=data.data;u.loader_cb(data.a);}};if(u.initialized){u.loader_cb(a);}else{u.queue.push({"data":u.data,"a":a});if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":"script","src":u.data.base_url,"cb":u.callBack,"loc":"script","id":'utag_6528'});}}
}};utag.o[loader].loader.LOAD(id);}("6528","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.6558 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={"link":1};u.scriptrequested=false;u.clearEmptyKeys=function(object){for(var key in object){if(object[key]===""||object[key]===undefined){delete object[key];}}
return object;};u.map={"product_id":"product_id","product_name":"product_name","product_unit_price":"product_unit_price","product_quantity":"product_quantity","product_sku":"product_sku","currency_code":"order_currency","product_category":"product_category","Curalate_sitename":"sitename","curalate_site_name":"sitename","curalate_event:contentImpression":"pageImpression","curalate_event:cart_add":"addtocart","curalate_event:purchase":"purchase","curalate_event:itemClick":"itemClick","curalate_event:productClick":"productClick","curalate_event:cart_remove":"removefromcart","curalate_event:homepage":"homepage","curalate_event:category":"category","itemId":"itemId","productId":"productId","position":"position","ugcExperienceId":"experienceId","page_type":"page_type,page_category","curalate_metrics_id":"metricsId","ugcProductStyleId":"productStyleId","sc_visitor_id":"customer_id"};u.extend=[function(a,b){try{if(1){try{b['_csku']=(function(){return(b._csku[0]===b._cprod[0]?[]:b._csku)})();}catch(e){}}}catch(e){utag.DB(e);}},function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pb-us':'wspotterybarn-u5wh3w'},{'pk-us':'wspbkids-drvjhd'},{'we-us':'wswestelm-i5hqoo'},{'ws-us':'wswilliamssonoma-d4zud2'},{'mg-us':'wsmarkandgraham-kg5qqz'},{'pt-us':'wspbteen-wv0omz'},{'rj-us':'wsrejuvenation-ntti7'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['Curalate_sitename']=c[e][f];m=true};};if(m)break};if(!m)b['Curalate_sitename']='';}},function(a,b){try{if(1){if(!b.curalateLibraryLoaded&&!utag_data.curalateLibraryLoaded){return;}
if(b["tealium_event"]&&b["tealium_event"]==="cart_add"){b["curalate_event"]=b["_cevent"]="addtocart";}else if(b["tealium_event"]&&b["tealium_event"]==="cart_remove"){b["curalate_event"]=b["_cevent"]="removefromcart";}}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pb-us':'JY5uzoSZ'},{'pk-us':'rTkJSXEE'},{'we-us':'1MTnuQDH'},{'ws-us':'T1olJSPP'},{'pt-us':'U0Do7kPP'},{'mg-us':'nY5m3Z1V'},{'rj-us':'m3NowoYQ'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['curalate_metrics_id']=c[e][f];m=true};};if(m)break};if(!m)b['curalate_metrics_id']='';}}];u.initialize=function(experienceId,displayType,metricsId){try{if(!window.crl8.metrics||!window.crl8.metrics.trackers||!window.crl8.metrics.trackers[experienceId]){var metricsId=metricsId||"",trackerData=crl8.metrics.trackers,displayType=displayType||"gallery";var tracker=window.crl8.metrics.init(experienceId,{baseUrl:'//e.curalate.com/api/v1/metrics/experience',displayType:displayType,metricsId:metricsId,pixelName:'events.png'});}}catch(e){utag.DB("Error initializing Curalate: 6558: "+e);}}
u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){utag.DB("send:6558");utag.DB(b);var c,d,e,f,h,i,j,evt;u.data={"sitename":"","base_url":"//cdn.curalate.com/sites/##utagreplace_sitename##/site/latest/site.","product_id":[],"product_name":[],"product_sku":[],"product_category":[],"product_quantity":[],"product_unit_price":[],"display_price":[],"event_queue":[],"experienceId":"","itemId":"","metricsId":"",};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:6558:EXTENSIONS");utag.DB(b);for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}else{h=d.split(":");if(h.length===2&&b[h[0]]===h[1]){if(u.map[d]){u.data.event_queue=u.data.event_queue.concat(u.map[d].split(","));}}}}
utag.DB("send:6558:MAPPINGS");utag.DB(u.data);b._cprod=b._cprod.length?b._cprod:utag_data._cprod;b._cprodname=b._cprodname.length?b._cprodname:b._cprod;b._csku=b._csku.length?b._csku:utag_data._csku;b._ccat=b._ccat.length?b._ccat:utag_data._ccat;b._cquan=b._cquan.length?b._cquan:utag_data._cquan;b._cprice=b._cprice.length?b._cprice:utag_data._cprice;u.data.order_id=u.data.order_id||b._corder||utag_data.order_id||"";u.data.order_subtotal=u.data.order_subtotal||b._csubtotal||utag_data.order_discounted_subtotal||"";u.data.order_shipping=u.data.order_shipping||b._cship||utag_data.order_shipping_amount||"";u.data.order_tax=u.data.order_tax||b._ctax||utag_data.order_tax_amount||"";u.data.order_currency=u.data.order_currency||b._ccurrency||utag_data._ccurrency||"";u.data.customer_id=u.data.customer_id||b._ccustid||utag_data._ccustid||"";u.data.customer_city=u.data.customer_city||b._ccity||utag_data._ccity||"";u.data.customer_country=u.data.customer_country||b._ccountry||utag_data._ccountry||"";if(u.data.product_id.length===0&&b._cprod!==undefined){u.data.product_id=b._cprod.slice(0);}
if(u.data.product_name.length===0&&b._cprodname!==undefined){u.data.product_name=b._cprodname.slice(0);}else{u.data.product_name=u.data.product_id}
if(u.data.product_sku.length===0&&b._csku!==undefined){u.data.product_sku=b._csku.slice(0);}
if(u.data.product_category.length===0&&b._ccat!==undefined){u.data.product_category=b._ccat.slice(0);}
if(u.data.product_quantity.length===0&&b._cquan!==undefined){u.data.product_quantity=b._cquan.slice(0);}
if(u.data.product_unit_price.length===0&&b._cprice!==undefined){u.data.product_unit_price=b._cprice.slice(0);}
if(u.data.event_queue.length===0&&b._cevent!==undefined){u.data.event_queue=(u.typeOf(b._cevent)==="array")?b._cevent.slice(0):[b._cevent];}
if(!u.data.sitename){utag.DB(u.id+": Tag not fired: Required attribute sitename not populated");return;}
u.data.base_url=u.data.base_url.replace("##utagreplace_sitename##",u.data.sitename);if(u.data.order_id&&u.data.event_queue.indexOf("purchase")===-1){u.data.event_queue.push("purchase");}
var experienceId="custom-fanreel-"+utag_data.page_type;for(evt=0;evt<u.data.event_queue.length;evt++){if(u.data.event_queue[evt]==="category"){u.initialize(experienceId,"category",u.data.metricsId);}else if(u.data.event_queue[evt]==="pageImpression"){if(u.data.page_type==="home"){u.initialize(experienceId,"homepage",u.data.metricsId);}else if(u.data.page_type==="product"){u.initialize(experienceId,"pdp",u.data.metricsId);}else if(u.data.page_type==="gallery"){u.initialize(experienceId,"gallery",u.data.metricsId);}
window.crl8.metrics.recordEvent({experienceId:experienceId,eventName:'pageImpression'});}else if(u.data.event_queue[evt]==="itemClick"){window.crl8.metrics.recordEvent({experienceId:experienceId,eventName:'itemClick',eventData:{itemId:u.data.itemId,position:u.data.position}});}else if(u.data.event_queue[evt]==="productClick"){window.crl8.metrics.recordEvent({experienceId:experienceId,eventName:'productClick',eventData:{itemId:u.data.itemId,position:u.data.position,productId:u.data.productId||u.data.productStyleId,productStyleId:u.data.productStyleId}});}else if(u.data.event_queue[evt]==="purchase"){for(i=0;i<u.data.product_id.length;i++){crl8.pixel("addProduct",{"productId":u.data.product_id[i],"productName":u.data.product_name[i],"price":u.data.product_unit_price[i],"displayPrice":u.data.display_price[i],"quantity":u.data.product_quantity[i],"sku":u.data.product_sku[i],"category":u.data.product_category[i],"currency":u.data.order_currency});}
crl8.pixel("addTransactionInfo",u.clearEmptyKeys({"transactionId":u.data.order_id,"userId":u.data.customer_id,"cartValue":u.data.order_subtotal,"taxValue":u.data.order_tax,"shippingValue":u.data.order_shipping,"shippingCity":u.data.customer_city,"shippingCountry":u.data.customer_country,"currency":u.data.order_currency}));crl8.pixel("send");}}
utag.DB("send:6558:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("6558","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.6568 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
window.snaptr=window.snaptr||function(){window.snaptr.handleRequest?window.snaptr.handleRequest.apply(window.snaptr,arguments):window.snaptr.queue.push(arguments);};window.snaptr.queue=window.snaptr.queue||[];try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
var match=/ut\d\.(\d*)\..*/.exec(utag.cfg.v);if(utag.ut.loader===undefined||!match||parseInt(match[1])<41){u.loader=function(o,a,b,c,l,m){utag.DB(o);a=document;if(o.type=="iframe"){m=a.getElementById(o.id);if(m&&m.tagName=="IFRAME"){b=m;}else{b=a.createElement("iframe");}o.attrs=o.attrs||{};utag.ut.merge(o.attrs,{"height":"1","width":"1","style":"display:none"},0);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";}if(o.id){b.id=o.id;}for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){this.onreadystatechange=null;o.cb();}};}}if(o.type!="img"&&!m){l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}}};}else{u.loader=utag.ut.loader;}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={"view":1,"link":1};u.initialized=false;u.scriptrequested=false;u.clearEmptyKeys=function(object){for(var key in object){if(object[key]===""||object[key]===undefined){delete object[key];}}
return object;};u.map={"snapchat_event:purchase":"PURCHASE","snapchat_event:cart_add":"ADD_CART","snapchat_event:product_view":"VIEW_CONTENT","snapchat_event:search_results":"SEARCH","snapchat_event:pageview":"PAGE_VIEW","snapChat_Id":"pixel_id","currency_code":"order_currency","search_keyword":"search_string","new_site_visitor_90":"newSiteVisitor","pmc_pageName":"description"};u.extend=[function(a,b){try{if(parseFloat(b['days_since_last_visit'])>parseFloat(90)||b['cp.utag_main__sn']=='1'){b['new_site_visitor_90']='true'}}catch(e){utag.DB(e);}},function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'pt':'569dd5b9-d81f-43db-8584-aad5ba55221f'},{'pb':'75999c29-9d7b-411a-8f10-f0e4726a3e73'},{'ws':'0da26d2c-694f-4f93-a639-7ad44de73bc5'},{'we':'0c0b06a8-f9db-4a18-8d17-03dc3551ef10'},{'mg':'81915b3d-475c-4ce7-9e6e-352d29acea0c'},{'pk':'7441e893-10d2-4189-bbe7-72598b1d8b96'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['snapChat_Id']=c[e][f];m=true};};if(m)break};}},function(a,b){try{if(1){var eventList=["purchase","cart_add","product_view","search_results",];var snapEvent=function(tevent){for(var i=0,len=eventList.length;i<len;i++){if(tevent===eventList[i]){return tevent;}}
if(a==="view"){return"pageview";}
return"";};b.snapchat_event=snapEvent(b.tealium_event);}}catch(e){utag.DB(e)}}];u.sumItems=function(arr){var totalItems=0,i;for(i=0;i<arr.length;i++){totalItems+=parseInt(arr[i]);}
return totalItems;};u.handleEvent=function(event_name){if(!event_name){return;}
var event_data={};if(event_name==="PURCHASE"){event_data["currency"]=u.data.order_currency;event_data["transaction_id"]=u.data.order_id;}
if(/VIEW_CONTENT|ADD_CART|START_CHECKOUT|PURCHASE/i.test(event_name)){event_data["price"]=u.data.order_subtotal;event_data["item_ids"]=u.data.product_id;event_data["item_category"]=u.data.product_category[0];event_data["number_items"]=u.sumItems(u.data.product_quantity);}
event_data["description"]=u.data.description;event_data["search_string"]=u.data.search_string;event_data["payment_info_available"]=u.data.payment_info_available;event_data["sign_up_method"]=u.data.sign_up_method;event_data["success"]=u.data.success;window.snaptr("track",event_name,u.clearEmptyKeys(event_data));};u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){utag.DB("send:6568");utag.DB(b);var c,d,e,f,h,i;u.data={"qsp_delim":"&","kvp_delim":"=","base_url":"https://sc-static.net/scevent.min.js","pixel_id":"","product_id":[],"product_category":[],"product_quantity":[],"product_unit_price":[],"event":[],"user_data":{}};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:6568:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(e[f].indexOf("user_")===0){u.data.user_data[e[f]]=b[d];}else{u.data[e[f]]=b[d];}}}else{h=d.split(":");if(h.length===2&&b[h[0]]===h[1]){if(u.map[d]){u.data.event=u.data.event.concat(u.map[d].split(","));}}}}
utag.DB("send:6568:MAPPINGS");utag.DB(u.data);u.data.order_id=u.data.order_id||b._corder||"";u.data.order_subtotal=u.data.order_subtotal||b._csubtotal||"";u.data.order_currency=u.data.order_currency||b._ccurrency||"";u.data.customer_id=u.data.customer_id||b._ccustid||"";if(u.data.product_id.length===0&&b._cprod!==undefined){u.data.product_id=b._cprod.slice(0);}
if(u.data.product_category.length===0&&b._ccat!==undefined){u.data.product_category=b._ccat.slice(0);}
if(u.data.product_quantity.length===0&&b._cquan!==undefined){u.data.product_quantity=b._cquan.slice(0);}
if(u.data.product_unit_price.length===0&&b._cprice!==undefined){u.data.product_unit_price=b._cprice.slice(0);}
if(u.data.event.length===0&&b._cevent!==undefined){u.data.event=(u.typeOf(b._cevent)==="array")?b._cevent.slice(0):[b._cevent];}
if(!u.data.pixel_id){utag.DB(u.id+": Tag not fired: Required attribute not populated");return;}
if(u.data.hashed_email){u.data.user_data.user_hashed_email=u.data.hashed_email;}
window.snaptr("init",u.data.pixel_id,u.data.user_data);if(u.data.event.join(",").indexOf("PURCHASE")<0&&u.data.order_id){u.data.event.push("PURCHASE");}
for(i=0;i<u.data.event.length;i++){u.handleEvent(u.data.event[i]);}
if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":"script","src":u.data.base_url,"cb":null,"loc":"script","id":"utag_6568","attrs":{}});}
utag.DB("send:6568:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("6568","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.6636 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.loader===undefined){u.loader=function(o){var b,c,l,a=document;if(o.type==="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l];}b.src=o.src;}if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}}}else{u.loader=utag.ut.loader;}
u.encode=function(a,b){b="";try{b=encodeURIComponent(a)}catch(e){utag.DB(e);}if(b==""){b=escape(a);}return b}
u.ev={"view":1,"link":1};u.scriptrequested=false;u.rp=function(a,b){if(typeof a!=="undefined"&&a.indexOf("@@")>0){a=a.replace(/@@([^@]+)@@/g,function(m,d){if(b[d]){return u.encode(b[d]);}else{return"";}});}
return a;};u.variableNameMap=[{topCatName:"ws-home",catID:"px_36023079a4b0ab",catCode:"px_6602309392f0dc",pageType:"px_960230948ec831",superCategories:"px_56023097bb4f78",topCat:"px_5602309897de47",pageName:"px_46023099d50618",SiteCat:"px_4602309afa9cff",PathName:"px_8602309bd2565d",},{topCatName:"B2B",catID:"px_0602309fc0e6e9",catCode:"px_560230a0dde13b",pageType:"px_860230a1931e4a",superCategories:"px_060230a2545cc7",topCat:"px_860230a31e6add",pageName:"px_060230a3d3850e",SiteCat:"px_660230a48c8e34",PathName:"px_960230a55b8d32",},{topCatName:"markandgraham",catID:"px_960230a9e353a1",catCode:"px_760230aaaca683",pageType:"px_660230ab573d42",superCategories:"px_260230abf65f4d",topCat:"px_660230acd17adf",pageName:"px_960230ad756995",SiteCat:"px_060230ae3778f6",PathName:"px_860230aee54fe0",},{topCatName:"potterybarn",catID:"px_760230b47b8f4d",catCode:"px_360230b5733f5e",pageType:"px_760230b63869c1",superCategories:"px_660230b6e523fa",topCat:"px_860230b78b1f0f",pageName:"px_360230b8365444",SiteCat:"px_660230b8d7f103",PathName:"px_060230b9878d7a",},{topCatName:"pk-kids",catID:"px_760230bfda3178",catCode:"px_460230c23c3728",pageType:"px_860230c2f60894",superCategories:"px_460230c3c249d9",topCat:"px_860230c485d39a",pageName:"px_460230c53db948",SiteCat:"px_460230c5dc1e6c",PathName:"px_660230c6aedf5b",},{topCatName:"pbteen",catID:"px_3602304017cab6",catCode:"px_86023046a6a856",pageType:"px_060230491512c4",superCategories:"px_0602304c0da09e",topCat:"px_9602305161bffc",pageName:"px_860230573c8996",SiteCat:"px_46023059921097",PathName:"px_0602305f622fb9",},{topCatName:"Rejuvenation",catID:"px_260230664cadf4",catCode:"px_0602306b1c7415",pageType:"px_2602306d0a2f8b",superCategories:"px_1602306f148f30",topCat:"px_66023073d1157d",pageName:"px_26023075b97950",SiteCat:"px_260230796a85d2",PathName:"px_8602307b62bf2a",},{topCatName:"TheKey",catID:"px_860230822de98b",catCode:"px_16023084403a25",pageType:"px_16023089fcf0cb",superCategories:"px_1602308b9d3302",topCat:"px_6602308d7ce9df",pageName:"px_2602308f0484a2",SiteCat:"px_06023090d888ca",PathName:"px_46023092cdc6e5",},{topCatName:"west-elm",catID:"px_360230999f249d",catCode:"px_2602309b3a5bef",pageType:"px_1602309d064a8b",superCategories:"px_8602309f1af37f",topCat:"px_460230a6f894e5",pageName:"px_660230a8a42cd5",SiteCat:"px_560230aa3bfecb",PathName:"px_860230ae788253",},{topCatName:"ws-kitchen",catID:"px_360230b802ef86",catCode:"px_760230b9b40d47",pageType:"px_660230bbc7dfb2",superCategories:"px_060230bdbad40d",topCat:"px_960230bf8c9f56",pageName:"px_460230c1423b31",SiteCat:"px_460230c2ee70c5",PathName:"px_660230c4d0619d",},];u.remapVariables=function(params,map){var newParams=[];var found;for(var i=0,iLen=params.length;i<iLen;i++){found=false;for(var j in map){if(pmc.stringStartsWith(params[i],j)){newParams.push(params[i].replace(j,map[j]));found=true;break;}}
if(!found){newParams.push(params[i]);}}
return newParams;};u.findInMap=function(params){var topCatName="";for(var j=0,jLen=u.variableNameMap.length;j<jLen;j++){topCatName=u.variableNameMap[j].topCatName;for(var i=0,iLen=params.length;i<iLen;i++){if(pmc.stringStartsWith(params[i],"topCat")&&pmc.stringContains(params[i],topCatName)){return u.remapVariables(params,u.variableNameMap[j]);}}}};u.map={"jivox_pixel_id":"px","encoded_path_name":"PathName","_cprod":"cData","category_id":"catID","category_path_string":"catCode","page_type":"pageType","pmc_pageName":"pageName","top_category":"superCategories","jivox_top_cat":"topCat","sc_visitor_id":"SiteCat"};u.extend=[function(a,b){try{if(1){var getJivoxId=function(){var idMap=[{key:"ws",value:"65fe1343d59011"},{key:"pb",value:"85fe131bb35e38"},{key:"pk",value:"05fe1315aa3f03"},{key:"pt",value:"05fe13210a7d79"},{key:"we",value:"15fe1331e97916"},{key:"mg",value:"85fe130a4c2235"},];if(utag_data.brand==="ws"&&utag_data.subBrand==="ws-home"){return"15fe0ed26462a5";}
return pmc.resolveMapLookup(idMap,utag_data.brand);};b.jivox_pixel_id=getJivoxId();}}catch(e){utag.DB(e)}},function(a,b){try{if(1){b.category_path_string=Array.isArray(b.category_path)?b.category_path.join(','):"";b.product_id_string=Array.isArray(b.product_id)?b.product_id.join(","):"";b.product_unit_price_string=Array.isArray(b.product_unit_price)?b.product_unit_price.join(","):"";}}catch(e){utag.DB(e)}},function(a,b){try{if(1){var jivoxTopCatMap=[{key:"pb",value:"potterybarn",},{key:"pb-apartment",value:"potterybarn",},{key:"ws-kitchen",value:"ws-kitchen",},{key:"ws-home",value:"ws-home",},{key:"we",value:"west-elm",},{key:"we-collection",value:"west-elm",},{key:"we-kids",value:"west-elm",},{key:"we-b2b",value:"west-elm",},{key:"pt",value:"pbteen",},{key:"pt-dorm",value:"pbteen",},{key:"pk",value:"pk-kids",},{key:"pk-baby",value:"pk-kids",},{key:"pk-modern-baby",value:"pk-kids",},{key:"mg",value:"markandgraham",},{key:"rj",value:"rejuvenation",},];b.jivox_top_cat=pmc.resolveMapLookup(jivoxTopCatMap,b.subBrand);}}catch(e){utag.DB(e)}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f;u.data={"qsp_delim":"&"||"&","kvp_delim":"="||"=","qs_delim":"?"||"?","tag_type":"img","base_url":"https://pxl.jivox.com/tags/re/pxrc.php","secure_base_url":"","static_params":"ret=img","cachebust":"disabled","cachevar":""||"_rnd","requestscriptonce":"disabled"};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:6636:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(typeof b[d]!=="undefined"&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(!u.data.hasOwnProperty(e[f])){c.push(e[f]+"##kvp_delim##"+u.encode(b[d]));}
u.data[e[f]]=b[d];}}}
if(!u.data.base_url){if(!u.data.secure_base_url){utag.DB("Error: No Base URL or Secure HTTPS Override Provided.");return;}else{u.data.base_url=u.data.secure_base_url;utag.DB("No Base URL provided, using Secure HTTPS Override.");}}
u.data.secure_base_url=u.data.secure_base_url||u.data.base_url;u.data.url=(location.protocol==="https:"?u.data.secure_base_url:u.data.base_url);if(u.data.url.indexOf("http")!==0&&u.data.url.indexOf("/")!==0){u.data.url=location.protocol+"//"+u.data.url;}
if(u.data.static_params){c.push(u.data.static_params);}
var cb_check=new RegExp("(\\"+u.data.qs_delim+"|"+u.data.qsp_delim+")"+u.data.cachevar+"=");if(u.data.cachebust==="enabled"&&!cb_check.test(u.data.url)){c.push([u.data.cachevar,Math.random()].join(u.data.kvp_delim));}
if(c.length>0){if(u.data.url.indexOf(u.data.qs_delim)<0){u.data.url+=u.data.qs_delim;}else if(u.data.url.indexOf(u.data.qs_delim)!==(u.data.url.length-1)){u.data.url+=u.data.qsp_delim;}}
if(u.data.pageType==="product"){u.data.fakeTopCat="browse";}
if(u.data.pageName==="add item:add to cart"){u.data.fakeTopCat="";u.data.fakePageName="cart add"}
c=u.findInMap(c);u.data.url=u.rp(u.data.url,b)+u.rp(c.join(u.data.qsp_delim),b);u.data.url=u.data.url.replace(/##kvp_delim##/g,u.data.kvp_delim);u.data.url+=u.data.fakeTopCat?"&topCat=browse":"";u.data.url+=u.data.fakePageName?"&pageName=cart%20add":"";u.callback=u.callback||function(){};if(u.data.requestscriptonce==="enabled"&&u.data.tag_type==="script"){if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_6636","cb":u.callback});}else{u.callback();}}else{u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_6636","cb":u.callback});}
utag.DB("send:6636:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("6636","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.6646 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.loader===undefined){u.loader=function(o){var b,c,l,a=document;if(o.type==="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l];}b.src=o.src;}if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}}}else{u.loader=utag.ut.loader;}
u.encode=function(a,b){b="";try{b=encodeURIComponent(a)}catch(e){utag.DB(e);}if(b==""){b=escape(a);}return b}
u.ev={"view":1,"link":1,};u.scriptrequested=false;u.rp=function(a,b){if(typeof a!=="undefined"&&a.indexOf("@@")>0){a=a.replace(/@@([^@]+)@@/g,function(m,d){if(b[d]){return u.encode(b[d]);}else{return"";}});}
return a;};u.map={"product_id_string":"cData","category_id":"px_860230822de98b","category_path_string":"px_16023084403a25","page_type":"px_16023089fcf0cb","top_category":"px_1602308b9d3302","turn_top_cat":"px_6602308d7ce9df","encoded_path_name":"px_46023092cdc6e5","pmc_pageName":"px_2602308f0484a2","sc_visitor_id":"px_06023090d888ca"};u.extend=[function(a,b){try{if(1){var turnTopCatMap=[{key:"pb",value:"potterybarn",},{key:"pb-apartment",value:"pb-apartment",},{key:"ws-kitchen",value:"ws-kitchen",},{key:"ws-home",value:"ws-home",},{key:"we",value:"west-elm",},{key:"we-collection",value:"west-elm-collection",},{key:"we-kids",value:"west-elm",},{key:"pt",value:"pbteen",},{key:"pt-dorm",value:"pbdorm",},{key:"pk",value:"pk-kids",},{key:"pk-baby",value:"pk-baby",},{key:"pk-modern-baby",value:"pk-baby",},{key:"mg",value:"markandgraham",},{key:"rj",value:"rejuvenation",},{key:"gr",value:"greenrow",},];b.turn_top_cat=pmc.resolveMapLookup(turnTopCatMap,b.subBrand);}}catch(e){utag.DB(e)}},function(a,b){try{if(1){b.category_path_string=Array.isArray(b.category_path)?b.category_path.join(','):"";b.product_id_string=Array.isArray(b.product_id)?b.product_id.join(","):"";b.product_unit_price_string=Array.isArray(b.product_unit_price)?b.product_unit_price.join(","):"";}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'pb':'jvxpxl.potterybarn.com'},{'ws':'jvxpxl.williams-sonoma.com'},{'we':'jvxpxl.westelm.com'},{'pt':'jvxpxl.pbteen.com'},{'pk':'jvxpxl.potterybarnkids.com'},{'mg':'jvxpxl.markandgraham.com'},{'rj':'jvxpxl.rejuvenation.com'},{'gr':'jvxpxl.greenrow.com'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['jivox_endpoint']=c[e][f];m=true};};if(m)break};if(!m)b['jivox_endpoint']='';}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f;u.data={"qsp_delim":"&"||"&","kvp_delim":"="||"=","qs_delim":"?"||"?","tag_type":"img","base_url":"https://pxl.jivox.com/tags/re/pxrc.php","secure_base_url":"","static_params":"px=15fe132abc3cac&ret=img","cachebust":"disabled","cachevar":""||"_rnd","requestscriptonce":"disabled"};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:6646:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(typeof b[d]!=="undefined"&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(!u.data.hasOwnProperty(e[f])){c.push(e[f]+"##kvp_delim##"+u.encode(b[d]));}
u.data[e[f]]=b[d];}}}
if(!u.data.base_url){if(!u.data.secure_base_url){utag.DB("Error: No Base URL or Secure HTTPS Override Provided.");return;}else{u.data.base_url=u.data.secure_base_url;utag.DB("No Base URL provided, using Secure HTTPS Override.");}}
u.data.secure_base_url=u.data.secure_base_url||u.data.base_url;u.data.url=(location.protocol==="https:"?u.data.secure_base_url:u.data.base_url);if(u.data.url.indexOf("http")!==0&&u.data.url.indexOf("/")!==0){u.data.url=location.protocol+"//"+u.data.url;}
if(u.data.static_params){c.push(u.data.static_params);}
var cb_check=new RegExp("(\\"+u.data.qs_delim+"|"+u.data.qsp_delim+")"+u.data.cachevar+"=");if(u.data.cachebust==="enabled"&&!cb_check.test(u.data.url)){c.push([u.data.cachevar,Math.random()].join(u.data.kvp_delim));}
if(c.length>0){if(u.data.url.indexOf(u.data.qs_delim)<0){u.data.url+=u.data.qs_delim;}else if(u.data.url.indexOf(u.data.qs_delim)!==(u.data.url.length-1)){u.data.url+=u.data.qsp_delim;}}
u.data.url=u.rp(u.data.url,b)+u.rp(c.join(u.data.qsp_delim),b);u.data.url=u.data.url.replace(/##kvp_delim##/g,u.data.kvp_delim);u.callback=u.callback||function(){};if(u.data.requestscriptonce==="enabled"&&u.data.tag_type==="script"){if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_6646","cb":u.callback});}else{u.callback();}}else{u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_6646","cb":u.callback});}
utag.DB("send:6646:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("6646","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.6649 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
var match=/ut\d\.(\d*)\..*/.exec(utag.cfg.v);if(utag.ut.loader===undefined||!match||parseInt(match[1])<41){u.loader=function(o,a,b,c,l,m){utag.DB(o);a=document;if(o.type=="iframe"){m=a.getElementById(o.id);if(m&&m.tagName=="IFRAME"){b=m;}else{b=a.createElement("iframe");}o.attrs=o.attrs||{};utag.ut.merge(o.attrs,{"height":"1","width":"1","style":"display:none"},0);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";}if(o.id){b.id=o.id;}for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){this.onreadystatechange=null;o.cb();}};}}if(o.type!="img"&&!m){l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}}};}else{u.loader=utag.ut.loader;}
if(utag.ut.typeOf===undefined){u.typeOf=function(e){return({}).toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase();};}else{u.typeOf=utag.ut.typeOf;}
u.ev={"view":1,"link":1};u.initialized=false;u.scriptrequested=false;u.queue=[];u.map={};u.extend=[];u.loader_cb=function(a,b,c){utag.DB("send:6649:CALLBACK");u.initialized=true;var teal_session_id=b["cp.utag_main_ses_id"]+";exp-session";u.eventHandlers(a,b,c);if(b["cp.utag_main_ses_id"]){if(typeof b["cp.utag_main_qm_replay_sent"]==="undefined"){utag.loader.SC("utag_main",{"qm_replay_sent":teal_session_id});}else{if(b["cp.utag_main_qm_replay_sent"]===b["cp.utag_main_ses_id"]){utag.DB(u.id+": Same session detected; duplicate UDH call not sent.");return;}else{utag.loader.SC("utag_main",{"qm_replay_sent":teal_session_id});}}}
if(typeof utag.loader.RC("QuantumMetricSessionID")==="string"){u.makeUDHRequest(b);}else{var count=0,max_attempts=3;var timer=setInterval(function(){if(typeof utag.loader.RC("QuantumMetricSessionID")==="string"){u.makeUDHRequest(b);clearInterval(timer);}else{count++;if(count>max_attempts){utag.DB(u.id+": Unable to retrieve the Quantum Metric Session ID. Replay URL not sent to UDH.");clearInterval(timer);}}},2000);}
utag.DB("send:6649:CALLBACK:COMPLETE");};u.callBack=function(){var data={};while(data=u.queue.shift()){u.data=data.data;u.loader_cb(data.a,data.b,data.c);}};u.makeUDHRequest=function(b){var i,key,dc_parameter_list=[],replay_parameter_list=[],default_account_profile=utag.cfg.utid.split("/"),standard_replay_params=["autoreplay","replaysecond","qmUserCookie","qmSessionCookie","ts"];u.data.qmUserCookie=u.data.qmUserCookie||utag.loader.RC("QuantumMetricUserID");u.data.qmSessionCookie=u.data.qmSessionCookie||utag.loader.RC("QuantumMetricSessionID");for(i=0;i<standard_replay_params.length;i++){if(u.data[standard_replay_params[i]]){replay_parameter_list.push(standard_replay_params[i]+u.data.kvp_delim+u.data[standard_replay_params[i]]);}}
if(!utag.ut.isEmptyObject(u.data.custom)){for(key in u.data.custom){if(u.data.custom.hasOwnProperty(key)){replay_parameter_list.push(key+u.data.kvp_delim+u.data.custom[key]);}}}
u.data.replay_url=u.data.replay_url.replace("##utag_subscription_name##",u.data.subscription_name);u.data.replay_url+=replay_parameter_list.join(u.data.qsp_delim);u.data.tealium_account=u.data.tealium_account||default_account_profile[0];u.data.tealium_profile=u.data.tealium_profile||default_account_profile[1];dc_parameter_list.push("tealium_account"+u.data.kvp_delim+u.data.tealium_account);dc_parameter_list.push("tealium_profile"+u.data.kvp_delim+u.data.tealium_profile);dc_parameter_list.push("tealium_vid"+u.data.kvp_delim+b["cp.utag_main_v_id"]);dc_parameter_list.push("quantum_metric_user_id"+u.data.kvp_delim+u.data.qmUserCookie);dc_parameter_list.push("quantum_metric_replay_url"+u.data.kvp_delim+encodeURIComponent(u.data.replay_url));u.data.dc_base_url+=dc_parameter_list.join(u.data.qsp_delim);var xhr=new XMLHttpRequest();xhr.open("get",u.data.dc_base_url,true);xhr.send();};u.handleRecstrat=function(){var cmSrc=pmc.getQueryStringValue("cm_src");var recstrat=pmc.getQueryStringValue("recstrat");var splitArray;var cmSrcStrategy;var cmSrcDataset;if(!cmSrc||!recstrat){return;}
splitArray=recstrat.split("%257C");if(splitArray.length<=1){return;}
cmSrcStrategy=splitArray[0];cmSrcDataset=splitArray[1];if(cmSrcStrategy&&cmSrcDataset){pmc.quantumMetrics.sendEvent(92,cmSrc);pmc.quantumMetrics.sendEvent(93,cmSrcStrategy);pmc.quantumMetrics.sendEvent(94,cmSrcDataset);}};u.eventHandlers=function(a,b,c){var i,len;var fireForEachProduct=function(eventNumber,utagArray){var productInfo;if(!pmc.isArray(b.product_id)||typeof eventNumber!=="number"){return;}
for(i=0,len=b.product_id.length;i<len;i++){productInfo=b.product_id[i];if(utagArray&&pmc.isArray(b[utagArray])&&b[utagArray][i]){productInfo+="|"+b[utagArray][i];}
pmc.quantumMetrics.sendEvent(eventNumber,productInfo);}};var isPageViewLike=function(){return(a==="view"||pmc.stringStartsWith(b.tealium_event,"sparc_module_"));};var utagToQuantumMap=[{utagVariable:"pmc_prop1",qmEvent:79,viewOnly:true},{utagVariable:"customer_email_public",qmEvent:81},{utagVariable:"pmc_eVar4",qmEvent:89},{utagVariable:"pmc_eVar27",qmEvent:10},{utagVariable:"pmc_eVar6",qmEvent:22},{utagVariable:"pmc_pageName",qmEvent:99,viewOnly:true},{utagVariable:"pmc_prop23",qmEvent:23},{utagVariable:"PIPGroupID",qmEvent:2,viewOnly:true},{utagVariable:"sc_visitor_id",qmEvent:61,viewOnly:true},{utagVariable:"sc_visitor_id",qmEvent:109,viewOnly:true},{utagVariable:"pmc_eVar179",qmEvent:100},{utagVariable:"pmc_event433",qmEvent:115},{utagVariable:"pmc_event382",qmEvent:117},];var mapItem,mappedValue;for(i=0,len=utagToQuantumMap.length;i<len;i++){mapItem=utagToQuantumMap[i];mappedValue=b[mapItem.utagVariable];if(mappedValue&&(!mapItem.viewOnly||isPageViewLike())){if(pmc.stringContains(mappedValue,"pmc_event")){pmc.quantumMetrics.sendEvent(mapItem.qmEvent);}else{pmc.quantumMetrics.sendEvent(mapItem.qmEvent,mappedValue);}}}
if(b.pmc_eVar48!=="anonymous"){pmc.quantumMetrics.sendEvent(86,b.pmc_eVar48);}
if(b.pmc_eVar40){if(b.pmc_eVar40==="no refinement"){if(b.facet_action==="unselected"||b.facet_action==="clear all"||b.facet_action==="show all"){pmc.quantumMetrics.sendEvent(88,"no refinement");}}else{pmc.quantumMetrics.sendEvent(88,b.pmc_eVar40);}}
if(b.pmc_event34==="event34"){pmc.quantumMetrics.sendEvent(18,b.pmc_eVar27);}
if(b.pmc_event434==="event434"){pmc.quantumMetrics.sendEvent(116,b.pmc_eVar90);}else if(b.tealium_event==="initiate_smart_login"&&pmc.checkNestedValue(digitalData,"page.pageName","account:trade login")){pmc.quantumMetrics.sendEvent(120,b.pmc_eVar90);}
var WsiRetailStore=pmc.readCookie("WSIRetailStore");if(WsiRetailStore){pmc.quantumMetrics.sendEvent(91,WsiRetailStore);}
if(b.tealium_event==="cart_add"){fireForEachProduct(19,"product_sku");}else if(b.tealium_event==="cart_remove"){fireForEachProduct(125,"product_sku");}else if(b.tealium_event==="registry_add"){fireForEachProduct(80,"product_sku");}else if(b.tealium_event==="registry_create"){pmc.quantumMetrics.sendEvent(84,b.pmc_eVar36+"|"+b.visitor_id);}else if(b.tealium_event==="registry_list_view"){pmc.quantumMetrics.sendEvent(85,pmc.getNestedValue(digitalData,"page.registry.attributes.userRole"));}else if(b.tealium_event==="purchase"){for(i=0,len=b.product_id.length;i<len;i++){pmc.quantumMetrics.sendEvent(82,b.product_id[i]);pmc.quantumMetrics.sendEvent(83,b.product_sku[i]);}}else if(pmc.stringStartsWith(b.tealium_event,"availability_")){fireForEachProduct(96,"product_availability");}
u.handleRecstrat();};u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){utag.DB("send:6649");utag.DB(b);var c,d,e,f;u.data={"qsp_delim":"&","kvp_delim":"=","subscription_name":"williamssonomainc","tealium_account":"","tealium_profile":"","send_replay_url":"false","ts":"","base_url":"//cdn.quantummetric.com/qscripts/quantum-##utag_subscription_name##.js","dc_base_url":"https://collect.tealiumiq.com/vdata/i.gif?","replay_url":"https://##utag_subscription_name##.quantummetric.com/#/users/search?","autoreplay":"true","replaysecond":"-20","qmUserCookie":"","qmSessionCookie":"","custom":{}};utag.DB("send:6649:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(u.data.hasOwnProperty(e[f])){u.data[e[f]]=b[d];}else{u.data.custom[e[f]]=b[d];}}}}
utag.DB("send:6649:MAPPINGS");utag.DB(u.data);if(!u.data.subscription_name){utag.DB(u.id+": Tag not fired: Required attribute subscription_name not populated");return;}
u.data.ts=u.data.ts||"30days";u.data.send_replay_url=(u.data.send_replay_url===true||u.data.send_replay_url.toLowerCase()==="true")?true:false;u.data.base_url=u.data.base_url.replace("##utag_subscription_name##",u.data.subscription_name);if(b["ut.env"]==="qa"||b["ut.env"]==="dev"){u.data.base_url=u.data.base_url.replace(".js","-test.js");}
if(u.initialized&&!u.replay_url_sent){u.loader_cb(a,b,c);}else{u.queue.push({"data":u.data,"a":a,"b":b,"c":c});if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":"script","src":u.data.base_url,"cb":u.callBack,"loc":"script","id":"utag_6649","attrs":{}});}}
utag.DB("send:6649:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("6649","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.6728 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'view':1,'link':1,};u.initialized=false;u.map={"tealium_event":"tiktok_event","tiktok_pixel_id":"tiktok_pixel_id","random_order_id":"order_id","tiktok_products":"contents"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'we':'C2NE9AI3E7AIH24LVQBG'},{'pb':'CAKHC7RC77UCMC06MKO0'},{'ws':'CAKHGNJC77UEEA6MN090'},{'pk':'CAKBJNBC77U2DR2N75P0'},{'pt':'C7SNDBT6KGKTT9CME6VG'},{'mg':'CAKBO7JC77U10NC70VKG'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['tiktok_pixel_id']=c[e][f];m=true};};if(m)break};}},function(a,b){try{if(1){const formatProducts=function(){const tiktokArray=[];if(pmc.isArray(_cprod)&&pmc.isArray(_cquan)&&pmc.isArray(_cprice)){for(let i=0,len=_cprod.length;i<len;i++){tiktokArray.push({content_id:_cprod[i]||"",content_type:"product",quantity:_cquan[i]||0,price:_cprice[i]||0,});}}
return JSON.stringify(tiktokArray);};b.tiktok_products=formatProducts();}}catch(e){utag.DB(e)}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,i;u.data={"product_id":[],"product_name":[],"product_category":[],"product_quantity":[],"product_unit_price":[],};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
u.data.order_id=u.data.order_id||b._corder||"";u.data.order_subtotal=u.data.order_subtotal||b._csubtotal||"";u.data.order_currency=u.data.order_currency||b._ccurrency||"";if(u.data.product_id.length===0&&b._cprod!==undefined){u.data.product_id=b._cprod.slice(0);}
if(u.data.product_name.length===0&&b._cprodname!==undefined){u.data.product_name=b._cprodname.slice(0);}
if(u.data.product_category.length===0&&b._ccat!==undefined){u.data.product_category=b._ccat.slice(0);}
if(u.data.product_quantity.length===0&&b._cquan!==undefined){u.data.product_quantity=b._cquan.slice(0);}
if(u.data.product_unit_price.length===0&&b._cprice!==undefined){u.data.product_unit_price=b._cprice.slice(0);}
u.loader_cb=function(){u.initialized=true;var tikTokItems=[];if(u.data.product_id.length>0){for(var i=0;i<u.data.product_id.length;i++){var tikTokItem={content_type:'product',content_id:u.data.product_id[i],content_category:u.data.product_category[i],price:parseFloat(u.data.product_unit_price[i])||0,quantity:parseFloat(u.data.product_quantity[i])||0,}
tikTokItems.push(tikTokItem);}}
if(u.data.customer_email_public){ttq.identify({sha256_email:u.data.customer_email_public.toLowerCase(),});}
if(u.data.tiktok_event==="cart_add"){ttq.track('AddToCart',{contents:tikTokItems,currency:'USD',});}else if(u.data.tiktok_event==="product_view"){ttq.track('ViewContent',{content_type:'product_group',content_id:utag_data.PIPGroupID,content_category:u.data.product_category[0],});}else if(u.data.tiktok_event==="registry_create"){ttq.track('CompleteRegistration',{contents:tikTokItems,});}else if(u.data.tiktok_event==="purchase"){ttq.track('CompletePayment',{contents:tikTokItems,value:u.data.order_subtotal,currency:u.data.order_currency,description:u.data.order_id,});}}
if(u.initialized){u.loader_cb(a,b,c);}else{!function(w,d,t){w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=['page','track','identify','instances','debug','on','off','once','ready','alias','group','enableCookie','disableCookie'],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)
ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)
ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var i='https://analytics.tiktok.com/i18n/pixel/events.js';ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};var o=document.createElement('script');o.type='text/javascript',o.async=!0,o.src=i+'?sdkid='+e+'&lib='+t;var a=document.getElementsByTagName('script')[0];a.parentNode.insertBefore(o,a)};ttq.load(u.data.tiktok_pixel_id);ttq.page();}(window,document,'ttq');u.loader_cb();}
}};utag.o[loader].loader.LOAD(id);})("6728","wsi.williamssonoma");}catch(error){utag.DB(error);}

//tealium universal tag - utag.6744 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.loader===undefined){u.loader=function(o){var b,c,l,a=document;if(o.type==="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l];}b.src=o.src;}if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}}}else{u.loader=utag.ut.loader;}
u.encode=function(a,b){b="";try{b=encodeURIComponent(a)}catch(e){utag.DB(e);}if(b==""){b=escape(a);}return b}
u.ev={"view":1,"link":1};u.scriptrequested=false;u.rp=function(a,b){if(typeof a!=="undefined"&&a.indexOf("@@")>0){a=a.replace(/@@([^@]+)@@/g,function(m,d){if(b[d]){return u.encode(b[d]);}else{return"";}});}
return a;};u.variableNameMap=[{topCatName:"ws-home",catID:"px_7611cf2575995c",catCode:"px_8611cf2afd7cfb",pageType:"px_9611cf30a66432",superCategories:"px_4611cf31b38b4d",topCat:"px_0611cf32e86b73",pageName:"px_7611cf340cda7f",SiteCat:"px_3611cf35306cb8",PathName:"px_6611cf365d0057",},{topCatName:"west-elm",catID:"px_0611cf977dc60b",catCode:"px_1611cfa04a1342",pageType:"px_1611cfa2d62c1b",superCategories:"px_4611cfa5015527",topCat:"px_1611cfa64f3122",pageName:"px_3611cfa7842a50",SiteCat:"px_6611cfa8cee82c",PathName:"px_3611cfa9de6466",},{topCatName:"potterybarn",catID:"px_0611d01eba32d3",catCode:"px_9611d01f9b9912",pageType:"px_0611d0508a6aae",superCategories:"px_9611d0238a529a",topCat:"px_6611d024ceef3a",pageName:"px_1611d025a2deb9",SiteCat:"px_4611d026844d01",PathName:"px_4611d0275336f3",},{topCatName:"pk-kids",catID:"px_6611d099c78a80",catCode:"px_7611d09c614821",pageType:"px_2611d09d7e74d6",superCategories:"px_3611d09e4ec9ca",topCat:"px_8611d09f28c35e",pageName:"px_8611d09ffc9e67",SiteCat:"px_8611d0a11322b5",PathName:"px_5611d0a1e3f4e6",},{topCatName:"pbteen",catID:"px_3611d14028aa4c",catCode:"px_4611d1412a56aa",pageType:"px_0611d176b878ae",superCategories:"px_1611d177a158ed",topCat:"px_9611d17881e925",pageName:"px_0611d1798305a7",SiteCat:"px_9611d17a650a05",PathName:"px_1611d17b3256b6",},{topCatName:"markandgraham",catID:"px_0611d1b553980d",catCode:"px_9611d1b715448b",pageType:"px_2611d1b7fea6ec",superCategories:"px_9611d1b96370e2",topCat:"px_0611d1bade8bcd",pageName:"px_1611d1bbe242cc",SiteCat:"px_4611d1bcaca5f3",PathName:"px_6611d1bda14442",},{topCatName:"ws-kitchen",catID:"px_7611ee9c1ea40e",catCode:"px_3611ee9f030ac5",pageType:"px_9611eea08d857e",superCategories:"px_7611eea240e1c9",topCat:"px_2611eea4c5f0be",pageName:"px_0611eea6770deb",SiteCat:"px_1611eea83f35ac",PathName:"px_7611eeaa72d8e8",},{topCatName:"B2B",catID:"px_4611eebf3de9ca",catCode:"px_9611eec09ef30b",pageType:"px_9611eec1cd2c4d",superCategories:"px_1611eec2fa3e36",topCat:"px_9611eec44c0332",pageName:"px_0611eec5a47b21",SiteCat:"px_1611eec77a5220",PathName:"px_6611eec9d2d32c",},{topCatName:"we-kids",catID:"px_5611f75ab5b43c",catCode:"px_0611f75c06dc4f",pageType:"px_9611f75ccc919f",superCategories:"px_0611f764043e51",topCat:"px_0611f764f7d556",pageName:"px_5611f765a8a2a1",SiteCat:"px_4611f7666aaba0",PathName:"px_9611f7674c51cf",},{topCatName:"rejuvenation",catID:"px_9611eee53cf5e4",catCode:"px_0611eeed3d7262",pageType:"px_5611eeff962bc4",superCategories:"px_1611ef00e4f1e2",topCat:"px_4611ef02715d81",pageName:"px_6611ef0438037e",SiteCat:"px_6611ef06b60fb3",PathName:"px_2611ef07ed6364",},{topCatName:"greenrow",catID:"px_8V3OFPEDyXx9Y9",catCode:"px_k011BBf6IrI2t1",pageType:"px_cdQup20yElyKtT",superCategories:"px_6qMNFxtG4Uq4Uq",topCat:"px_sXhp9MkbAYVVIK",pageName:"px_i7vlPgrJ48eMQQ",SiteCat:"px_EXMtRAgctMk6p8",PathName:"px_oSsUn9wPSlCFjD",},];u.remapVariables=function(params,map){var newParams=[];var found;for(var i=0,iLen=params.length;i<iLen;i++){found=false;for(var j in map){if(pmc.stringStartsWith(params[i],j)){newParams.push(params[i].replace(j,map[j]));found=true;break;}}
if(!found){newParams.push(params[i]);}}
return newParams;};u.findInMap=function(params){var topCatName="";for(var j=0,jLen=u.variableNameMap.length;j<jLen;j++){topCatName=u.variableNameMap[j].topCatName;for(var i=0,iLen=params.length;i<iLen;i++){if(pmc.stringStartsWith(params[i],"topCat")&&pmc.stringContains(params[i],topCatName)){return u.remapVariables(params,u.variableNameMap[j]);}}}};u.map={"jivox_pixel_id":"px","encoded_path_name":"PathName","_cprod":"cData","category_id":"catID","category_path_string":"catCode","page_type":"pageType","pmc_pageName":"pageName","top_category":"superCategories","jivox_top_cat":"topCat","sc_visitor_id":"SiteCat"};u.extend=[function(a,b){try{if(1){b.category_path_string=Array.isArray(b.category_path)?b.category_path.join(','):"";b.product_id_string=Array.isArray(b.product_id)?b.product_id.join(","):"";b.product_unit_price_string=Array.isArray(b.product_unit_price)?b.product_unit_price.join(","):"";}}catch(e){utag.DB(e)}},function(a,b){try{if(1){var jivoxTopCatMap=[{key:"pb",value:"potterybarn",},{key:"pb-apartment",value:"potterybarn",},{key:"ws-kitchen",value:"ws-kitchen",},{key:"ws-home",value:"ws-home",},{key:"we",value:"west-elm",},{key:"we-collection",value:"west-elm",},{key:"we-kids",value:"west-elm",},{key:"we-b2b",value:"west-elm",},{key:"pt",value:"pbteen",},{key:"pt-dorm",value:"pbteen",},{key:"pk",value:"pk-kids",},{key:"pk-baby",value:"pk-kids",},{key:"pk-modern-baby",value:"pk-kids",},{key:"mg",value:"markandgraham",},{key:"rj",value:"rejuvenation",},];b.jivox_top_cat=pmc.resolveMapLookup(jivoxTopCatMap,b.subBrand);}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'pb':'jvxpxl.potterybarn.com'},{'ws':'jvxpxl.williams-sonoma.com'},{'we':'jvxpxl.westelm.com'},{'pt':'jvxpxl.pbteen.com'},{'pk':'jvxpxl.potterybarnkids.com'},{'mg':'jvxpxl.markandgraham.com'},{'rj':'jvxpxl.rejuvenation.com'},{'gr':'jvxpxl.greenrow.com'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['jivox_endpoint']=c[e][f];m=true};};if(m)break};if(!m)b['jivox_endpoint']='';}},function(a,b){try{if(1){var getJivoxId=function(){var idMap=[{key:"ws",value:"6611ee7cc2efe2"},{key:"pb",value:"6611d01c897da3"},{key:"pk",value:"8611d098743eae"},{key:"pt",value:"3611d13f090630"},{key:"we",value:"8611cf94deb378"},{key:"mg",value:"7611d1b28d5ee7"},{key:"rj",value:"2611eee1f4d7b9"},];if(utag_data.brand==="ws"&&utag_data.subBrand==="ws-home"){return"3611cef46693a8";}else if(utag_data.brand==="we"&&utag_data.subBrand==="we-kids"){return"1611f74edc435b";}
return pmc.resolveMapLookup(idMap,utag_data.brand);};b.jivox_pixel_id=getJivoxId();}}catch(e){utag.DB(e)}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f;u.data={"qsp_delim":"&"||"&","kvp_delim":"="||"=","qs_delim":"?"||"?","tag_type":"img","base_url":"https://@@jivox_endpoint@@/tags/re/pxrc.php","secure_base_url":"","static_params":"ret=img","cachebust":"disabled","cachevar":""||"_rnd","requestscriptonce":"disabled"};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:6744:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(typeof b[d]!=="undefined"&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(!u.data.hasOwnProperty(e[f])){c.push(e[f]+"##kvp_delim##"+u.encode(b[d]));}
u.data[e[f]]=b[d];}}}
if(!u.data.base_url){if(!u.data.secure_base_url){utag.DB("Error: No Base URL or Secure HTTPS Override Provided.");return;}else{u.data.base_url=u.data.secure_base_url;utag.DB("No Base URL provided, using Secure HTTPS Override.");}}
u.data.secure_base_url=u.data.secure_base_url||u.data.base_url;u.data.url=(location.protocol==="https:"?u.data.secure_base_url:u.data.base_url);if(u.data.url.indexOf("http")!==0&&u.data.url.indexOf("/")!==0){u.data.url=location.protocol+"//"+u.data.url;}
if(u.data.static_params){c.push(u.data.static_params);}
var cb_check=new RegExp("(\\"+u.data.qs_delim+"|"+u.data.qsp_delim+")"+u.data.cachevar+"=");if(u.data.cachebust==="enabled"&&!cb_check.test(u.data.url)){c.push([u.data.cachevar,Math.random()].join(u.data.kvp_delim));}
if(c.length>0){if(u.data.url.indexOf(u.data.qs_delim)<0){u.data.url+=u.data.qs_delim;}else if(u.data.url.indexOf(u.data.qs_delim)!==(u.data.url.length-1)){u.data.url+=u.data.qsp_delim;}}
if(u.data.pageType==="product"){u.data.fakeTopCat="browse";}
if(u.data.pageName==="add item:add to cart"){u.data.fakeTopCat="";u.data.fakePageName="cart add"}
c=u.findInMap(c);u.data.url=u.rp(u.data.url,b)+u.rp(c.join(u.data.qsp_delim),b);u.data.url=u.data.url.replace(/##kvp_delim##/g,u.data.kvp_delim);u.data.url+=u.data.fakeTopCat?"&topCat=browse":"";u.data.url+=u.data.fakePageName?"&pageName=cart%20add":"";u.callback=u.callback||function(){};if(u.data.requestscriptonce==="enabled"&&u.data.tag_type==="script"){if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_6744","cb":u.callback});}else{u.callback();}}else{u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_6744","cb":u.callback});}
utag.DB("send:6744:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("6744","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.6753 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.loader===undefined){u.loader=function(o){var b,c,l,a=document;if(o.type==="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l];}b.src=o.src;}if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}}}else{u.loader=utag.ut.loader;}
u.encode=function(a,b){b="";try{b=encodeURIComponent(a)}catch(e){utag.DB(e);}if(b==""){b=escape(a);}return b}
u.ev={"view":1};u.scriptrequested=false;u.rp=function(a,b){if(typeof a!=="undefined"&&a.indexOf("@@")>0){a=a.replace(/@@([^@]+)@@/g,function(m,d){if(b[d]){return u.encode(b[d]);}else{return"";}});}
return a;};u.map={};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'pb':'jvxpxl.potterybarn.com'},{'ws':'jvxpxl.williams-sonoma.com'},{'we':'jvxpxl.westelm.com'},{'pt':'jvxpxl.pbteen.com'},{'pk':'jvxpxl.potterybarnkids.com'},{'mg':'jvxpxl.markandgraham.com'},{'rj':'jvxpxl.rejuvenation.com'},{'gr':'jvxpxl.greenrow.com'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['jivox_endpoint']=c[e][f];m=true};};if(m)break};if(!m)b['jivox_endpoint']='';}},function(a,b){try{if(1){var getJivoxId=function(){var idMap=[{key:"ws",value:"9622aedc4d5cbb"},{key:"pb",value:"3622aec596c2f1"},{key:"pk",value:"2622aec9725295"},{key:"pt",value:"5622aecf6b5506"},{key:"we",value:"0622aed635ceee"},{key:"mg",value:"4622ae954a70e6"},];if(utag_data.brand==="ws"&&utag_data.subBrand==="ws-home"){return"6622aed98d33a0";}
return pmc.resolveMapLookup(idMap,utag_data.brand);};b.jivox_pixel_id=getJivoxId();}}catch(e){utag.DB(e)}},function(a,b){try{if(1){var getJivoxCoptId=function(){var idMap=[{key:"ws",value:"WSK_PlusOne"},{key:"pb",value:"PB_PlusOne"},{key:"pk",value:"PBK_PlusOne"},{key:"pt",value:"PBT_PlusOne"},{key:"we",value:"WestElm_Plus"},{key:"mg",value:"MG_PlusOne"},];if(utag_data.brand==="ws"&&utag_data.subBrand==="ws-home"){return"WSH_PlusOne";}
return pmc.resolveMapLookup(idMap,utag_data.brand);};b.jivox_copt_id=getJivoxCoptId();}}catch(e){utag.DB(e)}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f;u.data={"qsp_delim":"&"||"&","kvp_delim":"="||"=","qs_delim":"?"||"?","tag_type":"img","base_url":"//@@jivox_endpoint@@/tags/conv/pxre.php?px=@@jivox_pixel_id@@&cOpt=@@jivox_copt_id@@","secure_base_url":"","static_params":"","cachebust":"disabled","cachevar":""||"_rnd","requestscriptonce":"disabled"};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:6753:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(typeof b[d]!=="undefined"&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(!u.data.hasOwnProperty(e[f])){c.push(e[f]+"##kvp_delim##"+u.encode(b[d]));}
u.data[e[f]]=b[d];}}}
if(!u.data.base_url){if(!u.data.secure_base_url){utag.DB("Error: No Base URL or Secure HTTPS Override Provided.");return;}else{u.data.base_url=u.data.secure_base_url;utag.DB("No Base URL provided, using Secure HTTPS Override.");}}
u.data.secure_base_url=u.data.secure_base_url||u.data.base_url;u.data.url=(location.protocol==="https:"?u.data.secure_base_url:u.data.base_url);if(u.data.url.indexOf("http")!==0&&u.data.url.indexOf("/")!==0){u.data.url=location.protocol+"//"+u.data.url;}
if(u.data.static_params){c.push(u.data.static_params);}
var cb_check=new RegExp("(\\"+u.data.qs_delim+"|"+u.data.qsp_delim+")"+u.data.cachevar+"=");if(u.data.cachebust==="enabled"&&!cb_check.test(u.data.url)){c.push([u.data.cachevar,Math.random()].join(u.data.kvp_delim));}
if(c.length>0){if(u.data.url.indexOf(u.data.qs_delim)<0){u.data.url+=u.data.qs_delim;}else if(u.data.url.indexOf(u.data.qs_delim)!==(u.data.url.length-1)){u.data.url+=u.data.qsp_delim;}}
u.data.url=u.rp(u.data.url,b)+u.rp(c.join(u.data.qsp_delim),b);u.data.url=u.data.url.replace(/##kvp_delim##/g,u.data.kvp_delim);u.callback=u.callback||function(){};if(u.data.requestscriptonce==="enabled"&&u.data.tag_type==="script"){if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_6753","cb":u.callback});}else{u.callback();}}else{u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_6753","cb":u.callback});}
utag.DB("send:6753:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("6753","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.6754 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.loader===undefined){u.loader=function(o){var b,c,l,a=document;if(o.type==="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l];}b.src=o.src;}if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}}}else{u.loader=utag.ut.loader;}
u.encode=function(a,b){b="";try{b=encodeURIComponent(a)}catch(e){utag.DB(e);}if(b==""){b=escape(a);}return b}
u.ev={"view":1};u.scriptrequested=false;u.rp=function(a,b){if(typeof a!=="undefined"&&a.indexOf("@@")>0){a=a.replace(/@@([^@]+)@@/g,function(m,d){if(b[d]){return u.encode(b[d]);}else{return"";}});}
return a;};u.map={};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'pb':'jvxpxl.potterybarn.com'},{'ws':'jvxpxl.williams-sonoma.com'},{'we':'jvxpxl.westelm.com'},{'pt':'jvxpxl.pbteen.com'},{'pk':'jvxpxl.potterybarnkids.com'},{'mg':'jvxpxl.markandgraham.com'},{'rj':'jvxpxl.rejuvenation.com'},{'gr':'jvxpxl.greenrow.com'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['jivox_endpoint']=c[e][f];m=true};};if(m)break};if(!m)b['jivox_endpoint']='';}},function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'mg':'Key_PlusOne_MG'},{'pb':'Key_PlusOne_PB'},{'pk':'Key_PlusOne_PBK'},{'pt':'Key_PlusOne_PBT'},{'we':'Key_PlusOne_WE'},{'ws':'Key_PlusOne_WS'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['jivox_copt_id']=c[e][f];m=true};};if(m)break};}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f;u.data={"qsp_delim":"&"||"&","kvp_delim":"="||"=","qs_delim":"?"||"?","tag_type":"img","base_url":"//@@jivox_endpoint@@/tags/conv/pxre.php?px=2612769378a2f3&cOpt=@@jivox_copt_id@@&rev=0","secure_base_url":"","static_params":"","cachebust":"disabled","cachevar":""||"_rnd","requestscriptonce":"disabled"};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:6754:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(typeof b[d]!=="undefined"&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(!u.data.hasOwnProperty(e[f])){c.push(e[f]+"##kvp_delim##"+u.encode(b[d]));}
u.data[e[f]]=b[d];}}}
if(!u.data.base_url){if(!u.data.secure_base_url){utag.DB("Error: No Base URL or Secure HTTPS Override Provided.");return;}else{u.data.base_url=u.data.secure_base_url;utag.DB("No Base URL provided, using Secure HTTPS Override.");}}
u.data.secure_base_url=u.data.secure_base_url||u.data.base_url;u.data.url=(location.protocol==="https:"?u.data.secure_base_url:u.data.base_url);if(u.data.url.indexOf("http")!==0&&u.data.url.indexOf("/")!==0){u.data.url=location.protocol+"//"+u.data.url;}
if(u.data.static_params){c.push(u.data.static_params);}
var cb_check=new RegExp("(\\"+u.data.qs_delim+"|"+u.data.qsp_delim+")"+u.data.cachevar+"=");if(u.data.cachebust==="enabled"&&!cb_check.test(u.data.url)){c.push([u.data.cachevar,Math.random()].join(u.data.kvp_delim));}
if(c.length>0){if(u.data.url.indexOf(u.data.qs_delim)<0){u.data.url+=u.data.qs_delim;}else if(u.data.url.indexOf(u.data.qs_delim)!==(u.data.url.length-1)){u.data.url+=u.data.qsp_delim;}}
u.data.url=u.rp(u.data.url,b)+u.rp(c.join(u.data.qsp_delim),b);u.data.url=u.data.url.replace(/##kvp_delim##/g,u.data.kvp_delim);u.callback=u.callback||function(){};if(u.data.requestscriptonce==="enabled"&&u.data.tag_type==="script"){if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_6754","cb":u.callback});}else{u.callback();}}else{u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_6754","cb":u.callback});}
utag.DB("send:6754:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("6754","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.6768 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.loader===undefined){u.loader=function(o){var b,c,l,a=document;if(o.type==="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l];}b.src=o.src;}if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}}}else{u.loader=utag.ut.loader;}
u.encode=function(a,b){b="";try{b=encodeURIComponent(a)}catch(e){utag.DB(e);}if(b==""){b=escape(a);}return b}
u.ev={"view":1};u.scriptrequested=false;u.rp=function(a,b){if(typeof a!=="undefined"&&a.indexOf("@@")>0){a=a.replace(/@@([^@]+)@@/g,function(m,d){if(b[d]){return u.encode(b[d]);}else{return"";}});}
return a;};u.map={"product_id_string":"cData","category_id":"px_96125841c23163","category_path_string":"px_761258433ad59b","page_type":"px_8612584e3574b3","top_category":"px_96125853c905fa","turn_top_cat":"px_6602308d7ce9df","encoded_path_name":"px_66125854e93499","pmc_pageName":"px_56125852ad8615","sc_visitor_id":"px_06023090d888ca"};u.extend=[function(a,b){try{if(1){var turnTopCatMap=[{key:"pb",value:"potterybarn",},{key:"pb-apartment",value:"pb-apartment",},{key:"ws-kitchen",value:"ws-kitchen",},{key:"ws-home",value:"ws-home",},{key:"we",value:"west-elm",},{key:"we-collection",value:"west-elm-collection",},{key:"we-kids",value:"west-elm",},{key:"pt",value:"pbteen",},{key:"pt-dorm",value:"pbdorm",},{key:"pk",value:"pk-kids",},{key:"pk-baby",value:"pk-baby",},{key:"pk-modern-baby",value:"pk-baby",},{key:"mg",value:"markandgraham",},{key:"rj",value:"rejuvenation",},{key:"gr",value:"greenrow",},];b.turn_top_cat=pmc.resolveMapLookup(turnTopCatMap,b.subBrand);}}catch(e){utag.DB(e)}},function(a,b){try{if(1){b.category_path_string=Array.isArray(b.category_path)?b.category_path.join(','):"";b.product_id_string=Array.isArray(b.product_id)?b.product_id.join(","):"";b.product_unit_price_string=Array.isArray(b.product_unit_price)?b.product_unit_price.join(","):"";}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'pb':'jvxpxl.potterybarn.com'},{'ws':'jvxpxl.williams-sonoma.com'},{'we':'jvxpxl.westelm.com'},{'pt':'jvxpxl.pbteen.com'},{'pk':'jvxpxl.potterybarnkids.com'},{'mg':'jvxpxl.markandgraham.com'},{'rj':'jvxpxl.rejuvenation.com'},{'gr':'jvxpxl.greenrow.com'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['jivox_endpoint']=c[e][f];m=true};};if(m)break};if(!m)b['jivox_endpoint']='';}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f;u.data={"qsp_delim":"&"||"&","kvp_delim":"="||"=","qs_delim":"?"||"?","tag_type":"img","base_url":"https://@@jivox_endpoint@@/tags/re/pxrc.php","secure_base_url":"","static_params":"px=4612583e1ea81e&ret=img","cachebust":"disabled","cachevar":""||"_rnd","requestscriptonce":"disabled"};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:6768:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(typeof b[d]!=="undefined"&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(!u.data.hasOwnProperty(e[f])){c.push(e[f]+"##kvp_delim##"+u.encode(b[d]));}
u.data[e[f]]=b[d];}}}
if(!u.data.base_url){if(!u.data.secure_base_url){utag.DB("Error: No Base URL or Secure HTTPS Override Provided.");return;}else{u.data.base_url=u.data.secure_base_url;utag.DB("No Base URL provided, using Secure HTTPS Override.");}}
u.data.secure_base_url=u.data.secure_base_url||u.data.base_url;u.data.url=(location.protocol==="https:"?u.data.secure_base_url:u.data.base_url);if(u.data.url.indexOf("http")!==0&&u.data.url.indexOf("/")!==0){u.data.url=location.protocol+"//"+u.data.url;}
if(u.data.static_params){c.push(u.data.static_params);}
var cb_check=new RegExp("(\\"+u.data.qs_delim+"|"+u.data.qsp_delim+")"+u.data.cachevar+"=");if(u.data.cachebust==="enabled"&&!cb_check.test(u.data.url)){c.push([u.data.cachevar,Math.random()].join(u.data.kvp_delim));}
if(c.length>0){if(u.data.url.indexOf(u.data.qs_delim)<0){u.data.url+=u.data.qs_delim;}else if(u.data.url.indexOf(u.data.qs_delim)!==(u.data.url.length-1)){u.data.url+=u.data.qsp_delim;}}
u.data.url=u.rp(u.data.url,b)+u.rp(c.join(u.data.qsp_delim),b);u.data.url=u.data.url.replace(/##kvp_delim##/g,u.data.kvp_delim);u.callback=u.callback||function(){};if(u.data.requestscriptonce==="enabled"&&u.data.tag_type==="script"){if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_6768","cb":u.callback});}else{u.callback();}}else{u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_6768","cb":u.callback});}
utag.DB("send:6768:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("6768","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.6780 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;u.ev={"view":1,"link":1};u.map={"ga4_property_id":"measurement_id","tealium_event:cart_add":"add_to_cart","tealium_event:cart_view":"view_cart","tealium_event:product_view":"view_item","tealium_event:cart_remove":"remove_from_cart","tealium_event:favorites_add":"add_to_wishlist","tealium_event:thekey_confirm_view":"rewards_sign_up","tealium_event:registry_create":"create_registry","tealium_event:bosts_select_store":"select_store","tealium_event:pickup_delivery_store_change":"select_store","tealium_event:registry_add":"add_to_registry","tealium_event:swatch_legacy_submit":"order_swatches","tealium_event:swatch_order_submit":"order_swatches","tealium_event:qudini_scheduling_appointment_confirmation":"schedule_appointment","tealium_event:key_confirmation":"rewards_sign_up","pmc_scCheckout:checkout":"begin_checkout","pmc_event51:event51":"login","pmc_event52:event52":"sign_up","page_type:category":"view_item_list","page_type":"page_view.page_type","page_name":"view_item_list.item_list_name","pmc_event32:event32":"generate_lead","shippingConsolidationSelected":"add_shipping_info.shipping_tier","hasShippingConsolidationSelected:yes":"add_shipping_info","pmc_eVar7":"add_payment_info.payment_type","hasTenderType:yes":"add_payment_info","pmc_event207:event207":"rewards_sign_up","storeSelected":"select_store.storeSelected","pmc_eVar95":"select_store.store_id","pmc_eVar103":"select_store.store_brand","category_id":"page_view.shop_category","top_category":"page_view.shop_top_category","subBrand":"page_view.concept","random_order_id":"order_id","sc_visitor_id":"page_view.adobe_id"};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'pk-us':'6KZGSRMSPR'},{'ws-us':'08GWQKHEM5'},{'we-us':'5LHKHW4CJN'},{'pb-us':'WK1YY1TWBW'},{'pt-us':'RE029VB3PS'},{'mg-us':'HWDG5Z5DGL'},{'ws-ca':'D8BT06MM1Z'},{'pt-ca':'1ED2JH8H4E'},{'pb-ca':'L5N06XE6C5'},{'pk-ca':'QY7W7DBBYT'},{'we-ca':'C8S7V1PH3Y'},{'rj-us':'BRWP7QZVL8'},{'gr-us':'VTVCZQQECF'},{'mg-ca':'RRBRKD658R'},{'rj-ca':'LKG5EZWZG6'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['ga4_property_id']=c[e][f];m=true};};if(m)break};if(!m)b['ga4_property_id']='';}},function(a,b){try{if(1){if(b.shippingConsolidationSelected){b.hasShippingConsolidationSelected="yes";}
if(b.pmc_eVar7){b.hasTenderType="yes";}}}catch(e){utag.DB(e)}}];u.send=function(utag_event,data_layer){if(u.ev[utag_event]||u.ev.all!==undefined){utag.DB("send:6780");utag.DB(data_layer);var a,b,c,d,i,j,has_purchase=false,prop;a=utag_event;b=data_layer;u.data={"base_url":"https://www.googletagmanager.com/gtag/js?id=##utag_measurement_id##","measurement_id":"SET_BY_EXTENSION","clear_global_vars":"false","data_layer_name":"","send_page_view":"true","order_id":"","order_total":"","order_subtotal":"","order_shipping":"","order_tax":"","order_store":"","order_currency":"","order_coupon_code":"","product_id":[],"product_name":[],"product_brand":[],"product_category":[],"product_subcategory":[],"product_addcategory3":[],"product_addcategory4":[],"product_addcategory5":[],"product_quantity":[],"product_unit_price":[],"product_discount":[],"product_coupon":[],"product_variant":[],"product_promotion_id":[],"product_promotion_name":[],"product_creative_name":[],"product_creative_slot":[],"product_location_id":[],"product_index":[],"product_item_list_name":[],"product_item_list_id":[],"product_affiliation":[],"event_queue":[],"config":{},"set":{"developer_id.dYmQxMT":true,"user_properties":{}},"event":{},"items":[]};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:6780:EXTENSIONS");utag.DB(data_layer);for(var mapping_key in utag.loader.GV(u.map)){if(data_layer[mapping_key]!==undefined&&data_layer[mapping_key]!==""){var destinations=u.map[mapping_key].split(",");for(i=0;i<destinations.length;i++){mapFunc(destinations[i].split("."),u.data,data_layer[mapping_key]);}}else{var event_destinations=mapping_key.split(":");if(event_destinations.length===2&&data_layer[event_destinations[0]]===event_destinations[1]){if(u.map[mapping_key]){u.data.event_queue=u.data.event_queue.concat(u.map[mapping_key].split(","));}}}}
utag.DB("send:6780:MAPPINGS");utag.DB(u.data);u.data.order_id=u.data.order_id||data_layer._corder||"";u.data.order_total=u.data.order_total||data_layer._ctotal||"";u.data.order_shipping=u.data.order_shipping||data_layer._cship||"";u.data.order_tax=u.data.order_tax||data_layer._ctax||"";u.data.order_store=u.data.order_store||data_layer._cstore||"";u.data.order_currency=u.data.order_currency||data_layer._ccurrency||"";u.data.order_coupon_code=u.data.order_coupon_code||data_layer._cpromo||"";u.data.customer_id=u.data.customer_id||data_layer._ccustid||"";u.data.customer_city=u.data.customer_city||data_layer._ccity||"";u.data.customer_state=u.data.customer_state||data_layer._cstate||"";u.data.customer_zip=u.data.customer_zip||data_layer._czip||"";u.data.customer_country=u.data.customer_country||data_layer._ccountry||"";if(u.data.product_id.length===0&&data_layer._cprod!==undefined){u.data.product_id=data_layer._cprod.slice(0);}
if(u.data.product_name.length===0&&data_layer._cprodname!==undefined){u.data.product_name=data_layer._cprodname.slice(0);}
if(u.data.product_brand.length===0&&data_layer._cbrand!==undefined){u.data.product_brand=data_layer._cbrand.slice(0);}
if(u.data.product_category.length===0&&data_layer._ccat!==undefined){u.data.product_category=data_layer._ccat.slice(0);}
if(u.data.product_subcategory.length===0&&data_layer._ccat2!==undefined){u.data.product_subcategory=data_layer._ccat2.slice(0);}
if(u.data.product_quantity.length===0&&data_layer._cquan!==undefined){u.data.product_quantity=data_layer._cquan.slice(0);}
if(u.data.product_unit_price.length===0&&data_layer._cprice!==undefined){u.data.product_unit_price=data_layer._cprice.slice(0);}
if(u.data.product_discount.length===0&&data_layer._cpdisc!==undefined){u.data.product_discount=data_layer._cpdisc.slice(0);}
if(utag.ut.typeOf(u.data.measurement_id)==="string"&&u.data.measurement_id!==""){u.data.measurement_id=u.data.measurement_id.replace(/\s/g,"").split(",");}
if(u.data.data_layer_name){u.data.base_url=u.data.base_url+"&l="+u.data.data_layer_name;}
if(!u.data.measurement_id){utag.DB(u.id+": Tag not fired: Required attribute measurement_id not populated");return;}
if(u.data.gtag_enable_tcf_support){window["gtag_enable_tcf_support"]=toBoolean(u.data.gtag_enable_tcf_support);}
var utmParams=["utm_source","utm_medium","utm_campaign","utm_term","utm_content"];var utmPageLocation=u.data.config.page_location||data_layer["dom.url"];var utmQuery=[];utmParams.forEach(function(paramName){if(u.data[paramName]&&utmPageLocation.indexOf(paramName+"=")===-1){utmQuery.push(paramName+"="+u.data[paramName]);}});if(utmQuery.length){u.data.config.page_location=utmPageLocation.indexOf("?")===-1?utmPageLocation+"?"+utmQuery.join("&"):utmPageLocation+"&"+utmQuery.join("&");}
u.data.event.send_to=u.data.event.send_to||u.data.measurement_id;if(u.data.customer_id){u.data.config.user_id=u.data.customer_id;}
if(toBoolean(u.data.clear_global_vars)){setGlobalProperties(u.data.config,true);for(prop in utag.loader.GV(u.data.set)){if(prop!=="developer_id.dYmQxMT"){setGlobalProperties(u.data.set,true,prop);}}}
setGlobalProperties(u.data.config,false);setGlobalProperties(u.data.set,false);if(u.data.config.send_page_view!==undefined){u.data.send_page_view=toBoolean(u.data.config.send_page_view);}
if(!u.initialized&&toBoolean(u.data.send_page_view)){u.data.event_queue.unshift("page_view");}
u.data.config.send_page_view=false;for(i=0;i<u.data.measurement_id.length;i++){if(!/^[a-zA-Z]{1}-|^[a-zA-Z]{2}-/.test(u.data.measurement_id[i])){u.data.measurement_id[i]="G-"+u.data.measurement_id[i];}
u.o("config",u.data.measurement_id[i],u.data.config);}
u.initialized=true;for(i=0;i<u.data.event_queue.length;i++){if(u.data.event_queue[i]==="purchase"||u.data.event_queue[i]==="refund"){has_purchase=true;}}
if(u.data.order_id&&!has_purchase){u.data.event_queue.push("purchase");}
for(i=0;i<u.data.event_queue.length;i++){var event_name=u.data.event_queue[i];var event_data={};event_data=JSON.parse(JSON.stringify(u.data.event));if(u.data.event.non_interaction){u.data.event.non_interaction=true;}
if(u.event_map[event_name]){for(j=0;j<u.event_map[event_name].length;j++){var event_param=u.event_map[event_name][j];var event_param_value=u.std_params[event_param]?u.std_params[event_param](event_name):u.data[event_param]||"";if(event_param_value!==""){event_data[event_param]=event_param_value;}}}
Object.keys(u.map).forEach(function(mapping_from){if(u.map[mapping_from].indexOf(event_name)===0&&typeof b[mapping_from]!=="undefined"){var mapping_to=u.map[mapping_from].substring(event_name.length+1);event_data[mapping_to]=b[mapping_from];}});utag.ut.merge(event_data,u.data[event_name],0);u.o("event",event_name,event_data);}
if(!hasgtagjs()){u.scriptrequested=true;utag.ut.gtagScriptRequested=true;u.data.base_url=u.data.base_url.replace("##utag_measurement_id##",u.data.measurement_id[0]);utag.ut.loader({"type":"script","src":u.data.base_url,"cb":null,"loc":"script","id":"utag_6780","attrs":{}});}
utag.DB("send:6780:COMPLETE");}};function mapFunc(arr,obj,item){var i=arr.shift();obj[i]=obj[i]||{};if(arr.length>0){mapFunc(arr,obj[i],item);}else{obj[i]=item;}}
function toBoolean(val){val=val||"";return val===true||val.toLowerCase()==="true"||val.toLowerCase()==="on";}
function hasgtagjs(){window.gtagRename=window.gtagRename||""||"gtag";if(utag.ut.gtagScriptRequested){return true;}
var i,s=document.getElementsByTagName("script");for(i=0;i<s.length;i++){if(s[i].src&&s[i].src.indexOf("gtag/js")>=0&&(s[i].id&&s[i].id.indexOf("utag")>-1)){return true;}}
var data_layer_name=""||"dataLayer";window[data_layer_name]=window[data_layer_name]||[];if(typeof window[window.gtagRename]!=="function"){window[window.gtagRename]=function(){window[data_layer_name].push(arguments);};var cross_track=toBoolean(""),cross_track_domains="";if(cross_track&&cross_track_domains!==""){window[window.gtagRename]("set","linker",{domains:cross_track_domains.split(","),accept_incoming:true});}
window[window.gtagRename]("js",new Date());}
return false;}
u.scriptrequested=hasgtagjs();u.initialized=false;u.o=window[window.gtagRename];function setGlobalProperties(data,reset,custom_property){var map={"user_id":{"name":"user_id","type":"exists","reset":true},"page_path":{"name":"page_path","type":"exists","reset":true},"page_title":{"name":"page_title","type":"exists","reset":true},"page_location":{"name":"page_location","type":"exists","reset":false},"developer_id.dYmQxMT":{"name":"developer_id.dYmQxMT","type":"exists","reset":false},"user_properties":{"name":"user_properties","type":"object","reset":true}},prop,subProp,g={};if(custom_property&&reset){g[custom_property]="";}
for(prop in utag.loader.GV(map)){if(reset&&map[prop].reset){if(map[prop].name==="user_properties"){for(subProp in data[prop]){if(!g[map[prop].name]){g[map[prop].name]={};}
g[map[prop].name][subProp]="";}}else{g[map[prop].name]="";}}else{if(map[prop].type==="bool"){if(data[prop]==true||data[prop]==="true"){g[map[prop].name]=true;}}
else if(map[prop].type==="exists"||map[prop].type==="object"){if(data[prop]){g[map[prop].name]=data[prop];}}}}
if(!utag.ut.isEmptyObject(g)){u.o("set",g);}}
function getItems(length){var g={},i,items=[];length=length||u.data.product_id.length||u.data.product_name.length;for(i=0;i<length;i++){g={};g.item_id=u.data.product_id[i];if(u.data.product_name[i]){g.item_name=u.data.product_name[i];}
if(u.data.product_coupon[i]){g.coupon=u.data.product_coupon[i];}
if(u.data.product_discount[i]){g.discount=u.data.product_discount[i];}
if(u.data.product_affiliation[i]){g.affiliation=u.data.product_affiliation[i];}
if(u.data.product_brand[i]){g.item_brand=u.data.product_brand[i];}
if(u.data.product_category[i]){g.item_category=u.data.product_category[i];}
if(u.data.product_subcategory[i]){g.item_category2=u.data.product_subcategory[i];}
if(u.data.product_addcategory3[i]){g.item_category3=u.data.product_addcategory3[i];}
if(u.data.product_addcategory4[i]){g.item_category4=u.data.product_addcategory4[i];}
if(u.data.product_addcategory5[i]){g.item_category5=u.data.product_addcategory5[i];}
if(u.data.product_variant[i]){g.item_variant=u.data.product_variant[i];}
if(u.data.product_unit_price[i]){g.price=u.data.product_unit_price[i];}
if(u.data.order_currency){g.currency=u.data.order_currency;}
if(u.data.product_quantity[i]){g.quantity=u.data.product_quantity[i];}
if(u.data.product_promotion_id[i]){g.promotion_id=u.data.product_promotion_id[i];}
if(u.data.product_promotion_name[i]){g.promotion_name=u.data.product_promotion_name[i];}
if(u.data.product_creative_name[i]){g.creative_name=u.data.product_creative_name[i];}
if(u.data.product_creative_slot[i]){g.creative_slot=u.data.product_creative_slot[i];}
if(u.data.product_location_id[i]){g.location_id=u.data.product_location_id[i];}
if(u.data.product_index[i]){g.index=u.data.product_index[i];}
if(u.data.product_item_list_name[i]){g.item_list_name=u.data.product_item_list_name[i];}
if(u.data.product_item_list_id[i]){g.item_list_id=u.data.product_item_list_id[i];}
items.push(g);}
return items;}
u.event_map={add_payment_info:["coupon","currency","items","payment_type","value"],add_shipping_info:["coupon","currency","items","shipping_tier","value"],add_to_cart:["currency","items","value"],add_to_wishlist:["currency","items","value"],begin_checkout:["coupon","currency","items","value"],earn_virtual_currency:["virtual_currency_name","value"],generate_lead:["currency","value"],join_group:["group_id"],level_end:["level_name","success"],level_start:["level_name"],level_up:["level","character"],login:["method"],post_score:["score","level","character"],purchase:["affiliation","coupon","currency","items","transaction_id","shipping","tax","value"],refund:["affiliation","coupon","currency","items","transaction_id","shipping","tax","value"],remove_from_cart:["currency","items","value"],search:["search_term"],select_content:["content_type","item_id"],select_item:["items","item_list_name","item_list_id"],select_promotion:["items","location_id"],share:["method","content_type","content_id"],sign_up:["method"],spend_virtual_currency:["item_name","virtual_currency_name","value"],tutorial_begin:[],tutorial_complete:[],unlock_achievement:["achievement_id"],view_cart:["currency","items","value"],view_item:["currency","items","value"],view_item_list:["items","item_list_name","item_list_id"],view_promotion:["items","location_id"],exception:["description","fatal"],screen_view:["screen_name"]};u.std_params={"transaction_id":function(){return u.data.order_id;},"affiliation":function(){return u.data.order_store;},"value":function(event){if(event.match(/timing_complete|virtual_currency/i)){return u.data.value;}
return u.data.order_total;},"currency":function(){return u.data.order_currency;},"tax":function(){return u.data.order_tax;},"shipping":function(){return u.data.order_shipping;},"coupon":function(){return u.data.order_coupon_code;},"fatal":function(){return toBoolean(u.data.fatal);},"items":function(event){if(event.match(/view_item$|select_content/)){return getItems(1);}
return getItems();},"item_id":function(){return u.data.product_id[0]?u.data.product_id[0]:"";}};utag.o[loader].loader.LOAD(id);}("6780","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.7213 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
(function(t){var signal=window[t]=window[t]||[];if(!signal.init)if(signal.loaded)window.console&&console.error&&console.error("Signal snippet included twice.");else{signal.loaded=!0,signal.methods=["init","debug","browser","session","identity","forget","event"],signal.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);return e.unshift(t),signal.push(e),signal}};for(var n=0;n<signal.methods.length;n++){var r=signal.methods[n];signal[r]=signal.factory(r)}}})("signal");try{(function(id,loader){var u={id:id};utag.o[loader].sender[id]=u;u.ev={view:1,};u.initialized=false;u.scriptrequested=false;u.map={"pmc_pageName":"page_title","product_id":"product_id","product_name":"product_name","tealium_event:product_view":"ProductPageView","tealium_event:purchase":"OrderCompletion","tealium_event:search_results":"ProductSearch","dom.url":"page_url","price_string_array":"product_unit_price","order_id":"order_id","search_keyword":"search_term","product_quantity_string_array":"product_quantity","order_subtotal_string":"order_subtotal","order_discount_amount_string":"order_discount","sc_visitor_id":"customer_id,identity_id","davinci_access_token":"config_access_token","customer_email_public":"customer_email","product_discount":"product_discount"};u.extend=[function(a,b){try{if(typeof b['product_unit_price']!='undefined'&&b['product_unit_price']!=''){try{b['price_string_array']=pmc.convertArrayNumbersToStrings(b["product_unit_price"]);}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(typeof b['order_discounted_subtotal']!='undefined'&&b['order_discounted_subtotal']!=''){try{b['order_subtotal_string']=b["order_discounted_subtotal"].toString();}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(typeof b['order_discount_amount']!='undefined'&&b['order_discount_amount']!=''){try{b['order_discount_amount_string']=b["order_discount_amount"].toString();}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(typeof b['product_discounted_price']!='undefined'&&b['product_discounted_price']!=''){try{b['product_discount']=pmc.convertArrayNumbersToStrings(b["product_discount"]);}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(typeof b['product_quantity']!='undefined'&&b['product_quantity']!=''){try{b['product_quantity_string_array']=pmc.convertArrayNumbersToStrings(b["product_quantity"]);}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(1){b.davinci_access_token="public_6f35eeefa6ded1c2fffe422eb9e6b58e";const environment=(pmc.environment.tealiumEnvironment==="prod")?"prod":"qa";const brand_environment=b.brand+environment;const token_map=[{brand_environment:"wsprod",token:"public_7edf0f1e8d8971bd7d9bd8fb24504de5"},{brand_environment:"wsqa",token:"public_test_cd85be3f25f8d40da8edf524ae2ec7ff"},];const foundElement=token_map.find(element=>brand_environment===element.brand_environment);b.davinci_access_token=foundElement?foundElement.token:b.davinci_access_token;}}catch(e){utag.DB(e)}}];u.clearEmptyKeys=function(object){Object.keys(object).forEach(function(key){if(object[key]===""||object[key]===undefined){delete object[key];}});return object;};u.dispatchEvent=function(type,data){var helpers={makeOrder:function(data){return u.clearEmptyKeys({discount:data.order_discount,items:helpers.makeOrderItems(data),processedAt:data.order_processed_at,referenceId:data.order_id,source:data.source,subtotal:data.order_subtotal,tags:data.metadata_tags,attributes:data.metadata_attributes});},makeOrderItems:function(data){if(data.product_id&&data.product_id.length){return data.product_id.map(function(_,i){return u.clearEmptyKeys({discount:data.product_discount&&data.product_discount[i],name:data.product_name&&data.product_name[i],price:data.product_unit_price&&data.product_unit_price[i],quantity:data.product_quantity&&data.product_quantity[i],referenceId:data.product_id&&data.product_id[i],tags:data.metadata_tags,attributes:data.metadata_attributes});});}
return[];},makeProducts:function(data){if(data.product_id&&data.product_id.length){return data.product_id.map(function(_,i){return u.clearEmptyKeys({name:data.product_name&&data.product_name[i],referenceId:data.product_id&&data.product_id[i],variants:helpers.makeProductVariants(data,i),tags:data.metadata_tags,attributes:data.metadata_attributes});});}
return[];},makeProductVariants:function(data,j){if(data.product_variant_id&&data.product_variant_id.length){return data.product_variant_id
.map(function(_,i){if((data.product_variant_product_id&&data.product_variant_product_id[i])===(data.product_id&&data.product_id[j])){return u.clearEmptyKeys({name:data.product_variant_name&&data.product_variant_name[i],referenceId:data.product_variant_id&&data.product_variant_id[i],price:data.product_variant_price&&data.product_variant_price[i],tags:data.metadata_tags,attributes:data.metadata_attributes});}
return null;})
.filter(Boolean);}
if(data.product_id&&data.product_id[j]){return[u.clearEmptyKeys({name:data.product_name&&data.product_name[j],referenceId:data.product_id&&data.product_id[j],price:data.product_unit_price&&data.product_unit_price[j],tags:data.metadata_tags,attributes:data.metadata_attributes})];}
return[];}};var events={Forget:function(){signal.forget();},Identity:function(data){signal.identity(u.clearEmptyKeys({contactId:data.contact_id,emailAddress:"",referenceId:data.customer_email,source:data.source,tags:data.metadata_tags,attributes:data.metadata_attributes}));},OrderCancelation:function(data){signal.event("orderCancelation",u.clearEmptyKeys({order:helpers.makeOrder(data),tags:data.metadata_tags,attributes:data.metadata_attributes}));},OrderCompletion:function(data){signal.event("orderCompletion",u.clearEmptyKeys({order:helpers.makeOrder(data),tags:data.metadata_tags,attributes:data.metadata_attributes}));},OrderRefund:function(data){signal.event("orderRefund",u.clearEmptyKeys({order:helpers.makeOrder(data),tags:data.metadata_tags,attributes:data.metadata_attributes}));},PageView:function(data){signal.event("pageView",u.clearEmptyKeys({referrer:data.page_referrer,source:data.source,title:data.page_title,url:data.page_url,tags:data.metadata_tags,attributes:data.metadata_attributes}));},ProductPageView:function(data){signal.event("productPageView",u.clearEmptyKeys({product:helpers.makeProducts(data)[0],referrer:data.page_referrer,source:data.source,title:data.page_title,url:data.page_url,tags:data.metadata_tags,attributes:data.metadata_attributes}));},ProductSearch:function(data){signal.event("productSearch",u.clearEmptyKeys({products:helpers.makeProducts(data),query:data.search_term,tags:data.metadata_tags,attributes:data.metadata_attributes}));}};if(events[type]){events[type](utag.loader.GV(data));}};u.dispatchAllEvents=function(events){events.forEach(function(event){u.dispatchEvent(event,u.data);});};u.send=function(utag_event,data_layer){if(u.ev[utag_event]||u.ev.all!==undefined){utag.DB("send:7213");utag.DB(data_layer);var a,b,c,d;a=utag_event;b=data_layer;var events=["PageView"];u.data={config_access_token:"public_6f35eeefa6ded1c2fffe422eb9e6b58e",config_base_url:"https://track.coherentpath.com",config_currency_code:"USD",config_debug:false,config_src_url:"https://track.coherentpath.com/v1/track.js",metadata_attributes:undefined,metadata_tags:undefined,contact_id:"",customer_email:"",order_discount:"",order_processed_at:"",page_referrer:"",page_title:"",page_url:"",product_variant_id:[],product_variant_name:[],product_variant_price:[],product_variant_product_id:[],search_term:"",source:"",customer_id:"",order_id:"",order_subtotal:"",product_discount:[],product_id:[],product_name:[],product_quantity:[],product_unit_price:[]};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:7213:EXTENSIONS");utag.DB(data_layer);Object.keys(utag.loader.GV(u.map)).forEach(function(mapping_key){if(data_layer[mapping_key]!==undefined&&data_layer[mapping_key]!==""){var destinations=u.map[mapping_key].split(",");destinations.forEach(function(parameter){u.data[parameter]=data_layer[mapping_key];});}else{var event_destinations=mapping_key.split(":");if(event_destinations.length===2&&String(data_layer[event_destinations[0]])===String(event_destinations[1])){if(u.map[mapping_key]){events=events.concat(u.map[mapping_key].split(","));}}}});utag.DB("send:7213:MAPPINGS");utag.DB(u.data);var eCommerceMapping=[{eCommerceData:b._ccustid,name:"customer_id",isArray:false},{eCommerceData:b._corder,name:"order_id",isArray:false},{eCommerceData:b._csubtotal,name:"order_subtotal",isArray:false},{eCommerceData:b._cpdisc,name:"product_discount",isArray:true},{eCommerceData:b._cprod,name:"product_id",isArray:true},{eCommerceData:b._cprodname,name:"product_name",isArray:true},{eCommerceData:b._cquan,name:"product_quantity",isArray:true},{eCommerceData:b._cprice,name:"product_unit_price",isArray:true}];eCommerceMapping.forEach(function(dataObject){if(!dataObject.isArray){u.data[dataObject.name]=u.data[dataObject.name]||dataObject.eCommerceData||"";}else if(u.data[dataObject.name].length===0&&dataObject.eCommerceData!==undefined&&dataObject.isArray){u.data[dataObject.name]=dataObject.eCommerceData.slice(0);}});if(!u.data.config_src_url||!u.data.config_access_token){utag.DB(u.id+": Tag not fired: Required attribute config_src_url or config_access_token not populated");return;}
if(u.data.customer_email){events.unshift("Identity");}
if(u.initialized){u.dispatchAllEvents(events);}
if(!u.scriptrequested){u.scriptrequested=true;utag.ut.loader({type:"script",src:u.data.config_src_url,cb:function(){u.initialized=true;signal.init(u.data.config_access_token,{baseUrl:u.data.config_base_url,currencyCode:u.data.config_currency_code});signal.debug(u.data.config_debug);u.dispatchAllEvents(events);},loc:"script",id:"utag_7213",attrs:{}});}
utag.DB("send:7213:COMPLETE");}};utag.o[loader].loader.LOAD(id);})("7213","wsi.williamssonoma");}catch(error){utag.DB(error);}

//tealium universal tag - utag.7218 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.loader===undefined){u.loader=function(o){var b,c,l,a=document;if(o.type==="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l];}b.src=o.src;}if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}}}else{u.loader=utag.ut.loader;}
u.encode=function(a,b){b="";try{b=encodeURIComponent(a)}catch(e){utag.DB(e);}if(b==""){b=escape(a);}return b}
u.ev={"view":1};u.scriptrequested=false;u.rp=function(a,b){if(typeof a!=="undefined"&&a.indexOf("@@")>0){a=a.replace(/@@([^@]+)@@/g,function(m,d){if(b[d]){return u.encode(b[d]);}else{return"";}});}
return a;};u.map={};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'pb':'jvxpxl.potterybarn.com'},{'ws':'jvxpxl.williams-sonoma.com'},{'we':'jvxpxl.westelm.com'},{'pt':'jvxpxl.pbteen.com'},{'pk':'jvxpxl.potterybarnkids.com'},{'mg':'jvxpxl.markandgraham.com'},{'rj':'jvxpxl.rejuvenation.com'},{'gr':'jvxpxl.greenrow.com'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['jivox_endpoint']=c[e][f];m=true};};if(m)break};if(!m)b['jivox_endpoint']='';}},function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'mg':'Xbrand_PlusOne_MG'},{'pb':'Xbrand_PlusOne_PB'},{'pk':'Xbrand_PlusOne_PBK'},{'pt':'Xbrand_PlusOne_PBT'},{'we':'Xbrand_PlusOne_WE'},{'ws':'Xbrand_PlusOne_WS'},{'gr':'Xbrand_PlusOne_GR'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['jivox_copt_id']=c[e][f];m=true};};if(m)break};}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f;u.data={"qsp_delim":"&"||"&","kvp_delim":"="||"=","qs_delim":"?"||"?","tag_type":"img","base_url":"//@@jivox_endpoint@@/tags/conv/pxre.php?px=36230615231bb4&cOpt=@@jivox_copt_id@@&rev=0","secure_base_url":"","static_params":"","cachebust":"disabled","cachevar":""||"_rnd","requestscriptonce":"disabled"};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:7218:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(typeof b[d]!=="undefined"&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(!u.data.hasOwnProperty(e[f])){c.push(e[f]+"##kvp_delim##"+u.encode(b[d]));}
u.data[e[f]]=b[d];}}}
if(!u.data.base_url){if(!u.data.secure_base_url){utag.DB("Error: No Base URL or Secure HTTPS Override Provided.");return;}else{u.data.base_url=u.data.secure_base_url;utag.DB("No Base URL provided, using Secure HTTPS Override.");}}
u.data.secure_base_url=u.data.secure_base_url||u.data.base_url;u.data.url=(location.protocol==="https:"?u.data.secure_base_url:u.data.base_url);if(u.data.url.indexOf("http")!==0&&u.data.url.indexOf("/")!==0){u.data.url=location.protocol+"//"+u.data.url;}
if(u.data.static_params){c.push(u.data.static_params);}
var cb_check=new RegExp("(\\"+u.data.qs_delim+"|"+u.data.qsp_delim+")"+u.data.cachevar+"=");if(u.data.cachebust==="enabled"&&!cb_check.test(u.data.url)){c.push([u.data.cachevar,Math.random()].join(u.data.kvp_delim));}
if(c.length>0){if(u.data.url.indexOf(u.data.qs_delim)<0){u.data.url+=u.data.qs_delim;}else if(u.data.url.indexOf(u.data.qs_delim)!==(u.data.url.length-1)){u.data.url+=u.data.qsp_delim;}}
u.data.url=u.rp(u.data.url,b)+u.rp(c.join(u.data.qsp_delim),b);u.data.url=u.data.url.replace(/##kvp_delim##/g,u.data.kvp_delim);u.callback=u.callback||function(){};if(u.data.requestscriptonce==="enabled"&&u.data.tag_type==="script"){if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_7218","cb":u.callback});}else{u.callback();}}else{u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_7218","cb":u.callback});}
utag.DB("send:7218:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("7218","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.7226 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={};utag.o[loader].sender[id]=u;if(utag===undefined){utag={};}if(utag.ut===undefined){utag.ut={};}if(utag.ut.loader===undefined){u.loader=function(o){var a,b,c,l;a=document;if(o.type==="iframe"){b=a.createElement("iframe");b.setAttribute("height","1");b.setAttribute("width","1");b.setAttribute("style","display:none");b.setAttribute("src",o.src);}else if(o.type==="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";b.src=o.src;}if(o.id){b.id=o.id;}if(typeof o.cb==="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb();},false);}else{b.onreadystatechange=function(){if(this.readyState==="complete"||this.readyState==="loaded"){this.onreadystatechange=null;o.cb();}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l==="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b);}}};}else{u.loader=utag.ut.loader;}
u.ev={'view':1,'link':1};u.initialized=false;u.map={"product_id":"ProdCode","page_type":"PageType","category_id":"CatID","category_path":"CatCode","turn_b2":"turn_account_id","product_highest_price":"Price","product_favorite_add":"Fave","top_category":"SuperCat","encoded_path_name":"PathName","turn_top_cat":"TopCat","liveramp_ats_envelope":"rampid","sc_visitor_id":"SiteCat"};u.extend=[function(a,b){try{if((typeof b['pmc_scAdd']!='undefined'&&b['pmc_scAdd']=='scAdd')){try{b['turn_bprice']=b.product_unit_price[0].toString()}catch(e){};b['page_type']='AddToCart'}}catch(e){utag.DB(e);}},function(a,b){try{if(b['page_type'].toString().toLowerCase()=='product'.toLowerCase()||b['page_type'].toString().toLowerCase()=='AddToCart'.toLowerCase()){try{b['adv_top_level_category']=(function(){return digitalData.product.productCategory.categories[0]})();}catch(e){};try{b['category_path']=(function(){return digitalData.product.productCategory.categories.join()})();}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(b['page_type'].toString().toLowerCase()=='category'.toLowerCase()){try{b['adv_top_level_category']=(function(){return digitalData.page.pageCategory.categories[0]})();}catch(e){};try{b['category_path']=(function(){return digitalData.page.pageCategory.categories[digitalData.page.pageCategory.categories.length-1]})();}catch(e){}}}catch(e){utag.DB(e);}},function(a,b,c,d,e,f,g){if(1){d=b['brand_with_market'];if(typeof d=='undefined')return;c=[{'mg-us':'L21rdC84NjEvY2lkLzI4NjUxOTYyL3QvMA'},{'pt-us':'L21rdC84NjEvY2lkLzI4NjkwODQzL3QvMA'},{'pb-us':'L21rdC84NjEvY2lkLzI4NTcyMjExL3QvMA'},{'pk-us':'L21rdC84NjEvY2lkLzI4NjkwNzQxL3QvMA'},{'we-us':'L21rdC84NjEvY2lkLzI4NjkwNzM5L3QvMA'},{'ws-us':'L21rdC84NjEvY2lkLzI4NjkwNzQwL3QvMA'},{'rj-us':'L21rdC84NjEvY2lkLzI4NjkwNzQyL3QvMA'},{'gr-us':'L21rdC84NjEvY2lkLzE3NTAyMTIzNzAvdC8w'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d.toString().indexOf(f)>-1){b['turn_b2']=c[e][f];m=true};};if(m)break};}},function(a,b){try{if(1){window.beacon_price="";window.client_track_id="";var sub=b["order_discounted_subtotal"];var orderId=b["order_id"];if(typeof(sub)!=="undefined"&&sub.length>0&&!isNaN(sub)){window.beacon_price=sub;}
if(typeof(orderId)!=="undefined"&&orderId.length>0){window.client_track_id=orderId;}}}catch(e){utag.DB(e)}},function(a,b){try{if(b['dom.pathname'].toString().indexOf('/pages/harry-potter-preview/')>-1){b['page_type']='Harry Potter Preview'}}catch(e){utag.DB(e);}},function(a,b){try{if((typeof b['pmc_scAdd']!='undefined'&&b['pmc_scAdd']=='scAdd')||b['page_type']!='product'){var getHighestPrice=function(pArray,highestPrice){if(typeof(pArray)!=="undefined"){for(var i=0;i<pArray.length;i++){if(pArray[i]>highestPrice){highestPrice=pArray[i];}}}
return highestPrice;}
b.product_highest_price=getHighestPrice(b.product_unit_price,0);}}catch(e){utag.DB(e)}},function(a,b){try{if((b['tealium_event']=='favorites_add'&&typeof b['pmc_products']!='undefined'&&typeof b['pmc_products']!='undefined'&&b['pmc_products']!='')){b['product_favorite_add']=b['group_id'];b['page_type']='addFavorites';b['is_favorite']='true'}}catch(e){utag.DB(e);}},function(a,b){try{if(b['dom.pathname'].toString().indexOf('/pages/pbdorm/')>-1){b['page_type']='dorm'}}catch(e){utag.DB(e);}},function(a,b){try{if(b['dom.pathname'].toString().indexOf('/pages/baby/')>-1){b['page_type']='baby'}}catch(e){utag.DB(e);}},function(a,b){try{if(b['dom.pathname'].toString().indexOf('/pages/williams-sonoma-home/')>-1){b['page_type']='ws_home'}}catch(e){utag.DB(e);}},function(a,b){try{if((typeof b['pmc_scAdd']!='undefined'&&b['pmc_scAdd']=='scAdd')){try{b['product_id']=(function(){var prodArray=b['pmc_products'].split(";");return(prodArray.length>1)?prodArray.slice(1,2):[""];})();}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(1){try{b['top_category']=(function(){return b["top_category"]})();}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(1){try{b['new_or_repeat_visitor']=(function(){return utag_data.new_or_repeat_visitor;})();}catch(e){}}}catch(e){utag.DB(e);}},function(a,b){try{if(1){if(a==="link"&&b.associatedTags){return false;}}}catch(e){utag.DB(e)}},function(a,b){try{if(1){var turnTopCatMap=[{key:"pb",value:"potterybarn",},{key:"pb-apartment",value:"pb-apartment",},{key:"ws-kitchen",value:"ws-kitchen",},{key:"ws-home",value:"ws-home",},{key:"we",value:"west-elm",},{key:"we-collection",value:"west-elm-collection",},{key:"we-kids",value:"west-elm",},{key:"pt",value:"pbteen",},{key:"pt-dorm",value:"pbdorm",},{key:"pk",value:"pk-kids",},{key:"pk-baby",value:"pk-baby",},{key:"pk-modern-baby",value:"pk-baby",},{key:"mg",value:"markandgraham",},{key:"rj",value:"rejuvenation",},{key:"gr",value:"greenrow",},];b.turn_top_cat=pmc.resolveMapLookup(turnTopCatMap,b.subBrand);}}catch(e){utag.DB(e)}},function(a,b,c,d,e,f,g){if(b['brand']=='we'){d=b['cp.ret_split'];if(typeof d=='undefined')return;c=[{'ctrl':'0'},{'turn':'1'},{'desk':'2'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['retargeting_split_numeric']=c[e][f];m=true};};if(m)break};if(!m)b['retargeting_split_numeric']='3';}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f,i;u.data={"base_url":"//d.turn.com/server/dp_data_call.js?dp=/r/dd/id/","turn_account_id":"","SiteCat":"","PageType":"","ProdCode":[],"product_id":[],"CatID":"","CatCode":"","TopCat":"","Fave":"","Price":"","cb":""};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){u.data[e[f]]=b[d];}}}
if(typeof(u.data["ProdCode"][0])==="undefined"){u.data["ProdCode"][0]=""};u.loader_cb=function(){};var rampId=u.data.rampid||utag_data.liveramp_ats_envelope;var delay=0;var data;window.setTimeout(function(){rampId=rampId||utag_data.liveramp_ats_envelope;if(!u.initialized){var parameterString="/cat/1/dpuid/"+u.data.SiteCat;parameterString+="/fpid/"+u.data.SiteCat;if(u.data.rampid){parameterString+="/rampid/"+rampId;}
parameterString+="/kv/SiteCat="+u.data.SiteCat;parameterString+=",TopCat="+u.data.TopCat;parameterString+=",Fave="+u.data.Fave;parameterString+=",Price="+u.data.Price;parameterString+=",PageType="+u.data.PageType;parameterString+=",ProdCode="+u.data.ProdCode[0];parameterString+=",CatID="+u.data.CatID;parameterString+=",SuperCat="+u.data.SuperCat;parameterString+=",CatCode="+u.data.CatCode;parameterString+=",PathName="+u.data.PathName;data={"type":"script","src":u.data.base_url+u.data.turn_account_id+parameterString,"cb":u.loader_cb,"loc":"script","id":'utag_7226'};u.loader(data);}else{u.loader_cb();}},delay);}};utag.o[loader].loader.LOAD(id);})("7226","wsi.williamssonoma");}catch(error){utag.DB(error);}

//tealium universal tag - utag.7247 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.loader===undefined){u.loader=function(o){var b,c,l,a=document;if(o.type==="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l];}b.src=o.src;}if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}}}else{u.loader=utag.ut.loader;}
u.encode=function(a,b){b="";try{b=encodeURIComponent(a)}catch(e){utag.DB(e);}if(b==""){b=escape(a);}return b}
u.ev={"view":1};u.scriptrequested=false;u.rp=function(a,b){if(typeof a!=="undefined"&&a.indexOf("@@")>0){a=a.replace(/@@([^@]+)@@/g,function(m,d){if(b[d]){return u.encode(b[d]);}else{return"";}});}
return a;};u.map={};u.extend=[function(a,b,c,d,e,f,g){if(1){d=b['brand'];if(typeof d=='undefined')return;c=[{'ws':'williamssonoma'},{'we':'westelm'},{'pb':'potterybarn'},{'pk':'potterybarnkids'},{'pt':'pbteen'},{'rj':'rejuvenation'},{'mg':'markandgraham'},{'gr':'greenrow'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['sf_account_id']=c[e][f];m=true};};if(m)break};}},function(a,b,c,d,e,f,g){if(1){d=b['ut.env'];if(typeof d=='undefined')return;c=[{'prod':'prod'},{'staging':'prod'}];var m=false;for(e=0;e<c.length;e++){for(f in utag.loader.GV(c[e])){if(d==f){b['sf_environment']=c[e][f];m=true};};if(m)break};if(!m)b['sf_environment']='test';}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f;u.data={"qsp_delim":"&"||"&","kvp_delim":"="||"=","qs_delim":"?"||"?","tag_type":"script","base_url":"//cdn.evgnet.com/beacon/williamssonomainc/@@sf_account_id@@_@@sf_environment@@/scripts/evergage.min.js","secure_base_url":"","static_params":"","cachebust":"disabled","cachevar":""||"_rnd","requestscriptonce":"enabled","attribute":{}};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:7247:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(typeof b[d]!=="undefined"&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(e[f].indexOf("attribute.")===0){u.data.attribute[e[f].split(".")[1]]=b[d];}else if(!u.data.hasOwnProperty(e[f])){c.push(e[f]+"##kvp_delim##"+u.encode(b[d]));}
u.data[e[f]]=b[d];}}}
if(!u.data.base_url){if(!u.data.secure_base_url){utag.DB("Error: No Base URL or Secure HTTPS Override Provided.");return;}else{u.data.base_url=u.data.secure_base_url;utag.DB("No Base URL provided, using Secure HTTPS Override.");}}
u.data.secure_base_url=u.data.secure_base_url||u.data.base_url;u.data.url=(location.protocol==="https:"?u.data.secure_base_url:u.data.base_url);if(u.data.url.indexOf("http")!==0&&u.data.url.indexOf("/")!==0){u.data.url=location.protocol+"//"+u.data.url;}
if(u.data.static_params){c.push(u.data.static_params);}
var cb_check=new RegExp("(\\"+u.data.qs_delim+"|"+u.data.qsp_delim+")"+u.data.cachevar+"=");if(u.data.cachebust==="enabled"&&!cb_check.test(u.data.url)){c.push([u.data.cachevar,Math.random()].join(u.data.kvp_delim));}
if(c.length>0){if(u.data.url.indexOf(u.data.qs_delim)<0){u.data.url+=u.data.qs_delim;}else if(u.data.url.indexOf(u.data.qs_delim)!==(u.data.url.length-1)){u.data.url+=u.data.qsp_delim;}}
u.data.url=u.rp(u.data.url,b)+u.rp(c.join(u.data.qsp_delim),b);u.data.url=u.data.url.replace(/##kvp_delim##/g,u.data.kvp_delim);u.callback=u.callback||function(){};if(u.data.requestscriptonce==="enabled"&&u.data.tag_type==="script"){if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_7247","cb":u.callback,"attrs":u.data.attribute});}else{u.callback();}}else{u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_7247","cb":u.callback,"attrs":u.data.attribute});}
utag.DB("send:7247:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("7247","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.7260 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.loader===undefined){u.loader=function(o){var b,c,l,a=document;if(o.type==="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l];}b.src=o.src;}if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}}}else{u.loader=utag.ut.loader;}
u.encode=function(a,b){b="";try{b=encodeURIComponent(a)}catch(e){utag.DB(e);}if(b==""){b=escape(a);}return b}
u.ev={"view":1};u.scriptrequested=false;u.rp=function(a,b){if(typeof a!=="undefined"&&a.indexOf("@@")>0){a=a.replace(/@@([^@]+)@@/g,function(m,d){if(b[d]){return u.encode(b[d]);}else{return"";}});}
return a;};u.map={};u.extend=[];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f;u.data={"qsp_delim":"&"||"&","kvp_delim":"="||"=","qs_delim":"?"||"?","tag_type":"img","base_url":"//trkn.us/pixel/conv/ppt=21837;g=sitewide;gid=50698;ord=@@tealium_random@@","secure_base_url":"","static_params":"","cachebust":"disabled","cachevar":""||"_rnd","requestscriptonce":"disabled","attribute":{}};utag.DB("send:7260:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(typeof b[d]!=="undefined"&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(e[f].indexOf("attribute.")===0){u.data.attribute[e[f].split(".")[1]]=b[d];}else if(!u.data.hasOwnProperty(e[f])){c.push(e[f]+"##kvp_delim##"+u.encode(b[d]));}
u.data[e[f]]=b[d];}}}
if(!u.data.base_url){if(!u.data.secure_base_url){utag.DB("Error: No Base URL or Secure HTTPS Override Provided.");return;}else{u.data.base_url=u.data.secure_base_url;utag.DB("No Base URL provided, using Secure HTTPS Override.");}}
u.data.secure_base_url=u.data.secure_base_url||u.data.base_url;u.data.url=(location.protocol==="https:"?u.data.secure_base_url:u.data.base_url);if(u.data.url.indexOf("http")!==0&&u.data.url.indexOf("/")!==0){u.data.url=location.protocol+"//"+u.data.url;}
if(u.data.static_params){c.push(u.data.static_params);}
var cb_check=new RegExp("(\\"+u.data.qs_delim+"|"+u.data.qsp_delim+")"+u.data.cachevar+"=");if(u.data.cachebust==="enabled"&&!cb_check.test(u.data.url)){c.push([u.data.cachevar,Math.random()].join(u.data.kvp_delim));}
if(c.length>0){if(u.data.url.indexOf(u.data.qs_delim)<0){u.data.url+=u.data.qs_delim;}else if(u.data.qs_delim!==u.data.url[u.data.url.length-1]){u.data.url+=u.data.qsp_delim;}}
u.data.url=u.rp(u.data.url,b)+u.rp(c.join(u.data.qsp_delim),b);u.data.url=u.data.url.replace(/##kvp_delim##/g,u.data.kvp_delim);u.callback=u.callback||function(){};if(u.data.requestscriptonce==="enabled"&&u.data.tag_type==="script"){if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_7260","cb":u.callback,"attrs":u.data.attribute});}else{u.callback();}}else{u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_7260","cb":u.callback,"attrs":u.data.attribute});}
utag.DB("send:7260:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("7260","wsi.williamssonoma"));}catch(error){utag.DB(error);}

//tealium universal tag - utag.7261 ut4.0.202306211434, Copyright 2023 Tealium.com Inc. All Rights Reserved.
try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
if(utag.ut.loader===undefined){u.loader=function(o){var b,c,l,a=document;if(o.type==="iframe"){b=a.createElement("iframe");o.attrs=o.attrs||{"height":"1","width":"1","style":"display:none"};for(l in utag.loader.GV(o.attrs)){b.setAttribute(l,o.attrs[l]);}b.setAttribute("src",o.src);}else if(o.type=="img"){utag.DB("Attach img: "+o.src);b=new Image();b.src=o.src;return;}else{b=a.createElement("script");b.language="javascript";b.type="text/javascript";b.async=1;b.charset="utf-8";for(l in utag.loader.GV(o.attrs)){b[l]=o.attrs[l];}b.src=o.src;}if(o.id){b.id=o.id};if(typeof o.cb=="function"){if(b.addEventListener){b.addEventListener("load",function(){o.cb()},false);}else{b.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){this.onreadystatechange=null;o.cb()}};}}l=o.loc||"head";c=a.getElementsByTagName(l)[0];if(c){utag.DB("Attach to "+l+": "+o.src);if(l=="script"){c.parentNode.insertBefore(b,c);}else{c.appendChild(b)}}}}else{u.loader=utag.ut.loader;}
u.encode=function(a,b){b="";try{b=encodeURIComponent(a)}catch(e){utag.DB(e);}if(b==""){b=escape(a);}return b}
u.ev={"view":1};u.scriptrequested=false;u.rp=function(a,b){if(typeof a!=="undefined"&&a.indexOf("@@")>0){a=a.replace(/@@([^@]+)@@/g,function(m,d){if(b[d]){return u.encode(b[d]);}else{return"";}});}
return a;};u.map={};u.extend=[];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){var c,d,e,f;u.data={"qsp_delim":"&"||"&","kvp_delim":"="||"=","qs_delim":"?"||"?","tag_type":"img","base_url":"//trkn.us/pixel/conv/ppt=21837;g=order-confirmation-page;gid=50699;cv1=@@order_discounted_subtotal@@;ord=@@tealium_random@@","secure_base_url":"","static_params":"","cachebust":"disabled","cachevar":""||"_rnd","requestscriptonce":"disabled","attribute":{}};utag.DB("send:7261:EXTENSIONS");utag.DB(b);c=[];for(d in utag.loader.GV(u.map)){if(typeof b[d]!=="undefined"&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(e[f].indexOf("attribute.")===0){u.data.attribute[e[f].split(".")[1]]=b[d];}else if(!u.data.hasOwnProperty(e[f])){c.push(e[f]+"##kvp_delim##"+u.encode(b[d]));}
u.data[e[f]]=b[d];}}}
if(!u.data.base_url){if(!u.data.secure_base_url){utag.DB("Error: No Base URL or Secure HTTPS Override Provided.");return;}else{u.data.base_url=u.data.secure_base_url;utag.DB("No Base URL provided, using Secure HTTPS Override.");}}
u.data.secure_base_url=u.data.secure_base_url||u.data.base_url;u.data.url=(location.protocol==="https:"?u.data.secure_base_url:u.data.base_url);if(u.data.url.indexOf("http")!==0&&u.data.url.indexOf("/")!==0){u.data.url=location.protocol+"//"+u.data.url;}
if(u.data.static_params){c.push(u.data.static_params);}
var cb_check=new RegExp("(\\"+u.data.qs_delim+"|"+u.data.qsp_delim+")"+u.data.cachevar+"=");if(u.data.cachebust==="enabled"&&!cb_check.test(u.data.url)){c.push([u.data.cachevar,Math.random()].join(u.data.kvp_delim));}
if(c.length>0){if(u.data.url.indexOf(u.data.qs_delim)<0){u.data.url+=u.data.qs_delim;}else if(u.data.qs_delim!==u.data.url[u.data.url.length-1]){u.data.url+=u.data.qsp_delim;}}
u.data.url=u.rp(u.data.url,b)+u.rp(c.join(u.data.qsp_delim),b);u.data.url=u.data.url.replace(/##kvp_delim##/g,u.data.kvp_delim);u.callback=u.callback||function(){};if(u.data.requestscriptonce==="enabled"&&u.data.tag_type==="script"){if(!u.scriptrequested){u.scriptrequested=true;u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_7261","cb":u.callback,"attrs":u.data.attribute});}else{u.callback();}}else{u.loader({"type":u.data.tag_type,"src":u.data.url,"loc":"script","id":"utag_7261","cb":u.callback,"attrs":u.data.attribute});}
utag.DB("send:7261:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("7261","wsi.williamssonoma"));}catch(error){utag.DB(error);}
(function(){ if(typeof utag!='undefined' && !utag_condload){utag.initcatch=true;for(var i in utag.loader.GV(utag.loader.cfg)){var b=utag.loader.cfg[i];if(b.load!=4){utag.initcatch=false;break};if(b.wait==1){utag.initcatch=false;break}};if(utag.initcatch)utag.handler.INIT();} })();